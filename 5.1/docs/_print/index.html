<!doctype html><html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name="generator" content="Hugo 0.110.0">
<link rel="canonical" type="text/html" href="https://kube-logging.dev/5.1/docs/">
<link rel="alternate" type="text/releases" href="https://kube-logging.dev/5.1/docs/releases.releases">
<meta name="robots" content="noindex, nofollow">
<link rel="shortcut icon" href="/5.1/favicons/favicon.ico">
<link rel="apple-touch-icon" href="/5.1/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/5.1/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/5.1/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/5.1/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/5.1/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/5.1/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/5.1/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/5.1/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/5.1/favicons/android-192x192.png" sizes="192x192">
<title>Logging operator | Logging operator</title><meta name="description" content="Documentation for the Logging operator">
<meta property="og:title" content="Logging operator">
<meta property="og:description" content="Documentation for the Logging operator">
<meta property="og:type" content="website">
<meta property="og:url" content="https://kube-logging.dev/5.1/docs/"><meta property="og:site_name" content="Logging operator">
<meta itemprop="name" content="Logging operator">
<meta itemprop="description" content="Documentation for the Logging operator"><meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Logging operator">
<meta name="twitter:description" content="Documentation for the Logging operator">
<link rel="preload" href="/5.1/scss/main.min.86aacb60bddeb293329df2c5300c7ccbb0b5b5c79006869829b192179e011aef.css" as="style">
<link href="/5.1/scss/main.min.86aacb60bddeb293329df2c5300c7ccbb0b5b5c79006869829b192179e011aef.css" rel="stylesheet" integrity>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" crossorigin="anonymous"></script>
<link rel="stylesheet" href="/5.1/css/prism.css">
<script src="/js/w3.js" type="application/x-javascript"></script>
<link rel="canonical" href="https://kube-logging.dev/docs/">
<script src="/pagefind/pagefind-highlight.js" type="application/x-javascript"></script>
<script type="module">
        await import('/pagefind/pagefind-highlight.js');
        new PagefindHighlight({ highlightParam: "highlight" });
    </script>
<script>window.__SJ_MESSAGE__="We collect cookies to analyze our website traffic and performance. We never collect any personal data.",window.__SJ_ACCEPT_BTN_TEXT__="Accept",window.__SJ_REJECT_BTN_TEXT__="Reject"</script>
<script src="https://cdn.jsdelivr.net/gh/sprucejoy/cookie-consent-autoblock-gdpr/cookie-consent.js" crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LM8C8QXCN7"></script>
<script>var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LM8C8QXCN7")}</script>
</head><body class="td-section">
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class="navbar-brand" href="/5.1/"><span class="navbar-brand__logo navbar-logo"><svg viewBox="0 0 3237.738 490.023" id="svg142" sodipodi:docname="logo-new2.svg" inkscape:version="1.2.1 (9c6d41e4, 2022-07-14)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs146"/><sodipodi:namedview id="namedview144" pagecolor="#505050" bordercolor="#ffffff" borderopacity="1" inkscape:showpageshadow="0" inkscape:pageopacity="0" inkscape:pagecheckerboard="1" inkscape:deskcolor="#505050" showgrid="false" inkscape:zoom=".37340884" inkscape:cx="1620.208" inkscape:cy="243.70071" inkscape:window-width="705" inkscape:window-height="480" inkscape:window-x="0" inkscape:window-y="25" inkscape:window-maximized="0" inkscape:current-layer="svg142"/><g id="Group_2068" data-name="Group 2068" transform="translate(-43577.297 -34456.625)"><g id="Group_2067" data-name="Group 2067" transform="translate(27723.789 24565.273)"><path id="Path_4217" data-name="Path 4217" d="M47842.219 34024.414l-276.027 475.07h71.242l240.227-414.1z" transform="translate(-31703.996 -24123.111)" fill="#d6d7d9" stroke="#d6d7d9" stroke-width="10"/><path id="Path_4218" data-name="Path 4218" d="M47831.324 34080.781l166.754 287.355h-333.035z" transform="translate(-31640.254 -24086.76)" fill="#fff" stroke="#fff" stroke-width="10"/><path id="Path_4220" data-name="Path 4220" d="M47668.742 34274.2l-37.727 64.1h442.43l-37.156-64.1z" transform="translate(-31662.199 -23962.018)" fill="#d6d7d9" stroke="#d6d7d9" stroke-width="10"/><path id="Path_4222" data-name="Path 4222" d="M11294.989 10157.944l311.97-.01-156.218-269.074-78.621 135.83z" transform="translate(4740.338 117.39)" fill="#fff"/><path id="Path_4224" data-name="Path 4224" d="M47787.594 34159.125l-54.391 93.035h108.039z" transform="translate(-31596.297 -24036.238)" fill="#13142c" stroke="#13132d" stroke-width="10"/></g><text id="Logging_Operator" data-name="Logging Operator" transform="translate(45475.035 34799.609)" fill="#fff" font-size="267" font-family="Montserrat-Bold, Montserrat" font-weight="700" letter-spacing=".046em"><tspan x="-1339.806" y="0" id="tspan138">Logging Operator</tspan></text></g></svg></span><span class="navbar-brand__name">Logging operator</span>
<span class="font-weight-bold navbar-logo navbar-version">5.1</span></a>
<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link" href="https://github.com/kube-logging/logging-operator" title="Go to GitHub project page" target="_blank"><span>Project page</span></a>
</li><li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link" href="/5.1/docs/" title="Read the documentation"><span>Documentation</span></a>
</li><li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link" href="/5.1/docs/community/" title="Come chat with us!"><span>Community</span></a>
</li><li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
Releases
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
<div w3-include-html="/docs//releases.releases" w3-include-html-default='<a class="dropdown-item" href="/docs/releases.releases">Latest</a>'></div><script type="application/x-javascript">w3.includeHTML()</script>
</div></li></ul></div><div class="navbar-nav d-none d-lg-block">
<div class="main-menu-search">
<a href="/search">
<span class="nav-link"><i class="fa fa-search" aria-hidden="true"></i> Search</span>
</a>
</div></div></nav></header><div class="container-fluid td-outer">
<div class="td-main">
<div class="row flex-xl-nowrap">
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="return print(),!1">Click here to print</a>.
</p><p>
<a href="/5.1/docs/">Return to the regular view of this page</a>.
</p></div><h1 class="title">Logging operator</h1><ul>
<li>1: <a href="#pg-ddbb0ea047ddeaf6e0d24960a53a83c8">What's new</a></li><ul>
</ul><li>2: <a href="#pg-dba60f6e1187cfb4700ab7f78948fc24">Install</a></li><ul>
</ul><li>3: <a href="#pg-5e2d56ea782d776e21715559d28c9e90">Quick start guides</a></li><ul>
<li>3.1: <a href="#pg-5b079e76b2e1dabb1cc1b5ac08b733e7">Single app, one destination</a></li></ul><li>4: <a href="#pg-96f42b3851e06e8878e5685bcce84b05">Configure log routing</a></li><ul>
<li>4.1: <a href="#pg-c5c6ecdc3cc510bf60493ff486193ff0">Which log forwarder to use</a></li><li>4.2: <a href="#pg-ba978670e30a52baf4356021adabc84e">Output and ClusterOutput</a></li><li>4.3: <a href="#pg-6d5ebd4108d840b1126282c775c2e0dd">Flow and ClusterFlow</a></li><li>4.4: <a href="#pg-b31cd9cdcf163cc38c88156ce33e62f1">Routing your logs with Fluentd match directives</a></li><li>4.5: <a href="#pg-1af6b8a7150b57e6f6af4991d03afabf">Routing your logs with syslog-ng</a></li><li>4.6: <a href="#pg-ac7f8f2de0bfec29f800c2742a2d0127">Kubernetes events, node logs, and logfiles</a></li><ul>
<li>4.6.1: <a href="#pg-04413fd144b07886f11cf231a5113cbc">Kubernetes Event Tailer</a></li><li>4.6.2: <a href="#pg-18c73f8f2b09bffa26f060f563c9b14a">Kubernetes host logs, journals, and logfiles</a></li><li>4.6.3: <a href="#pg-064cf3669ed75479a61d9edba52b81d4">Tail logfiles with a webhook</a></li></ul><li>4.7: <a href="#pg-e717e7a286f2e387a96139f1e780a80f">Custom Resource Definitions</a></li><ul>
<li>4.7.1: <a href="#pg-44379ccd6059a94ad3c04f41ddd93d31">Available CRDs</a></li><ul>
<li>4.7.1.1: <a href="#pg-4e72a83b9fd0f217cf5e4c1787a014b6">ClusterFlow</a></li><li>4.7.1.2: <a href="#pg-12aea1089d22dc7b1ec3e444ebae4bc3">ClusterOutput</a></li><li>4.7.1.3: <a href="#pg-aba3be1da4e9fa0884cceaab7336a25b">Common</a></li><li>4.7.1.4: <a href="#pg-9c0c5afa7fb47abe7a0d1dee1e0cbc7b">FlowSpec</a></li><li>4.7.1.5: <a href="#pg-b9b388c411066f5f6dd5a2eef91b8474">FluentbitSpec</a></li><li>4.7.1.6: <a href="#pg-a2aaa1e3f933893e7e8fb304ba24b4d9">FluentdConfig</a></li><li>4.7.1.7: <a href="#pg-19e14e51b926eaba460288b329a9c8ce">FluentdSpec</a></li><li>4.7.1.8: <a href="#pg-04f0ef161b0a9d3bf58fb1db783332d1">LoggingRouteSpec</a></li><li>4.7.1.9: <a href="#pg-d295f1a0ca0a93108b789e0cfa709b32">LoggingSpec</a></li><li>4.7.1.10: <a href="#pg-2c2339470c0f0e05b2453d914e401e3a">NodeAgent</a></li><li>4.7.1.11: <a href="#pg-8718fca65b6b82a0865b8f450c52a288">OutputSpec</a></li><li>4.7.1.12: <a href="#pg-9d8ed361c6ac392becad14253fc27fd4">SyslogNGClusterFlow</a></li><li>4.7.1.13: <a href="#pg-8b95a382d4b401c66683fec0554bf659">SyslogNGClusterOutput</a></li><li>4.7.1.14: <a href="#pg-9b84f07030945b10cbc8314ab166b603">SyslogNGConfig</a></li><li>4.7.1.15: <a href="#pg-de7a2ad119020fdf1efa724f2230d938">SyslogNGFlowSpec</a></li><li>4.7.1.16: <a href="#pg-eea1110e47d17724202c6751b18af627">SyslogNGOutputSpec</a></li><li>4.7.1.17: <a href="#pg-b5fd5711d1786f5011e175001c26f721">SyslogNGSpec</a></li></ul><li>4.7.2: <a href="#pg-e07d1bc49d964a7c40eb66abea5f2677">Logging extensions CRDs</a></li><ul>
<li>4.7.2.1: <a href="#pg-1dd2e29e6fc6677a064f9d79bc2429ff">EventTailer</a></li><li>4.7.2.2: <a href="#pg-f24e78a067096c5c4a1cb33b2be8447b">HostTailer</a></li></ul></ul><li>4.8: <a href="#pg-9e73eeb4ad3474fcbb18858c80510ec4">Supported Plugins</a></li><ul>
<li>4.8.1: <a href="#pg-8a164ca77d26df7144202dbce9fc83ed">Security</a></li><li>4.8.2: <a href="#pg-417b2dcf5d345902aeedec3805d3b518">Transport</a></li><li>4.8.3: <a href="#pg-054b25caf1e92a922927809d3e403385">Fluentd filters</a></li><ul>
<li>4.8.3.1: <a href="#pg-349fa261ad6602912c90010a75fa2c8a">Concat</a></li><li>4.8.3.2: <a href="#pg-bb097fab5840c448f215a8825f17af78">Dedot</a></li><li>4.8.3.3: <a href="#pg-55a61951fa9d47c3fc701c2b0c2534d4">ElasticSearch GenId</a></li><li>4.8.3.4: <a href="#pg-1e14b035cd2fa8152fe231991dc9b922">Exception Detector</a></li><li>4.8.3.5: <a href="#pg-91b6e53e4bb1647d0973b03564f40336">Geo IP</a></li><li>4.8.3.6: <a href="#pg-d911e67edeb675049a9637d612f14d1a">Grep</a></li><li>4.8.3.7: <a href="#pg-4ed899f75f815259c224810fdfb84730">Kubernetes Events Timestamp</a></li><li>4.8.3.8: <a href="#pg-5a6aa7b18aae1acb56e9fd8f8f8cd854">Parser</a></li><li>4.8.3.9: <a href="#pg-b1ababb8fff927a359f5ee10ddd9740d">Prometheus</a></li><li>4.8.3.10: <a href="#pg-2c5a900f0f1960d731ab3d2e7e9ae2dd">Record Modifier</a></li><li>4.8.3.11: <a href="#pg-2adc391c4bf236f17f4dff5d5236127b">Record Transformer</a></li><li>4.8.3.12: <a href="#pg-06af9b3099c8f9f37d675b5aee19c604">StdOut</a></li><li>4.8.3.13: <a href="#pg-9f71d81ccc4b25c0f75938abbc9a158d">Tag Normaliser</a></li><li>4.8.3.14: <a href="#pg-c86a56fc7e085e5aea4460c0e18e5990">Throttle</a></li><li>4.8.3.15: <a href="#pg-3610a8928860c8aae138583bea272461">User Agent</a></li></ul><li>4.8.4: <a href="#pg-506383d863d6db46f320e08de47fb0c7">Fluentd outputs</a></li><ul>
<li>4.8.4.1: <a href="#pg-d52aa3c8a0eb89cb0544a82420222298"></a></li><li>4.8.4.2: <a href="#pg-28f1e98e5b5c5f770fb8b2e592e1abf0">Alibaba Cloud</a></li><li>4.8.4.3: <a href="#pg-aeea1cd1922e8ddddba7f377f910cc60">Amazon CloudWatch</a></li><li>4.8.4.4: <a href="#pg-2b59c5fb4b2ccfdb47e90229617f245a">Amazon Elasticsearch</a></li><li>4.8.4.5: <a href="#pg-dec03311d9f65d4bec85b8a63c46e105">Amazon Kinesis</a></li><li>4.8.4.6: <a href="#pg-0309d186051d45cea94e4ea4a3d95907">Amazon Kinesis</a></li><li>4.8.4.7: <a href="#pg-f6b80b815b14c83b2fe835b820aa13d0">Amazon S3</a></li><li>4.8.4.8: <a href="#pg-3fa3b93039c08434aba115eb9ab22b12">Azure Storage</a></li><li>4.8.4.9: <a href="#pg-67bcee478125d9574288135a71954591">Buffer</a></li><li>4.8.4.10: <a href="#pg-cfa15a5d894da7ae0606dc5571b76531">Datadog</a></li><li>4.8.4.11: <a href="#pg-d4855c4f7dc79bc11e74c046473de585">Elasticsearch</a></li><li>4.8.4.12: <a href="#pg-11b10c2ba394f448a129e3e87a7da45d">File</a></li><li>4.8.4.13: <a href="#pg-ebcbedef5be28c9f30752486b0b2b01b">Format</a></li><li>4.8.4.14: <a href="#pg-88fc6991b80563054a472b95a994e01b">Format rfc5424</a></li><li>4.8.4.15: <a href="#pg-ed0a10704a55da5f7330009ec393e387">Forward</a></li><li>4.8.4.16: <a href="#pg-18e50786ba4697ffac3ab83b4c57e6e5">GELF</a></li><li>4.8.4.17: <a href="#pg-a6993ae75e6633de7954ded98992861c">Google Cloud Storage</a></li><li>4.8.4.18: <a href="#pg-a56bffbadd1b6a7c1ede4f727316205c">Grafana Loki</a></li><li>4.8.4.19: <a href="#pg-ae38f1f9de3603c1e55fe2fb4eeba9b0">Http</a></li><li>4.8.4.20: <a href="#pg-1b992ac5779a83a537b40f5defa1bfa5">Kafka</a></li><li>4.8.4.21: <a href="#pg-3736a73536ae2ea19873950bfc5c1521">LogDNA</a></li><li>4.8.4.22: <a href="#pg-f5b4f39075d38f596892cbc946ca5735">LogZ</a></li><li>4.8.4.23: <a href="#pg-683bbb879ced9c27f3943b7a4809b29e">Mattermost</a></li><li>4.8.4.24: <a href="#pg-434371d7a3888abd2a15c4cd22f941cc">NewRelic</a></li><li>4.8.4.25: <a href="#pg-bb72140946679f3fa6eaf82e404ea444">OpenSearch</a></li><li>4.8.4.26: <a href="#pg-ef25dbf7203fc85cd0c4a189a702360a">Redis</a></li><li>4.8.4.27: <a href="#pg-67b66da64354abd24b6cf4012f300c3a">Relabel</a></li><li>4.8.4.28: <a href="#pg-65dde214a849324898de8fc0878b8ff4">Splunk</a></li><li>4.8.4.29: <a href="#pg-f239285458b59ea6270063a2b99b095d">SQS</a></li><li>4.8.4.30: <a href="#pg-014aa24ff26bb6369dc8484f097d845d">Syslog</a></li><li>4.8.4.31: <a href="#pg-1f1e7ebd2a7521c62ebb908f2d9dc6d4">VMware Log Intelligence</a></li><li>4.8.4.32: <a href="#pg-0102b64d79d8ea746d1515b5bde58add">VMware LogInsight</a></li><li>4.8.4.33: <a href="#pg-3effea023502f5f282b1bcfc984721f7">Secret definition</a></li></ul><li>4.8.5: <a href="#pg-f82c0e1c4bdef1d77adef0a24aa2326c">syslog-ng filters</a></li><ul>
<li>4.8.5.1: <a href="#pg-ed56f7c86144eb14193213bc7f89126f">Match</a></li><li>4.8.5.2: <a href="#pg-4afe8af7a86227831c993a592f328feb">Parser</a></li><li>4.8.5.3: <a href="#pg-71055e789d2740b4a21574d9424fd407">Rewrite</a></li></ul><li>4.8.6: <a href="#pg-810c80c2dbdca02f7ade52079fd88712">syslog-ng outputs</a></li><ul>
<li>4.8.6.1: <a href="#pg-d2c9db8ba7a6ba7639262daaea30cbd6">Authentication for syslog-ng outputs</a></li><li>4.8.6.2: <a href="#pg-0125a4a4d818b30d9054879982e084a1">Disk buffer</a></li><li>4.8.6.3: <a href="#pg-217fe992275c17196145bd8aca20419a">Elasticsearch</a></li><li>4.8.6.4: <a href="#pg-20150d5282a0092eb6c0366d786537b3">Elasticsearch datastream</a></li><li>4.8.6.5: <a href="#pg-def8416dfd78030f291e4e2fee600a97">File</a></li><li>4.8.6.6: <a href="#pg-f64978e87cfa5c2c0a8c6ad06c690873">HTTP</a></li><li>4.8.6.7: <a href="#pg-db09f336e539e97c3a4b6ae4786aded5">Loggly output</a></li><li>4.8.6.8: <a href="#pg-18b36b379ed9690f5568e3f8d7088d0f">LogScale</a></li><li>4.8.6.9: <a href="#pg-eefbe22dbc8ede1633843ddca2372922">Loki</a></li><li>4.8.6.10: <a href="#pg-50ca131a90db80476f6b3ee7bf91ede9">MongoDB</a></li><li>4.8.6.11: <a href="#pg-31ea9edde3a649f6c3772919f9e7a156">MQTT</a></li><li>4.8.6.12: <a href="#pg-f45875ac7b5bd367d7324b30c22e5503">Openobserve</a></li><li>4.8.6.13: <a href="#pg-6d7223a166a300bc7803f652ecf314ae">OpenTelemetry output</a></li><li>4.8.6.14: <a href="#pg-d44d1d1ef5ea3fb8124c088fcb9e125f">Redis</a></li><li>4.8.6.15: <a href="#pg-a30c0b2e8f92178a45957a767cd80264">S3</a></li><li>4.8.6.16: <a href="#pg-ebf6ce972f8f52a488cb4fd3bc510dcb">SplunkHEC</a></li><li>4.8.6.17: <a href="#pg-764b7c70899b4d51e51a8ba401f96cd2">Sumo Logic HTTP</a></li><li>4.8.6.18: <a href="#pg-1721ec291a25f8230ddeedf2a20018f9">Sumo Logic Syslog</a></li><li>4.8.6.19: <a href="#pg-17c2f3cac6d1fd9cb831fa66c2daf727">Syslog (RFC5424) output</a></li><li>4.8.6.20: <a href="#pg-56a41f3fbc6007034e66766bff690bfa">TLS config for syslog-ng outputs</a></li></ul></ul></ul><li>5: <a href="#pg-7eee50e5d896d8c0f7761ed471a95d89">Examples</a></li><ul>
<li>5.1: <a href="#pg-05eacbf7a0c1b481b78d7fadf3072b45">Filter examples in Flows</a></li><li>5.2: <a href="#pg-a32e96d02144ee3cb1936db017f63e08">Parsing custom date formats</a></li><li>5.3: <a href="#pg-40c8034365add30f05453065286935a7">Store Nginx Access Logs in Amazon CloudWatch with Logging Operator</a></li><li>5.4: <a href="#pg-8ccd39da9b80871a1d5d3a16b317985a">Transport all logs into Amazon S3 with Logging operator</a></li><li>5.5: <a href="#pg-4db6cfeb56675824920db186601c2746">Store NGINX access logs in Elasticsearch with Logging operator</a></li><li>5.6: <a href="#pg-151681c15ceae7e696e0c20fe51220fa">Splunk operator with Logging operator</a></li><li>5.7: <a href="#pg-256fcfd7514994ffef95721e2aab59da">Sumo Logic with Logging operator and Fluentd</a></li><li>5.8: <a href="#pg-9e8c31099cc068e1c927a9cdd5531187">Sumo Logic with Logging operator and syslog-ng</a></li><li>5.9: <a href="#pg-abd97e700fb7a973b1dcfb4cb9aae1b4">Transport Nginx Access Logs into Kafka with Logging operator</a></li><li>5.10: <a href="#pg-01af43cb645f47605cedaae3bc91678b">Store Nginx Access Logs in Grafana Loki with Logging operator</a></li><li>5.11: <a href="#pg-aeee3c18c3b933f861743e7b21d3529d">Nodegroup-based multitenancy</a></li><li>5.12: <a href="#pg-3c57b775dac77ff05294c6fa7e03a10b">Custom source and output metrics</a></li></ul><li>6: <a href="#pg-66b2f94db85b38033f1e648756b3c604">Logging infrastructure setup</a></li><ul>
<li>6.1: <a href="#pg-c0708ac9ee8c8fbda19457c73798a929">The Logging custom resource</a></li><li>6.2: <a href="#pg-73731e87b595ac2d32428566811fc127">Configure Fluentd</a></li><li>6.3: <a href="#pg-e0c4f740879ef5ce79b6d0d086ef5e14">Configure syslog-ng</a></li><li>6.4: <a href="#pg-e55dcde4fa90369f23e1167b78e14986">Fluent Bit log collector</a></li><li>6.5: <a href="#pg-d8f4a300f3d0e2b8000fec50bc64befb">Multiple Fluent Bit agents in the cluster</a></li><li>6.6: <a href="#pg-34e5e120deddba15a35b3c3d1135cbb2">TLS encryption</a></li><li>6.7: <a href="#pg-ad05d57db5d08bb5a16b343b608e91fa">Security</a></li><ul>
</ul></ul><li>7: <a href="#pg-2468a881210107c399941aefc2a95a23">Operation</a></li><ul>
<li>7.1: <a href="#pg-85dfc8f2bc8d8124c30cdb1fdddb3b6c">Logging operator troubleshooting</a></li><ul>
<li>7.1.1: <a href="#pg-741171b799e509ff0eabf397d862c757">Troubleshooting Fluent Bit</a></li><li>7.1.2: <a href="#pg-08d978e8b4bd5dff112fd9e079aaba48">Troubleshooting Fluentd</a></li><li>7.1.3: <a href="#pg-3f9ff6b76f6626e8e1fb3f91c1ad7b0f">Troubleshooting syslog-ng</a></li><li>7.1.4: <a href="#pg-ff4769d67e22b03ee37bf3b31cd60c80">Running on KinD</a></li></ul><li>7.2: <a href="#pg-f43e816fa3bb01ec74b11406f7aa77ce">Monitor your logging pipeline with Prometheus Operator</a></li><li>7.3: <a href="#pg-362f849752620b4cf0d070e2fc884699">Alerting</a></li><li>7.4: <a href="#pg-e1b978ea58e795d55d2b6d7ad7aabb23">Readiness probe</a></li><li>7.5: <a href="#pg-791b523329c1485057fb827f9ed4b80b">Collect Fluentd errors</a></li><li>7.6: <a href="#pg-5ac19d15e22096d860ccfc7422b529f9">Optimization</a></li><li>7.7: <a href="#pg-af5ba8326f5b4c35d5dc6de4337c19b0">Scaling</a></li><li>7.8: <a href="#pg-2ea22a017fd9fef2575c36200cd7f9b8">CPU and memory requirements</a></li></ul><li>8: <a href="#pg-58416e0a7f68f24b8e7d9b1834b3036f">Images used by Logging operator</a></li><li>9: <a href="#pg-b9683b78eca24c9572e4995734221f3f">For developers</a></li><li>10: <a href="#pg-04fd5dde5261fd5d26d6bac28e83d40e">Commercial support for the Logging operator</a></li><li>11: <a href="#pg-956da29f025cba37fca9fe6b80ab5d48">Frequently asked questions</a></li><li>12: <a href="#pg-0c44f8157757ae9807433efcf75c4e52">License</a></li><li>13: <a href="#pg-51fa3b5335cd006e7cfd90883860deec">Community</a></li></ul><div class="content">
<p>Welcome to the Logging operator documentation!</p><h2 id="overview">Overview</h2><p>The Logging operator solves your logging-related problems in Kubernetes environments by automating the deployment and configuration of a Kubernetes logging pipeline.</p><ol>
<li>The operator deploys and configures a log collector (currently a Fluent Bit DaemonSet) on every node to collect container and application logs from the node file system.</li><li>Fluent Bit queries the Kubernetes API and enriches the logs with metadata about the pods, and transfers both the logs and the metadata to a log forwarder instance.</li><li>The log forwarder instance receives, filters, and transforms the incoming logs, and transfers them to one or more destination outputs. The Logging operator supports <a href="https://www.fluentd.org/">Fluentd</a> and syslog-ng (via the <a href="https://axoflow.com/docs/axosyslog-core/">AxoSyslog syslog-ng distribution</a>) as log forwarders.</li></ol><p>Your logs are always transferred on authenticated and encrypted channels.</p><p>This operator helps you bundle logging information with your applications: you can describe the behavior of your application in its charts, the Logging operator does the rest.</p><p align="center"><img src="img/logging_operator_flow.png" alt="How Logging operator works"></p><h2 id="feature-highlights">Feature highlights</h2><ul>
<li>Namespace isolation</li><li>Native Kubernetes label selectors</li><li>Secure communication (TLS)</li><li>Configuration validation</li><li>Multiple flow support (multiply logs for different transformations)</li><li>Multiple <a href="/5.1/docs/configuration/plugins/outputs/">output</a> support (store the same logs in multiple storage: S3, GCS, ES, Loki and more&mldr;)</li><li>Multiple logging system support (multiple Fluentd, Fluent Bit deployment on the same cluster)</li><li>Support for both syslog-ng and Fluentd as the central log routing component</li></ul><h2 id="architecture">Architecture</h2><p>The Logging operator manages the log collectors and log forwarders of your logging infrastructure, and the routing rules that specify where you want to send your different log messages.</p><p>The <strong>log collectors</strong> are endpoint agents that collect the logs of your Kubernetes nodes and send them to the log forwarders. Logging operator currently uses Fluent Bit as log collector agents.</p><p>The <strong>log forwarder</strong> (also called <strong>log aggregator</strong>) instance receives, filters, and transforms the incoming logs, and transfers them to one or more destination outputs. The Logging operator supports Fluentd and syslog-ng as log forwarders. Which log forwarder is best for you depends on your logging requirements. For tips, see <a href="/5.1/docs/configuration/fluentd-vs-syslog-ng/">Which log forwarder to use</a>.</p><p>You can filter and process the incoming log messages using the <a href="/5.1/docs/configuration/flow/"><strong>flow</strong></a> custom resource of the log forwarder to route them to the appropriate <a href="/5.1/docs/configuration/output/"><strong>output</strong></a>. The outputs are the destinations where you want to send your log messages, for example, Elasticsearch, or an Amazon S3 bucket. You can also define cluster-wide outputs and flows, for example, to use a centralized output that namespaced users can reference but cannot modify. Note that flows and outputs are specific to the type of log forwarder you use (Fluentd or syslog-ng).</p><p>You can configure the Logging operator using the following Custom Resource Definitions.</p><ul>
<li><a href="/5.1/docs/logging-infrastructure/logging/">logging</a> - The <code>logging</code> resource defines the logging infrastructure (the log collectors and forwarders) for your cluster that collects and transports your log messages. It can also contain configurations for Fluent Bit, Fluentd, and syslog-ng. (Starting with Logging operator version 4.5, you can also configure <a href="/5.1/docs/logging-infrastructure/fluentbit/">Fluent Bit</a>, <a href="/5.1/docs/logging-infrastructure/fluentd/">Fluentd</a>, and <a href="/5.1/docs/logging-infrastructure/syslog-ng/">syslog-ng</a> as separate resources.)</li><li>CRDs for Fluentd:
<ul>
<li><a href="/5.1/docs/configuration/output/">output</a> - Defines a Fluentd Output for a logging flow, where the log messages are sent using Fluentd. This is a namespaced resource. See also <code>clusteroutput</code>. To configure syslog-ng outputs, see <code>SyslogNGOutput</code>.</li><li><a href="/5.1/docs/configuration/flow/">flow</a> - Defines a Fluentd logging flow using <code>filters</code> and <code>outputs</code>. Basically, the flow routes the selected log messages to the specified outputs. This is a namespaced resource. See also <code>clusterflow</code>. To configure syslog-ng flows, see <code>SyslogNGFlow</code>.</li><li><a href="/5.1/docs/configuration/output/">clusteroutput</a> - Defines a Fluentd output that is available from all flows and clusterflows. The operator evaluates clusteroutputs in the <code>controlNamespace</code> only unless <code>allowClusterResourcesFromAllNamespaces</code> is set to true.</li><li><a href="/5.1/docs/configuration/flow/">clusterflow</a> - Defines a Fluentd logging flow that collects logs from all namespaces by default. The operator evaluates clusterflows in the <code>controlNamespace</code> only unless <code>allowClusterResourcesFromAllNamespaces</code> is set to true. To configure syslog-ng clusterflows, see <code>SyslogNGClusterFlow</code>.</li></ul></li><li>CRDs for syslog-ng (these resources like their Fluentd counterparts, but are tailored to features available via syslog-ng):
<ul>
<li><a href="/5.1/docs/configuration/output/#syslogngoutput">SyslogNGOutput</a> - Defines a syslog-ng Output for a logging flow, where the log messages are sent using syslog-ng. This is a namespaced resource. See also <code>SyslogNGClusterOutput</code>. To configure Fluentd outputs, see <code>output</code>.</li><li><a href="/5.1/docs/configuration/flow/#syslogngflow">SyslogNGFlow</a> - Defines a syslog-ng logging flow using <code>filters</code> and <code>outputs</code>. Basically, the flow routes the selected log messages to the specified outputs. This is a namespaced resource. See also <code>SyslogNGClusterFlow</code>. To configure Fluentd flows, see <code>flow</code>.</li><li><a href="/5.1/docs/configuration/output/#syslogngoutput">SyslogNGClusterOutput</a> - Defines a syslog-ng output that is available from all flows and clusterflows. The operator evaluates clusteroutputs in the <code>controlNamespace</code> only unless <code>allowClusterResourcesFromAllNamespaces</code> is set to true.</li><li><a href="/5.1/docs/configuration/flow/#syslogngflow">SyslogNGClusterFlow</a> - Defines a syslog-ng logging flow that collects logs from all namespaces by default. The operator evaluates clusterflows in the <code>controlNamespace</code> only unless <code>allowClusterResourcesFromAllNamespaces</code> is set to true. To configure Fluentd clusterflows, see <code>clusterflow</code>.</li></ul></li></ul><p>For the detailed CRD documentation, see <a href="/5.1/docs/configuration/crds/">List of CRDs</a>.</p><p><img src="/docs/img/logging-operator-v2-architecture.png" alt="Logging operator architecture"></p><h2 id="quickstart">Quickstart</h2><p>See our <a href="/5.1/docs/quickstarts/">Quickstart guides</a>.</p><h2 id="support">Support</h2><p>If you encounter problems while using the Logging operator the documentation does not address, <a href="https://github.com/kube-logging/logging-operator/issues">open an issue</a> or talk to us on <a href="https://discord.gg/9ACY4RDsYN">Discord</a> or on the <a href="/5.1/docs/community/">CNCF Slack</a>.</p><p>For the list of companies that offer commercial support, see <a href="/5.1/docs/commercial-support/">Commercial support for the Logging operator</a>.</p></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-ddbb0ea047ddeaf6e0d24960a53a83c8">1 - What's new</h1><h2 id="version-51">Version 5.1</h2><p>The following are the highlights and main changes of Logging operator 5.1. For a complete list of changes and bugfixes, see the <a href="https://github.com/kube-logging/logging-operator/releases/tag/5.1.1">Logging operator 5.1 releases page</a>.</p><h3 id="fluentd-http-output-improvements">Fluentd http output improvements</h3><ul>
<li>Set the <code>compress</code> option to <code>gzip</code> to compress the HTTP request body.</li><li>You can use the <code>headers_from_placeholders</code> option to add headers to the HTTP requests.</li><li>Set the <code>reuse_connection</code> option to <code>true</code> to try to reuse HTTP connections to improve performance.</li></ul><h3 id="multiple-hosttailer-support">Multiple hosttailer support</h3><p>You can now define multiple hosttailers in your logging configuration, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">logging</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">enabled</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">hostTailers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">enabled</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">instances</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">kubeauditane</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">enabled</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">workloadOverrides</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">nodeSelector</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">node-role.kubernetes.io/control-plane</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;true&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">tolerations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">node-role.kubernetes.io/control-plane</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#204a87;font-weight:700">operator</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Exists</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#204a87;font-weight:700">effect</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">NoSchedule</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">fileTailers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">kube-audit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/var/lib/rancher/rke2/server/logs/*.log</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">workersnodesonly</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">enabled</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">workloadOverrides</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">nodeSelector</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">node-role.kubernetes.io/worker</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;true&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">fileTailers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">kube-audit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/var/lib/rancher/rke2/agent/logs/*.log</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>This also means that <code>logging.hostTailer</code> has been deprecated and is superseded by <code>logging.hostTailers</code> and will be removed in a future release.</p><h2 id="graceful-reload-in-fluentd">Graceful reload in Fluentd</h2><p>You can now enable graceful reloading via a webhook using the <a href="/5.1/docs/configuration/crds/v1beta1/fluentd_types/#fluentdspec-configreloaderusegracefulreloadwebhook"><code>configReloaderUseGracefulReloadWebhook</code> option</a>.</p><h3 id="memory-usage">Memory usage</h3><p>In order to reduce the memory usage of the operator in large environments, you can now use the following flags during installation:</p><ul>
<li><code>watch-labeled-children</code> to watch only child resources created by the operator. This option will be enabled by default in a future new minor version.</li><li><code>watch-labeled-secrets</code> to watch secrets with <code>logging.banzaicloud.io/watch: enabled</code> label. This option will be enabled by default in a future new major version.</li></ul><h3 id="changes-in-fluentd-images">Changes in Fluentd images</h3><p>Earlier, Logging operator used Fluentd images published at <a href="https://github.com/kube-logging/fluentd-images">https://github.com/kube-logging/fluentd-images</a>, and its version numbers followed the official Fluentd version numbers. From now on, we build Fluentd images from our repository (<a href="https://github.com/kube-logging/logging-operator/tree/master/images/fluentd">https://github.com/kube-logging/logging-operator/tree/master/images/fluentd</a>) and its version numbering follows the version numbers of Logging operator, for example: ghcr.io/kube-logging/logging-operator/fluentd:5.1.1-base/filters/full</p><h2 id="version-50">Version 5.0</h2><p>The following are the highlights and main changes of Logging operator 5.0. For a complete list of changes and bugfixes, see the <a href="https://github.com/kube-logging/logging-operator/releases/tag/5.0">Logging operator 5.0 releases page</a>.</p><h3 id="breaking-changes">Breaking changes</h3><ul>
<li>The Sumo Logic filter, the Sumo Logic output, and the <code>enhance_k8s</code> filter are no longer supported, as they are not available in the new Fluentd image (v1.17-5.0). If you want to continue using them, keep using the 4.x version of Logging operator.</li><li>The name of the <code>crd</code> subchart changed to <code>logging-operator-crds</code>. This new subchart is also available as an OCI artifact.</li></ul><h3 id="clean-up-stuck-finalizers">Clean up stuck finalizers</h3><p>When uninstalling Logging operator using Helm, some finalizers may be stuck because Helm uninstalls the resources in a non-deterministic order. You can use the new <code>finalizer-cleanup</code> flag in conjunction with <code>.Values.rbac.retainOnDelete</code> to avoid this problem. When both options are set during uninstall, then:</p><ul>
<li>Helm will retain the operator&rsquo;s service account, cluster role, and cluster role binding. This is necessary because Helm uninstalls resources in an unpredictable order.</li><li>The operator will attempt to free up its managed logging resources by removing finalizers, which would otherwise remain stuck.</li></ul><p>For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>helm install logging-operator ./charts/logging-operator/ --set rbac.retainOnDelete<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#204a87">true</span> --set <span style="color:#000">extraArgs</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{&#34;-enable-leader-election=true&#34;,&#34;-finalizer-cleanup=true&#34;}&#39;</span>
</span></span></code></pre></div><h3 id="experimental-telemetry-controller-support">Experimental Telemetry Controller support</h3><p>You can now use the <a href="https://github.com/kube-logging/telemetry-controller">Telemetry Controller</a> as a log collector agent instead of Fluent Bit. To test this feature, you have to:</p><ol>
<li>
<p>Install Logging operator with the <code>enable-telemetry-controller-route</code> flag and the <code>telemetry-controller.install</code> options enabled:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>helm install logging-operator ./charts/logging-operator/ --set <span style="color:#000">extraArgs</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{&#34;-enable-leader-election=true&#34;,&#34;-enable-telemetry-controller-route&#34;}&#39;</span> --set telemetry-controller.install<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#204a87">true</span>
</span></span></code></pre></div></li><li>
<p>Configure the <code>routeConfig</code> option in the <code>Logging</code> resource to specify how the Telemetry Controller resources are created:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tc-config</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">routeConfig</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">enableTelemetryControllerRoute</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Determines whether to create TC resources for log-collection and routing purposes.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">disableLoggingRoute</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Determines whether to use Logging-routes for routing purposes and Fluentbit-agents for log-collection.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tenantLabels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># Will be placed on TC&#39;s tenant resources, must be matched with the same field on the Collector resource. (Deployed by the cluster administrator.)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">tenant</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li></ol><p><strong>NOTE: There is a hands-on example available to try: <a href="https://github.com/kube-logging/logging-operator/tree/master/config/samples/telemetry-controller-routing">https://github.com/kube-logging/logging-operator/tree/master/config/samples/telemetry-controller-routing</a></strong></p><h3 id="improved-ipv6-support">Improved IPv6 support</h3><ul>
<li>Fluent Bit couldn&rsquo;t listen on an IPv6 http socket because its HTTP_Listen address was hardcoded. Now this is set using the <code>POD_IP</code>, so it works in IPv6 environments as well.</li><li>Until now, IPv6-only clusters couldn&rsquo;t scrape metrics from the Fluentd aggregator. This has been fixed.</li></ul><h3 id="rdkafka-option-support">rdkafka option support</h3><p>You can now set <code>rdkafka_options</code> in for rdkafka2 in the <a href="/5.1/docs/configuration/plugins/outputs/kafka/#kafka-rdkafka_options">Kafka Fluentd output</a>.</p><h3 id="other-fluent-bit-changes">Other Fluent Bit changes</h3><ul>
<li>You can now specify whether to pause or drop data when the buffer is full. This helps to make sure we apply backpressure on the input. For details, see <a href="/5.1/docs/configuration/crds/v1beta1/fluentbit_types/#inputtail-storage.pause_on_chunks_overlimit">storage.pause_on_chunks_overlimit (string, optional)</a>.</li><li>HotReload pauses all inputs and waits until they finish. However, this can block the reload indefinitely, for example, if an output is down for a longer time. You can now force the reload to happen after a grace period using the <a href="/5.1/docs/configuration/crds/v1beta1/fluentbit_types/#fluentbitspec-forcehotreloadaftergrace"><code>forceHotReloadAfterGrace</code></a> option.</li></ul><h2 id="version-411">Version 4.11</h2><p>The following are the highlights and main changes of Logging operator 4.11. For a complete list of changes and bugfixes, see the <a href="https://github.com/kube-logging/logging-operator/releases/tag/4.11.0">Logging operator 4.11 releases page</a>.</p><ul>
<li>
<p>You can now set the <code>protected</code> flag for SyslogNGClusterOutput kinds.</p></li><li>
<p>Charts and images are now signed. To verify the signature, see <a href="/5.1/docs/install/#verify">Image and chart verification</a>.</p></li><li>
<p>You can now add annotations and labels to Persistent Volume Claims of the Fluentd StatefulSet. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">all-to-file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">bufferStorageVolume</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">pvc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">annotations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">source</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">claimName</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">manual</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">readOnly</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>You can now set liveness probes to the buffer-metrics sidecar container using the <code>bufferVolumeLivenessProbe</code> option.</p></li><li>
<p>IPv6 improvements:</p><ul>
<li>You can now scrape the metrics of Fluentd on clusters that only have IPv6 addresses.</li><li>Fluent Bit can now listen on IPv6 addresses.</li></ul></li><li>
<p>The <a href="/5.1/docs/configuration/plugins/outputs/opensearch/">OpenSearch Fluentd output</a> now supports the <code>remove_keys</code> option.</p></li><li>
<p>You can now set the <code>strategy</code> and <code>topologySpreadConstraints</code> in the Logging operator chart.</p></li></ul><h2 id="version-410">Version 4.10</h2><p>The following are the highlights and main changes of Logging operator 4.10. For a complete list of changes and bugfixes, see the <a href="https://github.com/kube-logging/logging-operator/releases/tag/4.10.0">Logging operator 4.10 releases page</a>.</p><ul>
<li>
<p>You can now control the memory usage of Fluent Bit in persistent buffering mode using the <a href="/5.1/docs/configuration/crds/v1beta1/fluentbit_types/#bufferstorage-storage.max_chunks_up"><code>storage.max_chunks_up</code></a> option.</p></li><li>
<p>When using <a href="/5.1/docs/configuration/crds/extensions/hosttailer_types/#systemdtailer-systemdfilter"><code>systemdFilters</code></a> in <code>HostTailers</code>, you can now specify the journal field to use.</p></li><li>
<p>The documentation of the <a href="/5.1/docs/configuration/plugins/outputs/gelf/">Gelf Fluentd output</a> has been improved, and now includes the <code>max_bytes</code> option that can limit the size of the messages.</p></li><li>
<p>You can now configure image repository overrides in the syslog-ng spec (both in the <code>Logging</code> resource and in the <code>SyslogNGConfig</code> resource):</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">syslogNGImage</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">configReloadImage</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metricsExporterImage</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">bufferVolumeMetricsImage</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>When using the <a href="/5.1/docs/configuration/plugins/outputs/kafka/#kafka-max_send_limit_bytes">Kafka Fluentd output</a>, you can now set the maximal size of the messages using the <code>max_send_limit_bytes</code> option.</p></li></ul><h2 id="version-49">Version 4.9</h2><p>The following are the highlights and main changes of Logging operator 4.9. For a complete list of changes and bugfixes, see the <a href="https://github.com/kube-logging/logging-operator/releases/tag/4.9.0">Logging operator 4.9 releases page</a>.</p><h3 id="opentelemetry-output">OpenTelemetry output</h3><p>When using the <a href="/5.1/docs/configuration/output/#syslogngoutput">syslog-ng aggretor</a>, you can now send data directly to an OpenTelemetry endpoint. All metadata and the original log record are available in the body of the log record. Resource attributes will be available in a future release, when we switch to an OpenTelemetry input and receive standard OTLP logs. For details, see <a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/opentelemetry/">OpenTelemetry output</a>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">2024-07-05T09:00:23.407Z</span><span style="color:#f8f8f8;text-decoration:underline">	</span><span style="color:#000">info	LogsExporter	{&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;logs&#34;, &#34;name&#34;: &#34;debug&#34;, &#34;resource logs&#34;: 1, &#34;log records&#34;: 1}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">2024-07-05T09:00:23.407Z</span><span style="color:#f8f8f8;text-decoration:underline">	</span><span style="color:#000">info	ResourceLog</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">Resource SchemaURL</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">ScopeLogs</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">ScopeLogs SchemaURL</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">InstrumentationScope</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">LogRecord</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic">#0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">ObservedTimestamp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">2024-07-05 09:00:23.405798 +0000</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">UTC</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">Timestamp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">2024-07-05 09:00:23.406049 +0000</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">UTC</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">SeverityText</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">SeverityNumber</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Info2(10)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">Body</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Str({&#34;ts&#34;:&#34;2024-07-05T09:00:22.424670Z&#34;,&#34;log&#34;:&#34;107.147.239.123 - - [05/Jul/2024:09:00:22 +0000] \&#34;POST /index.html HTTP/1.1\&#34; 200 14184 \&#34;-\&#34; \&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3191.0 Safari/537.36\&#34; \&#34;-\&#34;\n&#34;,&#34;stream&#34;:&#34;stdout&#34;,&#34;time&#34;:&#34;2024-07-05T09:00:22.424670292Z&#34;,&#34;kubernetes&#34;:{&#34;pod_name&#34;:&#34;log-generator-55867b6d4c-66fdv&#34;,&#34;namespace_name&#34;:&#34;log-generator&#34;,&#34;pod_id&#34;:&#34;682c9ed9-9421-406f-9c7b-cf2b2e62f406&#34;,&#34;labels&#34;:{&#34;app.kubernetes.io/instance&#34;:&#34;log-generator&#34;,&#34;app.kubernetes.io/name&#34;:&#34;log-generator&#34;,&#34;pod-template-hash&#34;:&#34;55867b6d4c&#34;},&#34;host&#34;:&#34;logging&#34;,&#34;container_name&#34;:&#34;log-generator&#34;,&#34;docker_id&#34;:&#34;dba14a358990c4b6ab82acdf75069952f3b180b3f16dd9527adc7eb11f6d2167&#34;,&#34;container_hash&#34;:&#34;ghcr.io/kube-logging/log-generator@sha256:e26102ef2d28201240fa6825e39efdf90dec0da9fa6b5aea6cf9113c0d3e93aa&#34;,&#34;container_image&#34;:&#34;ghcr.io/kube-logging/log-generator:0.7.0&#34;}})</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">Trace ID</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">Span ID</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">Flags</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span>{<span style="color:#204a87;font-weight:700">&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;logs&#34;, &#34;name&#34;: </span><span style="color:#4e9a06">&#34;debug&#34;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="elasticsearch-data-streams">Elasticsearch data streams</h3><p>You can now send messages and metrics to <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/data-streams.html">Elasticsearch data streams</a> to store your log and metrics data as time series data. You have to use the <a href="/5.1/docs/configuration/output/#syslogngoutput">syslog-ng aggretor</a> to use this output. For details, see <a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/elasticsearch_datastream/">Elasticsearch datastream</a>.</p><h3 id="improved-kafka-performance">Improved Kafka performance</h3><p>The <a href="/5.1/docs/configuration/plugins/outputs/kafka/">Kafka</a> Fluentd output now supports using the rdkafka2 client, which offers higher performance than ruby-kafka. Set <code>use_rdkafka</code> to <code>true</code> to use the rdkafka2 client. (If you&rsquo;re using a custom Fluentd image, note that rdkafka2 requires v1.16-4.9-full or higher.)</p><h3 id="containerd-compatibility">Containerd compatibility</h3><p>As many users prefer Containerd instead of Docker as their container runtime, the slight differences between these CRIs are causing some problems. Now you can enable a compatibility layer with the <code>enableDockerParserCompatibilityForCRI</code> option of the <code>logging</code> CRD, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">containerd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">enableDockerParserCompatibilityForCRI</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>This option enables a log parser that is compatible with the docker parser. This has the following benefits:</p><ul>
<li>automatically parses JSON logs using the Merge_Log feature</li><li>downstream parsers can use the <code>log</code> field instead of the <code>message</code> field, just like with the docker runtime</li><li>the <code>concat</code> and <code>parser</code> filters are automatically set back to use the <code>log</code> field.</li></ul><p>Here is a sample log message with the option enabled:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="display:flex"><span><span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&#34;log&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;2024-08-12T14:19:29.672991171Z stderr F [2024/08/12 14:19:29] [ info] [input:tail:tail.0] inotify_fs_add(): inode=2939617 watch_fd=17 name=/var/log/containers/containerd-fluentd-0_default_fluentd-e46f1fcb1b63e7458fc43c079b7455f8e1305e551939ca128361a9574a194ed7.log&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&#34;kubernetes&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&#34;pod_name&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;containerd-fluentbit-mchwz&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&#34;namespace_name&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&#34;pod_id&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;22f86078-26f1-4202-bbc7-1dd5ddce20ec&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&#34;labels&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>      <span style="color:#204a87;font-weight:700">&#34;app.kubernetes.io/instance&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;containerd&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>      <span style="color:#204a87;font-weight:700">&#34;app.kubernetes.io/managed-by&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;containerd&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>      <span style="color:#204a87;font-weight:700">&#34;app.kubernetes.io/name&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;fluentbit&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>      <span style="color:#204a87;font-weight:700">&#34;controller-revision-hash&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;6bb6f7f5f4&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>      <span style="color:#204a87;font-weight:700">&#34;pod-template-generation&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;2&#34;</span>
</span></span><span style="display:flex"><span>    <span style="color:#000;font-weight:700">},</span>
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&#34;annotations&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>      <span style="color:#204a87;font-weight:700">&#34;checksum/cri-log-parser.conf&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;d902a0ee964e9398e637b581be851cdf50ab2846e82003d2f5e2feef82bef95d&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>      <span style="color:#204a87;font-weight:700">&#34;checksum/fluent-bit.conf&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;dc9727d915c447b414dc05df2d9a6f23246cdca345309eb3107cc16ae8369b53&#34;</span>
</span></span><span style="display:flex"><span>    <span style="color:#000;font-weight:700">},</span>
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&#34;host&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;logging&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&#34;container_name&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;fluent-bit&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&#34;docker_id&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;5cf032406344fdf41d76ce4489ee6f3ca092e9207ec49ab6209cc2bcf950e593&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&#34;container_image&#34;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;fluent/fluent-bit:3.0.4&#34;</span>
</span></span><span style="display:flex"><span>  <span style="color:#000;font-weight:700">}</span>
</span></span><span style="display:flex"><span><span style="color:#000;font-weight:700">}</span>
</span></span></code></pre></div><h3 id="set-the-severity-of-prometheusrules">Set the severity of PrometheusRules</h3><p>You can now configure <code>PrometheusRulesOverride</code> in your <a href="/5.1/docs/configuration/crds/v1beta1/common_types/#PrometheusRulesOverride"><code>logging</code> CRDs</a>. The content of <code>PrometheusRulesOverride</code> is identical to the v1.Rule Prometheus rule type. The controller will match overrides by their names with the original rules. All of the override attributes are optional and whenever an attribute is set, it will replace the original attribute.</p><p>For example, you can change the severity of a rule like this:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">metrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">prometheusRules</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">prometheusRulesOverride</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">alert</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentdPredictedBufferGrowth</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#204a87;font-weight:700">rulegroup</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#204a87;font-weight:700">service</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#000">fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#204a87;font-weight:700">severity</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">none</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="other-changes">Other changes</h3><ul>
<li><a href="#fluent-bit-hot-reload">Fluent Bit hot reload</a> now reloads imagePullSecrets as well.</li><li>From now on, the entire <code>spec.Security.SecurityContext</code> is passed to Fluent Bit.</li><li>Kubernetes namespace labels are added to the metadata by default. (The default of the <code>namespace_labels</code> option in the FluentBitAgent CRD is <code>on</code>.)</li></ul><h2 id="version-48">Version 4.8</h2><p>The following are the highlights and main changes of Logging operator 4.8. For a complete list of changes and bugfixes, see the <a href="https://github.com/kube-logging/logging-operator/releases/tag/4.8.0">Logging operator 4.8 releases page</a> and the <a href="https://axoflow.com/logging-operator-4.8-release">Logging operator 4.8 release blog post</a>.</p><h3 id="routing-based-on-namespace-labels">Routing based on namespace labels</h3><p>In your Fluentd ClusterFlows you can now route your messages based on namespace labels.</p><blockquote>
<p>Note: This feature requires a new Fluentd image: <code>ghcr.io/kube-logging/fluentd:v1.16-4.8-full</code>. If you&rsquo;re using a custom Fluentd image, make sure to update it!</p></blockquote><p>If you have <a href="https://kube-logging.dev/docs/whats-new/#kubernetes-namespace-labels-and-annotations">enabled namespace labeling in Fluent Bit</a>, you can use namespace labels in your selectors, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ClusterFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dev-logs</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">namespace_labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">tenant</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dev</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">globalOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">example</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="breaking-change">Breaking change</h3><p>If you&rsquo;re using <code>hostTailer</code> or <code>eventTailer</code> and configured it through the helm chart&rsquo;s <code>logging.hostTailer</code> or <code>logging.eventTailer</code> option, note that now both components have an <code>enabled</code> flag. Set this flag to true if you used any of these components from the chart. For details, see the <a href="https://github.com/kube-logging/logging-operator/pull/1576">pull request</a>.</p><h3 id="go-templates-in-metrics-probe-label-values">Go templates in metrics-probe label values</h3><p>You can now use go templates that resolve to destination information (<code>name</code>, <code>namespace</code>, <code>scope:local/global</code> and the <code>logging</code> name) in metrics-probe label values. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGClusterFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">outputMetrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">custom_output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">flow</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># define your own label for output name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">my-key-for-the-output</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;{{ .Destination.Name }}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#8f5902;font-style:italic"># do not add the output_name label to the metric</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">output_name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">globalOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">http</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="other-changes-1">Other changes</h3><ul>
<li>
<p>You can set the maximal number of TCP connections Fluent Bit can open towards the aggregator to avoid overloading it.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># The below network configurations allow fluentbit to retry indefinitely on a limited number of connections to avoid overloading the aggregator (syslog-ng in this case)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">network</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">maxWorkerConnections</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogng_output</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">Workers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">Retry_Limit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;no_limits&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>In the Logging operator helm chart you can include extra manifests to deploy together with the chart using the <code>extraManifests</code> field, similarly to other popular charts.</p></li></ul><h2 id="version-47">Version 4.7</h2><p>The following are the highlights and main changes of Logging operator 4.7. For a complete list of changes and bugfixes, see the <a href="https://github.com/kube-logging/logging-operator/releases/tag/4.7.0">Logging operator 4.7 releases page</a> and the <a href="https://axoflow.com/logging-operator-4.7-release">Logging operator 4.7 release blog post</a>.</p><h3 id="breaking-change-for-fluentd">Breaking change for Fluentd</h3><p>When using the Fluentd aggregator, Logging operator has overridden the default <code>chunk_limit_size</code> for the Fluentd disk buffers. Since Fluentd updated the default value to a much saner default, Logging operator won&rsquo;t override that to avoid creating too many small buffer chunks. (Having too many small chunks can lead to <code>too many open files</code> errors.)</p><p>This isn&rsquo;t an intrusive breaking change, it only affects your deployments if you intentionally or accidentally depended on this value.</p><h3 id="json-output-format-for-fluentd">JSON output format for Fluentd</h3><p>In addition to the default text format, Fluentd can now format the output as JSON:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">logFormat</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="disk-buffer-support-for-more-outputs">Disk buffer support for more outputs</h3><p>Enabling disk buffers wasn&rsquo;t available for some of the outputs, this has been fixed for: <a href="/5.1/docs/configuration/plugins/outputs/gelf/">Gelf</a>, <a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/elasticsearch/">Elasticsearch</a>, <a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/openobserve/">OpenObserve</a>, <a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/s3/">S3</a>, <a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/splunk_hec/">Splunk HEC</a>.</p><h3 id="compression-support-for-elasticsearch">Compression support for Elasticsearch</h3><p>The <a href="/5.1/docs/configuration/plugins/outputs/elasticsearch/#elasticsearch-compression_level">Elasticsearch output of the Fluentd aggregator</a> now supports compressing the output data using gzip. You can use the <code>compression_level</code> option to set <code>default_compression</code>, <code>best_compression</code>, or <code>best_speed</code>. By default, compression is disabled.</p><h3 id="protected-clusteroutputs-for-fluentd">Protected ClusterOutputs for Fluentd</h3><p>By default, ClusterOutputs can be referenced in any Flow. In certain scenarios, this means that users can send logs from Flows to the ClusterOutput, possibly spamming the output with user logs. From now on, you can set the <code>protected</code> flag for ClusterOutputs and prevent Flows from sending logs to the protected ClusterOutput.</p><h3 id="configcheck-settings-for-aggregators">ConfigCheck settings for aggregators</h3><p>You can now specify <code>configCheck</code> settings globally in the Loggings CRD, and override them if needed on the aggregator level in the <a href="/5.1/docs/configuration/crds/v1beta1/fluentd_types/">Fluentd</a> or <a href="/5.1/docs/configuration/crds/v1beta1/syslogng_types/">SyslogNG</a> CRD.</p><h3 id="limit-connections-for-fluent-bit">Limit connections for Fluent Bit</h3><p>You can now limit the number of TCP connections that each Fluent Bit worker can open toward the aggregator endpoints. The <code>max_worker_connections</code> is set to unlimited by default, and should be used together with the <code>Workers</code> option (which defaults to 2 according to the <a href="https://docs.fluentbit.io/manual/pipeline/outputs/tcp-and-tls#:~:text=double-,Workers,-Enables%20dedicated%20thread">Fluent Bit documentation</a>). The following example uses a single worker with a single connection:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">network</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">maxWorkerConnections</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogng_output</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">Workers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="version-46">Version 4.6</h2><p>The following are the highlights and main changes of Logging operator 4.6. For a complete list of changes and bugfixes, see the <a href="https://github.com/kube-logging/logging-operator/releases/tag/4.6.0">Logging operator 4.6 releases page</a> and the <a href="https://axoflow.com/fluent-bit-hot-reload-kubernetes-namespace-labels-vmware-outputs-logging-operator-4-6">Logging operator 4.6 release blog post</a>.</p><h3 id="fluent-bit-hot-reload">Fluent Bit hot reload</h3><p>As a Fluent Bit restart can take a long time when there are many files to index, Logging operator now supports <a href="https://docs.fluentbit.io/manual/administration/hot-reload">hot reload for Fluent Bit</a> to reload its configuration on the fly.</p><p>You can enable hot reloads under the Logging&rsquo;s <code>spec.fluentbit.configHotReload</code> (legacy method) option, or the new FluentbitAgent&rsquo;s <code>spec.configHotReload</code> option:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">reload-example</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">configHotReload</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>You can configure the <code>resources</code> and <code>image</code> options:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">reload-example</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">configHotReload</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">resources</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">image</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ghcr.io/kube-logging/config-reloader</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v0.0.5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Many thanks to @aslafy-z for contributing this feature!</p><h3 id="vmware-aria-operations-output-for-fluentd">VMware Aria Operations output for Fluentd</h3><p>When using the Fluentd aggregator with the Logging operator, you can now send your logs to <a href="https://www.vmware.com/products/aria-operations-for-logs.html">VMware Aria Operations for Logs</a>. This output uses the <a href="https://github.com/vmware/fluent-plugin-vmware-loginsight">vmwareLogInsight plugin</a>.</p><p>Here is a sample output snippet:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">vmwareLogInsight</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">scheme</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">ssl_verify</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">MY_LOGINSIGHT_HOST</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">9543</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">agent_id</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">log_text_keys</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span>- <span style="color:#000">log</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span>- <span style="color:#000">msg</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span>- <span style="color:#000">message</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">http_conn_debug</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Many thanks to @logikone for contributing this feature!</p><h3 id="vmware-log-intelligence-output-for-fluentd">VMware Log Intelligence output for Fluentd</h3><p>When using the Fluentd aggregator with the Logging operator, you can now send your logs to <a href="https://aria.vmware.com/t/vmware-log-intelligence/">VMware Log Intelligence</a>. This output uses the <a href="https://github.com/vmware/fluent-plugin-vmware-log-intelligence">vmware_log_intelligence plugin</a>.</p><p>Here is a sample output snippet:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">vmwarelogintelligence</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">endpoint_url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://data.upgrade.symphony-dev.com/le-mans/v1/streams/ingestion-pipeline-stream</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">verify_ssl</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">http_compress</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">headers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">content_type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;application/json&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">authorization</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">vmware-log-intelligence-token</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">authorization</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">structure</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">chunk_limit_records</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">300</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">flush_interval</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">3s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">retry_max_times</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Many thanks to @zrobisho for contributing this feature!</p><h3 id="kubernetes-namespace-labels-and-annotations">Kubernetes namespace labels and annotations</h3><p>Logging operator 4.6 supports the new Fluent Bit Kubernetes filter options that will be released in Fluent Bit 3.0. That way you&rsquo;ll be able to enrich your logs with Kubernetes namespace labels and annotations right at the source of the log messages.</p><p>Fluent Bit 3.0 hasn&rsquo;t been released yet (at the time of this writing), but you can use a developer image to test the feature, using a <code>FluentbitAgent</code> resource like this:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">namespace-label-test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filterKubernetes</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">namespace_annotations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;On&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">namespace_labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;On&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">image</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ghcr.io/fluent/fluent-bit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3.0.0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="other-changes-2">Other changes</h3><ul>
<li>Enabling ServiceMonitor checks if Prometheus is already available.</li><li>You can now use a custom PVC without a template for the statefulset.</li><li>You can now configure PodDisruptionBudget for Fluentd.</li><li>Event tailer metrics are now automatically exposed.</li><li>You can configure <a href="https://kube-logging.dev/docs/whats-new/#timeout-based-configuration-checks">timeout-based configuration checks</a> using the <code>logging.configCheck</code> object of the <code>logging-operator</code> chart.</li><li>You can now specify the event tailer image to use in the <code>logging-operator</code> chart.</li><li>Fluent Bit can now automatically delete irrecoverable chunks.</li><li>The Fluentd statefulset and its components created by the Logging operator now include the whole securityContext object.</li><li>The Elasticsearch output of the syslog-ng aggregator now supports the template option.</li><li>To avoid problems that might occur when a tenant has a faulty output and backpressure kicks in, Logging operator now creates a dedicated tail input for each tenant.</li></ul><h3 id="removed-feature">Removed feature</h3><p>We have removed support for <a href="https://kubernetes.io/docs/concepts/security/pod-security-policy/">Pod Security Policies (PSPs)</a>, which were deprecated in Kubernetes v1.21, and removed from Kubernetes in v1.25.</p><p>Note that the API was left intact, it just doesn&rsquo;t do anything.</p><h2 id="version-45">Version 4.5</h2><p>The following are the highlights and main changes of Logging operator 4.5. For a complete list of changes and bugfixes, see the <a href="https://github.com/kube-logging/logging-operator/releases/tag/4.5.0">Logging operator 4.5 releases page</a>.</p><h3 id="standalone-fluentdconfig-and-syslogngconfig-crds">Standalone FluentdConfig and SyslogNGConfig CRDs</h3><p>Starting with Logging operator version 4.5, you can either configure Fluentd in the <code>Logging</code> CR, or you can use a standalone <code>FluentdConfig</code> CR. Similarly, you can use a standalone <code>SyslogNGConfig</code> CRD to configure syslog-ng.</p><p>These standalone CRDs are namespaced resources that allow you to configure the Fluentd/syslog-ng aggregator in the control namespace, separately from the Logging resource. That way you can use a multi-tenant model, where tenant owners are responsible for operating their own aggregator, while the Logging resource is in control of the central operations team.</p><p>For details, see <a href="/5.1/docs/logging-infrastructure/fluentd/">Configure Fluentd</a> and <a href="/5.1/docs/logging-infrastructure/syslog-ng/">Configure syslog-ng</a>.</p><h3 id="new-syslog-ng-features">New syslog-ng features</h3><p>When using syslog-ng as the log aggregator, you can now:</p><ul>
<li>Send data to <a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/openobserve/">OpenObserve</a></li><li>Use a <a href="/5.1/docs/examples/date-parser/">custom date-parser</a></li><li>Create <a href="/5.1/docs/examples/custom-syslog-ng-metrics/">custom log metrics for sources and outputs</a></li><li>Set the permitted <a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/tls/#tls-ssl_version">SSL versions in HTTP based outputs</a></li><li>Configure the <a href="/5.1/docs/configuration/crds/v1beta1/syslogng_types/#syslogngspec-maxconnections">maxConnections parameter of the sources</a></li></ul><h3 id="new-fluentd-features">New Fluentd features</h3><p>When using Fluentd as the log aggregator, you can now:</p><ul>
<li>Use the <a href="/5.1/docs/configuration/plugins/filters/useragent/">useragent Fluent filter</a></li><li>Configure <a href="/5.1/docs/configuration/crds/v1beta1/fluentd_types/#fluentdspec-sidecarcontainers">sidecar container in Fluentd pods</a></li><li>Configure the <a href="/5.1/docs/configuration/crds/v1beta1/fluentd_types/#fluentdspec-sidecarcontainers#fluentddrainconfig-securitycontext">security-context of every container</a></li><li>Set which <a href="/5.1/docs/configuration/plugins/outputs/azurestore/#output-config-azure_cloud">Azure Cloud to use</a> (for example, AzurePublicCloud), when using the Azure Storage output</li><li>Customize the <code>image</code> to use in <a href="/5.1/docs/configuration/crds/extensions/">event and host tailers</a></li></ul><h3 id="other-changes-3">Other changes</h3><ul>
<li>LoggingStatus now includes the number (problemsCount) and the related watchNamespaces to help troubleshooting</li></ul><h3 id="image-and-dependency-updates">Image and dependency updates</h3><p>For the list of images used in Logging operator, see <a href="/5.1/docs/image-versions/">Images used by Logging operator</a>.</p><h2 id="version-44">Version 4.4</h2><p>The following are the highlights and main changes of Logging operator 4.4. For a complete list of changes and bugfixes, see the <a href="https://github.com/kube-logging/logging-operator/releases/tag/4.4.0">Logging operator 4.4 releases page</a>.</p><h3 id="new-syslog-ng-features-1">New syslog-ng features</h3><p>When using syslog-ng as the log aggregator, you can now use the following new outputs:</p><ul>
<li><a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/elasticsearch/">ElasticSearch</a></li><li><a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/loki/">Grafana Loki</a></li><li><a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/mongodb/">MongoDB</a></li><li><a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/redis/">Redis</a></li><li><a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/s3/">Amazon S3</a></li><li><a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/splunk_hec/">Splunk HEC</a></li><li>The <a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/http/">HTTP</a> output now supports the <code>log-fifo-size</code>, <code>response-action</code>, and <code>timeout</code> fields.</li></ul><p>You can now use the <code>metrics-probe()</code> parser of syslog-ng in syslogNGFLow and SyslogNGClusterFlow. For details, see <a href="/5.1/docs/configuration/plugins/syslog-ng-filters/parser/#metricsprobe">MetricsProbe</a>.</p><h3 id="multitenancy-with-namespace-based-routing">Multitenancy with namespace-based routing</h3><p>Logging operator now supports namespace based routing for efficient aggregator-level multi-tenancy.</p><p>In the project repository you can:</p><ul>
<li>find an <a href="https://github.com/kube-logging/logging-operator/blob/master/docs/multi-tenancy.md">overview about multitenancy</a>.</li><li>find more detailed information about the new <a href="https://github.com/kube-logging/logging-operator/blob/master/docs/logging-route.md">LoggingRoute</a> resource that enables this new behaviour.</li><li>find a <a href="https://github.com/kube-logging/logging-operator/tree/master/config/samples/multitenant-routing">simple example</a> to demonstrate the new behaviour</li></ul><p>On a side note, nodegroup level isolation for hard multitenancy is also supported, see the <a href="/5.1/docs/examples/multitenancy/">Nodegroup-based multitenancy</a> example.</p><h3 id="forwarder-logs">Forwarder logs</h3><p>Fluent-bit now doesn&rsquo;t process the logs of the Fluentd and syslog-ng forwarders by default to avoid infinitely growing message loops. With this change, you can access Fluentd and syslog-ng logs simply by running <code>kubectl logs &lt;name-of-forwarder-pod></code></p><p>In a future Logging operator version the logs of the aggregators will also be available for routing to external outputs.</p><h3 id="timeout-based-configuration-checks">Timeout-based configuration checks</h3><p>Timeout-based configuration checks are different from the normal method: they start a Fluentd or syslog-ng instance
without the dry-run or syntax-check flags, so output plugins or destination drivers actually try to establish
connections and will fail if there are any issues , for example, with the credentials.</p><p>Add the following to you <code>Logging</code> resource spec:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">configCheck</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">strategy</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">StartWithTimeout</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">timeoutSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="istio-support">Istio support</h3><p>For jobs/individual pods that run to completion, Istio sidecar injection needs to be disabled, otherwise the affected pods would live forever with the running sidecar container. Configuration checkers and Fluentd drainer pods can be configured with the label <code>sidecar.istio.io/inject</code> set to <code>false</code>. You can configure Fluentd drainer labels in the Logging spec.</p><h3 id="improved-buffer-metrics">Improved buffer metrics</h3><p>The buffer metrics are now available for both the Fluentd and the SyslogNG based aggregators.</p><p>The sidecar configuration has been rewritten to add a new metric and improve performance by avoiding unnecessary cardinality.</p><p>The name of the metric has been changed as well, but the original metric was kept in place to avoid breaking existing clients.</p><p><strong>Metrics currently supported by the sidecar</strong></p><p>Old</p><pre tabindex="0"><code>+# HELP node_buffer_size_bytes Disk space used [deprecated]
+# TYPE node_buffer_size_bytes gauge
+node_buffer_size_bytes{entity=&#34;/buffers&#34;} 32253
</code></pre><p>New</p><pre tabindex="0"><code>+# HELP logging_buffer_files File count
+# TYPE logging_buffer_files gauge
+logging_buffer_files{entity=&#34;/buffers&#34;,host=&#34;all-to-file-fluentd-0&#34;} 2
+# HELP logging_buffer_size_bytes Disk space used
+# TYPE logging_buffer_size_bytes gauge
+logging_buffer_size_bytes{entity=&#34;/buffers&#34;,host=&#34;all-to-file-fluentd-0&#34;} 32253
</code></pre><h3 id="other-improvements">Other improvements</h3><ul>
<li>You can now configure the resources of the buffer metrics sidecar.</li><li>You can now rerun failed configuration checks if there is no configcheck pod.</li><li>The <a href="/5.1/docs/configuration/plugins/outputs/elasticsearch/">Fluentd ElasticSearch output</a> now supports the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.13/index-templates.html">composable index template</a> format. To use it, set the <code>use_legacy_template</code> option to <code>false</code>.</li><li>The metrics for the syslog-ng forwarder are now exported using <a href="https://github.com/axoflow/axosyslog-metrics-exporter">axosyslog-metrics-exporter</a>.</li></ul><h3 id="image-and-dependency-updates-1">Image and dependency updates</h3><p>For the list of images used in Logging operator, see <a href="/5.1/docs/image-versions/">Images used by Logging operator</a>.</p><p>Fluentd images with versions <code>v1.14</code> and <code>v1.15</code> are now EOL due to the fact they are based on ruby 2.7 which is EOL as well.</p><p>The currently supported image is <a href="https://github.com/kube-logging/fluentd-images/tree/main/v1.15-ruby3">v1.15-ruby3</a> and build configuration for <a href="https://github.com/kube-logging/fluentd-images/tree/main/v1.15-staging">v1.15-staging</a> is available for staging experimental changes.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-dba60f6e1187cfb4700ab7f78948fc24">2 - Install</h1><blockquote>
<p>Caution: The <strong>master branch</strong> is under heavy development. Use <a href="https://github.com/kube-logging/logging-operator/releases">releases</a> instead of the master branch to get stable software.</p></blockquote><h2 id="prerequisites">Prerequisites</h2><ul>
<li>Logging operator requires Kubernetes v1.22.x or later.</li><li>For the <a href="#helm">Helm-based installation</a> you need Helm v3.8.1 or later.</li></ul><blockquote>
<p>With the 4.3.0 release, the chart is now distributed through an OCI registry. <br>
For instructions on how to interact with OCI registries, please take a look at <a href="https://helm.sh/docs/topics/registries/">Use OCI-based registries</a>.
For instructions on installing the previous 4.2.3 version, see <a href="/4.2/docs/install">Installation for 4.2</a>.</p></blockquote><h2 id="helm">Deploy Logging operator with Helm</h2><p align="center"><img src="../img/helm.svg" alt="Logos" width="150"></p><p align="center">
<p>To install the Logging operator using Helm, complete the following steps.</p><blockquote>
<p>Note: You need Helm v3.8 or later to be able to install the chart from an OCI registry.</p></blockquote><ol>
<li>
<p>Install the Logging operator into the <em>logging</em> namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging logging-operator oci://ghcr.io/kube-logging/helm-charts/logging-operator
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;logging-operator&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>Pulled: ghcr.io/kube-logging/helm-charts/logging-operator:4.3.0
</span></span><span style="display:flex"><span>Digest: sha256:c2ece861f66a3a2cb9788e7ca39a267898bb5629dc98429daa8f88d7acf76840
</span></span><span style="display:flex"><span>NAME: logging-operator
</span></span><span style="display:flex"><span>LAST DEPLOYED: Wed Aug  <span style="color:#0000cf;font-weight:700">9</span> 11:02:12 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: logging
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>TEST SUITE: None
</span></span></code></pre></div><blockquote>
<p>Note:</p><ul>
<li>
<p>Helm has a known issue in version 3.13.0 that requires users to log in to the registry, even though the repo is public.</p><p>Upgrade to 3.13.1 or higher to avoid having to log in, see: <a href="https://github.com/kube-logging/logging-operator/issues/1522">https://github.com/kube-logging/logging-operator/issues/1522</a></p></li><li>
<p>If you&rsquo;re installing the Helm chart from Terraform, reference the repository as <code>repository = "oci://ghcr.io/kube-logging/helm-charts/"</code> (without the <code>logging-operator</code> suffix). Otherwise, you&rsquo;ll get a <a href="https://github.com/hashicorp/terraform-provider-helm/issues/1291">403 Forbidden error</a>.</p></li></ul></blockquote><blockquote>
<p>Note: By default, the Logging operator Helm chart doesn&rsquo;t install the <code>logging</code> resource. If you want to install it with Helm, set the <code>logging.enabled</code> value to true.</p><p>For details on customizing the installation, see the <a href="https://github.com/kube-logging/logging-operator/tree/master/charts/logging-operator">Helm chart values</a>.</p></blockquote></li></ol><h2 id="arguments">Operator arguments</h2><h3 id="metrics-and-performance">Metrics and Performance</h3><ul>
<li><code>--metrics-addr</code> (string, default <code>:8080</code>): Address for metric endpoint</li><li><code>--pprof</code> (boolean, default <code>false</code>): Enable performance profiling</li></ul><h3 id="logging-configuration">Logging Configuration</h3><ul>
<li><code>--verbose</code> (boolean, default <code>false</code>): Enable verbose logging</li><li><code>--klogLevel</code> (integer, default <code>0</code>): Global log level for klog (0-9)</li><li><code>--output-format</code> (string, default <code>""</code>): Logging output format (<code>json</code> or <code>console</code>)</li></ul><h3 id="resource-watching">Resource Watching</h3><ul>
<li><code>--watch-namespace</code> (string, default <code>""</code>): Filter watched objects by namespace</li><li><code>--watch-logging-name</code> (string, default <code>""</code>): Filter objects by logging resource name</li><li><code>--watch-labeled-children</code> (boolean, default <code>false</code>): Watch child resources only with logging operator&rsquo;s name label (<code>app.kubernetes.io/name: fluentd|fluentbit|syslog-ng</code>)</li><li><code>--watch-labeled-secrets</code> (boolean, default <code>false</code>): Watch secrets only with <code>logging.banzaicloud.io/watch: enabled</code> label</li></ul><blockquote>
<p><strong>Note on Combinations:</strong></p><ul>
<li>If <code>watch-namespace</code> is set, it narrows the scope for ALL watched resources</li><li><code>watch-logging-name</code> and <code>watch-labeled-children</code> can be combined to further restrict child resource watching</li><li><code>watch-labeled-children</code> and <code>watch-labeled-secrets</code> apply independent label filters</li><li>Using multiple filters creates an increasingly restrictive watch scope</li><li>Most restrictive scenario: All three flags set will significantly limit the operator&rsquo;s resource visibility</li></ul></blockquote><h3 id="controller-management">Controller Management</h3><ul>
<li><code>--enable-leader-election</code> (boolean, default <code>false</code>): Ensure only one active controller manager</li><li><code>--finalizer-cleanup</code> (boolean, default <code>false</code>): Remove finalizers during operator shutdown, useful for <code>Helm</code> uninstallation</li><li><code>--enable-telemetry-controller-route</code> (boolean, default <code>false</code>): Enable Telemetry Controller routing for Logging resources</li><li><code>--sync-period</code> (string, default <code>""</code>): Minimum frequency for reconciling watched resources, for example, <code>30s</code>, or <code>2h45m</code>. Valid time units are &ldquo;ms&rdquo;, &ldquo;s&rdquo;, &ldquo;m&rdquo;, &ldquo;h&rdquo;.</li></ul><p>To add arguments with <code>Helm</code> you can use the <code>extraArgs</code> field e.g:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm install logging-operator ./charts/logging-operator/ --set <span style="color:#000">extraArgs</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{&#34;-enable-leader-election=true&#34;,&#34;-enable-telemetry-controller-route&#34;}&#39;</span>
</span></span></code></pre></div><h2 id="validate">Validate the deployment</h2><p>To verify that the installation was successful, complete the following steps.</p><ol>
<li>
<p>Check the status of the pods. You should see a new logging-operator pod.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging get pods
</span></span></code></pre></div><p>Expected output:</p><pre tabindex="0"><code>NAME                                READY   STATUS    RESTARTS   AGE
logging-operator-5df66b87c9-wgsdf   1/1     Running   0          21s
</code></pre></li><li>
<p>Check the CRDs. You should see the following five new CRDs.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl get crd
</span></span></code></pre></div><p>Expected output:</p><pre tabindex="0"><code>NAME                                    CREATED AT
clusterflows.logging.banzaicloud.io              2023-08-10T12:05:04Z
clusteroutputs.logging.banzaicloud.io            2023-08-10T12:05:04Z
eventtailers.logging-extensions.banzaicloud.io   2023-08-10T12:05:04Z
flows.logging.banzaicloud.io                     2023-08-10T12:05:04Z
fluentbitagents.logging.banzaicloud.io           2023-08-10T12:05:04Z
hosttailers.logging-extensions.banzaicloud.io    2023-08-10T12:05:04Z
loggings.logging.banzaicloud.io                  2023-08-10T12:05:05Z
nodeagents.logging.banzaicloud.io                2023-08-10T12:05:05Z
outputs.logging.banzaicloud.io                   2023-08-10T12:05:05Z
syslogngclusterflows.logging.banzaicloud.io      2023-08-10T12:05:05Z
syslogngclusteroutputs.logging.banzaicloud.io    2023-08-10T12:05:05Z
syslogngflows.logging.banzaicloud.io             2023-08-10T12:05:05Z
syslogngoutputs.logging.banzaicloud.io           2023-08-10T12:05:06Z
</code></pre></li></ol><h2 id="verify">Image and chart verification</h2><p>Images and charts are signed with GitHub Actions OIDC token. We sign the digests of the images and the charts to ensure the integrity and authenticity of the artifacts.</p><p>To verify signatures, you must have <a href="https://docs.sigstore.dev/cosign/system_config/installation/">cosign</a> installed.</p><h3 id="image-verification">Image verification</h3><p>You can verify our images by running the following command.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>cosign verify <span style="color:#4e9a06">&#34;ghcr.io/kube-logging/logging-operator@{sha256-IMAGE-DIGEST}&#34;</span> <span style="color:#4e9a06">\ </span>
</span></span><span style="display:flex"><span>--certificate-identity <span style="color:#4e9a06">&#34;https://github.com/ghcr.io/kube-logging/logging-operator/.github/workflows/artifacts.yaml@{refs/heads/main || refs/tags/&lt;tag_name&gt;}&#34;</span> <span style="color:#4e9a06">\ </span>
</span></span><span style="display:flex"><span>--certificate-oidc-issuer <span style="color:#4e9a06">&#34;https://token.actions.githubusercontent.com&#34;</span>
</span></span></code></pre></div><ul>
<li>Replace <code>{sha256-IMAGE-DIGEST}</code> with the digest of the image you want to verify. You can find the digests at <a href="https://ghcr.io/kube-logging/logging-operator">ghcr.io/kube-logging/logging-operator</a>. For example, for the 4.11.0 release it&rsquo;s <code>sha256:50550883905ffe484f210ae65a8e0dbcbc0836c240b1fec454945d8b97830ede</code>.</li><li>Replace <code>{refs/heads/main || refs/tags/&lt;tag_name>}</code> with the reference to the image you want to verify. For example, for the 4.11.0 release, use <code>refs/tags/4.11.0</code>.</li></ul><p>For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>cosign verify <span style="color:#4e9a06">&#34;ghcr.io/kube-logging/logging-operator@sha256:50550883905ffe484f210ae65a8e0dbcbc0836c240b1fec454945d8b97830ede&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --certificate-identity <span style="color:#4e9a06">&#34;https://github.com/kube-logging/logging-operator/.github/workflows/artifacts.yaml@refs/tags/4.11.0&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --certificate-oidc-issuer <span style="color:#4e9a06">&#34;https://token.actions.githubusercontent.com&#34;</span>
</span></span></code></pre></div><h3 id="chart-verification">Chart verification</h3><p>You can verify our charts by running the following command.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>cosign verify <span style="color:#4e9a06">&#34;ghcr.io/kube-logging/logging-operator@{sha256-CHART-DIGEST}&#34;</span> <span style="color:#4e9a06">\ </span>
</span></span><span style="display:flex"><span>--certificate-identity <span style="color:#4e9a06">&#34;https://github.com/ghcr.io/kube-logging/logging-operator/.github/workflows/artifacts.yaml@{refs/heads/main || refs/tags/&lt;tag_name&gt;}&#34;</span> <span style="color:#4e9a06">\ </span>
</span></span><span style="display:flex"><span>--certificate-oidc-issuer <span style="color:#4e9a06">&#34;https://token.actions.githubusercontent.com&#34;</span>
</span></span></code></pre></div><ul>
<li>Replace <code>{sha256-CHART-DIGEST}</code> with the digest of the image you want to verify. You can find the digests at <a href="https://ghcr.io/kube-logging/helm-charts/logging-operator">ghcr.io/kube-logging/helm-charts/logging-operator</a>. For example, for the 4.11.0 release it&rsquo;s <code>sha256:233407195e1c97382e7fc0dfb00f9c6cadbba2928a64bfce6be072fc37df20eb</code>.</li><li>Replace <code>{refs/heads/main || refs/tags/&lt;tag_name>}</code> with the reference to the image you want to verify. For example, for the 4.11.0 release, use <code>refs/tags/4.11.0</code>.</li></ul><p>For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>cosign verify <span style="color:#4e9a06">&#34;ghcr.io/kube-logging/helm-charts/logging-operator@sha256:233407195e1c97382e7fc0dfb00f9c6cadbba2928a64bfce6be072fc37df20eb&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --certificate-identity <span style="color:#4e9a06">&#34;https://github.com/kube-logging/logging-operator/.github/workflows/artifacts.yaml@refs/tags/4.11.0&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --certificate-oidc-issuer <span style="color:#4e9a06">&#34;https://token.actions.githubusercontent.com&#34;</span>
</span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-5e2d56ea782d776e21715559d28c9e90">3 - Quick start guides</h1><p>Try out Logging Operator with these quick start guides, that show you the basics of Logging operator.</p><p>For other detailed examples using different outputs, see <a href="/5.1/docs/examples/">Examples</a>.</p></div><div class="td-content">
<h1 id="pg-5b079e76b2e1dabb1cc1b5ac08b733e7">3.1 - Single app, one destination</h1><p>This guide shows you how to collect application and container logs in Kubernetes using the Logging operator.</p><p>The Logging operator itself doesn&rsquo;t store any logs. For demonstration purposes, it can deploy a special workload to the cluster to let you observe the logs flowing through the system.</p><p>The Logging operator collects all logs from the cluster, selects the specific logs based on pod labels, and sends the selected log messages to the output.
For more details about the Logging operator, see the <a href="/5.1/docs/">Logging operator overview</a>.</p><blockquote>
<p>Note: This example aims to be simple enough to understand the basic capabilities of the operator. For a production ready setup, see <a href="/5.1/docs/logging-infrastructure/">Logging infrastructure setup</a> and <a href="/5.1/docs/operation/">Operation</a>.</p></blockquote><p>In this tutorial, you will:</p><ul>
<li>Install the Logging operator on a cluster.</li><li>Configure Logging operator to collect logs from a namespace and send it to a sample output.</li><li>Install a sample application (log-generator) to collect its logs.</li><li>Check the collected logs.</li></ul><h2 id="helm">Deploy the Logging operator with Helm</h2><p>To install the Logging operator using Helm, complete the following steps.</p><blockquote>
<p>Note: You need Helm v3.8 or later to be able to install the chart from an OCI registry.</p></blockquote><p>This command installs the latest stable Logging operator and an extra workload (service and deployment). This workload is called <code>logging-operator-test-receiver</code>. It listens on an HTTP port, receives JSON messages, and writes them to the standard output (stdout) so that it is trivial to observe.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>helm upgrade --install --wait <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>     --create-namespace --namespace logging <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>     --set testReceiver.enabled<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#204a87">true</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>     logging-operator oci://ghcr.io/kube-logging/helm-charts/logging-operator
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;logging-operator&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>Pulled: ghcr.io/kube-logging/helm-charts/logging-operator:4.3.0
</span></span><span style="display:flex"><span>Digest: sha256:c2ece861f66a3a2cb9788e7ca39a267898bb5629dc98429daa8f88d7acf76840
</span></span><span style="display:flex"><span>NAME: logging-operator
</span></span><span style="display:flex"><span>LAST DEPLOYED: Tue Aug <span style="color:#0000cf;font-weight:700">15</span> 15:58:41 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: logging
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>TEST SUITE: None
</span></span></code></pre></div><p>After the installation is completed, check that the following pods and services are running:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get deploy -n logging
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>NAME                             READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style="display:flex"><span>logging-operator                 1/1     <span style="color:#0000cf;font-weight:700">1</span>            <span style="color:#0000cf;font-weight:700">1</span>           15m
</span></span><span style="display:flex"><span>logging-operator-test-receiver   1/1     <span style="color:#0000cf;font-weight:700">1</span>            <span style="color:#0000cf;font-weight:700">1</span>           15m
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get svc -n logging
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>NAME                             TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span style="color:#ce5c00;font-weight:700">(</span>S<span style="color:#ce5c00;font-weight:700">)</span>    AGE
</span></span><span style="display:flex"><span>logging-operator                 ClusterIP   None           &lt;none&gt;        8080/TCP   15m
</span></span><span style="display:flex"><span>logging-operator-test-receiver   ClusterIP   10.99.77.113   &lt;none&gt;        8080/TCP   15m
</span></span></code></pre></div><h2 id="configure-the-logging-operator">Configure the Logging operator</h2><ol>
<li>
<p>Create a <code>Logging</code> resource to deploy syslog-ng or Fluentd as the central log aggregator and forwarder. You can complete this quick start guide with any of them, but they have different features, so they are not equivalent. For details, see <a href="/5.1/docs/configuration/fluentd-vs-syslog-ng/">Which log forwarder to use</a>.</p><p>Run one of the following commands.</p><ul class="nav nav-tabs justify-content-end" id="tabs-3" role="tablist">
<li class="nav-item">
<a class="nav-link disabled" id="tabs-03-00-tab" data-toggle="tab" href="#tabs-03-00" role="tab" aria-controls="tabs-03-00" aria-selected="false">
<strong>Log forwarder</strong>:
</a>
</li><li class="nav-item">
<a class="nav-link active persistLang-syslog-ng" id="tabs-03-01-tab" data-toggle="tab" href="#tabs-03-01" role="tab" onclick='persistLang("syslog-ng")' aria-controls="tabs-03-01" aria-selected="false">
syslog-ng
</a>
</li><li class="nav-item">
<a class="nav-link persistLang-fluentd" id="tabs-03-02-tab" data-toggle="tab" href="#tabs-03-02" role="tab" onclick='persistLang("fluentd")' aria-controls="tabs-03-02" aria-selected="false">
Fluentd
</a>
</li></ul><div class="tab-content" id="tabs-3-content">
<div class="tab-body tab-pane fade" id="tabs-03-00" role="tabpanel" aria-labelled-by="tabs-03-00-tab">
</div><div class="tab-body tab-pane fade show active" id="tabs-03-01" role="tabpanel" aria-labelled-by="tabs-03-01-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl --namespace logging apply -f - &lt;&lt;&#34;EOF&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">quickstart</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogNG</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># `#` is the recommended key delimiter when parsing json in syslog-ng</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">jsonKeyDelim</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;#&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></div><div class="tab-body tab-pane fade" id="tabs-03-02" role="tabpanel" aria-labelled-by="tabs-03-02-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl --namespace logging apply -f - &lt;&lt;&#34;EOF&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">quickstart</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">disablePvc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></div></div><blockquote>
<p>Note: The control namespace is where the Logging operator deploys the forwarder&rsquo;s resources, such as the StatefulSet and the configuration secrets. Usually it&rsquo;s called <code>logging</code>.</p><p>By default, this namespace is used to define the cluster-wide resources: <code>SyslogNGClusterOutput</code>, <code>SyslogNGClusterFlow</code>, <code>ClusterOutput</code>, and <code>ClusterFlow</code>. For details, see <a href="/5.1/docs/configuration/">Configure log routing</a>.</p></blockquote><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>logging.logging.banzaicloud.io/quickstart created
</span></span></code></pre></div></li><li>
<p>Create a <code>FluentbitAgent</code> resource to collect logs from all containers. No special configuration is required for now.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl --namespace logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: FluentbitAgent
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>    name: quickstart
</span></span><span style="display:flex"><span>spec: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>fluentbitagent.logging.banzaicloud.io/quickstart created
</span></span></code></pre></div></li><li>
<p>Check that the resources were created successfully so far. Run the following command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pod --namespace logging --selector app.kubernetes.io/managed-by<span style="color:#ce5c00;font-weight:700">=</span>quickstart
</span></span></code></pre></div><p>You should already see a completed configcheck pod that validates the forwarder&rsquo;s configuration before the actual statefulset starts.
There should also be a running fluentbit instance per node, that already starts to send all logs to the forwarder.</p><ul class="nav nav-tabs justify-content-end" id="tabs-5" role="tablist">
<li class="nav-item">
<a class="nav-link disabled" id="tabs-05-00-tab" data-toggle="tab" href="#tabs-05-00" role="tab" aria-controls="tabs-05-00" aria-selected="false">
<strong>All logging resources</strong>:
</a>
</li><li class="nav-item">
<a class="nav-link active persistLang-syslog-ng" id="tabs-05-01-tab" data-toggle="tab" href="#tabs-05-01" role="tab" onclick='persistLang("syslog-ng")' aria-controls="tabs-05-01" aria-selected="false">
syslog-ng
</a>
</li><li class="nav-item">
<a class="nav-link persistLang-fluentd" id="tabs-05-02-tab" data-toggle="tab" href="#tabs-05-02" role="tab" onclick='persistLang("fluentd")' aria-controls="tabs-05-02" aria-selected="false">
Fluentd
</a>
</li></ul><div class="tab-content" id="tabs-5-content">
<div class="tab-body tab-pane fade" id="tabs-05-00" role="tabpanel" aria-labelled-by="tabs-05-00-tab">
</div><div class="tab-body tab-pane fade show active" id="tabs-05-01" role="tabpanel" aria-labelled-by="tabs-05-01-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>NAME                                        READY   STATUS      RESTARTS   AGE
</span></span><span style="display:flex"><span>quickstart-fluentbit-jvdp5                  1/1     Running     <span style="color:#0000cf;font-weight:700">0</span>          3m5s
</span></span><span style="display:flex"><span>quickstart-syslog-ng-0                      2/2     Running     <span style="color:#0000cf;font-weight:700">0</span>          3m5s
</span></span><span style="display:flex"><span>quickstart-syslog-ng-configcheck-8197c552   0/1     Completed   <span style="color:#0000cf;font-weight:700">0</span>          3m42s
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id="tabs-05-02" role="tabpanel" aria-labelled-by="tabs-05-02-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>NAME                                      READY   STATUS      RESTARTS   AGE
</span></span><span style="display:flex"><span>quickstart-fluentbit-nk9ms                1/1     Running     <span style="color:#0000cf;font-weight:700">0</span>          19s
</span></span><span style="display:flex"><span>quickstart-fluentd-0                      2/2     Running     <span style="color:#0000cf;font-weight:700">0</span>          19s
</span></span><span style="display:flex"><span>quickstart-fluentd-configcheck-ac2d4553   0/1     Completed   <span style="color:#0000cf;font-weight:700">0</span>          60s
</span></span></code></pre></div></div></div></li><li>
<p>Create a namespace (for example: <code>quickstart</code>) from which you want to collect the logs from.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl create namespace quickstart
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>namespace/quickstart created
</span></span></code></pre></div></li><li>
<p>Create a <a href="/5.1/docs/configuration/flow/">flow</a> and an <a href="/5.1/docs/configuration/output/">output</a> resource in the same namespace (<code>quickstart</code>). The flow resource routes logs from the namespace to a specific output. In this example, the output is called <code>http</code>. The flow resources are called <code>SyslogNGFlow</code> and <code>Flow</code>, the output resources are <code>SyslogNGOutput</code> and <code>Output</code> for syslog-ng and Fluentd, respectively.</p><ul class="nav nav-tabs justify-content-end" id="tabs-8" role="tablist">
<li class="nav-item">
<a class="nav-link disabled" id="tabs-08-00-tab" data-toggle="tab" href="#tabs-08-00" role="tab" aria-controls="tabs-08-00" aria-selected="false">
<strong>Flow and output</strong>:
</a>
</li><li class="nav-item">
<a class="nav-link active persistLang-syslog-ng" id="tabs-08-01-tab" data-toggle="tab" href="#tabs-08-01" role="tab" onclick='persistLang("syslog-ng")' aria-controls="tabs-08-01" aria-selected="false">
syslog-ng
</a>
</li><li class="nav-item">
<a class="nav-link persistLang-fluentd" id="tabs-08-02-tab" data-toggle="tab" href="#tabs-08-02" role="tab" onclick='persistLang("fluentd")' aria-controls="tabs-08-02" aria-selected="false">
Fluentd
</a>
</li></ul><div class="tab-content" id="tabs-8-content">
<div class="tab-body tab-pane fade" id="tabs-08-00" role="tabpanel" aria-labelled-by="tabs-08-00-tab">
</div><div class="tab-body tab-pane fade show active" id="tabs-08-01" role="tabpanel" aria-labelled-by="tabs-08-01-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl --namespace quickstart apply -f - &lt;&lt;&#34;EOF&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;json#kubernetes#labels#app.kubernetes.io/instance&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">http</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">http</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://logging-operator-test-receiver:8080</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">headers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#4e9a06">&#34;Content-Type: application/json&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">disk_buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">dir</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/buffers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">disk_buf_size</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">512000000</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 512 MB</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">reliable</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></div><div class="tab-body tab-pane fade" id="tabs-08-02" role="tabpanel" aria-labelled-by="tabs-08-02-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl --namespace quickstart apply -f - &lt;&lt;&#34;EOF&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app.kubernetes.io/name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">http</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">http</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">endpoint</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://logging-operator-test-receiver:8080</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">content_type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">application/json</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">memory</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">tags</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">time</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">0s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></div></div><blockquote>
<p>Note: In production environment, use a longer <code>timekey</code> interval to avoid generating too many objects.</p></blockquote><p>Expected output:</p><ul class="nav nav-tabs justify-content-end" id="tabs-9" role="tablist">
<li class="nav-item">
<a class="nav-link disabled" id="tabs-09-00-tab" data-toggle="tab" href="#tabs-09-00" role="tab" aria-controls="tabs-09-00" aria-selected="false">
<strong>Log forwarder</strong>:
</a>
</li><li class="nav-item">
<a class="nav-link active persistLang-syslog-ng" id="tabs-09-01-tab" data-toggle="tab" href="#tabs-09-01" role="tab" onclick='persistLang("syslog-ng")' aria-controls="tabs-09-01" aria-selected="false">
syslog-ng
</a>
</li><li class="nav-item">
<a class="nav-link persistLang-fluentd" id="tabs-09-02-tab" data-toggle="tab" href="#tabs-09-02" role="tab" onclick='persistLang("fluentd")' aria-controls="tabs-09-02" aria-selected="false">
Fluentd
</a>
</li></ul><div class="tab-content" id="tabs-9-content">
<div class="tab-body tab-pane fade" id="tabs-09-00" role="tabpanel" aria-labelled-by="tabs-09-00-tab">
</div><div class="tab-body tab-pane fade show active" id="tabs-09-01" role="tabpanel" aria-labelled-by="tabs-09-01-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>syslogngflow.logging.banzaicloud.io/log-generator created
</span></span><span style="display:flex"><span>syslogngoutput.logging.banzaicloud.io/http created
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id="tabs-09-02" role="tabpanel" aria-labelled-by="tabs-09-02-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>flow.logging.banzaicloud.io/log-generator created
</span></span><span style="display:flex"><span>output.logging.banzaicloud.io/http created
</span></span></code></pre></div></div></div></li><li>
<p>Check that the resources were created successfully. Run the following command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get logging-all --namespace quickstart
</span></span></code></pre></div><p>You should see that the logging resource has been created and the flow and output are active.</p><ul class="nav nav-tabs justify-content-end" id="tabs-10" role="tablist">
<li class="nav-item">
<a class="nav-link disabled" id="tabs-10-00-tab" data-toggle="tab" href="#tabs-10-00" role="tab" aria-controls="tabs-10-00" aria-selected="false">
<strong>All logging resources</strong>:
</a>
</li><li class="nav-item">
<a class="nav-link active persistLang-syslog-ng" id="tabs-10-01-tab" data-toggle="tab" href="#tabs-10-01" role="tab" onclick='persistLang("syslog-ng")' aria-controls="tabs-10-01" aria-selected="false">
syslog-ng
</a>
</li><li class="nav-item">
<a class="nav-link persistLang-fluentd" id="tabs-10-02-tab" data-toggle="tab" href="#tabs-10-02" role="tab" onclick='persistLang("fluentd")' aria-controls="tabs-10-02" aria-selected="false">
Fluentd
</a>
</li></ul><div class="tab-content" id="tabs-10-content">
<div class="tab-body tab-pane fade" id="tabs-10-00" role="tabpanel" aria-labelled-by="tabs-10-00-tab">
</div><div class="tab-body tab-pane fade show active" id="tabs-10-01" role="tabpanel" aria-labelled-by="tabs-10-01-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>NAME                                               AGE
</span></span><span style="display:flex"><span>fluentbitagent.logging.banzaicloud.io/quickstart   10m
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>NAME                                        AGE
</span></span><span style="display:flex"><span>logging.logging.banzaicloud.io/quickstart   10m
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>NAME                                         ACTIVE   PROBLEMS
</span></span><span style="display:flex"><span>syslogngoutput.logging.banzaicloud.io/http   <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>NAME                                                ACTIVE   PROBLEMS
</span></span><span style="display:flex"><span>syslogngflow.logging.banzaicloud.io/log-generator   <span style="color:#204a87">true</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id="tabs-10-02" role="tabpanel" aria-labelled-by="tabs-10-02-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>NAME                                        ACTIVE   PROBLEMS
</span></span><span style="display:flex"><span>flow.logging.banzaicloud.io/log-generator   <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>NAME                                 ACTIVE   PROBLEMS
</span></span><span style="display:flex"><span>output.logging.banzaicloud.io/http   <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>NAME                                        AGE
</span></span><span style="display:flex"><span>logging.logging.banzaicloud.io/quickstart   3m12s
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>NAME                                               AGE
</span></span><span style="display:flex"><span>fluentbitagent.logging.banzaicloud.io/quickstart   3m2s
</span></span></code></pre></div></div></div></li><li>
<p>Install the log-generator to produce logs labelled with: <code>app.kubernetes.io/name: log-generator</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --wait --namespace quickstart log-generator oci://ghcr.io/kube-logging/helm-charts/log-generator
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;log-generator&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>Pulled: ghcr.io/kube-logging/helm-charts/log-generator:0.7.0
</span></span><span style="display:flex"><span>Digest: sha256:0eba2c5c3adfc33deeec1d1612839cd1a0aa86f30022672ee022beab22436e04
</span></span><span style="display:flex"><span>NAME: log-generator
</span></span><span style="display:flex"><span>LAST DEPLOYED: Tue Aug <span style="color:#0000cf;font-weight:700">15</span> 16:21:40 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: quickstart
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>TEST SUITE: None
</span></span></code></pre></div><p>The log-generator application starts to create HTTP access logs. Logging operator collects these log messages and sends them to the test-receiver pod defined in the output custom resource.</p></li><li>
<p>Check that the logs are delivered to the test-receiver pod output. First, run the following command to get the name of the test-receiver pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl logs --namespace logging -f svc/logging-operator-test-receiver
</span></span></code></pre></div><p>The output should be similar to the following:</p><ul class="nav nav-tabs justify-content-end" id="tabs-11" role="tablist">
<li class="nav-item">
<a class="nav-link disabled" id="tabs-11-00-tab" data-toggle="tab" href="#tabs-11-00" role="tab" aria-controls="tabs-11-00" aria-selected="false">
<strong>Receiving logs</strong>:
</a>
</li><li class="nav-item">
<a class="nav-link active persistLang-syslog-ng" id="tabs-11-01-tab" data-toggle="tab" href="#tabs-11-01" role="tab" onclick='persistLang("syslog-ng")' aria-controls="tabs-11-01" aria-selected="false">
syslog-ng
</a>
</li><li class="nav-item">
<a class="nav-link persistLang-fluentd" id="tabs-11-02-tab" data-toggle="tab" href="#tabs-11-02" role="tab" onclick='persistLang("fluentd")' aria-controls="tabs-11-02" aria-selected="false">
Fluentd
</a>
</li></ul><div class="tab-content" id="tabs-11-content">
<div class="tab-body tab-pane fade" id="tabs-11-00" role="tabpanel" aria-labelled-by="tabs-11-00-tab">
</div><div class="tab-body tab-pane fade show active" id="tabs-11-01" role="tabpanel" aria-labelled-by="tabs-11-01-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>0<span style="color:#ce5c00;font-weight:700">]</span> http.0: <span style="color:#ce5c00;font-weight:700">[[</span>1692117678.581721054, <span style="color:#ce5c00;font-weight:700">{}]</span>, <span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;ts&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;2023-08-15T16:41:18.130862Z&#34;</span>, <span style="color:#4e9a06">&#34;time&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;2023-08-15T16:41:18.13086297Z&#34;</span>, <span style="color:#4e9a06">&#34;stream&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;stdout&#34;</span>, <span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;142.251.196.69 - - [15/Aug/2023:16:41:18 +0000] &#34;</span>PUT /index.html HTTP/1.1<span style="color:#4e9a06">&#34; 302 24666 &#34;</span>-<span style="color:#4e9a06">&#34; &#34;</span>Mozilla/5.0 <span style="color:#ce5c00;font-weight:700">(</span>Windows NT 6.1<span style="color:#000;font-weight:700">;</span> WOW64<span style="color:#ce5c00;font-weight:700">)</span> AppleWebKit/537.36 <span style="color:#ce5c00;font-weight:700">(</span>KHTML, like Gecko<span style="color:#ce5c00;font-weight:700">)</span> Chrome/54.0.2840.99 Safari/537.36<span style="color:#4e9a06">&#34; &#34;</span>-<span style="color:#4e9a06">&#34;&#34;</span>, <span style="color:#4e9a06">&#34;kubernetes&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;pod_name&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;log-generator-56b7dfb79-6v67b&#34;</span>, <span style="color:#4e9a06">&#34;pod_id&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;b7e8a5b2-9164-46d1-ba0a-8d142bdfb4cb&#34;</span>, <span style="color:#4e9a06">&#34;namespace_name&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;quickstart&#34;</span>, <span style="color:#4e9a06">&#34;labels&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;pod-template-hash&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;56b7dfb79&#34;</span>, <span style="color:#4e9a06">&#34;app.kubernetes.io/name&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;log-generator&#34;</span>, <span style="color:#4e9a06">&#34;app.kubernetes.io/instance&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;log-generator&#34;</span><span style="color:#ce5c00;font-weight:700">}</span>, <span style="color:#4e9a06">&#34;host&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;minikube&#34;</span>, <span style="color:#4e9a06">&#34;docker_id&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;fe60b1c0fdf97f062ed91e3a2074caf3ee3cb4f3d12844f2c6f5d8212419907d&#34;</span>, <span style="color:#4e9a06">&#34;container_name&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;log-generator&#34;</span>, <span style="color:#4e9a06">&#34;container_image&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;ghcr.io/kube-logging/log-generator:0.7.0&#34;</span>, <span style="color:#4e9a06">&#34;container_hash&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;ghcr.io/kube-logging/log-generator@sha256:e26102ef2d28201240fa6825e39efdf90dec0da9fa6b5aea6cf9113c0d3e93aa&#34;</span><span style="color:#ce5c00;font-weight:700">}}]</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id="tabs-11-02" role="tabpanel" aria-labelled-by="tabs-11-02-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>0<span style="color:#ce5c00;font-weight:700">]</span> http.0: <span style="color:#ce5c00;font-weight:700">[[</span>1692118483.267342676, <span style="color:#ce5c00;font-weight:700">{}]</span>, <span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;51.196.131.145 - - [15/Aug/2023:16:54:36 +0000] &#34;</span>PUT / HTTP/1.1<span style="color:#4e9a06">&#34; 200 7823 &#34;</span>-<span style="color:#4e9a06">&#34; &#34;</span>Mozilla/5.0 <span style="color:#ce5c00;font-weight:700">(</span>Windows NT 6.1<span style="color:#000;font-weight:700">;</span> Win64<span style="color:#000;font-weight:700">;</span> x64<span style="color:#ce5c00;font-weight:700">)</span> AppleWebKit/537.36 <span style="color:#ce5c00;font-weight:700">(</span>KHTML, like Gecko<span style="color:#ce5c00;font-weight:700">)</span> Chrome/54.0.2840.99 Safari/537.36<span style="color:#4e9a06">&#34; &#34;</span>-<span style="color:#4e9a06">&#34;&#34;</span>, <span style="color:#4e9a06">&#34;stream&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;stdout&#34;</span>, <span style="color:#4e9a06">&#34;time&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;2023-08-15T16:54:36.019636047Z&#34;</span>, <span style="color:#4e9a06">&#34;kubernetes&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;pod_name&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;log-generator-56b7dfb79-rrzsz&#34;</span>, <span style="color:#4e9a06">&#34;namespace_name&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;quickstart&#34;</span>, <span style="color:#4e9a06">&#34;pod_id&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;902dc881-af36-4054-b377-47e2d751e6cd&#34;</span>, <span style="color:#4e9a06">&#34;labels&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;app.kubernetes.io/instance&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;log-generator&#34;</span>, <span style="color:#4e9a06">&#34;app.kubernetes.io/name&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;log-generator&#34;</span>, <span style="color:#4e9a06">&#34;pod-template-hash&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;56b7dfb79&#34;</span><span style="color:#ce5c00;font-weight:700">}</span>, <span style="color:#4e9a06">&#34;host&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;minikube&#34;</span>, <span style="color:#4e9a06">&#34;container_name&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;log-generator&#34;</span>, <span style="color:#4e9a06">&#34;docker_id&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;7615c4c72d8fdd05137dc9845204d7ef681b750b6f2a6d27bd75190b12dc5d8e&#34;</span>, <span style="color:#4e9a06">&#34;container_hash&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;ghcr.io/kube-logging/log-generator@sha256:e26102ef2d28201240fa6825e39efdf90dec0da9fa6b5aea6cf9113c0d3e93aa&#34;</span>, <span style="color:#4e9a06">&#34;container_image&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;ghcr.io/kube-logging/log-generator:0.7.0&#34;</span><span style="color:#ce5c00;font-weight:700">}}]</span>
</span></span></code></pre></div></div></div><p>The log messages include the usual information of the access logs, and also Kubernetes-specific information like the pod name, labels, and so on.</p></li><li>
<p>(Optional) If you want to retry this guide with the other log forwarder on the same cluster, run the following command to delete the forwarder-specific resources:</p><ul class="nav nav-tabs justify-content-end" id="tabs-12" role="tablist">
<li class="nav-item">
<a class="nav-link disabled" id="tabs-12-00-tab" data-toggle="tab" href="#tabs-12-00" role="tab" aria-controls="tabs-12-00" aria-selected="false">
<strong>Log forwarder</strong>:
</a>
</li><li class="nav-item">
<a class="nav-link active persistLang-syslog-ng" id="tabs-12-01-tab" data-toggle="tab" href="#tabs-12-01" role="tab" onclick='persistLang("syslog-ng")' aria-controls="tabs-12-01" aria-selected="false">
syslog-ng
</a>
</li><li class="nav-item">
<a class="nav-link persistLang-fluentd" id="tabs-12-02-tab" data-toggle="tab" href="#tabs-12-02" role="tab" onclick='persistLang("fluentd")' aria-controls="tabs-12-02" aria-selected="false">
Fluentd
</a>
</li></ul><div class="tab-content" id="tabs-12-content">
<div class="tab-body tab-pane fade" id="tabs-12-00" role="tabpanel" aria-labelled-by="tabs-12-00-tab">
</div><div class="tab-body tab-pane fade show active" id="tabs-12-01" role="tabpanel" aria-labelled-by="tabs-12-01-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl delete logging quickstart
</span></span><span style="display:flex"><span>kubectl delete --namespace quickstart syslogngflow log-generator
</span></span><span style="display:flex"><span>kubectl delete --namespace quickstart syslogngoutput http
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id="tabs-12-02" role="tabpanel" aria-labelled-by="tabs-12-02-tab">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl delete logging quickstart
</span></span><span style="display:flex"><span>kubectl delete --namespace quickstart flow log-generator
</span></span><span style="display:flex"><span>kubectl delete --namespace quickstart output http
</span></span></code></pre></div></div></div></li></ol><h2 id="summary">Summary</h2><p>If you have completed this guide, you have made the following changes to your cluster:</p><ul>
<li>
<p>Installed the Fluent Bit agent on every node of the cluster to collect the logs and the labels from the node.</p></li><li>
<p>Installed syslog-ng or Fluentd on the cluster, to receive the logs from the Fluent Bit agents, and filter, parse, and transform them as needed, and to route the incoming logs to an output. To learn more about routing and filtering, see <a href="/5.1/docs/configuration/log-routing-syslog-ng/">Routing your logs with syslog-ng</a> or <a href="/5.1/docs/configuration/log-routing/">Routing your logs with Fluentd match directives</a>. - Created the following resources that configure Logging operator and the components it manages:</p><ul>
<li><code>Logging</code> to configure the logging infrastructure, like the details of the Fluent Bit and the syslog-ng or Fluentd deployment. To learn more about configuring the logging infrastructure, see <a href="/5.1/docs/logging-infrastructure/">Logging infrastructure setup</a>.</li><li><code>SyslogNGOutput</code> or <code>Output</code> to define an HTTP output that receives the collected messages. To learn more, see <a href="/5.1/docs/configuration/output/#syslogngoutput">syslog-ng outputs</a> or <a href="/5.1/docs/configuration/output/">Output and ClusterOutput</a>.</li><li><code>SyslogNGFlow</code> or <code>Flow</code> that processes the incoming messages and routes them to the appropriate output. To learn more, see <a href="/5.1/docs/configuration/flow/#syslogngflow">syslog-ng flows</a> or <a href="/5.1/docs/configuration/flow/">Flow and ClusterFlow</a>.</li></ul></li><li>
<p>Installed a simple receiver to act as the destination of the logs, and configured the log forwarder to send the logs from the <code>quickstart</code> namespace to this destination.</p></li><li>
<p>Installed a log-generator application to generate sample log messages, and verified that the logs of this application arrive to the output.</p></li></ul><h2 id="getting-support">Getting Support</h2><p>If you encounter any problems that the documentation does not address, <a href="https://github.com/kube-logging/logging-operator/issues">file an issue</a> or talk to us on <a href="https://discord.gg/9ACY4RDsYN">Discord</a> or on the <a href="/5.1/docs/community/">CNCF Slack</a>.</p><p>Before asking for help, prepare the following information to make troubleshooting faster:</p><ul>
<li>Logging operator version</li><li>kubernetes version</li><li>helm/chart version (if you installed the Logging operator with helm)</li><li>Logging operator logs</li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#check-fluentd-configuration">fluentd configuration</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#get-fluentd-logs">fluentd logs</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentbit/#check-the-fluent-bit-configuration">fluentbit configuration</a></li><li>fluentbit logs</li></ul><p>Do not forget to remove any sensitive information (for example, passwords and private keys) before sharing.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-96f42b3851e06e8878e5685bcce84b05">4 - Configure log routing</h1><p>You can configure the various features and parameters of the Logging operator using Custom Resource Definitions (CRDs).</p><p>The Logging operator manages the log collectors and log forwarders of your logging infrastructure, and the routing rules that specify where you want to send your different log messages.</p><p>The <strong>log collectors</strong> are endpoint agents that collect the logs of your Kubernetes nodes and send them to the log forwarders. Logging operator currently uses Fluent Bit as log collector agents.</p><p>The <strong>log forwarder</strong> (also called <strong>log aggregator</strong>) instance receives, filters, and transforms the incoming logs, and transfers them to one or more destination outputs. The Logging operator supports Fluentd and syslog-ng as log forwarders. Which log forwarder is best for you depends on your logging requirements. For tips, see <a href="/5.1/docs/configuration/fluentd-vs-syslog-ng/">Which log forwarder to use</a>.</p><p>You can filter and process the incoming log messages using the <a href="/5.1/docs/configuration/flow/"><strong>flow</strong></a> custom resource of the log forwarder to route them to the appropriate <a href="/5.1/docs/configuration/output/"><strong>output</strong></a>. The outputs are the destinations where you want to send your log messages, for example, Elasticsearch, or an Amazon S3 bucket. You can also define cluster-wide outputs and flows, for example, to use a centralized output that namespaced users can reference but cannot modify. Note that flows and outputs are specific to the type of log forwarder you use (Fluentd or syslog-ng).</p><p>You can configure the Logging operator using the following Custom Resource Definitions.</p><ul>
<li><a href="/5.1/docs/logging-infrastructure/logging/">logging</a> - The <code>logging</code> resource defines the logging infrastructure (the log collectors and forwarders) for your cluster that collects and transports your log messages. It can also contain configurations for Fluent Bit, Fluentd, and syslog-ng. (Starting with Logging operator version 4.5, you can also configure <a href="/5.1/docs/logging-infrastructure/fluentbit/">Fluent Bit</a>, <a href="/5.1/docs/logging-infrastructure/fluentd/">Fluentd</a>, and <a href="/5.1/docs/logging-infrastructure/syslog-ng/">syslog-ng</a> as separate resources.)</li><li>CRDs for Fluentd:
<ul>
<li><a href="/5.1/docs/configuration/output/">output</a> - Defines a Fluentd Output for a logging flow, where the log messages are sent using Fluentd. This is a namespaced resource. See also <code>clusteroutput</code>. To configure syslog-ng outputs, see <code>SyslogNGOutput</code>.</li><li><a href="/5.1/docs/configuration/flow/">flow</a> - Defines a Fluentd logging flow using <code>filters</code> and <code>outputs</code>. Basically, the flow routes the selected log messages to the specified outputs. This is a namespaced resource. See also <code>clusterflow</code>. To configure syslog-ng flows, see <code>SyslogNGFlow</code>.</li><li><a href="/5.1/docs/configuration/output/">clusteroutput</a> - Defines a Fluentd output that is available from all flows and clusterflows. The operator evaluates clusteroutputs in the <code>controlNamespace</code> only unless <code>allowClusterResourcesFromAllNamespaces</code> is set to true.</li><li><a href="/5.1/docs/configuration/flow/">clusterflow</a> - Defines a Fluentd logging flow that collects logs from all namespaces by default. The operator evaluates clusterflows in the <code>controlNamespace</code> only unless <code>allowClusterResourcesFromAllNamespaces</code> is set to true. To configure syslog-ng clusterflows, see <code>SyslogNGClusterFlow</code>.</li></ul></li><li>CRDs for syslog-ng (these resources like their Fluentd counterparts, but are tailored to features available via syslog-ng):
<ul>
<li><a href="/5.1/docs/configuration/output/#syslogngoutput">SyslogNGOutput</a> - Defines a syslog-ng Output for a logging flow, where the log messages are sent using syslog-ng. This is a namespaced resource. See also <code>SyslogNGClusterOutput</code>. To configure Fluentd outputs, see <code>output</code>.</li><li><a href="/5.1/docs/configuration/flow/#syslogngflow">SyslogNGFlow</a> - Defines a syslog-ng logging flow using <code>filters</code> and <code>outputs</code>. Basically, the flow routes the selected log messages to the specified outputs. This is a namespaced resource. See also <code>SyslogNGClusterFlow</code>. To configure Fluentd flows, see <code>flow</code>.</li><li><a href="/5.1/docs/configuration/output/#syslogngoutput">SyslogNGClusterOutput</a> - Defines a syslog-ng output that is available from all flows and clusterflows. The operator evaluates clusteroutputs in the <code>controlNamespace</code> only unless <code>allowClusterResourcesFromAllNamespaces</code> is set to true.</li><li><a href="/5.1/docs/configuration/flow/#syslogngflow">SyslogNGClusterFlow</a> - Defines a syslog-ng logging flow that collects logs from all namespaces by default. The operator evaluates clusterflows in the <code>controlNamespace</code> only unless <code>allowClusterResourcesFromAllNamespaces</code> is set to true. To configure Fluentd clusterflows, see <code>clusterflow</code>.</li></ul></li></ul><p>The following sections show examples on configuring the various components to configure outputs and to filter and route your log messages to these outputs. For a list of available CRDs, see <a href="/5.1/docs/configuration/crds/">Custom Resource Definitions</a>.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-c5c6ecdc3cc510bf60493ff486193ff0">4.1 - Which log forwarder to use</h1><p>The Logging operator supports <a href="https://www.fluentd.org/">Fluentd</a> and syslog-ng (via the <a href="https://axoflow.com/docs/axosyslog-core/">AxoSyslog syslog-ng distribution</a>) as log forwarders. The log forwarder instance receives, filters, and transforms the incoming logs, and transfers them to one or more destination outputs. Which one to use depends on your logging requirements.</p><p>The following points help you decide which forwarder to use.</p><ul>
<li>The forwarders support different outputs. If the output you want to use is supported by only one forwarder, use that.</li><li>If the volume of incoming log messages is high, use syslog-ng, as its multithreaded processing provides higher performance.</li><li>If you have many logging flows or need complex routing or log message processing, use syslog-ng.</li></ul><blockquote>
<p>Note: Depending on the log forwarder you choose, the CRDs you need to create and configure will differ.</p></blockquote><p>syslog-ng is supported only in Logging operator 4.0 or newer.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-ba978670e30a52baf4356021adabc84e">4.2 - Output and ClusterOutput</h1><p>Outputs are the destinations where your log forwarder sends the log messages, for example, to Sumo Logic, or to a file. Depending on which log forwarder you use, you have to configure different custom resources.</p><h2 id="fluentd-outputs">Fluentd outputs</h2><ul>
<li>The <code>Output</code> resource defines an output where your <strong>Fluentd</strong> Flows can send the log messages. The output is a <code>namespaced</code> resource which means only a <code>Flow</code> within the <em>same</em> namespace can access it. You can use <code>secrets</code> in these definitions, but they must also be in the same namespace.
Outputs are the final stage for a <code>logging flow</code>. You can define multiple <code>outputs</code> and attach them to multiple <code>flows</code>.</li><li><code>ClusterOutput</code> defines an Output <strong>without</strong> namespace restrictions. It is only evaluated in the <code>controlNamespace</code> by default unless <code>allowClusterResourcesFromAllNamespaces</code> is set to true.</li></ul><blockquote>
<p>Note: <code>Flow</code> can be connected to <code>Output</code> and <code>ClusterOutput</code>, but <code>ClusterFlow</code> can be attached only to <code>ClusterOutput</code>.</p></blockquote><ul>
<li>For the details of the supported output plugins, see <a href="/5.1/docs/configuration/plugins/outputs/">Fluentd outputs</a>.</li><li>For the details of <code>Output</code> custom resource, see <a href="/5.1/docs/configuration/crds/v1beta1/output_types/">OutputSpec</a>.</li><li>For the details of <code>ClusterOutput</code> custom resource, see <a href="/5.1/docs/configuration/crds/v1beta1/clusteroutput_types/">ClusterOutput</a>.</li></ul><h3 id="fluentd-s3-output-example">Fluentd S3 output example</h3><p>The following snippet defines an Amazon S3 bucket as an output.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">s3</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">aws_key_id</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3-secret</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">awsAccessKeyId</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">aws_sec_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3-secret</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">awsSecretAccessKey</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">s3_bucket</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-logging-bucket</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">s3_region</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eu-west-1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logs/${tag}/%Y/%m/%d/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_use_utc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="syslogngoutput">syslog-ng outputs</h2><ul>
<li>The <code>SyslogNGOutput</code> resource defines an output for <strong>syslog-ng</strong> where your SyslogNGFlows can send the log messages. The output is a <code>namespaced</code> resource which means only a <code>SyslogNGFlow</code> within the <em>same</em> namespace can access it. You can use <code>secrets</code> in these definitions, but they must also be in the same namespace.
Outputs are the final stage for a <code>logging flow</code>. You can define multiple <code>SyslogNGOutputs</code> and attach them to multiple <code>SyslogNGFlows</code>.</li><li><code>SyslogNGClusterOutput</code> defines a SyslogNGOutput <strong>without</strong> namespace restrictions. It is only evaluated in the <code>controlNamespace</code> by default unless <code>allowClusterResourcesFromAllNamespaces</code> is set to true.</li></ul><blockquote>
<p>Note: <code>SyslogNGFlow</code> can be connected to <code>SyslogNGOutput</code> and <code>SyslogNGClusterOutput</code>, but a <code>SyslogNGClusterFlow</code> can only be attached to a <code>SyslogNGClusterOutput</code>.</p></blockquote><h3 id="rfc5424-syslog-ng-output-example">RFC5424 syslog-ng output example</h3><p>The following example defines a simple <code>SyslogNGOutput</code> resource that sends the logs to the specified syslog server using the RFC5424 Syslog protocol in a TLS-encrypted connection.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">syslog-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslog</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">10.20.9.89</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">601</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">template</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;$(format-json
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">                --subkeys json.
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">                --exclude json.kubernetes.labels.*
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">                json.kubernetes.labels=literal($(format-flat-json --subkeys json.kubernetes.labels.)))\n&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tls</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">ca_file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">mountFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ca.crt</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">syslog-tls-cert</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">cert_file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">mountFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls.crt</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">syslog-tls-cert</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">key_file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">mountFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls.key</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">syslog-tls-cert</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">transport</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><ul>
<li>For the details of the supported output plugins, see <a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/">syslog-ng outputs</a>.</li><li>For the details of <code>SyslogNGOutput</code> custom resource, see <a href="/5.1/docs/configuration/crds/v1beta1/syslogng_output_types/">SyslogNGOutputSpec</a>.</li><li>For the details of <code>SyslogNGClusterOutput</code> custom resource, see <a href="/5.1/docs/configuration/crds/v1beta1/syslogng_clusteroutput_types/">SyslogNGClusterOutput</a>.</li></ul><h2 id="protected-flag-cluster-outputs">protected flag cluster outputs</h2><p>Since versions:</p><ul>
<li>4.7 for Fluentd</li><li>5.0 for Syslog-ng</li></ul><p>You can set the <code>protected</code> flag on a <code>ClusterOutput</code> and <code>SyslogNGClusterOutput</code>. This prevents namespaced <code>Flows</code> and <code>SyslogNGFlows</code> from sending logs to these outputs and only allows <code>ClusterFlows</code> and <code>SyslogNGClusterFlows</code> to reference it.</p><p>By default, <code>ClusterOutputs</code> can be referenced by any <code>Flow</code>. Setting the <code>protected</code> flag restricts this access to <code>ClusterFlows</code> only.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ClusterOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">protected-cluster-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">infra</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">protected</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">s3</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">aws_key_id</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3-secret</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">awsAccessKeyId</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">aws_sec_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3-secret</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">awsSecretAccessKey</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">s3_bucket</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-logging-bucket</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">s3_region</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eu-west-1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logs/${tag}/%Y/%m/%d/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_use_utc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-6d5ebd4108d840b1126282c775c2e0dd">4.3 - Flow and ClusterFlow</h1><p>Flows route the selected log messages to the specified outputs. Depending on which log forwarder you use, you can use different filters and outputs, and have to configure different custom resources.</p><h2 id="fluentd-flows">Fluentd flows</h2><p><code>Flow</code> defines a logging flow for <strong>Fluentd</strong> with <strong>filters</strong> and <strong>outputs</strong>.</p><p>The Flow is a <code>namespaced</code> resource, so only logs from the same namespaces are collected. You can specify <code>match</code> statements to select or exclude logs according to Kubernetes <code>labels</code>, container and host names. (Match statements are evaluated in the order they are defined and processed only until the first matching <code>select</code> or <code>exclude</code> rule applies.) For detailed examples on using the match statement, see <a href="/5.1/docs/configuration/log-routing/">log routing</a>.</p><p>You can define one or more <code>filters</code> within a Flow. Filters can perform various actions on the logs, for example, add additional data, transform the logs, or parse values from the records.
The filters in the flow are applied in the order in the definition. You can find the <a href="/5.1/docs/configuration/plugins/filters/">list of supported filters here</a>.</p><p>At the end of the Flow, you can attach one or more <a href="/5.1/docs/configuration/output/">outputs</a>, which may also be <code>Output</code> or <code>ClusterOutput</code> resources.</p><blockquote>
<p><code>Flow</code> resources are <code>namespaced</code>, the <code>selector</code> only select <code>Pod</code> logs within namespace.
<code>ClusterFlow</code> defines a Flow <strong>without</strong> namespace restrictions. It is also only effective in the <code>controlNamespace</code>.
<code>ClusterFlow</code> selects logs from <strong>ALL</strong> namespace.</p></blockquote><p>The following example transforms the log messages from the <code>default</code> namespace and sends them to an S3 output.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">parser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">remove_key_name_field</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">parse</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">tag_normaliser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${namespace_name}.${pod_name}.${container_name}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">s3-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><blockquote>
<p>Note: In a multi-cluster setup you cannot easily determine which cluster the logs come from. You can append your own labels to each log
using the <a href="/5.1/docs/configuration/plugins/filters/record_modifier/">record modifier filter</a>.</p></blockquote><ul>
<li>For the details of <code>Flow</code> custom resource, see <a href="/5.1/docs/configuration/crds/v1beta1/flow_types/">FlowSpec</a>.</li><li>For the details of <code>ClusterFlow</code> custom resource, see <a href="/5.1/docs/configuration/crds/v1beta1/clusterflow_types/">ClusterFlow</a>.</li><li>For details on selecting messages, see <a href="/5.1/docs/configuration/log-routing/">Routing your logs with Fluentd match directives</a></li><li>See the <a href="/5.1/docs/configuration/plugins/filters/">list of supported filters</a>.</li></ul><h2 id="syslogngflow">syslog-ng flows</h2><p><code>SyslogNGFlow</code> defines a logging flow for <strong>syslog-ng</strong> with <strong>filters</strong> and <strong>outputs</strong>.</p><p>syslog-ng is supported only in Logging operator 4.0 or newer.</p><p>The Flow is a <code>namespaced</code> resource, so only logs from the same namespaces are collected. You can specify <code>match</code> statements to select or exclude logs according to Kubernetes <code>labels</code>, container and host names. For detailed examples on using the match statement, see <a href="/5.1/docs/configuration/log-routing-syslog-ng/">log routing with syslog-ng</a>.</p><p>You can define one or more filters within a Flow. Filters can perform various actions on the logs, for example, add additional data, transform the logs, or parse values from the records.
The filters in the flow are applied in the order in the definition. You can find the <a href="/5.1/docs/configuration/plugins/syslog-ng-filters/">list of supported filters here</a>.</p><p>At the end of the Flow, you can attach one or more <a href="/5.1/docs/configuration/output/">outputs</a>, which may also be <code>Output</code> or <code>ClusterOutput</code> resources.</p><blockquote>
<p><code>SyslogNGFlow</code> resources are <code>namespaced</code>, the <code>selector</code> only selects <code>Pod</code> logs within the namespace.
<code>SyslogNGClusterFlow</code> defines a SyslogNGFlow <strong>without</strong> namespace restrictions. It is also only effective in the <code>controlNamespace</code>.
<code>SyslogNGClusterFlow</code> selects logs from <strong>ALL</strong> namespaces.</p></blockquote><p>The following example selects only messages sent by the log-generator application and forwards them to a syslog output.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">TestFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">and</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">syslog-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><ul>
<li>For the details of the <code>SyslogNGFlow</code> custom resource, see <a href="/5.1/docs/configuration/crds/v1beta1/syslogng_flow_types/">SyslogNGFlowSpec</a>.</li><li>For the details of the <code>SyslogNGClusterFlow</code> custom resource, see <a href="/5.1/docs/configuration/crds/v1beta1/syslogng_clusterflow_types/">SyslogNGClusterFlow</a>.</li><li>For details on selecting messages, see <a href="/5.1/docs/configuration/log-routing-syslog-ng/">Routing your logs with syslog-ng</a></li><li>See the <a href="/5.1/docs/configuration/plugins/syslog-ng-filters/">list of supported filters</a>.</li></ul></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-b31cd9cdcf163cc38c88156ce33e62f1">4.4 - Routing your logs with Fluentd match directives</h1><blockquote>
<p>Note: This page describes routing logs with <strong>Fluentd</strong>. If you are using syslog-ng to route your log messages, see <a href="/5.1/docs/configuration/log-routing-syslog-ng/">Routing your logs with syslog-ng</a>.</p></blockquote><p>The first step to process your logs is to select which logs go where.
The Logging operator uses Kubernetes labels, namespaces and other metadata
to separate different log flows.</p><p>Available routing metadata keys:</p><table>
<thead>
<tr>
<th>Name</th><th>Type</th><th>Description</th><th>Empty</th></tr></thead><tbody>
<tr>
<td>namespaces</td><td>[]string</td><td>List of matching namespaces</td><td>All namespaces</td></tr><tr>
<td>labels</td><td>map[string]string</td><td>Key - Value pairs of labels</td><td>All labels</td></tr><tr>
<td>hosts</td><td>[]string</td><td>List of matching hosts</td><td>All hosts</td></tr><tr>
<td>container_names</td><td>[]string</td><td>List of matching containers (not Pods)</td><td>All containers</td></tr></tbody></table><h2 id="match-statement">Match statement</h2><p>To select or exclude logs you can use the <code>match</code> statement. Match is a collection
of <code>select</code> and <code>exclude</code> expressions. In both expression you can use the <code>labels</code>
attribute to filter for pod&rsquo;s labels. Moreover, in Cluster flow you can use <code>namespaces</code>
as a selecting or excluding criteria.</p><p>If you specify more than one label in a <code>select</code> or <code>exclude</code> expression, the labels have a logical AND connection between them. For example, an <code>exclude</code> expression with two labels excludes messages that have both labels. If you want an OR connection between labels, list them in separate expressions. For example, to exclude messages that have one of two specified labels, create a separate <code>exclude</code> expression for each label.</p><p>The <code>select</code> and <code>exclude</code> statements are evaluated <strong>in order</strong>!</p><p>Without at least one <code>select</code> criteria, no messages will be selected!</p><p>Flow:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">exclude</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">exclude-this</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">label</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">label/xxx</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>ClusterFlow:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ClusterFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">exclude</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">exclude-this</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">label</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">namespaces</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#000">developer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">label/xxx</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">namespaces</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#000">production</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#000">beta</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="examples">Examples</h2><h3 id="example-0-select-all-logs">Example 0. Select all logs</h3><p>To select all logs, or if you only want to exclude some logs but retain others you need an empty select statement.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">forward-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="example-1-select-logs-by-label">Example 1. Select logs by label</h3><p>Select logs with <code>app: nginx</code> labels from the namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">forward-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="example-2-exclude-logs-by-label">Example 2. Exclude logs by label</h3><p>Exclude logs with <code>app: nginx</code> labels from the namespace</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">forward-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">exclude</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="example-3-exclude-and-select-logs-by-label">Example 3. Exclude and select logs by label</h3><p>Select logs with <code>app: nginx</code> labels from the <code>default</code> namespace but exclude logs with <code>env: dev</code> labels</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">forward-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">exclude</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">env</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dev</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="example-4-exclude-cluster-logs-by-namespace">Example 4. Exclude cluster logs by namespace</h3><p>Select <code>app: nginx</code> from all namespaces except from <code>dev</code> and <code>sandbox</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ClusterFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">clusterflow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">globalOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">forward-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">exclude</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">namespaces</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">dev</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">sandbox</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="example-5-exclude-and-select-cluster-logs-by-namespace">Example 5. Exclude and select cluster logs by namespace</h3><p>Select <code>app: nginx</code> from all <code>prod</code> and <code>infra</code> namespaces but exclude cluster logs from <code>dev</code>, <code>sandbox</code> namespaces</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ClusterFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">clusterflow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">globalOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">forward-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">exclude</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">namespaces</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">dev</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">sandbox</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">namespaces</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">prod</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">infra</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="example-6-multiple-labels---and">Example 6. Multiple labels - AND</h3><p>Exclude logs that have both the <code>app: nginx</code> and <code>app.kubernetes.io/instance: nginx-demo</code> labels</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">forward-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">exclude</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app.kubernetes.io/instance</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx-demo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="example-6-multiple-labels---or">Example 6. Multiple labels - OR</h3><p>Exclude logs that have either the <code>app: nginx</code> or the <code>app.kubernetes.io/instance: nginx-demo</code> labels</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">forward-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">exclude</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">exclude</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app.kubernetes.io/instance</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx-demo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-1af6b8a7150b57e6f6af4991d03afabf">4.5 - Routing your logs with syslog-ng</h1><blockquote>
<p>Note: This page describes routing logs with <strong>syslog-ng</strong>. If you are using Fluentd to route your log messages, see <a href="/5.1/docs/configuration/log-routing/">Routing your logs with Fluentd match directives</a>.</p></blockquote><p>syslog-ng is supported only in Logging operator 4.0 or newer.</p><p>The first step to process your logs is to select which logs go where.</p><p>The <code>match</code> field of the <code>SyslogNGFlow</code> and <code>SyslogNGClusterFlow</code> resources define the routing rules of the logs.</p><blockquote>
<p>Note: Fluentd can use only metadata to route the logs. When using <a href="https://axoflow.com/docs/axosyslog-core/chapter-routing-filters/filters/">syslog-ng filter expressions</a>, you can filter both on metadata and log content as well.</p><p>The syntax of syslog-ng match statements is slightly different from the Fluentd match statements.</p></blockquote><p>Available routing metadata keys:</p><table>
<thead>
<tr>
<th>Name</th><th>Type</th><th>Description</th><th>Empty</th></tr></thead><tbody>
<tr>
<td>namespaces</td><td>[]string</td><td>List of matching namespaces</td><td>All namespaces</td></tr><tr>
<td>labels</td><td>map[string]string</td><td>Key - Value pairs of labels</td><td>All labels</td></tr><tr>
<td>hosts</td><td>[]string</td><td>List of matching hosts</td><td>All hosts</td></tr><tr>
<td>container_names</td><td>[]string</td><td>List of matching containers (not Pods)</td><td>All containers</td></tr></tbody></table><h2 id="match-statement">Match statement</h2><p>Match expressions select messages by applying patterns on the content or metadata of the messages. You can use simple string matching, and also complex regular expressions. You can combine matches using the <code>and</code>, <code>or</code>, and <code>not</code> boolean operators to create complex expressions to select or exclude messages as needed for your use case.</p><p>Currently, only a pattern matching function is supported (called <a href="https://axoflow.com/docs/axosyslog-core/chapter-routing-filters/filters/reference-filters/filter-match/"><code>match</code></a> in syslog-ng parlance, but renamed to <code>regexp</code> in the CRD to avoid confusion).</p><p>The <code>match</code> field can have one of the following options:</p><ul>
<li>
<p><code>regexp</code>: A pattern that matches the value of a field or a templated value. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;parameters&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p><code>and</code>: Combines the nested match expressions with the logical AND operator.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">and</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;list of nested match expressions&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p><code>or</code>: Combines the nested match expressions with the logical OR operator.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">or</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;list of nested match expressions&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p><code>not</code>: Matches the logical NOT of the nested match expressions with the logical AND operator.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">not</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;list of nested match expressions&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li></ul><h2 id="regexp-patterns"><code>regexp</code> patterns</h2><p>The <code>regexp</code> field (called <a href="https://axoflow.com/docs/axosyslog-core/chapter-routing-filters/filters/reference-filters/filter-match/"><code>match</code></a> in syslog-ng parlance, but renamed to <code>regexp</code> in the CRD to avoid confusion) defines the pattern that selects the matching messages. You can do two different kinds of matching:</p><ul>
<li>Find a pattern in the value of a field of the messages, for example, to select the messages of a specific application. To do that, set the <code>pattern</code> and <code>value</code> fields (and optionally the <code>type</code> and <code>flags</code> fields).</li><li>Find a pattern in a template expression created from multiple fields of the message. To do that, set the <code>pattern</code> and <code>template</code> fields (and optionally the <code>type</code> and <code>flags</code> fields).</li></ul><div class="warning-block">
<p><strong>CAUTION:</strong></p>You need to use the <code>json.</code> prefix in field names.
</div><p>You can reference fields using the <em>dot notation</em>. For example, if the log contains <code>{"kubernetes": {"namespace_name": "default"}}</code>, then you can reference the <code>namespace_name</code> field using <code>json.kubernetes.namespace_name</code>.</p><p>The following example filters for specific Pod labels:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">and</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="regexp-parameters"><code>regexp</code> parameters</h2><p>The <code>regexp</code> field can have the following parameters:</p><h3 id="regexp-pattern" class="property-required"><code>pattern</code> (string)</h3><p>Defines the pattern to match against the messages. The <a href="#regexp-type"><code>type</code> field</a> determines how the pattern is interpreted (for example, string or regular expression).</p><h3 id="regexp-value" class="property-optional"><code>value</code> (string)</h3><p>References a field of the message. The <code>pattern</code> is applied to the value of this field. If the <code>value</code> field is set, you cannot use the <code>template</code> field. When matching for labels or annotations, the available labels and annotations depend on the incoming message received from the log collector agent. See this <a href="https://kubernetes.io/docs/reference/labels-annotations-taints/">list of common Kubernetes labels and annotations</a> for details.</p><div class="warning-block">
<p><strong>CAUTION:</strong></p>You need to use the <code>json.</code> prefix in field names.
</div><p>You can reference fields using the <em>dot notation</em>. For example, if the log contains <code>{"kubernetes": {"namespace_name": "default"}}</code>, then you can reference the <code>namespace_name</code> field using <code>json.kubernetes.namespace_name</code>.</p><p>For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="regexp-template" class="property-optional"><code>template</code> (string)</h3><p>Specifies a template expression that combines fields. The <code>pattern</code> is matched against the value of these combined fields. If the <code>template</code> field is set, you cannot use the <code>value</code> field. For details on template expressions, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/customizing-message-format/configuring-macros/">syslog-ng documentation</a>.</p><h3 id="regexp-type" class="property-optional"><code>type</code> (string)</h3><p>Specifies how the <code>pattern</code> is interpreted. For details, see <a href="#regexp-types">Types of <code>regexp</code></a>.</p><h3 id="regexp-flags" class="property-optional"><code>flags</code> (list)</h3><p>Specifies flags for the <code>type</code> field.</p><h2 id="regexp-types"><code>regexp</code> types</h2><p>By default, syslog-ng uses PCRE-style regular expressions. Since evaluating complex regular expressions can greatly increase CPU usage and are not always needed, you can following expression types:</p><ul>
<li><a href="#pcre">Perl Compatible Regular Expressions (PCRE)</a></li><li><a href="#string">Literal string searches</a></li><li><a href="#glob">Glob patterns</a> (without regular expression support)</li></ul><h3 id="pcre"><code>pcre</code></h3><p>Description: Use Perl Compatible Regular Expressions (PCRE). If the <code>type()</code> parameter is not specified, syslog-ng uses PCRE regular expressions by default.</p><h3 id="pcre-flags"><code>pcre</code> flags</h3><p>PCRE regular expressions have the following flag options:</p><ul>
<li>
<p><code>disable-jit</code>: Disable the <a href="https://www.pcre.org/current/doc/html/pcre2jit.html">just-in-time compilation function</a> for PCRE regular expressions.</p></li><li>
<p><code>dupnames</code>: Allow using <a href="https://www.pcre.org/original/doc/html/pcrepattern.html#SEC16">duplicate names for named subpatterns</a>.</p></li><li>
<p><code>global</code>: Usable only in rewrite rules: match for every occurrence of the expression, not only the first one.</p></li><li>
<p><code>ignore-case</code>: Disable case-sensitivity.</p></li><li>
<p><code>newline</code>: When configured, it changes the newline definition used in PCRE regular expressions to accept either of the following:</p><ul>
<li>a single carriage-return</li><li>linefeed</li><li>the sequence carriage-return and linefeed (\r, \n and \r\n, respectively)</li></ul><p>This newline definition is used when the circumflex and dollar patterns (^ and $) are matched against an input. By default, PCRE interprets the linefeed character as indicating the end of a line. It does not affect the \r, \n or \R characters used in patterns.</p></li><li>
<p><code>store-matches</code>: Store the matches of the regular expression into the $0, &mldr; $255 variables. The $0 stores the entire match, $1 is the first group of the match (parentheses), and so on. Named matches (also called named subpatterns), for example (<code>?&lt;name>...</code>), are stored as well. Matches from the last filter expression can be referenced in regular expressions.</p></li><li>
<p><code>unicode</code>: Use Unicode support for UTF-8 matches. UTF-8 character sequences are handled as single characters.</p></li><li>
<p><code>utf8</code>: An alias for the unicode flag.</p></li></ul><p>For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">and</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">flag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ignore-case</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/regular-expressions/reference-regexp-types/regexp-flags-options/regexp-flags-options-pcre/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="string"><code>string</code></h3><p>Description: Match the strings literally, without regular expression support. By default, only identical strings are matched. For partial matches, use the <code>flags: prefix</code> or <code>flags: substring</code> flags. For example, if the consider the following patterns.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">and</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">flag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">prefix</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">flag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">substring</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><ul>
<li>The first matches only the <code>log-generator</code> label.</li><li>The second matches labels beginning with <code>log-generator</code>, for example, <code>log-generator-1</code>.</li><li>The third one matches labels that contain the <code>log-generator</code> string, for example, <code>my-log-generator</code>.</li></ul><h3 id="string-flags"><code>string</code> flags</h3><p>Literal string searches have the following <code>flags()</code> options:</p><ul>
<li>
<p><code>global</code>: Usable only in rewrite rules, match for every occurrence of the expression, not only the first one.</p></li><li>
<p><code>ignore-case</code>: Disables case-sensitivity.</p></li><li>
<p><code>prefix</code>: During the matching process, patterns (also called search expressions) are matched against the input string starting from the beginning of the input string, and the input string is matched only for the maximum character length of the pattern. The initial characters of the pattern and the input string must be identical in the exact same order, and the pattern&rsquo;s length is definitive for the matching process (that is, if the pattern is longer than the input string, the match will fail).</p><p>For example, for the input string <code>exam</code>:</p><ul>
<li>the following patterns will match:
<ul>
<li><code>ex</code> (the pattern contains the initial characters of the input string in the exact same order)</li><li><code>exam</code> (the pattern is an exact match for the input string)</li></ul></li><li>the following patterns will not match:
<ul>
<li><code>example</code> (the pattern is longer than the input string)</li><li><code>hexameter</code> (the pattern&rsquo;s initial characters do not match the input string&rsquo;s characters in the exact same order, and the pattern is longer than the input string)</li></ul></li></ul></li><li>
<p><code>store-matches</code>: Stores the matches of the regular expression into the $0, &mldr; $255 variables. The $0 stores the entire match, $1 is the first group of the match (parentheses), and so on. Named matches (also called named subpatterns), for example, (<code>?&lt;name>...</code>), are stored as well. Matches from the last filter expression can be referenced in regular expressions.</p><blockquote>
<p>NOTE: To convert match variables into a syslog-ng list, use the <code>$*</code> macro, which can be further manipulated using <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/customizing-message-format/reference-template-functions/#template-function-list">List manipulation</a>, or turned into a list in type-aware destinations.</p></blockquote></li><li>
<p><code>substring</code>: The given literal string will match when the pattern is found within the input. Unlike <code>flags: prefix</code>, the pattern does not have to be identical with the given literal string.</p></li></ul><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/regular-expressions/reference-regexp-types/regexp-flags-options/regexp-flags-options-string/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="glob"><code>glob</code></h3><p>Description: Match the strings against a pattern containing &lsquo;*&rsquo; and &lsquo;?&rsquo; wildcards, without regular expression and character range support. The advantage of glob patterns to regular expressions is that globs can be processed much faster.</p><ul>
<li><code>*</code>: matches an arbitrary string, including an empty string</li><li><code>?</code>: matches an arbitrary character</li></ul><blockquote>
<p>NOTE:</p><ul>
<li>The wildcards can match the <code>/</code> character.</li><li>You cannot use the <code>*</code> and <code>?</code> characters literally in the pattern.</li></ul></blockquote><p>Glob patterns cannot have any flags.</p><h2 id="examples">Examples</h2><h3 id="select-all-logs">Select all logs</h3><p>To select all logs, or if you only want to exclude some logs but retain others you need an empty select statement.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-all</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">glob</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">syslog-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="select-logs-by-label">Select logs by label</h3><p>Select logs with <code>app: nginx</code> labels from the namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-app-nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">glob</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">syslog-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="exclude-logs-by-label">Exclude logs by label</h3><p>Exclude logs with <code>app: nginx</code> labels from the namespace.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-not-nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">not</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">glob</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">syslog-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="exclude-and-select-logs-by-label">Exclude and select logs by label</h3><p>Exclude logs with <code>env: dev</code> labels but select <code>app: nginx</code> labels from the namespace.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-not-nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">and</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">glob</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">not</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/env</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dev</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">glob</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">syslog-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><!--### Exclude cluster logs by namespace

Exclude cluster logs from the `dev`, `sandbox` namespaces and select `app: nginx` from all namespaces

```yaml
apiVersion: logging.banzaicloud.io/v1beta1
kind: SyslogNGClusterFlow
metadata:
  name: clusterflow-sample
spec:
  globalOutputRefs:
    - forward-output-sample
  match:
    - exclude:
        namespaces:
          - dev
          - sandbox
    - select:
        labels:
          app: nginx
```

### Exclude and select cluster logs by namespace

Exclude cluster logs from  `dev`, `sandbox` namespaces and select `app: nginx` from all `prod` and `infra` namespaces

  ```yaml
  apiVersion: logging.banzaicloud.io/v1beta1
  kind: ClusterFlow
  metadata:
    name: clusterflow-sample
  spec:
    globalOutputRefs:
      - forward-output-sample
    match:
      - exclude:
          namespaces:
            - dev
            - sandbox
      - select:
          labels:
            app: nginx
          namespaces:
            - prod
            - infra
  ```
--><h3 id="multiple-labels---and">Multiple labels - AND</h3><p>Exclude logs that have both the <code>app: nginx</code> and <code>app.kubernetes.io/instance: nginx-demo</code> labels.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">forward-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">not</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">and</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">glob</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx-demo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">glob</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="multiple-labels---or">Multiple labels - OR</h3><p>Exclude logs that have either the <code>app: nginx</code> or the <code>app.kubernetes.io/instance: nginx-demo</code> labels</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">forward-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">not</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">or</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">glob</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/instance</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx-demo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">glob</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-ac7f8f2de0bfec29f800c2742a2d0127">4.6 - Kubernetes events, node logs, and logfiles</h1><p>The Logging extensions part of the Logging operator solves the following problems:</p><ul>
<li>Collect Kubernetes events to provide insight into what is happening inside a cluster, such as decisions made by the scheduler, or why some pods were evicted from the node.</li><li>Collect logs from the nodes like <code>kubelet</code> logs.</li><li>Collect logs from files on the nodes, for example, <code>audit</code> logs, or the <code>systemd</code> journal.</li><li>Collect logs from legacy application log files.</li></ul><p>Starting with Logging operator version 3.17.0, logging-extensions are open source and part of Logging operator.</p><h2 id="features">Features</h2><p>Logging-operator handles the new features the well-known way: it uses custom resources to access the features. This way a simple <code>kubectl apply</code> with a particular parameter set initiates a new feature. Extensions supports three different custom resource types:</p><ul>
<li><a href="/5.1/docs/configuration/extensions/kubernetes-event-tailer/">Event-tailer</a> listens for Kubernetes events and transmits their changes to stdout, so the Logging operator can process them.</li><li><a href="/5.1/docs/configuration/extensions/kubernetes-host-tailer/">Host-tailer</a> tails custom files and transmits their changes to stdout. This way the Logging operator can process them.
Kubernetes host tailer allows you to tail logs like <code>kubelet</code>, <code>audit</code> logs, or the <code>systemd</code> journal from the nodes.</li><li><a href="/5.1/docs/configuration/extensions/tailer-webhook/">Tailer-webhook</a> is a different approach for the same problem: parsing legacy application&rsquo;s log file. Instead of running a <code>host-tailer</code> instance on every node, <code>tailer-webhook</code> attaches a <code>sidecar container</code> to the pod, and reads the specified file(s).</li></ul><blockquote>
<p>Check our <a href="https://github.com/kube-logging/logging-operator/tree/master/config/samples/extensions">configuration snippets</a> for examples.</p></blockquote></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-04413fd144b07886f11cf231a5113cbc">4.6.1 - Kubernetes Event Tailer</h1><p>Kubernetes events are objects that provide insight into what is happening inside a cluster, such as what decisions were made by the scheduler or why some pods were evicted from the node. Event tailer listens for Kubernetes events and transmits their changes to stdout, so the Logging operator can process them.</p><p><img src="../logging-extensions-event-tailer.png" alt="Event tailer"></p><p>The operator handles this CR and generates the following required resources:</p><ul>
<li>ServiceAccount: new account for <code>event-tailer</code></li><li>ClusterRole: sets the <code>event-tailer's</code> roles</li><li>ClusterRoleBinding: links the account with the roles</li><li>ConfigMap: contains the configuration for the <code>event-tailer</code> pod</li><li>StatefulSet: manages the lifecycle of the <code>event-tailer</code> pod, which uses the <code>banzaicloud/eventrouter:v0.1.0</code> image to tail events</li></ul><h2 id="create-event-tailer">Create event tailer</h2><ol>
<li>
<p>The simplest way to init an <code>event-tailer</code> is to create a new <code>event-tailer</code> resource with a <code>name</code> and <code>controlNamespace</code> field specified. The following command creates an event tailer called <code>sample</code>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: logging-extensions.banzaicloud.io/v1alpha1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: EventTailer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: sample
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  controlNamespace: default
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div></li><li>
<p>Check that the new object has been created by running:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl get eventtailer
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>NAME     AGE
</span></span><span style="display:flex"><span>sample   22m
</span></span></code></pre></div></li><li>
<p>You can see the events in JSON format by checking the log of the <code>event-tailer</code> pod. This way Logging operator can collect the events, and handle them as any other log. Run:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl logs -l app.kubernetes.io/instance<span style="color:#ce5c00;font-weight:700">=</span>sample-event-tailer <span style="color:#000;font-weight:700">|</span> head -1 <span style="color:#000;font-weight:700">|</span> jq
</span></span></code></pre></div><p>The output should be similar to:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;verb&#34;</span>: <span style="color:#4e9a06">&#34;UPDATED&#34;</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;event&#34;</span>: <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;metadata&#34;</span>: <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;name&#34;</span>: <span style="color:#4e9a06">&#34;kube-scheduler-kind-control-plane.17145dad77f0e528&#34;</span>,
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;namespace&#34;</span>: <span style="color:#4e9a06">&#34;kube-system&#34;</span>,
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;uid&#34;</span>: <span style="color:#4e9a06">&#34;c2416fa6-7b7f-4a7d-a5f1-b2f2241bd599&#34;</span>,
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;resourceVersion&#34;</span>: <span style="color:#4e9a06">&#34;424&#34;</span>,
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;creationTimestamp&#34;</span>: <span style="color:#4e9a06">&#34;2022-09-13T08:19:22Z&#34;</span>,
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;managedFields&#34;</span>: <span style="color:#ce5c00;font-weight:700">[</span>
</span></span><span style="display:flex"><span>        <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>          <span style="color:#4e9a06">&#34;manager&#34;</span>: <span style="color:#4e9a06">&#34;kube-controller-manager&#34;</span>,
</span></span><span style="display:flex"><span>          <span style="color:#4e9a06">&#34;operation&#34;</span>: <span style="color:#4e9a06">&#34;Update&#34;</span>,
</span></span><span style="display:flex"><span>          <span style="color:#4e9a06">&#34;apiVersion&#34;</span>: <span style="color:#4e9a06">&#34;v1&#34;</span>,
</span></span><span style="display:flex"><span>          <span style="color:#4e9a06">&#34;time&#34;</span>: <span style="color:#4e9a06">&#34;2022-09-13T08:19:22Z&#34;</span>
</span></span><span style="display:flex"><span>        <span style="color:#ce5c00;font-weight:700">}</span>
</span></span><span style="display:flex"><span>      <span style="color:#ce5c00;font-weight:700">]</span>
</span></span><span style="display:flex"><span>    <span style="color:#ce5c00;font-weight:700">}</span>,
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;involvedObject&#34;</span>: <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;kind&#34;</span>: <span style="color:#4e9a06">&#34;Pod&#34;</span>,
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;namespace&#34;</span>: <span style="color:#4e9a06">&#34;kube-system&#34;</span>,
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;name&#34;</span>: <span style="color:#4e9a06">&#34;kube-scheduler-kind-control-plane&#34;</span>,
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;uid&#34;</span>: <span style="color:#4e9a06">&#34;7bd2c626-84f2-49c3-8e8e-8a7c0514b686&#34;</span>,
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;apiVersion&#34;</span>: <span style="color:#4e9a06">&#34;v1&#34;</span>,
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;resourceVersion&#34;</span>: <span style="color:#4e9a06">&#34;322&#34;</span>
</span></span><span style="display:flex"><span>    <span style="color:#ce5c00;font-weight:700">}</span>,
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;reason&#34;</span>: <span style="color:#4e9a06">&#34;NodeNotReady&#34;</span>,
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;message&#34;</span>: <span style="color:#4e9a06">&#34;Node is not ready&#34;</span>,
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;source&#34;</span>: <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>      <span style="color:#4e9a06">&#34;component&#34;</span>: <span style="color:#4e9a06">&#34;node-controller&#34;</span>
</span></span><span style="display:flex"><span>    <span style="color:#ce5c00;font-weight:700">}</span>,
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;firstTimestamp&#34;</span>: <span style="color:#4e9a06">&#34;2022-09-13T08:19:22Z&#34;</span>,
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;lastTimestamp&#34;</span>: <span style="color:#4e9a06">&#34;2022-09-13T08:19:22Z&#34;</span>,
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;count&#34;</span>: 1,
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;type&#34;</span>: <span style="color:#4e9a06">&#34;Warning&#34;</span>,
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;eventTime&#34;</span>: null,
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;reportingComponent&#34;</span>: <span style="color:#4e9a06">&#34;&#34;</span>,
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;reportingInstance&#34;</span>: <span style="color:#4e9a06">&#34;&#34;</span>
</span></span><span style="display:flex"><span>  <span style="color:#ce5c00;font-weight:700">}</span>,...
</span></span></code></pre></div></li><li>
<p>Once you have an <code>event-tailer</code>, you can bind your events to a specific logging flow. The following example configures a flow to route the previously created <code>sample-eventtailer</code> to the <code>sample-output</code>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: logging.banzaicloud.io/v1beta1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: Flow
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: eventtailer-flow
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  namespace: default
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  filters:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  - tag_normaliser: {}
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  match:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  # keeps data matching to label, the rest of the data will be discarded by this flow implicitly
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  - select:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      labels:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        app.kubernetes.io/name: sample-event-tailer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  outputRefs:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - sample-output
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div></li></ol><h2 id="delete-event-tailer">Delete event tailer</h2><p>To remove an unwanted tailer, delete the related <code>event-tailer</code> custom resource. This terminates the <code>event-tailer</code> pod. For example, run the following command to delete the event tailer called <code>sample</code>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl delete eventtailer sample <span style="color:#ce5c00;font-weight:700">&amp;&amp;</span> kubectl get pod
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>eventtailer.logging-extensions.banzaicloud.io <span style="color:#4e9a06">&#34;sample&#34;</span> deleted
</span></span><span style="display:flex"><span>NAME                    READY   STATUS        RESTARTS   AGE
</span></span><span style="display:flex"><span>sample-event-tailer-0   1/1     Terminating   <span style="color:#0000cf;font-weight:700">0</span>          12s
</span></span></code></pre></div><h2 id="persist-event-logs">Persist event logs</h2><p>Event-tailer supports persist mode. In this case, the logs generated from events are stored on a persistent volume. Add the following configuration to your event-tailer spec. In this example, the event tailer is called <code>sample</code>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: logging-extensions.banzaicloud.io/v1alpha1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: EventTailer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: sample
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  controlNamespace: default
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  positionVolume:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    pvc:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        accessModes:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">          - ReadWriteOnce
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        resources:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">          requests:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">            storage: 1Gi
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        volumeMode: Filesystem
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><p>Logging operator manages the persistent volume of event-tailer automatically, you don&rsquo;t have any further task with it. To check that the persistent volume has been created, run:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl get pvc <span style="color:#ce5c00;font-weight:700">&amp;&amp;</span> kubectl get pv
</span></span></code></pre></div><p>The output should be similar to:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>NAME                                        STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
</span></span><span style="display:flex"><span>sample-event-tailer-sample-event-tailer-0   Bound    pvc-6af02cb2-3a62-4d24-8201-dc749034651e   1Gi        RWO            standard       43s
</span></span><span style="display:flex"><span>NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                               STORAGECLASS   REASON   AGE
</span></span><span style="display:flex"><span>pvc-6af02cb2-3a62-4d24-8201-dc749034651e   1Gi        RWO            Delete           Bound    default/sample-event-tailer-sample-event-tailer-0   standard                42s
</span></span></code></pre></div><h2 id="configuration-options">Configuration options</h2><p>For the detailed list of configuration options, see the <a href="/5.1/docs/configuration/crds/extensions/eventtailer_types/">EventTailer CRD reference</a>.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-18c73f8f2b09bffa26f060f563c9b14a">4.6.2 - Kubernetes host logs, journals, and logfiles</h1><p>Kubernetes host tailer allows you to tail logs like <code>kubelet</code>, <code>audit</code> logs, or the <code>systemd</code> journal from the nodes.</p><p><img src="../logging-extensions-host-tailer.png" alt="Host-tailer"></p><h2 id="create-host-tailer">Create host tailer</h2><p>To tail logs from the node&rsquo;s host filesystem, define one or more file tailers in the <code>host-tailer</code> configuration.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: logging-extensions.banzaicloud.io/v1alpha1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: HostTailer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: multi-sample
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  # list of File tailers
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  fileTailers:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - name: nginx-access
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      path: /var/log/nginx/access.log
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - name: nginx-error
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      path: /var/log/nginx/error.log
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  # list of Systemd tailers
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  systemdTailers:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - name: my-systemd-tailer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      maxEntries: 100
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      systemdFilter: kubelet.service
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><h2 id="create-file-tailer">Create file tailer</h2><p>When an application (mostly legacy programs) is not logging in a Kubernetes-native way, Logging operator cannot process its logs. (For example, an old application does not send its logs to <code>stdout</code>, but uses some log files instead.) <code>File-tailer</code> helps to solve this problem: It configures Fluent Bit to tail the given file(s), and sends the logs to the <code>stdout</code>, to implement Kubernetes-native logging.</p><p><img src="../logging-extensions-host-tailer2.png" alt="Host-tailer"></p><p>However, <code>file-tailer</code> cannot access the pod&rsquo;s local dir, so the logfiles need to be written on a mounted volume.</p><p>Let&rsquo;s assume the following code represents a legacy application that generates logs into the <code>/legacy-logs/date.log</code> file. While the legacy-logs directory is mounted, it&rsquo;s accessible from other pods by mounting the same volume.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: v1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: Pod
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: test-pod
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  containers:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  - image: busybox
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    name: test
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    volumeMounts:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - mountPath: /legacy-logs
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      name: test-volume
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    command: [&#34;/bin/sh&#34;, &#34;-c&#34;]
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    args:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      - while true; do
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">          date &gt;&gt; /legacy-logs/date.log;
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">          sleep 1;
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        done
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  volumes:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  - name: test-volume
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    hostPath:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      path: /legacy-logs
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><p>To tail the logs of the previous example application, you can use the following <code>host-tailer</code> custom resource:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: logging-extensions.banzaicloud.io/v1alpha1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: HostTailer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: file-hosttailer-sample
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  fileTailers:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - name: sample-logfile
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      path: /legacy-logs/date.log
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      disabled: false
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><p>Logging operator configure the environment and start a <code>file-tailer</code> pod. It&rsquo;s also able to deal with multi-node clusters, since is starts the <code>host-tailer</code> pod through a <code>daemonset</code>.</p><p>Check the created file tailer pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl get pod
</span></span></code></pre></div><p>The output should be similar to:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>NAME                                       READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex"><span>file-hosttailer-sample-host-tailer-5tqhv   1/1     Running   <span style="color:#0000cf;font-weight:700">0</span>          117s
</span></span><span style="display:flex"><span>test-pod                                   1/1     Running   <span style="color:#0000cf;font-weight:700">0</span>          5m40s
</span></span></code></pre></div><p>Checking the logs of the <code>file-tailer's</code> pod. You will see the logfile&rsquo;s content on <code>stdout</code>. This way Logging operator can process those logs as well.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl logs file-hosttailer-sample-host-tailer-5tqhv
</span></span></code></pre></div><p>The logs of the sample application should be similar to:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>Fluent Bit v1.9.5
</span></span><span style="display:flex"><span>* Copyright <span style="color:#ce5c00;font-weight:700">(</span>C<span style="color:#ce5c00;font-weight:700">)</span> 2015-2022 The Fluent Bit Authors
</span></span><span style="display:flex"><span>* Fluent Bit is a CNCF sub-project under the umbrella of Fluentd
</span></span><span style="display:flex"><span>* https://fluentbit.io
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/13 12:26:02<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>fluent bit<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#000">version</span><span style="color:#ce5c00;font-weight:700">=</span>1.9.5, <span style="color:#000">commit</span><span style="color:#ce5c00;font-weight:700">=</span>9ec43447b6, <span style="color:#000">pid</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/13 12:26:02<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>storage<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#000">version</span><span style="color:#ce5c00;font-weight:700">=</span>1.2.0, <span style="color:#000">type</span><span style="color:#ce5c00;font-weight:700">=</span>memory-only, <span style="color:#000">sync</span><span style="color:#ce5c00;font-weight:700">=</span>normal, <span style="color:#000">checksum</span><span style="color:#ce5c00;font-weight:700">=</span>disabled, <span style="color:#000">max_chunks_up</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#0000cf;font-weight:700">128</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/13 12:26:02<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>cmetrics<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#000">version</span><span style="color:#ce5c00;font-weight:700">=</span>0.3.4
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/13 12:26:02<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>sp<span style="color:#ce5c00;font-weight:700">]</span> stream processor started
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/13 12:26:02<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>output:file:file.0<span style="color:#ce5c00;font-weight:700">]</span> worker <span style="color:#8f5902;font-style:italic">#0 started</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/13 12:26:02<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>input:tail:tail.0<span style="color:#ce5c00;font-weight:700">]</span> inotify_fs_add<span style="color:#ce5c00;font-weight:700">()</span>: <span style="color:#000">inode</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#0000cf;font-weight:700">418051</span> <span style="color:#000">watch_fd</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#0000cf;font-weight:700">1</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:700">=</span>/legacy-logs/date.log
</span></span><span style="display:flex"><span>Tue Sep <span style="color:#0000cf;font-weight:700">13</span> 12:22:51 UTC <span style="color:#0000cf;font-weight:700">2022</span>
</span></span><span style="display:flex"><span>Tue Sep <span style="color:#0000cf;font-weight:700">13</span> 12:22:52 UTC <span style="color:#0000cf;font-weight:700">2022</span>
</span></span><span style="display:flex"><span>Tue Sep <span style="color:#0000cf;font-weight:700">13</span> 12:22:53 UTC <span style="color:#0000cf;font-weight:700">2022</span>
</span></span><span style="display:flex"><span>Tue Sep <span style="color:#0000cf;font-weight:700">13</span> 12:22:54 UTC <span style="color:#0000cf;font-weight:700">2022</span>
</span></span><span style="display:flex"><span>Tue Sep <span style="color:#0000cf;font-weight:700">13</span> 12:22:55 UTC <span style="color:#0000cf;font-weight:700">2022</span>
</span></span><span style="display:flex"><span>Tue Sep <span style="color:#0000cf;font-weight:700">13</span> 12:22:56 UTC <span style="color:#0000cf;font-weight:700">2022</span>
</span></span></code></pre></div><h3 id="file-tailer-configuration-options">File Tailer configuration options</h3><table>
<thead>
<tr>
<th>Variable Name</th><th>Type</th><th>Required</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>name</td><td>string</td><td>Yes</td><td>-</td><td>Name for the tailer<br></td></tr><tr>
<td>path</td><td>string</td><td>No</td><td>-</td><td>Path to the loggable file<br></td></tr><tr>
<td>disabled</td><td>bool</td><td>No</td><td>-</td><td>Disable tailing the file<br></td></tr><tr>
<td>containerOverrides</td><td>*types.ContainerBase</td><td>No</td><td>-</td><td>Override container fields for the given tailer<br></td></tr></tbody></table><h2 id="tail-systemd-journal">Tail systemd journal</h2><p>This is a special case of <code>file-tailer</code>, since it tails the <code>systemd</code> journal file specifically.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: logging-extensions.banzaicloud.io/v1alpha1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: HostTailer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: systemd-tailer-sample
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  # list of Systemd tailers
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  systemdTailers:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - name: my-systemd-tailer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      maxEntries: 100
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      systemdFilter: kubelet.service
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><h3 id="systemd-tailer-configuration-options">Systemd tailer configuration options</h3><table>
<thead>
<tr>
<th>Variable Name</th><th>Type</th><th>Required</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>name</td><td>string</td><td>Yes</td><td>-</td><td>Name for the tailer<br></td></tr><tr>
<td>path</td><td>string</td><td>No</td><td>-</td><td>Override systemd log path<br></td></tr><tr>
<td>disabled</td><td>bool</td><td>No</td><td>-</td><td>Disable component<br></td></tr><tr>
<td>systemdFilter</td><td>string</td><td>No</td><td>-</td><td>Filter to select systemd unit example: kubelet.service<br></td></tr><tr>
<td>maxEntries</td><td>int</td><td>No</td><td>-</td><td>Maximum entries to read when starting to tail logs to avoid high pressure<br></td></tr><tr>
<td>containerOverrides</td><td>*types.ContainerBase</td><td>No</td><td>-</td><td>Override container fields for the given tailer<br></td></tr></tbody></table><h2 id="example-configure-logging-flow-to-route-logs-from-a-host-tailer">Example: Configure logging Flow to route logs from a host tailer</h2><p>The following example uses the flow&rsquo;s match term to listen the previously created <code>file-hosttailer-sample</code> Hosttailer&rsquo;s log.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: logging.banzaicloud.io/v1beta1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: Flow
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: hosttailer-flow
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  namespace: default
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  filters:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  - tag_normaliser: {}
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  # keeps data matching to label, the rest of the data will be discarded by this flow implicitly
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  match:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  - select:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      labels: 
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        app.kubernetes.io/name: file-hosttailer-sample
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      # there might be a need to match on container name too (in case of multiple containers)
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      container_names:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        - nginx-access
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  outputRefs:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - sample-output
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><h2 id="example-kubernetes-host-tailer-with-multiple-tailers">Example: Kubernetes host tailer with multiple tailers</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: logging-extensions.banzaicloud.io/v1alpha1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: HostTailer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: multi-sample
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  # list of File tailers
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  fileTailers:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - name: nginx-access
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      path: /var/log/nginx/access.log
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - name: nginx-error
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      path: /var/log/nginx/error.log
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  # list of Systemd tailers
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  systemdTailers:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - name: my-systemd-tailer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      maxEntries: 100
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      systemdFilter: kubelet.service
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><h2 id="set-custom-priority">Set custom priority</h2><p>Create your own custom priority class in Kubernetes. Set its value between 0 and 2000000000. Note that:</p><ul>
<li>0 is the default priority</li><li>To change the default priority, set the <code>globalDefault</code> key.</li><li>2000000000 and above are reserved for the Kubernetes system</li><li>PriorityClass is a non-namespaced object.</li></ul><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: scheduling.k8s.io/v1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: PriorityClass
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: hosttailer-priority
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">value: 1000000
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">globalDefault: false
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">description: &#34;This priority class should be used for hosttailer pods only.&#34;
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><p>Now you can use your private priority class name to start hosttailer/eventtailer, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f -<span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: logging-extensions.banzaicloud.io/v1alpha1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: HostTailer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: priority-sample
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  controlNamespace: default
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  # Override podSpecBase variables here
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  workloadOverrides:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    priorityClassName: hosttailer-priority
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  fileTailers:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - name: nginx-access
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      path: /var/log/nginx/access.log
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - name: nginx-error
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      path: /var/log/nginx/error.log
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><h2 id="configuration-options">Configuration options</h2><table>
<thead>
<tr>
<th>Variable Name</th><th>Type</th><th>Required</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>fileTailers</td><td>[]FileTailer</td><td>No</td><td>-</td><td>List of file tailers<br></td></tr><tr>
<td>systemdTailers</td><td>[]SystemdTailer</td><td>No</td><td>-</td><td>List of systemd tailers<br></td></tr><tr>
<td>enableRecreateWorkloadOnImmutableFieldChange</td><td>bool</td><td>No</td><td>-</td><td>EnableRecreateWorkloadOnImmutableFieldChange enables the operator to recreate the<br>fluentbit daemonset and the fluentd statefulset (and possibly other resource in the future)<br>in case there is a change in an immutable field<br>that otherwise couldn&rsquo;t be managed with a simple update.<br></td></tr><tr>
<td>workloadMetaOverrides</td><td>*types.MetaBase</td><td>No</td><td>-</td><td>Override metadata of the created resources<br></td></tr><tr>
<td>workloadOverrides</td><td>*types.PodSpecBase</td><td>No</td><td>-</td><td>Override podSpec fields for the given daemonset<br></td></tr></tbody></table><h2 id="advanced-configuration-overrides">Advanced configuration overrides</h2><h3 id="metabase">MetaBase</h3><table>
<thead>
<tr>
<th>Variable Name</th><th>Type</th><th>Required</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>annotations</td><td><code>map[string]string</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>labels</td><td><code>map[string]string</code></td><td>No</td><td>-</td><td></td></tr></tbody></table><h3 id="podspecbase">PodSpecBase</h3><table>
<thead>
<tr>
<th>Variable Name</th><th>Type</th><th>Required</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>tolerations</td><td><code>[]corev1.Toleration</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>nodeSelector</td><td><code>map[string]string</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>serviceAccountName</td><td><code>string</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>affinity</td><td><code>*corev1.Affinity</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>securityContext</td><td><code>*corev1.PodSecurityContext</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>volumes</td><td><code>[]corev1.Volume</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>priorityClassName</td><td><code>string</code></td><td>No</td><td>-</td><td></td></tr></tbody></table><h3 id="containerbase">ContainerBase</h3><table>
<thead>
<tr>
<th>Variable Name</th><th>Type</th><th>Required</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>resources</td><td><code>*corev1.ResourceRequirements</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>image</td><td><code>string</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>pullPolicy</td><td><code>corev1.PullPolicy</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>command</td><td><code>[]string</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>volumeMounts</td><td><code>[]corev1.VolumeMount</code></td><td>No</td><td>-</td><td></td></tr><tr>
<td>securityContext</td><td><code>*corev1.SecurityContext</code></td><td>No</td><td>-</td><td></td></tr></tbody></table></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-064cf3669ed75479a61d9edba52b81d4">4.6.3 - Tail logfiles with a webhook</h1><p>The <code>tailer-webhook</code> is a different approach for the same problem: parsing legacy application&rsquo;s log file. As an alternative to using a <a href="/5.1/docs/configuration/extensions/kubernetes-host-tailer/">host file tailer</a> service, you can use a <code>file tailer webhook</code> service.
While the containers of the <code>host file tailers</code> run in a separated pod, <code>file tailer webhook</code> uses a different approach: if a pod has a specific annotation, the webhook injects a sidecar container for every tailed file into the pod.</p><p><img src="../logging-extensions-tailer-webhook.png" alt="Tailer-webhook"></p><p>The <code>tailer-webhook</code> behaves differently compared to the <code>host-tailer</code>:</p><p>Pros:</p><ul>
<li>A simple annotation on the pod initiates the file tailing.</li><li>There is no need to use <code>mounted volumes</code>, Logging operator will manage the volumes and mounts between your containers.</li></ul><p>Cons:</p><ul>
<li>Required to start the Logging operator with webhooks service enabled. This requires additional configuration, especially on certificates since webhook services are allowed over TLS only.</li><li>Possibly uses more resources, since every tailed file attaches a new sidecar container to the pod.</li></ul><h2 id="enable-webhooks">Enable webhooks in Logging operator</h2><blockquote>
<p>We recommend using <code>cert-manager</code> to manage your certificates. Below is a really simple command that bootstraps generates the required resources for the <code>tailer-webhook</code>.</p></blockquote><h3 id="issue-certificate-cert-manager">Issuing certificates using <code>cert-manager</code></h3><p>Follow the <a href="https://cert-manager.io/docs/installation/">official installation guide</a>.</p><p>Once installed the following commands should allow you to create the required certificate for the webhook.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: cert-manager.io/v1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: ClusterIssuer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: selfsigned-issuer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  selfSigned: {}
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">---
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: cert-manager.io/v1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: Certificate
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: webhook-tls
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  namespace: logging
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  isCA: true
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  commonName: my-selfsigned-ca
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  secretName: webhook-tls
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  privateKey:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    algorithm: ECDSA
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    size: 256
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  dnsNames:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - sample-webhook.banzaicloud.com
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - logging-webhooks.logging.svc
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  usages:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - server auth
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  issuerRef:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    name: selfsigned-issuer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    kind: ClusterIssuer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    group: cert-manager.io
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">---
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: cert-manager.io/v1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: ClusterIssuer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: my-ca-issuer
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  ca:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    secretName: webhook-tls
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><p>You will require the following things:</p><ul>
<li>a valid client certificate,</li><li>a CA certificate, and</li><li>a custom value.yaml file for your helm chart.</li></ul><p>The following example refers to a Kubernetes secret named <code>webhook-tls</code> which is a self-signed certificate generated by <code>cert-manager</code>.</p><p>Add the following lines to your custom <code>values.yaml</code> or create a new file if needed:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">env</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ENABLE_WEBHOOKS</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;true&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">volumes</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">webhook-tls</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">secret</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">secretName</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">webhook-tls</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">volumeMounts</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">webhook-tls</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">mountPath</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/tmp/k8s-webhook-server/serving-certs</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>This will:</p><ul>
<li>Set <code>ENABLE_WEBHOOKS</code> environment variable to <code>true</code>. This is the official way to enable webhooks in Logging operator.</li><li>Create a volume from the <code>webhook-tls</code> Kubernetes secret.</li><li>Mount the <code>webhook-tls</code> secret volume to the <code>/tmp/k8s-webhook-server/serving-certs</code> path where Logging operator will search for it.</li></ul><p>Now you are ready to install Logging operator with the new custom values:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging -f operator_values.yaml  logging-operator ./charts/logging-operator
</span></span></code></pre></div><p>Alternatively, instead of using the values.yaml file, you can run the installation from command line also by passing the values with the <code>set</code> and <code>set-string</code> parameters:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging --set <span style="color:#4e9a06">&#34;env[0].name=ENABLE_WEBHOOKS&#34;</span> --set-string <span style="color:#4e9a06">&#34;env[0].value=true&#34;</span> --set <span style="color:#4e9a06">&#34;volumes[0].name=webhook-tls&#34;</span> --set <span style="color:#4e9a06">&#34;volumes[0].secret.secretName=webhook-tls&#34;</span> --set <span style="color:#4e9a06">&#34;volumeMounts[0].name=webhook-tls&#34;</span> --set <span style="color:#4e9a06">&#34;volumeMounts[0].mountPath=/tmp/k8s-webhook-server/serving-certs&#34;</span>  logging-operator ./charts/logging-operator
</span></span></code></pre></div><p>You also need a service which points to the webhook port (9443) of Logging operator, and where the <code>mutatingwebhookconfiuration</code> will point to. Running the following command in shell will create the required service:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: v1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: Service
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: logging-webhooks
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  namespace: logging
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">spec:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  ports:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    - name: logging-webhooks
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      port: 443
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      targetPort: 9443
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      protocol: TCP
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  selector:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    app.kubernetes.io/instance: logging-operator
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  type: ClusterIP
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><p>Furthermore, you need to tell Kubernetes to send admission requests to our webhook service. To do that, create a <code>mutatingwebhookconfiguration</code> Kubernetes resource, and:</p><ul>
<li>Set the configuration to call <code>/tailer-webhook</code> path on your <code>logging-webhooks</code> service when <code>v1.Pod</code> is created.</li><li>Set <code>failurePolicy</code> to <code>ignore</code>, which means that the original pod will be created on webhook errors.</li><li>Set <code>sideEffects</code> to <code>none</code>, because we won&rsquo;t cause any out-of-band changes in Kubernetes.</li></ul><p>Unfortunately, <code>mutatingwebhookconfiguration</code> requires the <code>caBundle</code> field to be filled because we used a self-signed certificate, and the certificate cannot be validated through the system trust roots. If your certificate was generated with a system trust root CA, remove the <code>caBundle</code> line, because the certificate will be validated automatically.
There are more sophisticated ways to load the CA into this field, but this solution requires no further components.</p><blockquote>
<p>For example: you can inject the CA with a simple cert-manager <code>cert-manager.io/inject-ca-from: logging/webhook-tls</code> annotation on the <code>mutatingwebhookconfiguration</code> resource.</p></blockquote><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - <span style="color:#4e9a06">&lt;&lt;EOF
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">apiVersion: admissionregistration.k8s.io/v1
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">kind: MutatingWebhookConfiguration
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  name: sample-webhook-cfg
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  namespace: logging
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  labels:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    app: sample-webhook
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  annotations:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    cert-manager.io/inject-ca-from: logging/webhook-tls
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">webhooks:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">  - name: sample-webhook.banzaicloud.com
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    clientConfig:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      service:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        name: logging-webhooks
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        namespace: logging
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        path: &#34;/tailer-webhook&#34;
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    rules:
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">      - operations: [ &#34;CREATE&#34; ]
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        apiGroups: [&#34;&#34;]
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        apiVersions: [&#34;v1&#34;]
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        resources: [&#34;pods&#34;]
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">        scope: &#34;*&#34;
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    failurePolicy: Ignore
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    sideEffects: None
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">    admissionReviewVersions: [v1]
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">EOF</span>
</span></span></code></pre></div><h2 id="triggering-the-webhook">Triggering the webhook</h2><div class="warning-block">
<p><strong>CAUTION:</strong></p>To use the webhook, you must first <a href="#enable-webhooks">enable webhooks in the Logging operator</a>.
</div><p><code>File tailer webhook</code> is based on a <a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/"><code>Mutating Admission Webhook</code></a>. It is called every time when a pod starts.</p><p>To trigger the webhook, add the following annotation to the pod metadata:</p><ul>
<li>
<p>Annotation key: <code>sidecar.logging-extensions.banzaicloud.io/tail</code></p></li><li>
<p>Value of the annotation: the filename (including path, and optionally the container) you want to tail, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">annotations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:700">&#34;sidecar.logging-extensions.banzaicloud.io/tail&#34;: </span><span style="color:#4e9a06">&#34;/var/log/date&#34;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>To tail multiple files, add only one annotation, and separate the filenames with commas, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test-pod</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">annotations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:700">&#34;sidecar.logging-extensions.banzaicloud.io/tail&#34;: </span><span style="color:#4e9a06">&#34;/var/log/date,/var/log/mycustomfile&#34;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>If the pod contains multiple containers, see <a href="#multi-container-pods">Multi-container pods</a>.</p></li></ul><blockquote>
<p>Note: If the pod with the sidecar annotation is in the <code>default</code> namespace, Logging operator handles <code>tailer-webhook</code> annotations clusterwide. To restrict the webhook callbacks to the current namespace, change the <code>scope</code> of the <code>mutatingwebhookconfiguration</code> to <code>namespaced</code>.</p></blockquote><h3 id="file-tailer-example">File tailer example</h3><p>The following example creates a pod that is running a shell in infinite loop that appends the <code>date</code> command&rsquo;s output to a file every second. The annotation <code>sidecar.logging-extensions.banzaicloud.io/tail</code> notifies Logging operator to attach a sidecar container to the pod. The sidecar tails the <code>/var/log/date</code> file and sends its output to the stdout.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Pod</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test-pod</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">annotations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{<span style="color:#204a87;font-weight:700">&#34;sidecar.logging-extensions.banzaicloud.io/tail&#34;: </span><span style="color:#4e9a06">&#34;/var/log/date&#34;</span>}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">containers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">image</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">debian</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sample-container</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">command</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:700">[</span><span style="color:#4e9a06">&#34;/bin/sh&#34;</span><span style="color:#000;font-weight:700">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;-c&#34;</span><span style="color:#000;font-weight:700">]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">args</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">while true; do</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#000">date &gt;&gt; /var/log/date;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#000">sleep 1;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#000">done</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>After you have created the pod with the required annotation, make sure that the <code>test-pod</code> contains two containers by running <code>kubectl get pod</code></p><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>NAME       READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex"><span>test-pod   2/2     Running   <span style="color:#0000cf;font-weight:700">0</span>          29m
</span></span></code></pre></div><p>Check the container names in the pod to see that the Logging operator has created the sidecar container called <code>legacy-logs-date-log</code>. The sidecar containers&rsquo; name is always built from the path and name of the tailed file. Run the following command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl get pod test-pod -o json <span style="color:#000;font-weight:700">|</span> jq <span style="color:#4e9a06">&#39;.spec.containers | map(.name)&#39;</span>
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;sample-container&#34;</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;sample-container-var-log-date&#34;</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">]</span>
</span></span></code></pre></div><p>Check the logs of the <code>test</code> container. Since it writes the logs into a file, it does not produce any logs on stdout.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl logs test-pod sample-container<span style="color:#000;font-weight:700">;</span> <span style="color:#204a87">echo</span> <span style="color:#000">$?</span>
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#0000cf;font-weight:700">0</span>
</span></span></code></pre></div><p>Check the logs of the <code>legacy-logs-date-log</code> container. This container exposes the logs of the <code>test</code> container on its stdout.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl logs test-pod legacy-logs-date-log
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>Fluent Bit v1.9.5
</span></span><span style="display:flex"><span>* Copyright <span style="color:#ce5c00;font-weight:700">(</span>C<span style="color:#ce5c00;font-weight:700">)</span> 2015-2022 The Fluent Bit Authors
</span></span><span style="display:flex"><span>* Fluent Bit is a CNCF sub-project under the umbrella of Fluentd
</span></span><span style="display:flex"><span>* https://fluentbit.io
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/15 11:26:11<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>fluent bit<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#000">version</span><span style="color:#ce5c00;font-weight:700">=</span>1.9.5, <span style="color:#000">commit</span><span style="color:#ce5c00;font-weight:700">=</span>9ec43447b6, <span style="color:#000">pid</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/15 11:26:11<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>storage<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#000">version</span><span style="color:#ce5c00;font-weight:700">=</span>1.2.0, <span style="color:#000">type</span><span style="color:#ce5c00;font-weight:700">=</span>memory-only, <span style="color:#000">sync</span><span style="color:#ce5c00;font-weight:700">=</span>normal, <span style="color:#000">checksum</span><span style="color:#ce5c00;font-weight:700">=</span>disabled, <span style="color:#000">max_chunks_up</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#0000cf;font-weight:700">128</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/15 11:26:11<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>cmetrics<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#000">version</span><span style="color:#ce5c00;font-weight:700">=</span>0.3.4
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/15 11:26:11<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>sp<span style="color:#ce5c00;font-weight:700">]</span> stream processor started
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/15 11:26:11<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>input:tail:tail.0<span style="color:#ce5c00;font-weight:700">]</span> inotify_fs_add<span style="color:#ce5c00;font-weight:700">()</span>: <span style="color:#000">inode</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#0000cf;font-weight:700">938627</span> <span style="color:#000">watch_fd</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#0000cf;font-weight:700">1</span> <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:700">=</span>/legacy-logs/date.log
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>2022/09/15 11:26:11<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span> info<span style="color:#ce5c00;font-weight:700">]</span> <span style="color:#ce5c00;font-weight:700">[</span>output:file:file.0<span style="color:#ce5c00;font-weight:700">]</span> worker <span style="color:#8f5902;font-style:italic">#0 started</span>
</span></span><span style="display:flex"><span>Thu Sep <span style="color:#0000cf;font-weight:700">15</span> 11:26:11 UTC <span style="color:#0000cf;font-weight:700">2022</span>
</span></span><span style="display:flex"><span>Thu Sep <span style="color:#0000cf;font-weight:700">15</span> 11:26:12 UTC <span style="color:#0000cf;font-weight:700">2022</span>
</span></span><span style="display:flex"><span>...
</span></span></code></pre></div><h2 id="multi-container-pods">Multi-container pods</h2><p>In some cases you have multiple containers in your pod and you want to distinguish which file annotation belongs to which container. You can order every file annotations to particular container by prefixing the annotation with a <code>${ContainerName}:</code> container key. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>...
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>    name: test-pod
</span></span><span style="display:flex"><span>    annotations: <span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;sidecar.logging-extensions.banzaicloud.io/tail&#34;</span>: <span style="color:#4e9a06">&#34;sample-container:/var/log/date,sample-container2:/var/log/anotherfile,/var/log/mycustomfile,foobarbaz:/foo/bar/baz&#34;</span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>...
</span></span></code></pre></div><div class="warning-block">
<p><strong>CAUTION:</strong></p><ul>
<li>Annotations without containername prefix: the file gets tailed on the default container (container 0)</li><li>Annotations with invalid containername: file tailer annotation gets discarded</li></ul></div><table>
<thead>
<tr>
<th>Annotation</th><th>Explanation</th></tr></thead><tbody>
<tr>
<td>sample-container:/var/log/date</td><td>tails file /var/log/date in sample-container</td></tr><tr>
<td>sample-container2:/var/log/anotherfile</td><td>tails file /var/log/anotherfile in sample-container2</td></tr><tr>
<td>/var/log/mycustomfile</td><td>tails file /var/log/mycustomfile in default container (sample-container)</td></tr><tr>
<td>foobarbaz:/foo/bar/baz</td><td>will be discarded due to non-existing container name</td></tr></tbody></table></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-e717e7a286f2e387a96139f1e780a80f">4.7 - Custom Resource Definitions</h1><p>This document contains detailed information about the Custom Resource Definitions that the Logging operator uses.</p><blockquote>
<p>You can find <a href="https://github.com/kube-logging/logging-operator/tree/master/config/samples">example yamls in our GitHub repository</a>.</p></blockquote><h2 id="namespace-separation">Namespace separation</h2><p>A <code>logging pipeline</code> consist of two types of resources.</p><ul>
<li><code>Namespaced</code> resources: <code>Flow</code>, <code>Output</code>, <code>SyslogNGFlow</code>, <code>SyslogNGOutput</code></li><li><code>Global</code> resources: <code>ClusterFlow</code>, <code>ClusterOutput</code>, <code>SyslogNGClusterFlow</code>, <code>SyslogNGClusterOutput</code></li></ul><p>The <code>namespaced</code> resources are only effective in their <strong>own</strong> namespace. <code>Global</code> resources are <strong>cluster wide</strong>.</p><blockquote>
<p>You can create <code>ClusterFlow</code>, <code>ClusterOutput</code>, <code>SyslogNGClusterFlow</code>, and <code>SyslogNGClusterOutput</code> resources only in the <code>controlNamespace</code>, unless the <a href="/5.1/docs/configuration/crds/v1beta1/logging_types/#loggingspec-allowclusterresourcesfromallnamespaces"><code>allowClusterResourcesFromAllNamespaces</code></a> option is enabled in the logging resource. This namespace <strong>MUST</strong> be a <strong>protected</strong> namespace so that only <strong>administrators</strong> can access it.</p></blockquote><h2 id="available-crds">Available CRDs</h2></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-44379ccd6059a94ad3c04f41ddd93d31">4.7.1 - Available CRDs</h1><p>For more information please click on the name</p><center>
<table>
<thead>
<tr>
<th>Name</th><th>Description</th><th>Version</th></tr></thead><tbody>
<tr>
<td><strong><a href="../extensions/eventtailer_types/">EventTailer</a></strong></td><td>Eventtailer&rsquo;s main goal is to listen kubernetes events and transmit their changes to stdout. This way the logging-operator is able to process them.</td><td>extensions</td></tr><tr>
<td><strong><a href="../extensions/hosttailer_types/">HostTailer</a></strong></td><td>HostTailer&rsquo;s main goal is to tail custom files and transmit their changes to stdout. This way the logging-operator is able to process them.</td><td>extensions</td></tr><tr>
<td><strong><a href="clusterflow_types/">ClusterFlow</a></strong></td><td>ClusterFlow is the Schema for the clusterflows API</td><td>v1beta1</td></tr><tr>
<td><strong><a href="clusteroutput_types/">ClusterOutput</a></strong></td><td>ClusterOutput is the Schema for the clusteroutputs API</td><td>v1beta1</td></tr><tr>
<td><strong><a href="common_types/">Common</a></strong></td><td>ImageSpec Metrics Security</td><td>v1beta1</td></tr><tr>
<td><strong><a href="flow_types/">FlowSpec</a></strong></td><td>FlowSpec is the Kubernetes spec for Flows</td><td>v1beta1</td></tr><tr>
<td><strong><a href="fluentbit_types/">FluentbitSpec</a></strong></td><td>FluentbitSpec defines the desired state of FluentbitAgent</td><td>v1beta1</td></tr><tr>
<td><strong><a href="fluentd_types/">Fluent</a></strong></td><td>FluentdConfig is a reference to the desired Fluentd state</td><td>v1beta1</td></tr><tr>
<td><strong><a href="fluentd_types/">FluentdSpec</a></strong></td><td>FluentdSpec defines the desired state of Fluentd</td><td>v1beta1</td></tr><tr>
<td><strong><a href="logging_types/">Logging</a></strong></td><td>Logging system configuration</td><td>v1beta1</td></tr><tr>
<td><strong><a href="loggingroute_types/">LoggingRouteSpec</a></strong></td><td>LoggingRouteSpec defines the desired state of LoggingRoute</td><td>v1beta1</td></tr><tr>
<td><strong><a href="node_agent_types/">NodeAgent</a></strong></td><td></td><td>v1beta1</td></tr><tr>
<td><strong><a href="output_types/">OutputSpec</a></strong></td><td>OutputSpec defines the desired state of Output</td><td>v1beta1</td></tr><tr>
<td><strong><a href="syslogng_clusterflow_types/">SyslogNGClusterFlow</a></strong></td><td>SyslogNGClusterFlow is the Schema for the syslog-ng clusterflows API</td><td>v1beta1</td></tr><tr>
<td><strong><a href="syslogng_clusteroutput_types/">SyslogNGClusterOutput</a></strong></td><td>SyslogNGClusterOutput is the Schema for the syslog-ng clusteroutputs API</td><td>v1beta1</td></tr><tr>
<td><strong><a href="syslogng_types/">SyslogNG</a></strong></td><td>SyslogNG is a standalone reference to the desired SyslogNG configuration</td><td>v1beta1</td></tr><tr>
<td><strong><a href="syslogng_flow_types/">SyslogNGFlowSpec</a></strong></td><td>SyslogNGFlowSpec is the Kubernetes spec for SyslogNGFlows</td><td>v1beta1</td></tr><tr>
<td><strong><a href="syslogng_output_types/">SyslogNGOutputSpec</a></strong></td><td>SyslogNGOutputSpec defines the desired state of SyslogNGOutput</td><td>v1beta1</td></tr><tr>
<td><strong><a href="syslogng_types/">SyslogNGSpec</a></strong></td><td>SyslogNGSpec defines the desired state of SyslogNG</td><td>v1beta1</td></tr></tbody></table></center>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-4e72a83b9fd0f217cf5e4c1787a014b6">4.7.1.1 - ClusterFlow</h1><h2 id="clusterflow">ClusterFlow</h2><p>ClusterFlow is the Schema for the clusterflows API</p><h3 id="clusterflow-">(metav1.TypeMeta, required)</h3><h3 id="clusterflow-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="clusterflow-spec">spec (ClusterFlowSpec, optional)</h3><p>Name of the logging cluster to be attached</p><h3 id="clusterflow-status">status (FlowStatus, optional)</h3><h2 id="clustermatch">ClusterMatch</h2><h3 id="clustermatch-select">select (*ClusterSelect, optional)</h3><h3 id="clustermatch-exclude">exclude (*ClusterExclude, optional)</h3><h2 id="clusterselect">ClusterSelect</h2><h3 id="clusterselect-container_names">container_names ([]string, optional)</h3><h3 id="clusterselect-hosts">hosts ([]string, optional)</h3><h3 id="clusterselect-labels">labels (map[string]string, optional)</h3><h3 id="clusterselect-namespace_labels">namespace_labels (map[string]string, optional)</h3><h3 id="clusterselect-namespaces">namespaces ([]string, optional)</h3><h2 id="clusterexclude">ClusterExclude</h2><h3 id="clusterexclude-container_names">container_names ([]string, optional)</h3><h3 id="clusterexclude-hosts">hosts ([]string, optional)</h3><h3 id="clusterexclude-labels">labels (map[string]string, optional)</h3><h3 id="clusterexclude-namespace_labels">namespace_labels (map[string]string, optional)</h3><h3 id="clusterexclude-namespaces">namespaces ([]string, optional)</h3><h2 id="clusterflowspec">ClusterFlowSpec</h2><p>ClusterFlowSpec is the Kubernetes spec for ClusterFlows</p><h3 id="clusterflowspec-filters">filters ([]Filter, optional)</h3><h3 id="clusterflowspec-flowlabel">flowLabel (string, optional)</h3><h3 id="clusterflowspec-globaloutputrefs">globalOutputRefs ([]string, optional)</h3><h3 id="clusterflowspec-includelabelinrouter">includeLabelInRouter (*bool, optional)</h3><h3 id="clusterflowspec-loggingref">loggingRef (string, optional)</h3><h3 id="clusterflowspec-match">match ([]ClusterMatch, optional)</h3><h3 id="clusterflowspec-outputrefs">outputRefs ([]string, optional)</h3><p>Deprecated</p><h3 id="clusterflowspec-selectors">selectors (map[string]string, optional)</h3><p>Deprecated</p><h2 id="clusterflowlist">ClusterFlowList</h2><p>ClusterFlowList contains a list of ClusterFlow</p><h3 id="clusterflowlist-">(metav1.TypeMeta, required)</h3><h3 id="clusterflowlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="clusterflowlist-items">items ([]ClusterFlow, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-12aea1089d22dc7b1ec3e444ebae4bc3">4.7.1.2 - ClusterOutput</h1><h2 id="clusteroutput">ClusterOutput</h2><p>ClusterOutput is the Schema for the clusteroutputs API</p><h3 id="clusteroutput-">(metav1.TypeMeta, required)</h3><h3 id="clusteroutput-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="clusteroutput-spec">spec (ClusterOutputSpec, required)</h3><h3 id="clusteroutput-status">status (OutputStatus, optional)</h3><h2 id="clusteroutputspec">ClusterOutputSpec</h2><p>ClusterOutputSpec contains Kubernetes spec for ClusterOutput</p><h3 id="clusteroutputspec-">(OutputSpec, required)</h3><h3 id="clusteroutputspec-protected">protected (bool, optional)</h3><h2 id="clusteroutputlist">ClusterOutputList</h2><p>ClusterOutputList contains a list of ClusterOutput</p><h3 id="clusteroutputlist-">(metav1.TypeMeta, required)</h3><h3 id="clusteroutputlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="clusteroutputlist-items">items ([]ClusterOutput, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-aba3be1da4e9fa0884cceaab7336a25b">4.7.1.3 - Common</h1><h2 id="basicimagespec">BasicImageSpec</h2><p>BasicImageSpec struct hold basic information about image specification</p><h3 id="basicimagespec-repository">repository (string, optional)</h3><h3 id="basicimagespec-tag">tag (string, optional)</h3><h2 id="imagespec">ImageSpec</h2><p>ImageSpec struct hold information about image specification</p><h3 id="imagespec-imagepullsecrets">imagePullSecrets ([]corev1.LocalObjectReference, optional)</h3><h3 id="imagespec-pullpolicy">pullPolicy (string, optional)</h3><h3 id="imagespec-repository">repository (string, optional)</h3><h3 id="imagespec-tag">tag (string, optional)</h3><h2 id="metrics">Metrics</h2><p>Metrics defines the service monitor endpoints</p><h3 id="metrics-interval">interval (string, optional)</h3><h3 id="metrics-path">path (string, optional)</h3><h3 id="metrics-port">port (int32, optional)</h3><h3 id="metrics-prometheusannotations">prometheusAnnotations (bool, optional)</h3><h3 id="metrics-prometheusrules">prometheusRules (bool, optional)</h3><h3 id="metrics-prometheusrulesoverride">prometheusRulesOverride ([]PrometheusRulesOverride, optional)</h3><h3 id="metrics-servicemonitor">serviceMonitor (bool, optional)</h3><h3 id="metrics-servicemonitorconfig">serviceMonitorConfig (ServiceMonitorConfig, optional)</h3><h3 id="metrics-timeout">timeout (string, optional)</h3><h2 id="prometheusrulesoverride">PrometheusRulesOverride</h2><h3 id="prometheusrulesoverride-alert">alert (string, optional)</h3><p>Name of the alert. Must be a valid label value. Only one of <code>record</code> and <code>alert</code> must be set.</p><h3 id="prometheusrulesoverride-annotations">annotations (map[string]string, optional)</h3><p>Annotations to add to each alert. Only valid for alerting rules.</p><h3 id="prometheusrulesoverride-expr">expr (*intstr.IntOrString, optional)</h3><p>PromQL expression to evaluate.</p><h3 id="prometheusrulesoverride-for">for (*v1.Duration, optional)</h3><p>Alerts are considered firing once they have been returned for this long. +optional</p><h3 id="prometheusrulesoverride-keep_firing_for">keep_firing_for (*v1.NonEmptyDuration, optional)</h3><p>KeepFiringFor defines how long an alert will continue firing after the condition that triggered it has cleared. +optional</p><h3 id="prometheusrulesoverride-labels">labels (map[string]string, optional)</h3><p>Labels to add or overwrite.</p><h3 id="prometheusrulesoverride-record">record (string, optional)</h3><p>Name of the time series to output to. Must be a valid metric name. Only one of <code>record</code> and <code>alert</code> must be set.</p><h2 id="buffermetrics">BufferMetrics</h2><p>BufferMetrics defines the service monitor endpoints</p><h3 id="buffermetrics-">(Metrics, required)</h3><h3 id="buffermetrics-mount_name">mount_name (string, optional)</h3><h2 id="servicemonitorconfig">ServiceMonitorConfig</h2><p>ServiceMonitorConfig defines the ServiceMonitor properties</p><h3 id="servicemonitorconfig-additionallabels">additionalLabels (map[string]string, optional)</h3><h3 id="servicemonitorconfig-honorlabels">honorLabels (bool, optional)</h3><h3 id="servicemonitorconfig-metricrelabelings">metricRelabelings ([]v1.RelabelConfig, optional)</h3><h3 id="servicemonitorconfig-relabelings">relabelings ([]v1.RelabelConfig, optional)</h3><h3 id="servicemonitorconfig-scheme">scheme (string, optional)</h3><h3 id="servicemonitorconfig-tlsconfig">tlsConfig (*v1.TLSConfig, optional)</h3><h2 id="security">Security</h2><p>Security defines Fluentd, FluentbitAgent deployment security properties</p><h3 id="security-createopenshiftscc">createOpenShiftSCC (*bool, optional)</h3><h3 id="security-podsecuritycontext">podSecurityContext (*corev1.PodSecurityContext, optional)</h3><h3 id="security-podsecuritypolicycreate">podSecurityPolicyCreate (bool, optional)</h3><p>Warning: this is not supported anymore and does nothing</p><h3 id="security-rolebasedaccesscontrolcreate">roleBasedAccessControlCreate (*bool, optional)</h3><h3 id="security-securitycontext">securityContext (*corev1.SecurityContext, optional)</h3><h3 id="security-serviceaccount">serviceAccount (string, optional)</h3><h2 id="readinessdefaultcheck">ReadinessDefaultCheck</h2><p>ReadinessDefaultCheck Enable default readiness checks</p><h3 id="readinessdefaultcheck-bufferfilenumber">bufferFileNumber (bool, optional)</h3><h3 id="readinessdefaultcheck-bufferfilenumbermax">bufferFileNumberMax (int32, optional)</h3><h3 id="readinessdefaultcheck-bufferfreespace">bufferFreeSpace (bool, optional)</h3><p>Enable default Readiness check it&rsquo;ll fail if the buffer volume free space exceeds the <code>readinessDefaultThreshold</code> percentage (90%).</p><h3 id="readinessdefaultcheck-bufferfreespacethreshold">bufferFreeSpaceThreshold (int32, optional)</h3><h3 id="readinessdefaultcheck-failurethreshold">failureThreshold (int32, optional)</h3><h3 id="readinessdefaultcheck-initialdelayseconds">initialDelaySeconds (int32, optional)</h3><h3 id="readinessdefaultcheck-periodseconds">periodSeconds (int32, optional)</h3><h3 id="readinessdefaultcheck-successthreshold">successThreshold (int32, optional)</h3><h3 id="readinessdefaultcheck-timeoutseconds">timeoutSeconds (int32, optional)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-9c0c5afa7fb47abe7a0d1dee1e0cbc7b">4.7.1.4 - FlowSpec</h1><h2 id="flowspec">FlowSpec</h2><p>FlowSpec is the Kubernetes spec for Flows</p><h3 id="flowspec-filters">filters ([]Filter, optional)</h3><h3 id="flowspec-flowlabel">flowLabel (string, optional)</h3><h3 id="flowspec-globaloutputrefs">globalOutputRefs ([]string, optional)</h3><h3 id="flowspec-includelabelinrouter">includeLabelInRouter (*bool, optional)</h3><h3 id="flowspec-localoutputrefs">localOutputRefs ([]string, optional)</h3><h3 id="flowspec-loggingref">loggingRef (string, optional)</h3><h3 id="flowspec-match">match ([]Match, optional)</h3><h3 id="flowspec-outputrefs">outputRefs ([]string, optional)</h3><p>Deprecated</p><h3 id="flowspec-selectors">selectors (map[string]string, optional)</h3><p>Deprecated</p><h2 id="match">Match</h2><h3 id="match-select">select (*Select, optional)</h3><h3 id="match-exclude">exclude (*Exclude, optional)</h3><h2 id="select">Select</h2><h3 id="select-container_names">container_names ([]string, optional)</h3><h3 id="select-hosts">hosts ([]string, optional)</h3><h3 id="select-labels">labels (map[string]string, optional)</h3><h2 id="exclude">Exclude</h2><h3 id="exclude-container_names">container_names ([]string, optional)</h3><h3 id="exclude-hosts">hosts ([]string, optional)</h3><h3 id="exclude-labels">labels (map[string]string, optional)</h3><h3 id="exclude-namespace_labels">namespace_labels (map[string]string, optional)</h3><h2 id="filter">Filter</h2><p>Filter definition for FlowSpec</p><h3 id="filter-concat">concat (*filter.Concat, optional)</h3><h3 id="filter-dedot">dedot (*filter.DedotFilterConfig, optional)</h3><h3 id="filter-detectexceptions">detectExceptions (*filter.DetectExceptions, optional)</h3><h3 id="filter-elasticsearch_genid">elasticsearch_genid (*filter.ElasticsearchGenId, optional)</h3><h3 id="filter-geoip">geoip (*filter.GeoIP, optional)</h3><h3 id="filter-grep">grep (*filter.GrepConfig, optional)</h3><h3 id="filter-kube_events_timestamp">kube_events_timestamp (*filter.KubeEventsTimestampConfig, optional)</h3><h3 id="filter-parser">parser (*filter.ParserConfig, optional)</h3><h3 id="filter-prometheus">prometheus (*filter.PrometheusConfig, optional)</h3><h3 id="filter-record_modifier">record_modifier (*filter.RecordModifier, optional)</h3><h3 id="filter-record_transformer">record_transformer (*filter.RecordTransformer, optional)</h3><h3 id="filter-stdout">stdout (*filter.StdOutFilterConfig, optional)</h3><h3 id="filter-tag_normaliser">tag_normaliser (*filter.TagNormaliser, optional)</h3><h3 id="filter-throttle">throttle (*filter.Throttle, optional)</h3><h3 id="filter-useragent">useragent (*filter.UserAgent, optional)</h3><h2 id="flowstatus">FlowStatus</h2><p>FlowStatus defines the observed state of Flow</p><h3 id="flowstatus-active">active (*bool, optional)</h3><h3 id="flowstatus-problems">problems ([]string, optional)</h3><h3 id="flowstatus-problemscount">problemsCount (int, optional)</h3><h2 id="flow">Flow</h2><p>Flow Kubernetes object</p><h3 id="flow-">(metav1.TypeMeta, required)</h3><h3 id="flow-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="flow-spec">spec (FlowSpec, optional)</h3><h3 id="flow-status">status (FlowStatus, optional)</h3><h2 id="flowlist">FlowList</h2><p>FlowList contains a list of Flow</p><h3 id="flowlist-">(metav1.TypeMeta, required)</h3><h3 id="flowlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="flowlist-items">items ([]Flow, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-b9b388c411066f5f6dd5a2eef91b8474">4.7.1.5 - FluentbitSpec</h1><h2 id="fluentbitagent">FluentbitAgent</h2><p>FluentbitAgent is the Schema for the loggings API</p><h3 id="fluentbitagent-">(metav1.TypeMeta, required)</h3><h3 id="fluentbitagent-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="fluentbitagent-spec">spec (FluentbitSpec, optional)</h3><h3 id="fluentbitagent-status">status (FluentbitStatus, optional)</h3><h2 id="fluentbitagentlist">FluentbitAgentList</h2><p>FluentbitAgentList contains a list of FluentbitAgent</p><h3 id="fluentbitagentlist-">(metav1.TypeMeta, required)</h3><h3 id="fluentbitagentlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="fluentbitagentlist-items">items ([]FluentbitAgent, required)</h3><h2 id="fluentbitspec">FluentbitSpec</h2><p>FluentbitSpec defines the desired state of FluentbitAgent</p><h3 id="fluentbitspec-affinity">affinity (*corev1.Affinity, optional)</h3><h3 id="fluentbitspec-annotations">annotations (map[string]string, optional)</h3><h3 id="fluentbitspec-bufferstorage">bufferStorage (BufferStorage, optional)</h3><h3 id="fluentbitspec-bufferstoragevolume">bufferStorageVolume (volume.KubernetesVolume, optional)</h3><p><a href="https://github.com/cisco-open/operator-tools/tree/master/docs/types">volume.KubernetesVolume</a></p><h3 id="fluentbitspec-buffervolumeargs">bufferVolumeArgs ([]string, optional)</h3><h3 id="fluentbitspec-buffervolumeimage">bufferVolumeImage (ImageSpec, optional)</h3><h3 id="fluentbitspec-buffervolumelivenessprobe">bufferVolumeLivenessProbe (*corev1.Probe, optional)</h3><h3 id="fluentbitspec-buffervolumemetrics">bufferVolumeMetrics (*Metrics, optional)</h3><h3 id="fluentbitspec-buffervolumeresources">bufferVolumeResources (corev1.ResourceRequirements, optional)</h3><h3 id="fluentbitspec-confighotreload">configHotReload (*HotReload, optional)</h3><h3 id="fluentbitspec-corostacksize">coroStackSize (int32, optional)</h3><p>Set the coroutines stack size in bytes. The value must be greater than the page size of the running system. Don&rsquo;t set too small value (say 4096), or coroutine threads can overrun the stack buffer. Do not change the default value of this parameter unless you know what you are doing. (default: 24576)</p><p>Default: 24576</p><h3 id="fluentbitspec-customconfigsecret">customConfigSecret (string, optional)</h3><h3 id="fluentbitspec-customparsers">customParsers (string, optional)</h3><p>Available in Logging operator version 4.2 and later. Specify a custom parser file to load in addition to the default parsers file. It must be a valid key in the configmap specified by customConfig.</p><p>The following example defines a <a href="/5.1/docs/configuration/plugins/filters/parser/">Fluentd parser</a> that places the parsed containerd log messages into the <code>log</code> field instead of the <code>message</code> field.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">containerd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">inputTail</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">Parser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">cri-log-key</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Parser that populates `log` instead of `message` to enable the Kubernetes filter&#39;s Merge_Log feature to work</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Mind the indentation, otherwise Fluent Bit will parse the whole message into the `log` key</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">customParsers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:700">|</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                  [PARSER]
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                      Name cri-log-key
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                      Format regex
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                      Regex ^(?&lt;time&gt;[^ ]+) (?&lt;stream&gt;stdout|stderr) (?&lt;logtag&gt;[^ ]*) (?&lt;log&gt;.*)$
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                      Time_Key    time
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                      Time_Format %Y-%m-%dT%H:%M:%S.%L%z</span><span style="color:#f8f8f8;text-decoration:underline">                  
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Required key remap if one wants to rely on the existing auto-detected log key in the fluentd parser and concat filter otherwise should be omitted</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filterModify</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">rules</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">Rename</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">message</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="fluentbitspec-dnsconfig">dnsConfig (*corev1.PodDNSConfig, optional)</h3><h3 id="fluentbitspec-dnspolicy">dnsPolicy (corev1.DNSPolicy, optional)</h3><h3 id="fluentbitspec-daemonsetannotations">daemonsetAnnotations (map[string]string, optional)</h3><h3 id="fluentbitspec-disablekubernetesfilter">disableKubernetesFilter (*bool, optional)</h3><p>Disable Kubernetes metadata filter</p><h3 id="fluentbitspec-enableupstream">enableUpstream (bool, optional)</h3><h3 id="fluentbitspec-enabledipv6">enabledIPv6 (bool, optional)</h3><h3 id="fluentbitspec-envvars">envVars ([]corev1.EnvVar, optional)</h3><h3 id="fluentbitspec-extravolumemounts">extraVolumeMounts ([]*VolumeMount, optional)</h3><h3 id="fluentbitspec-filteraws">filterAws (*FilterAws, optional)</h3><h3 id="fluentbitspec-filterkubernetes">filterKubernetes (FilterKubernetes, optional)</h3><p>Parameters for Kubernetes metadata filter</p><h3 id="fluentbitspec-filtermodify">filterModify ([]FilterModify, optional)</h3><h3 id="fluentbitspec-flush">flush (int32, optional)</h3><p>Set the flush time in seconds.nanoseconds. The engine loop uses a Flush timeout to define when is required to flush the records ingested by input plugins through the defined output plugins. (default: 1)</p><p>Default: 1</p><h3 id="fluentbitspec-forcehotreloadaftergrace">forceHotReloadAfterGrace (bool, optional)</h3><p>HotReload pauses all inputs and waits until they finish. In certain situations this is unacceptable, for example, if an output is down for a longer time. An undocumented option called &ldquo;Hot_Reload.Ensure_Thread_Safety Off&rdquo; can be used at the [SERVICE] config to force hotreload after the grace period. Note that it might result in a SIGSEGV, but worst case kubelet will restart the container. See <a href="https://github.com/fluent/fluent-bit/pull/7509">https://github.com/fluent/fluent-bit/pull/7509</a></p><h3 id="fluentbitspec-forwardoptions">forwardOptions (*ForwardOptions, optional)</h3><h3 id="fluentbitspec-grace">grace (int32, optional)</h3><p>Set the grace time in seconds as Integer value. The engine loop uses a Grace timeout to define wait time on exit.</p><p>Default: 5</p><h3 id="fluentbitspec-healthcheck">healthCheck (*HealthCheck, optional)</h3><p>Available in Logging operator version 4.4 and later.</p><h3 id="fluentbitspec-hostnetwork">HostNetwork (bool, optional)</h3><h3 id="fluentbitspec-image">image (ImageSpec, optional)</h3><h3 id="fluentbitspec-inputtail">inputTail (InputTail, optional)</h3><h3 id="fluentbitspec-labels">labels (map[string]string, optional)</h3><h3 id="fluentbitspec-livenessdefaultcheck">livenessDefaultCheck (bool, optional)</h3><h3 id="fluentbitspec-livenessprobe">livenessProbe (*corev1.Probe, optional)</h3><h3 id="fluentbitspec-loglevel">logLevel (string, optional)</h3><p>Set the logging verbosity level. Allowed values are: error, warn, info, debug and trace. Values are accumulative, e.g: if &lsquo;debug&rsquo; is set, it will include error, warning, info and debug. Note that trace mode is only available if Fluent Bit was built with the WITH_TRACE option enabled.</p><p>Default: info</p><h3 id="fluentbitspec-loggingref">loggingRef (string, optional)</h3><h3 id="fluentbitspec-metrics">metrics (*Metrics, optional)</h3><h3 id="fluentbitspec-mountpath">mountPath (string, optional)</h3><h3 id="fluentbitspec-network">network (*FluentbitNetwork, optional)</h3><h3 id="fluentbitspec-nodeselector">nodeSelector (map[string]string, optional)</h3><h3 id="fluentbitspec-parser">parser (string, optional)</h3><p>Deprecated, use inputTail.parser</p><h3 id="fluentbitspec-podpriorityclassname">podPriorityClassName (string, optional)</h3><h3 id="fluentbitspec-position_db">position_db (*volume.KubernetesVolume, optional)</h3><p>Deprecated, use positiondb</p><h3 id="fluentbitspec-positiondb">positiondb (volume.KubernetesVolume, optional)</h3><p><a href="https://github.com/cisco-open/operator-tools/tree/master/docs/types">volume.KubernetesVolume</a></p><h3 id="fluentbitspec-readinessprobe">readinessProbe (*corev1.Probe, optional)</h3><h3 id="fluentbitspec-resources">resources (corev1.ResourceRequirements, optional)</h3><h3 id="fluentbitspec-security">security (*Security, optional)</h3><h3 id="fluentbitspec-serviceaccount">serviceAccount (*typeoverride.ServiceAccount, optional)</h3><h3 id="fluentbitspec-syslogng_output">syslogng_output (*FluentbitTCPOutput, optional)</h3><h3 id="fluentbitspec-tls">tls (*FluentbitTLS, optional)</h3><h3 id="fluentbitspec-targethost">targetHost (string, optional)</h3><h3 id="fluentbitspec-targetport">targetPort (int32, optional)</h3><h3 id="fluentbitspec-tolerations">tolerations ([]corev1.Toleration, optional)</h3><h3 id="fluentbitspec-updatestrategy">updateStrategy (appsv1.DaemonSetUpdateStrategy, optional)</h3><h2 id="fluentbitstatus">FluentbitStatus</h2><p>FluentbitStatus defines the resource status for FluentbitAgent</p><h2 id="fluentbittls">FluentbitTLS</h2><p>FluentbitTLS defines the TLS configs</p><h3 id="fluentbittls-enabled">enabled (*bool, required)</h3><h3 id="fluentbittls-secretname">secretName (string, optional)</h3><h3 id="fluentbittls-sharedkey">sharedKey (string, optional)</h3><h2 id="fluentbittcpoutput">FluentbitTCPOutput</h2><p>FluentbitTCPOutput defines the TLS configs</p><h3 id="fluentbittcpoutput-json_date_format">json_date_format (string, optional)</h3><p>Default: iso8601</p><h3 id="fluentbittcpoutput-json_date_key">json_date_key (string, optional)</h3><p>Default: ts</p><h3 id="fluentbittcpoutput-retry_limit">Retry_Limit (string, optional)</h3><p>Available in Logging operator version 4.8 and later.</p><h3 id="fluentbittcpoutput-workers">Workers (*int, optional)</h3><p>Available in Logging operator version 4.4 and later.</p><h2 id="fluentbitnetwork">FluentbitNetwork</h2><p>FluentbitNetwork defines network configuration for fluentbit</p><h3 id="fluentbitnetwork-connecttimeout">connectTimeout (*uint32, optional)</h3><p>Sets the timeout for connecting to an upstream</p><p>Default: 10</p><h3 id="fluentbitnetwork-connecttimeoutlogerror">connectTimeoutLogError (*bool, optional)</h3><p>On connection timeout, specify if it should log an error. When disabled, the timeout is logged as a debug message</p><p>Default: true</p><h3 id="fluentbitnetwork-dnsmode">dnsMode (string, optional)</h3><p>Sets the primary transport layer protocol used by the asynchronous DNS resolver for connections established</p><p>Default: UDP, UDP or TCP</p><h3 id="fluentbitnetwork-dnspreferipv4">dnsPreferIpv4 (*bool, optional)</h3><p>Prioritize IPv4 DNS results when trying to establish a connection</p><p>Default: false</p><h3 id="fluentbitnetwork-dnsresolver">dnsResolver (string, optional)</h3><p>Select the primary DNS resolver type</p><p>Default: ASYNC, LEGACY or ASYNC</p><h3 id="fluentbitnetwork-keepalive">keepalive (*bool, optional)</h3><p>Whether or not TCP keepalive is used for the upstream connection</p><p>Default: true</p><h3 id="fluentbitnetwork-keepaliveidletimeout">keepaliveIdleTimeout (*uint32, optional)</h3><p>How long in seconds a TCP keepalive connection can be idle before being recycled</p><p>Default: 30</p><h3 id="fluentbitnetwork-keepalivemaxrecycle">keepaliveMaxRecycle (*uint32, optional)</h3><p>How many times a TCP keepalive connection can be used before being recycled</p><p>Default: 0, disabled</p><h3 id="fluentbitnetwork-maxworkerconnections">maxWorkerConnections (int, optional)</h3><p>Set maximum number of TCP connections that can be established per worker.</p><p>Default: 0, unlimited</p><h3 id="fluentbitnetwork-sourceaddress">sourceAddress (string, optional)</h3><p>Specify network address (interface) to use for connection and data traffic.</p><p>Default: disabled</p><h2 id="bufferstorage">BufferStorage</h2><p>BufferStorage is the Service Section Configuration of fluent-bit</p><h3 id="bufferstorage-storage.backlog.mem_limit">storage.backlog.mem_limit (string, optional)</h3><p>If storage.path is set, Fluent Bit will look for data chunks that were not delivered and are still in the storage layer, these are called backlog data. This option configure a hint of maximum value of memory to use when processing these records.</p><p>Default: 5M</p><h3 id="bufferstorage-storage.checksum">storage.checksum (string, optional)</h3><p>Enable the data integrity check when writing and reading data from the filesystem. The storage layer uses the CRC32 algorithm.</p><p>Default: Off</p><h3 id="bufferstorage-storage.delete_irrecoverable_chunks">storage.delete_irrecoverable_chunks (string, optional)</h3><p>When enabled, irrecoverable chunks will be deleted during runtime, and any other irrecoverable chunk located in the configured storage path directory will be deleted when Fluent Bit starts.</p><p>Default: Off</p><h3 id="bufferstorage-storage.max_chunks_up">storage.max_chunks_up (int, optional)</h3><p>If the input plugin has enabled filesystem storage type, this property sets the maximum number of Chunks that can be up in memory. This is the setting to use to control memory usage when you enable storage.type filesystem.</p><p>Default: 128</p><h3 id="bufferstorage-storage.metrics">storage.metrics (string, optional)</h3><p>Available in Logging operator version 4.4 and later. If the <code>http_server</code> option has been enabled in the main Service configuration section, this option registers a new endpoint where internal metrics of the storage layer can be consumed.</p><p>Default: Off</p><h3 id="bufferstorage-storage.path">storage.path (string, optional)</h3><p>Set an optional location in the file system to store streams and chunks of data. If this parameter is not set, Input plugins can only use in-memory buffering.</p><h3 id="bufferstorage-storage.sync">storage.sync (string, optional)</h3><p>Configure the synchronization mode used to store the data into the file system. It can take the values normal or full.</p><p>Default: normal</p><h2 id="healthcheck">HealthCheck</h2><p>HealthCheck configuration. Available in Logging operator version 4.4 and later.</p><h3 id="healthcheck-hcerrorscount">hcErrorsCount (int, optional)</h3><p>The error count to meet the unhealthy requirement, this is a sum for all output plugins in a defined HC_Period.</p><p>Default: 5</p><h3 id="healthcheck-hcperiod">hcPeriod (int, optional)</h3><p>The time period (in seconds) to count the error and retry failure data point.</p><p>Default: 60</p><h3 id="healthcheck-hcretryfailurecount">hcRetryFailureCount (int, optional)</h3><p>The retry failure count to meet the unhealthy requirement, this is a sum for all output plugins in a defined HC_Period</p><p>Default: 5</p><h2 id="hotreload">HotReload</h2><p>HotReload configuration</p><h3 id="hotreload-image">image (ImageSpec, optional)</h3><h3 id="hotreload-resources">resources (corev1.ResourceRequirements, optional)</h3><h2 id="inputtail">InputTail</h2><p>InputTail defines FluentbitAgent tail input configuration The tail input plugin allows to monitor one or several text files. It has a similar behavior like tail -f shell command.</p><h3 id="inputtail-buffer_chunk_size">Buffer_Chunk_Size (string, optional)</h3><p>Set the buffer size for HTTP client when reading responses from Kubernetes API server. The value must be according to the Unit Size specification.</p><p>Default: 32k</p><h3 id="inputtail-buffer_max_size">Buffer_Max_Size (string, optional)</h3><p>Set the limit of the buffer size per monitored file. When a buffer needs to be increased (e.g: very long lines), this value is used to restrict how much the memory buffer can grow. If reading a file exceed this limit, the file is removed from the monitored file list. The value must be according to the Unit Size specification.</p><p>Default: Buffer_Chunk_Size</p><h3 id="inputtail-db">DB (*string, optional)</h3><p>Specify the database file to keep track of monitored files and offsets.</p><h3 id="inputtail-db.journal_mode">DB.journal_mode (string, optional)</h3><p>sets the journal mode for databases (WAL). Enabling WAL provides higher performance. Note that WAL is not compatible with shared network file systems.</p><p>Default: WAL</p><h3 id="inputtail-db.locking">DB.locking (*bool, optional)</h3><p>Specify that the database will be accessed only by Fluent Bit. Enabling this feature helps to increase performance when accessing the database but it restrict any external tool to query the content.</p><p>Default: true</p><h3 id="inputtail-db_sync">DB_Sync (string, optional)</h3><p>Set a default synchronization (I/O) method. Values: Extra, Full, Normal, Off. This flag affects how the internal SQLite engine do synchronization to disk, for more details about each option please refer to this section.</p><p>Default: Full</p><h3 id="inputtail-docker_mode">Docker_Mode (string, optional)</h3><p>If enabled, the plugin will recombine split Docker log lines before passing them to any parser as configured above. This mode cannot be used at the same time as Multiline.</p><p>Default: Off</p><h3 id="inputtail-docker_mode_flush">Docker_Mode_Flush (string, optional)</h3><p>Wait period time in seconds to flush queued unfinished split lines.</p><p>Default: 4</p><h3 id="inputtail-docker_mode_parser">Docker_Mode_Parser (string, optional)</h3><p>Specify an optional parser for the first line of the docker multiline mode.</p><h3 id="inputtail-exclude_path">Exclude_Path (string, optional)</h3><p>Set one or multiple shell patterns separated by commas to exclude files matching a certain criteria, e.g: exclude_path=<em>.gz,</em>.zip</p><h3 id="inputtail-ignore_older">Ignore_Older (string, optional)</h3><p>Ignores files that have been last modified before this time in seconds. Supports m,h,d (minutes, hours,days) syntax. Default behavior is to read all specified files.</p><h3 id="inputtail-key">Key (string, optional)</h3><p>When a message is unstructured (no parser applied), it&rsquo;s appended as a string under the key name log. This option allows to define an alternative name for that key.</p><p>Default: log</p><h3 id="inputtail-mem_buf_limit">Mem_Buf_Limit (string, optional)</h3><p>Set a limit of memory that Tail plugin can use when appending data to the Engine. If the limit is reach, it will be paused; when the data is flushed it resumes.</p><h3 id="inputtail-multiline">Multiline (string, optional)</h3><p>If enabled, the plugin will try to discover multiline messages and use the proper parsers to compose the outgoing messages. Note that when this option is enabled the Parser option is not used.</p><p>Default: Off</p><h3 id="inputtail-multiline_flush">Multiline_Flush (string, optional)</h3><p>Wait period time in seconds to process queued multiline messages</p><p>Default: 4</p><h3 id="inputtail-multiline.parser">multiline.parser ([]string, optional)</h3><p>Specify one or multiple parser definitions to apply to the content. Part of the new Multiline Core support in 1.8</p><p>Default: ""</p><h3 id="inputtail-parser">Parser (string, optional)</h3><p>Specify the name of a parser to interpret the entry as a structured message.</p><h3 id="inputtail-parser_firstline">Parser_Firstline (string, optional)</h3><p>Name of the parser that machs the beginning of a multiline message. Note that the regular expression defined in the parser must include a group name (named capture)</p><h3 id="inputtail-parser_n">Parser_N ([]string, optional)</h3><p>Optional-extra parser to interpret and structure multiline entries. This option can be used to define multiple parsers, e.g: Parser_1 ab1, Parser_2 ab2, Parser_N abN.</p><h3 id="inputtail-path">Path (string, optional)</h3><p>Pattern specifying a specific log files or multiple ones through the use of common wildcards.</p><h3 id="inputtail-path_key">Path_Key (string, optional)</h3><p>If enabled, it appends the name of the monitored file as part of the record. The value assigned becomes the key in the map.</p><h3 id="inputtail-read_from_head">Read_From_Head (bool, optional)</h3><p>For new discovered files on start (without a database offset/position), read the content from the head of the file, not tail.</p><h3 id="inputtail-refresh_interval">Refresh_Interval (string, optional)</h3><p>The interval of refreshing the list of watched files in seconds.</p><p>Default: 60</p><h3 id="inputtail-rotate_wait">Rotate_Wait (string, optional)</h3><p>Specify the number of extra time in seconds to monitor a file once is rotated in case some pending data is flushed.</p><p>Default: 5</p><h3 id="inputtail-skip_long_lines">Skip_Long_Lines (string, optional)</h3><p>When a monitored file reach it buffer capacity due to a very long line (Buffer_Max_Size), the default behavior is to stop monitoring that file. Skip_Long_Lines alter that behavior and instruct Fluent Bit to skip long lines and continue processing other lines that fits into the buffer size.</p><p>Default: Off</p><h3 id="inputtail-storage.pause_on_chunks_overlimit">storage.pause_on_chunks_overlimit (string, optional)</h3><p>Specifies whether to pause or drop data when the buffer is full. This helps to make sure we apply backpressure on the input if enabled, see <a href="https://docs.fluentbit.io/manual/administration/backpressure">https://docs.fluentbit.io/manual/administration/backpressure</a></p><p>Default: on</p><h3 id="inputtail-storage.type">storage.type (string, optional)</h3><p>Specify the buffering mechanism to use. It can be memory or filesystem.</p><p>Default: memory</p><h3 id="inputtail-tag">Tag (string, optional)</h3><p>Set a tag (with regex-extract fields) that will be placed on lines read.</p><h3 id="inputtail-tag_regex">Tag_Regex (string, optional)</h3><p>Set a regex to extract fields from the file.</p><h2 id="filterkubernetes">FilterKubernetes</h2><p>FilterKubernetes Fluent Bit Kubernetes Filter allows to enrich your log files with Kubernetes metadata.</p><h3 id="filterkubernetes-annotations">Annotations (string, optional)</h3><p>Include Kubernetes resource annotations in the extra metadata.</p><p>Default: On</p><h3 id="filterkubernetes-buffer_size">Buffer_Size (string, optional)</h3><p>Set the buffer size for HTTP client when reading responses from Kubernetes API server. The value must be according to the Unit Size specification. A value of 0 results in no limit, and the buffer will expand as-needed. Note that if pod specifications exceed the buffer limit, the API response will be discarded when retrieving metadata, and some kubernetes metadata will fail to be injected to the logs. If this value is empty we will set it &ldquo;0&rdquo;.</p><p>Default: &ldquo;0&rdquo;</p><h3 id="filterkubernetes-cache_use_docker_id">Cache_Use_Docker_Id (string, optional)</h3><p>When enabled, metadata will be fetched from K8s when docker_id is changed.</p><p>Default: Off</p><h3 id="filterkubernetes-dns_retries">DNS_Retries (string, optional)</h3><p>DNS lookup retries N times until the network start working</p><p>Default: 6</p><h3 id="filterkubernetes-dns_wait_time">DNS_Wait_Time (string, optional)</h3><p>DNS lookup interval between network status checks</p><p>Default: 30</p><h3 id="filterkubernetes-dummy_meta">Dummy_Meta (string, optional)</h3><p>If set, use dummy-meta data (for test/dev purposes)</p><p>Default: Off</p><h3 id="filterkubernetes-k8s-logging.exclude">K8S-Logging.Exclude (string, optional)</h3><p>Allow Kubernetes Pods to exclude their logs from the log processor (read more about it in Kubernetes Annotations section).</p><p>Default: On</p><h3 id="filterkubernetes-k8s-logging.parser">K8S-Logging.Parser (string, optional)</h3><p>Allow Kubernetes Pods to suggest a pre-defined Parser (read more about it in Kubernetes Annotations section)</p><p>Default: Off</p><h3 id="filterkubernetes-keep_log">Keep_Log (string, optional)</h3><p>When Keep_Log is disabled, the log field is removed from the incoming message once it has been successfully merged (Merge_Log must be enabled as well).</p><p>Default: On</p><h3 id="filterkubernetes-kube_ca_file">Kube_CA_File (string, optional)</h3><p>CA certificate file (default:/var/run/secrets/kubernetes.io/serviceaccount/ca.crt)</p><p>Default: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt</p><h3 id="filterkubernetes-kube_ca_path">Kube_CA_Path (string, optional)</h3><p>Absolute path to scan for certificate files</p><h3 id="filterkubernetes-kube_meta_cache_ttl">Kube_Meta_Cache_TTL (string, optional)</h3><p>Configurable TTL for K8s cached metadata. By default, it is set to 0 which means TTL for cache entries is disabled and cache entries are evicted at random when capacity is reached. In order to enable this option, you should set the number to a time interval. For example, set this value to 60 or 60s and cache entries which have been created more than 60s will be evicted.</p><p>Default: 0</p><h3 id="filterkubernetes-kube_meta_preload_cache_dir">Kube_meta_preload_cache_dir (string, optional)</h3><p>If set, Kubernetes meta-data can be cached/pre-loaded from files in JSON format in this directory, named as namespace-pod.meta</p><h3 id="filterkubernetes-kube_tag_prefix">Kube_Tag_Prefix (string, optional)</h3><p>When the source records comes from Tail input plugin, this option allows to specify what&rsquo;s the prefix used in Tail configuration. (default:kube.var.log.containers.)</p><p>Default: kubernetes.var.log.containers</p><h3 id="filterkubernetes-kube_token_file">Kube_Token_File (string, optional)</h3><p>Token file (default:/var/run/secrets/kubernetes.io/serviceaccount/token)</p><p>Default: /var/run/secrets/kubernetes.io/serviceaccount/token</p><h3 id="filterkubernetes-kube_token_ttl">Kube_Token_TTL (string, optional)</h3><p>Token TTL configurable &rsquo;time to live&rsquo; for the K8s token. By default, it is set to 600 seconds. After this time, the token is reloaded from Kube_Token_File or the Kube_Token_Command. (default:&ldquo;600&rdquo;)</p><p>Default: 600</p><h3 id="filterkubernetes-kube_url">Kube_URL (string, optional)</h3><p>API Server end-point.</p><p>Default: <code>https://kubernetes.default.svc:443</code></p><h3 id="filterkubernetes-kubelet_port">Kubelet_Port (string, optional)</h3><p>kubelet port using for HTTP request, this only works when Use_Kubelet set to On</p><p>Default: 10250</p><h3 id="filterkubernetes-labels">Labels (string, optional)</h3><p>Include Kubernetes resource labels in the extra metadata.</p><p>Default: On</p><h3 id="filterkubernetes-match">Match (string, optional)</h3><p>Match filtered records (default:kube.*)</p><p>Default: kubernetes.*</p><h3 id="filterkubernetes-merge_log">Merge_Log (string, optional)</h3><p>When enabled, it checks if the log field content is a JSON string map, if so, it append the map fields as part of the log structure. (default:Off)</p><p>Default: On</p><h3 id="filterkubernetes-merge_log_key">Merge_Log_Key (string, optional)</h3><p>When Merge_Log is enabled, the filter tries to assume the log field from the incoming message is a JSON string message and make a structured representation of it at the same level of the log field in the map. Now if Merge_Log_Key is set (a string name), all the new structured fields taken from the original log content are inserted under the new key.</p><h3 id="filterkubernetes-merge_log_trim">Merge_Log_Trim (string, optional)</h3><p>When Merge_Log is enabled, trim (remove possible \n or \r) field values.</p><p>Default: On</p><h3 id="filterkubernetes-merge_parser">Merge_Parser (string, optional)</h3><p>Optional parser name to specify how to parse the data contained in the log key. Recommended use is for developers or testing only.</p><h3 id="filterkubernetes-namespace_annotations">namespace_annotations (string, optional)</h3><p>Include Kubernetes namespace annotations on every record</p><h3 id="filterkubernetes-kube_meta_namespace_cache_ttl">kube_meta_namespace_cache_ttl (string, optional)</h3><p>Configurable TTL for K8s cached namespace metadata. (15m)</p><h3 id="filterkubernetes-namespace_labels">namespace_labels (string, optional)</h3><p>Include Kubernetes namespace labels on every record</p><p>Default: On</p><h3 id="filterkubernetes-regex_parser">Regex_Parser (string, optional)</h3><p>Set an alternative Parser to process record Tag and extract pod_name, namespace_name, container_name and docker_id. The parser must be registered in a parsers file (refer to parser filter-kube-test as an example).</p><h3 id="filterkubernetes-tls.debug">tls.debug (string, optional)</h3><p>Debug level between 0 (nothing) and 4 (every detail).</p><p>Default: -1</p><h3 id="filterkubernetes-tls.verify">tls.verify (string, optional)</h3><p>When enabled, turns on certificate validation when connecting to the Kubernetes API server.</p><p>Default: On</p><h3 id="filterkubernetes-use_journal">Use_Journal (string, optional)</h3><p>When enabled, the filter reads logs coming in Journald format.</p><p>Default: Off</p><h3 id="filterkubernetes-use_kubelet">Use_Kubelet (string, optional)</h3><p>This is an optional feature flag to get metadata information from kubelet instead of calling Kube Server API to enhance the log.</p><p>Default: Off</p><h2 id="filteraws">FilterAws</h2><p>FilterAws The AWS Filter Enriches logs with AWS Metadata.</p><h3 id="filteraws-az">az (*bool, optional)</h3><p>The availability zone (default:true).</p><p>Default: true</p><h3 id="filteraws-account_id">account_id (*bool, optional)</h3><p>The account ID for current EC2 instance. (default:false)</p><p>Default: false</p><h3 id="filteraws-ami_id">ami_id (*bool, optional)</h3><p>The EC2 instance image id. (default:false)</p><p>Default: false</p><h3 id="filteraws-ec2_instance_id">ec2_instance_id (*bool, optional)</h3><p>The EC2 instance ID. (default:true)</p><p>Default: true</p><h3 id="filteraws-ec2_instance_type">ec2_instance_type (*bool, optional)</h3><p>The EC2 instance type. (default:false)</p><p>Default: false</p><h3 id="filteraws-hostname">hostname (*bool, optional)</h3><p>The hostname for current EC2 instance. (default:false)</p><p>Default: false</p><h3 id="filteraws-imds_version">imds_version (string, optional)</h3><p>Specify which version of the instance metadata service to use. Valid values are &lsquo;v1&rsquo; or &lsquo;v2&rsquo; (default).</p><p>Default: v2</p><h3 id="filteraws-match">Match (string, optional)</h3><p>Match filtered records (default:*)</p><p>Default: *</p><h3 id="filteraws-private_ip">private_ip (*bool, optional)</h3><p>The EC2 instance private ip. (default:false)</p><p>Default: false</p><h3 id="filteraws-vpc_id">vpc_id (*bool, optional)</h3><p>The VPC ID for current EC2 instance. (default:false)</p><p>Default: false</p><h2 id="filtermodify">FilterModify</h2><p>FilterModify The Modify Filter plugin allows you to change records using rules and conditions.</p><h3 id="filtermodify-conditions">conditions ([]FilterModifyCondition, optional)</h3><p>FluentbitAgent Filter Modification Condition</p><h3 id="filtermodify-rules">rules ([]FilterModifyRule, optional)</h3><p>FluentbitAgent Filter Modification Rule</p><h2 id="filtermodifyrule">FilterModifyRule</h2><p>FilterModifyRule The Modify Filter plugin allows you to change records using rules and conditions.</p><h3 id="filtermodifyrule-add">Add (*FilterKeyValue, optional)</h3><p>Add a key/value pair with key KEY and value VALUE if KEY does not exist</p><h3 id="filtermodifyrule-copy">Copy (*FilterKeyValue, optional)</h3><p>Copy a key/value pair with key KEY to COPIED_KEY if KEY exists AND COPIED_KEY does not exist</p><h3 id="filtermodifyrule-hard_copy">Hard_copy (*FilterKeyValue, optional)</h3><p>Copy a key/value pair with key KEY to COPIED_KEY if KEY exists. If COPIED_KEY already exists, this field is overwritten</p><h3 id="filtermodifyrule-hard_rename">Hard_rename (*FilterKeyValue, optional)</h3><p>Rename a key/value pair with key KEY to RENAMED_KEY if KEY exists. If RENAMED_KEY already exists, this field is overwritten</p><h3 id="filtermodifyrule-remove">Remove (*FilterKey, optional)</h3><p>Remove a key/value pair with key KEY if it exists</p><h3 id="filtermodifyrule-remove_regex">Remove_regex (*FilterKey, optional)</h3><p>Remove all key/value pairs with key matching regexp KEY</p><h3 id="filtermodifyrule-remove_wildcard">Remove_wildcard (*FilterKey, optional)</h3><p>Remove all key/value pairs with key matching wildcard KEY</p><h3 id="filtermodifyrule-rename">Rename (*FilterKeyValue, optional)</h3><p>Rename a key/value pair with key KEY to RENAMED_KEY if KEY exists AND RENAMED_KEY does not exist</p><h3 id="filtermodifyrule-set">Set (*FilterKeyValue, optional)</h3><p>Add a key/value pair with key KEY and value VALUE. If KEY already exists, this field is overwritten</p><h2 id="filtermodifycondition">FilterModifyCondition</h2><p>FilterModifyCondition The Modify Filter plugin allows you to change records using rules and conditions.</p><h3 id="filtermodifycondition-a_key_matches">A_key_matches (*FilterKey, optional)</h3><p>Is true if a key matches regex KEY</p><h3 id="filtermodifycondition-key_does_not_exist">Key_does_not_exist (*FilterKeyValue, optional)</h3><p>Is true if KEY does not exist</p><h3 id="filtermodifycondition-key_exists">Key_exists (*FilterKey, optional)</h3><p>Is true if KEY exists</p><h3 id="filtermodifycondition-key_value_does_not_equal">Key_value_does_not_equal (*FilterKeyValue, optional)</h3><p>Is true if KEY exists and its value is not VALUE</p><h3 id="filtermodifycondition-key_value_does_not_match">Key_value_does_not_match (*FilterKeyValue, optional)</h3><p>Is true if key KEY exists and its value does not match VALUE</p><h3 id="filtermodifycondition-key_value_equals">Key_value_equals (*FilterKeyValue, optional)</h3><p>Is true if KEY exists and its value is VALUE</p><h3 id="filtermodifycondition-key_value_matches">Key_value_matches (*FilterKeyValue, optional)</h3><p>Is true if key KEY exists and its value matches VALUE</p><h3 id="filtermodifycondition-matching_keys_do_not_have_matching_values">Matching_keys_do_not_have_matching_values (*FilterKeyValue, optional)</h3><p>Is true if all keys matching KEY have values that do not match VALUE</p><h3 id="filtermodifycondition-matching_keys_have_matching_values">Matching_keys_have_matching_values (*FilterKeyValue, optional)</h3><p>Is true if all keys matching KEY have values that match VALUE</p><h3 id="filtermodifycondition-no_key_matches">No_key_matches (*FilterKey, optional)</h3><p>Is true if no key matches regex KEY</p><h2 id="operation">Operation</h2><p>Operation Doc stub</p><h3 id="operation-key">Key (string, optional)</h3><h3 id="operation-op">Op (string, optional)</h3><h3 id="operation-value">Value (string, optional)</h3><h2 id="filterkey">FilterKey</h2><h3 id="filterkey-key">key (string, optional)</h3><h2 id="filterkeyvalue">FilterKeyValue</h2><h3 id="filterkeyvalue-key">key (string, optional)</h3><h3 id="filterkeyvalue-value">value (string, optional)</h3><h2 id="volumemount">VolumeMount</h2><p>VolumeMount defines source and destination folders of a hostPath type pod mount</p><h3 id="volumemount-destination">destination (string, required)</h3><p>Destination Folder</p><h3 id="volumemount-readonly">readOnly (*bool, optional)</h3><p>Mount Mode</p><h3 id="volumemount-source">source (string, required)</h3><p>Source folder</p><h2 id="forwardoptions">ForwardOptions</h2><p>ForwardOptions defines custom forward output plugin options, see <a href="https://docs.fluentbit.io/manual/pipeline/outputs/forward">https://docs.fluentbit.io/manual/pipeline/outputs/forward</a></p><h3 id="forwardoptions-require_ack_response">Require_ack_response (bool, optional)</h3><h3 id="forwardoptions-retry_limit">Retry_Limit (string, optional)</h3><h3 id="forwardoptions-send_options">Send_options (bool, optional)</h3><h3 id="forwardoptions-storage.total_limit_size">storage.total_limit_size (string, optional)</h3><p><code>storage.total_limit_size</code> Limit the maximum number of Chunks in the filesystem for the current output logical destination.</p><h3 id="forwardoptions-tag">Tag (string, optional)</h3><h3 id="forwardoptions-time_as_integer">Time_as_Integer (bool, optional)</h3><h3 id="forwardoptions-workers">Workers (*int, optional)</h3><p>Available in Logging operator version 4.4 and later. Enables dedicated thread(s) for this output. Default value (2) is set since version 1.8.13. For previous versions is 0.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-a2aaa1e3f933893e7e8fb304ba24b4d9">4.7.1.6 - FluentdConfig</h1><h2 id="fluentdconfig">FluentdConfig</h2><h3 id="fluentdconfig-">(metav1.TypeMeta, required)</h3><h3 id="fluentdconfig-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="fluentdconfig-spec">spec (FluentdSpec, optional)</h3><h3 id="fluentdconfig-status">status (FluentdConfigStatus, optional)</h3><h2 id="fluentdconfigstatus">FluentdConfigStatus</h2><h3 id="fluentdconfigstatus-active">active (*bool, optional)</h3><h3 id="fluentdconfigstatus-logging">logging (string, optional)</h3><h3 id="fluentdconfigstatus-problems">problems ([]string, optional)</h3><h3 id="fluentdconfigstatus-problemscount">problemsCount (int, optional)</h3><h2 id="fluentdconfiglist">FluentdConfigList</h2><h3 id="fluentdconfiglist-">(metav1.TypeMeta, required)</h3><h3 id="fluentdconfiglist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="fluentdconfiglist-items">items ([]FluentdConfig, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-19e14e51b926eaba460288b329a9c8ce">4.7.1.7 - FluentdSpec</h1><h2 id="fluentdspec">FluentdSpec</h2><p>FluentdSpec defines the desired state of Fluentd</p><h3 id="fluentdspec-affinity">affinity (*corev1.Affinity, optional)</h3><h3 id="fluentdspec-annotations">annotations (map[string]string, optional)</h3><h3 id="fluentdspec-bufferstoragevolume">bufferStorageVolume (volume.KubernetesVolume, optional)</h3><p>BufferStorageVolume is by default configured as PVC using FluentdPvcSpec <a href="https://github.com/cisco-open/operator-tools/tree/master/docs/types">volume.KubernetesVolume</a></p><h3 id="fluentdspec-buffervolumeargs">bufferVolumeArgs ([]string, optional)</h3><h3 id="fluentdspec-buffervolumeimage">bufferVolumeImage (ImageSpec, optional)</h3><h3 id="fluentdspec-buffervolumelivenessprobe">bufferVolumeLivenessProbe (*corev1.Probe, optional)</h3><h3 id="fluentdspec-buffervolumemetrics">bufferVolumeMetrics (*Metrics, optional)</h3><h3 id="fluentdspec-buffervolumeresources">bufferVolumeResources (corev1.ResourceRequirements, optional)</h3><h3 id="fluentdspec-compressconfigfile">compressConfigFile (bool, optional)</h3><h3 id="fluentdspec-configcheck">configCheck (*ConfigCheck, optional)</h3><p>Overrides the default logging level configCheck setup. This field is not used directly, just copied over the field in the logging resource if defined.</p><h3 id="fluentdspec-configcheckannotations">configCheckAnnotations (map[string]string, optional)</h3><h3 id="fluentdspec-configcheckresources">configCheckResources (corev1.ResourceRequirements, optional)</h3><h3 id="fluentdspec-configreloaderimage">configReloaderImage (ImageSpec, optional)</h3><h3 id="fluentdspec-configreloaderresources">configReloaderResources (corev1.ResourceRequirements, optional)</h3><h3 id="fluentdspec-configreloaderusegracefulreloadwebhook">configReloaderUseGracefulReloadWebhook (bool, optional)</h3><h3 id="fluentdspec-dnsconfig">dnsConfig (*corev1.PodDNSConfig, optional)</h3><h3 id="fluentdspec-dnspolicy">dnsPolicy (corev1.DNSPolicy, optional)</h3><h3 id="fluentdspec-disablepvc">disablePvc (bool, optional)</h3><h3 id="fluentdspec-enablemsgpacktimesupport">enableMsgpackTimeSupport (bool, optional)</h3><p>Allows Time object in buffer&rsquo;s MessagePack serde <a href="https://docs.fluentd.org/deployment/system-config#enable_msgpack_time_support">more info</a></p><h3 id="fluentdspec-enabledipv6">enabledIPv6 (bool, optional)</h3><h3 id="fluentdspec-envvars">envVars ([]corev1.EnvVar, optional)</h3><h3 id="fluentdspec-extraargs">extraArgs ([]string, optional)</h3><h3 id="fluentdspec-extravolumes">extraVolumes ([]ExtraVolume, optional)</h3><h3 id="fluentdspec-fluentlogdestination">fluentLogDestination (string, optional)</h3><h3 id="fluentdspec-fluentoutlogrotate">fluentOutLogrotate (*FluentOutLogrotate, optional)</h3><p>FluentOutLogrotate sends fluent&rsquo;s stdout to file and rotates it</p><h3 id="fluentdspec-fluentdpvcspec">fluentdPvcSpec (*volume.KubernetesVolume, optional)</h3><p>Deprecated, use bufferStorageVolume</p><h3 id="fluentdspec-forwardinputconfig">forwardInputConfig (*input.ForwardInputConfig, optional)</h3><h3 id="fluentdspec-ignorerepeatedloginterval">ignoreRepeatedLogInterval (string, optional)</h3><p>Ignore repeated log lines <a href="https://docs.fluentd.org/deployment/logging#ignore_repeated_log_interval">more info</a></p><h3 id="fluentdspec-ignoresameloginterval">ignoreSameLogInterval (string, optional)</h3><p>Ignore same log lines <a href="https://docs.fluentd.org/deployment/logging#ignore_same_log_interval">more info</a></p><h3 id="fluentdspec-image">image (ImageSpec, optional)</h3><h3 id="fluentdspec-labels">labels (map[string]string, optional)</h3><h3 id="fluentdspec-livenessdefaultcheck">livenessDefaultCheck (bool, optional)</h3><h3 id="fluentdspec-livenessprobe">livenessProbe (*corev1.Probe, optional)</h3><h3 id="fluentdspec-logformat">logFormat (string, optional)</h3><p>Set the logging format. Allowed values are: &ldquo;text&rdquo; (default) and &ldquo;json&rdquo;.</p><h3 id="fluentdspec-loglevel">logLevel (string, optional)</h3><h3 id="fluentdspec-metrics">metrics (*Metrics, optional)</h3><h3 id="fluentdspec-nodeselector">nodeSelector (map[string]string, optional)</h3><h3 id="fluentdspec-pdb">pdb (*PdbInput, optional)</h3><h3 id="fluentdspec-podpriorityclassname">podPriorityClassName (string, optional)</h3><h3 id="fluentdspec-port">port (int32, optional)</h3><p>Fluentd port inside the container (24240 by default). The headless service port is controlled by this field as well. Note that the default ClusterIP service port is always 24240, regardless of this field.</p><h3 id="fluentdspec-readinessdefaultcheck">readinessDefaultCheck (ReadinessDefaultCheck, optional)</h3><h3 id="fluentdspec-readinessprobe">readinessProbe (*corev1.Probe, optional)</h3><h3 id="fluentdspec-resources">resources (corev1.ResourceRequirements, optional)</h3><h3 id="fluentdspec-rootdir">rootDir (string, optional)</h3><h3 id="fluentdspec-scaling">scaling (*FluentdScaling, optional)</h3><h3 id="fluentdspec-security">security (*Security, optional)</h3><h3 id="fluentdspec-serviceaccount">serviceAccount (*typeoverride.ServiceAccount, optional)</h3><h3 id="fluentdspec-sidecarcontainers">sidecarContainers ([]corev1.Container, optional)</h3><p>Available in Logging operator version 4.5 and later. Configure sidecar container in Fluentd pods, for example: <a href="https://github.com/kube-logging/logging-operator/config/samples/logging_logging_fluentd_sidecars.yaml">https://github.com/kube-logging/logging-operator/config/samples/logging_logging_fluentd_sidecars.yaml</a>.</p><h3 id="fluentdspec-statefulsetannotations">statefulsetAnnotations (map[string]string, optional)</h3><h3 id="fluentdspec-tls">tls (FluentdTLS, optional)</h3><h3 id="fluentdspec-tolerations">tolerations ([]corev1.Toleration, optional)</h3><h3 id="fluentdspec-topologyspreadconstraints">topologySpreadConstraints ([]corev1.TopologySpreadConstraint, optional)</h3><h3 id="fluentdspec-volumemodimage">volumeModImage (ImageSpec, optional)</h3><h3 id="fluentdspec-volumemountchmod">volumeMountChmod (bool, optional)</h3><h3 id="fluentdspec-workers">workers (int32, optional)</h3><h2 id="fluentoutlogrotate">FluentOutLogrotate</h2><h3 id="fluentoutlogrotate-age">age (string, optional)</h3><h3 id="fluentoutlogrotate-enabled">enabled (bool, required)</h3><h3 id="fluentoutlogrotate-path">path (string, optional)</h3><h3 id="fluentoutlogrotate-size">size (string, optional)</h3><h2 id="extravolume">ExtraVolume</h2><p>ExtraVolume defines the fluentd extra volumes</p><h3 id="extravolume-containername">containerName (string, optional)</h3><h3 id="extravolume-path">path (string, optional)</h3><h3 id="extravolume-volume">volume (*volume.KubernetesVolume, optional)</h3><h3 id="extravolume-volumename">volumeName (string, optional)</h3><h2 id="fluentdscaling">FluentdScaling</h2><p>FluentdScaling enables configuring the scaling behaviour of the fluentd statefulset</p><h3 id="fluentdscaling-drain">drain (FluentdDrainConfig, optional)</h3><h3 id="fluentdscaling-podmanagementpolicy">podManagementPolicy (string, optional)</h3><h3 id="fluentdscaling-replicas">replicas (int, optional)</h3><h2 id="fluentdtls">FluentdTLS</h2><p>FluentdTLS defines the TLS configs</p><h3 id="fluentdtls-enabled">enabled (bool, required)</h3><h3 id="fluentdtls-secretname">secretName (string, optional)</h3><h3 id="fluentdtls-sharedkey">sharedKey (string, optional)</h3><h2 id="fluentddrainconfig">FluentdDrainConfig</h2><p>FluentdDrainConfig enables configuring the drain behavior when scaling down the fluentd statefulset</p><h3 id="fluentddrainconfig-annotations">annotations (map[string]string, optional)</h3><p>Annotations to use for the drain watch sidecar</p><h3 id="fluentddrainconfig-deletevolume">deleteVolume (bool, optional)</h3><p>Should persistent volume claims be deleted after draining is done</p><h3 id="fluentddrainconfig-enabled">enabled (bool, optional)</h3><p>Should buffers on persistent volumes left after scaling down the statefulset be drained</p><h3 id="fluentddrainconfig-image">image (ImageSpec, optional)</h3><h3 id="fluentddrainconfig-labels">labels (map[string]string, optional)</h3><p>Labels to use for the drain watch sidecar on top of labels added by the operator by default. Default values can be overwritten.</p><h3 id="fluentddrainconfig-pauseimage">pauseImage (ImageSpec, optional)</h3><p>Container image to use for the fluentd placeholder pod</p><h3 id="fluentddrainconfig-resources">resources (*corev1.ResourceRequirements, optional)</h3><p>Available in Logging operator version 4.4 and later. Configurable resource requirements for the drainer sidecar container. Default 20m cpu request, 20M memory limit</p><h3 id="fluentddrainconfig-securitycontext">securityContext (*corev1.SecurityContext, optional)</h3><p>Available in Logging operator version 4.4 and later. Configurable security context, uses fluentd pods&rsquo; security context by default</p><h2 id="pdbinput">PdbInput</h2><h3 id="pdbinput-maxunavailable">maxUnavailable (*intstr.IntOrString, optional)</h3><h3 id="pdbinput-minavailable">minAvailable (*intstr.IntOrString, optional)</h3><h3 id="pdbinput-unhealthypodevictionpolicy">unhealthyPodEvictionPolicy (*policyv1.UnhealthyPodEvictionPolicyType, optional)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-04f0ef161b0a9d3bf58fb1db783332d1">4.7.1.8 - LoggingRouteSpec</h1><h2 id="loggingroutespec">LoggingRouteSpec</h2><p>LoggingRouteSpec defines the desired state of LoggingRoute</p><h3 id="loggingroutespec-source">source (string, required)</h3><p>Source identifies the logging that this policy applies to</p><h3 id="loggingroutespec-targets">targets (metav1.LabelSelector, required)</h3><p>Targets refers to the list of logging resources specified by a label selector to forward logs to. Filtering of namespaces will happen based on the watchNamespaces and watchNamespaceSelector fields of the target logging resource.</p><h2 id="loggingroutestatus">LoggingRouteStatus</h2><p>LoggingRouteStatus defines the actual state of the LoggingRoute</p><h3 id="loggingroutestatus-notices">notices ([]string, optional)</h3><p>Enumerate non-blocker issues the user should pay attention to</p><h3 id="loggingroutestatus-noticescount">noticesCount (int, optional)</h3><p>Summarize the number of notices for the CLI output</p><h3 id="loggingroutestatus-problems">problems ([]string, optional)</h3><p>Enumerate problems that prohibits this route to take effect and populate the tenants field</p><h3 id="loggingroutestatus-problemscount">problemsCount (int, optional)</h3><p>Summarize the number of problems for the CLI output</p><h3 id="loggingroutestatus-tenants">tenants ([]Tenant, optional)</h3><p>Enumerate all loggings with all the destination namespaces expanded</p><h2 id="tenant">Tenant</h2><h3 id="tenant-name">name (string, required)</h3><h3 id="tenant-namespaces">namespaces ([]string, optional)</h3><h2 id="loggingroute">LoggingRoute</h2><p>Connects a log collector with log aggregators from other logging domains and routes relevant logs based on watch namespaces</p><h3 id="loggingroute-">(metav1.TypeMeta, required)</h3><h3 id="loggingroute-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="loggingroute-spec">spec (LoggingRouteSpec, optional)</h3><h3 id="loggingroute-status">status (LoggingRouteStatus, optional)</h3><h2 id="loggingroutelist">LoggingRouteList</h2><h3 id="loggingroutelist-">(metav1.TypeMeta, required)</h3><h3 id="loggingroutelist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="loggingroutelist-items">items ([]LoggingRoute, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-d295f1a0ca0a93108b789e0cfa709b32">4.7.1.9 - LoggingSpec</h1><h2 id="loggingspec">LoggingSpec</h2><p>LoggingSpec defines the desired state of Logging</p><h3 id="loggingspec-allowclusterresourcesfromallnamespaces">allowClusterResourcesFromAllNamespaces (bool, optional)</h3><p>Allow configuration of cluster resources from any namespace. Mutually exclusive with ControlNamespace restriction of Cluster resources</p><p>WARNING: Be careful when turning this on and off as it can result in some resources being orphaned.</p><h3 id="loggingspec-clusterdomain">clusterDomain (*string, optional)</h3><p>Cluster domain name to be used when templating URLs to services .</p><p>Default: &ldquo;cluster.local.&rdquo;</p><h3 id="loggingspec-configcheck">configCheck (ConfigCheck, optional)</h3><p>ConfigCheck settings that apply to both fluentd or syslog-ng. Can be overridden on the fluentd / syslog-ng level.</p><h3 id="loggingspec-controlnamespace">controlNamespace (string, required)</h3><p>Namespace for cluster wide configuration resources like ClusterFlow and ClusterOutput. This should be a protected namespace from regular users. Resources like fluentbit and fluentd will run in this namespace as well.</p><h3 id="loggingspec-defaultflow">defaultFlow (*DefaultFlowSpec, optional)</h3><p>Default flow for unmatched logs. This Flow configuration collects all logs that didn&rsquo;t matched any other Flow.</p><h3 id="loggingspec-enabledockerparsercompatibilityforcri">enableDockerParserCompatibilityForCRI (bool, optional)</h3><p>Enables a log parser that is compatible with the docker parser. This has the following benefits:</p><ul>
<li>automatically parses JSON logs using the Merge_Log feature</li><li>downstream parsers can use the <code>log</code> field instead of the <code>message</code> field, just like with the docker runtime</li><li>the <code>concat</code> and <code>parser</code> filters are automatically set back to use the <code>log</code> field.</li></ul><h3 id="loggingspec-enablerecreateworkloadonimmutablefieldchange">enableRecreateWorkloadOnImmutableFieldChange (bool, optional)</h3><p>EnableRecreateWorkloadOnImmutableFieldChange enables the operator to recreate the fluentbit daemonset and the fluentd statefulset (and possibly other resource in the future) in case there is a change in an immutable field that otherwise couldn&rsquo;t be managed with a simple update.</p><h3 id="loggingspec-erroroutputref">errorOutputRef (string, optional)</h3><p>GlobalOutput name to flush ERROR events to</p><h3 id="loggingspec-flowconfigcheckdisabled">flowConfigCheckDisabled (bool, optional)</h3><p>Disable configuration check before applying new fluentd or syslog-ng configuration.</p><h3 id="loggingspec-flowconfigoverride">flowConfigOverride (string, optional)</h3><p>Override generated config. This is a <em>raw</em> configuration string for troubleshooting purposes.</p><h3 id="loggingspec-fluentbit">fluentbit (*FluentbitSpec, optional)</h3><p>FluentbitAgent daemonset configuration. Deprecated, will be removed with next major version Migrate to the standalone NodeAgent resource</p><h3 id="loggingspec-fluentd">fluentd (*FluentdSpec, optional)</h3><p>Fluentd statefulset configuration. For details, see the <a href="/5.1/docs/configuration/crds/v1beta1/fluentd_types/">Fluentd configuration reference</a>.</p><h3 id="loggingspec-globalfilters">globalFilters ([]Filter, optional)</h3><p>Global filters to apply on logs before any match or filter mechanism.</p><h3 id="loggingspec-loggingref">loggingRef (string, optional)</h3><p>Reference to the logging system. Each of the <code>loggingRef</code>s can manage a fluentbit daemonset and a fluentd statefulset.</p><h3 id="loggingspec-nodeagents">nodeAgents ([]*InlineNodeAgent, optional)</h3><p>InlineNodeAgent Configuration Deprecated, will be removed with next major version</p><h3 id="loggingspec-routeconfig">routeConfig (*RouteConfig, optional)</h3><p>RouteConfig determines whether to use loggingRoutes or to create resources based on the logging resource that can be managed by the Telemetry Controller.</p><h3 id="loggingspec-skipinvalidresources">skipInvalidResources (bool, optional)</h3><p>Whether to skip invalid Flow and ClusterFlow resources</p><h3 id="loggingspec-syslogng">syslogNG (*SyslogNGSpec, optional)</h3><p>Syslog-NG statefulset configuration. For details, see the <a href="/5.1/docs/configuration/crds/v1beta1/syslogng_types/">syslogNG configuration reference</a>.</p><h3 id="loggingspec-watchnamespaceselector">watchNamespaceSelector (*metav1.LabelSelector, optional)</h3><p>WatchNamespaceSelector is a LabelSelector to find matching namespaces to watch as in WatchNamespaces</p><h3 id="loggingspec-watchnamespaces">watchNamespaces ([]string, optional)</h3><p>Limit namespaces to watch Flow and Output custom resources.</p><h2 id="configcheck">ConfigCheck</h2><h3 id="configcheck-labels">labels (map[string]string, optional)</h3><p>Labels to use for the configcheck pods on top of labels added by the operator by default. Default values can be overwritten.</p><h3 id="configcheck-strategy">strategy (ConfigCheckStrategy, optional)</h3><p>Select the config check strategy to use. <code>DryRun</code>: Parse and validate configuration. <code>StartWithTimeout</code>: Start with given configuration and exit after specified timeout. Default: <code>DryRun</code></p><h3 id="configcheck-timeoutseconds">timeoutSeconds (int, optional)</h3><p>Configure timeout in seconds if strategy is StartWithTimeout</p><h2 id="routeconfig">RouteConfig</h2><h3 id="routeconfig-disableloggingroute">disableLoggingRoute (bool, optional)</h3><p>If DisableLoggingRoute is set to true, the logging route controller should remove the given tenant from the status of the logging resource.</p><h3 id="routeconfig-enabletelemetrycontrollerroute">enableTelemetryControllerRoute (bool, optional)</h3><p>If EnableTelemetryControllerRoute set to true, the operator will create the corresponding Tenant, Subscription, and Output based on the logging resource.</p><h3 id="routeconfig-tenantlabels">tenantLabels (map[string]string, optional)</h3><p>TenantLabels is a map of labels that will be added to the tenant object so it can be matched with TelemetryController&rsquo;s TenantSelector ref: <a href="https://github.com/kube-logging/telemetry-controller/blob/main/api/telemetry/v1alpha1/collector_types.go">https://github.com/kube-logging/telemetry-controller/blob/main/api/telemetry/v1alpha1/collector_types.go</a></p><h2 id="loggingstatus">LoggingStatus</h2><p>LoggingStatus defines the observed state of Logging</p><h3 id="loggingstatus-configcheckresults">configCheckResults (map[string]bool, optional)</h3><p>Result of the config check. Under normal conditions there is a single item in the map with a bool value.</p><h3 id="loggingstatus-fluentdconfigname">fluentdConfigName (string, optional)</h3><p>Available in Logging operator version 4.5 and later. Name of the matched detached fluentd configuration object.</p><h3 id="loggingstatus-problems">problems ([]string, optional)</h3><p>Problems with the logging resource</p><h3 id="loggingstatus-problemscount">problemsCount (int, optional)</h3><p>Count of problems for printcolumn</p><h3 id="loggingstatus-syslogngconfigname">syslogNGConfigName (string, optional)</h3><p>Available in Logging operator version 4.5 and later. Name of the matched detached SyslogNG configuration object.</p><h3 id="loggingstatus-watchnamespaces">watchNamespaces ([]string, optional)</h3><p>List of namespaces that watchNamespaces + watchNamespaceSelector is resolving to. Not set means all namespaces.</p><h2 id="logging">Logging</h2><p>Logging is the Schema for the loggings API</p><h3 id="logging-">(metav1.TypeMeta, required)</h3><h3 id="logging-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="logging-spec">spec (LoggingSpec, optional)</h3><h3 id="logging-status">status (LoggingStatus, optional)</h3><h2 id="logginglist">LoggingList</h2><p>LoggingList contains a list of Logging</p><h3 id="logginglist-">(metav1.TypeMeta, required)</h3><h3 id="logginglist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="logginglist-items">items ([]Logging, required)</h3><h2 id="defaultflowspec">DefaultFlowSpec</h2><p>DefaultFlowSpec is a Flow for logs that did not match any other Flow</p><h3 id="defaultflowspec-filters">filters ([]Filter, optional)</h3><h3 id="defaultflowspec-flowlabel">flowLabel (string, optional)</h3><h3 id="defaultflowspec-globaloutputrefs">globalOutputRefs ([]string, optional)</h3><h3 id="defaultflowspec-includelabelinrouter">includeLabelInRouter (*bool, optional)</h3><h3 id="defaultflowspec-outputrefs">outputRefs ([]string, optional)</h3><p>Deprecated</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-2c2339470c0f0e05b2453d914e401e3a">4.7.1.10 - NodeAgent</h1><h2 id="nodeagent">NodeAgent</h2><p>NodeAgent</p><h3 id="nodeagent-">(metav1.TypeMeta, required)</h3><h3 id="nodeagent-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="nodeagent-spec">spec (NodeAgentSpec, optional)</h3><h3 id="nodeagent-status">status (NodeAgentStatus, optional)</h3><h2 id="nodeagentspec">NodeAgentSpec</h2><p>NodeAgentSpec</p><h3 id="nodeagentspec-">(NodeAgentConfig, required)</h3><p>InlineNodeAgent</p><h3 id="nodeagentspec-loggingref">loggingRef (string, optional)</h3><h2 id="nodeagentconfig">NodeAgentConfig</h2><h3 id="nodeagentconfig-nodeagentfluentbit">nodeAgentFluentbit (*NodeAgentFluentbit, optional)</h3><h3 id="nodeagentconfig-metadata">metadata (types.MetaBase, optional)</h3><h3 id="nodeagentconfig-profile">profile (string, optional)</h3><h2 id="nodeagentstatus">NodeAgentStatus</h2><p>NodeAgentStatus</p><h2 id="nodeagentlist">NodeAgentList</h2><p>NodeAgentList</p><h3 id="nodeagentlist-">(metav1.TypeMeta, required)</h3><h3 id="nodeagentlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="nodeagentlist-items">items ([]NodeAgent, required)</h3><h2 id="inlinenodeagent">InlineNodeAgent</h2><p>InlineNodeAgent
@deprecated, replaced by NodeAgent</p><h3 id="inlinenodeagent-">(NodeAgentConfig, required)</h3><h3 id="inlinenodeagent-name">name (string, optional)</h3><p>InlineNodeAgent unique name.</p><h2 id="nodeagentfluentbit">NodeAgentFluentbit</h2><h3 id="nodeagentfluentbit-bufferstorage">bufferStorage (BufferStorage, optional)</h3><h3 id="nodeagentfluentbit-bufferstoragevolume">bufferStorageVolume (volume.KubernetesVolume, optional)</h3><p><a href="https://github.com/cisco-open/operator-tools/tree/master/docs/types">volume.KubernetesVolume</a></p><h3 id="nodeagentfluentbit-containerspath">containersPath (string, optional)</h3><h3 id="nodeagentfluentbit-corostacksize">coroStackSize (int32, optional)</h3><p>Set the coroutines stack size in bytes. The value must be greater than the page size of the running system. Don&rsquo;t set too small value (say 4096), or coroutine threads can overrun the stack buffer. Do not change the default value of this parameter unless you know what you are doing. (default: 24576)</p><p>Default: 24576</p><h3 id="nodeagentfluentbit-customconfigsecret">customConfigSecret (string, optional)</h3><h3 id="nodeagentfluentbit-daemonset">daemonSet (*typeoverride.DaemonSet, optional)</h3><h3 id="nodeagentfluentbit-disablekubernetesfilter">disableKubernetesFilter (*bool, optional)</h3><h3 id="nodeagentfluentbit-enableupstream">enableUpstream (*bool, optional)</h3><h3 id="nodeagentfluentbit-enabled">enabled (*bool, optional)</h3><h3 id="nodeagentfluentbit-extravolumemounts">extraVolumeMounts ([]*VolumeMount, optional)</h3><h3 id="nodeagentfluentbit-filteraws">filterAws (*FilterAws, optional)</h3><h3 id="nodeagentfluentbit-filterkubernetes">filterKubernetes (FilterKubernetes, optional)</h3><h3 id="nodeagentfluentbit-flush">flush (int32, optional)</h3><p>Set the flush time in seconds.nanoseconds. The engine loop uses a Flush timeout to define when is required to flush the records ingested by input plugins through the defined output plugins. (default: 1)</p><p>Default: 1</p><h3 id="nodeagentfluentbit-forwardoptions">forwardOptions (*ForwardOptions, optional)</h3><h3 id="nodeagentfluentbit-grace">grace (int32, optional)</h3><p>Set the grace time in seconds as Integer value. The engine loop uses a Grace timeout to define wait time on exit (default: 5)</p><p>Default: 5</p><h3 id="nodeagentfluentbit-inputtail">inputTail (InputTail, optional)</h3><h3 id="nodeagentfluentbit-livenessdefaultcheck">livenessDefaultCheck (*bool, optional)</h3><p>Default: true</p><h3 id="nodeagentfluentbit-loglevel">logLevel (string, optional)</h3><p>Set the logging verbosity level. Allowed values are: error, warn, info, debug and trace. Values are accumulative, e.g: if &lsquo;debug&rsquo; is set, it will include error, warning, info and debug. Note that trace mode is only available if Fluent Bit was built with the WITH_TRACE option enabled. (default: info)</p><p>Default: info</p><h3 id="nodeagentfluentbit-metrics">metrics (*Metrics, optional)</h3><h3 id="nodeagentfluentbit-metricsservice">metricsService (*typeoverride.Service, optional)</h3><h3 id="nodeagentfluentbit-network">network (*FluentbitNetwork, optional)</h3><h3 id="nodeagentfluentbit-podpriorityclassname">podPriorityClassName (string, optional)</h3><h3 id="nodeagentfluentbit-positiondb">positiondb (volume.KubernetesVolume, optional)</h3><p><a href="https://github.com/cisco-open/operator-tools/tree/master/docs/types">volume.KubernetesVolume</a></p><h3 id="nodeagentfluentbit-security">security (*Security, optional)</h3><h3 id="nodeagentfluentbit-serviceaccount">serviceAccount (*typeoverride.ServiceAccount, optional)</h3><h3 id="nodeagentfluentbit-tls">tls (*FluentbitTLS, optional)</h3><h3 id="nodeagentfluentbit-targethost">targetHost (string, optional)</h3><h3 id="nodeagentfluentbit-targetport">targetPort (int32, optional)</h3><h3 id="nodeagentfluentbit-varlogspath">varLogsPath (string, optional)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-8718fca65b6b82a0865b8f450c52a288">4.7.1.11 - OutputSpec</h1><h2 id="outputspec">OutputSpec</h2><p>OutputSpec defines the desired state of Output</p><h3 id="outputspec-awselasticsearch">awsElasticsearch (*output.AwsElasticsearchOutputConfig, optional)</h3><h3 id="outputspec-azurestorage">azurestorage (*output.AzureStorage, optional)</h3><h3 id="outputspec-cloudwatch">cloudwatch (*output.CloudWatchOutput, optional)</h3><h3 id="outputspec-datadog">datadog (*output.DatadogOutput, optional)</h3><h3 id="outputspec-elasticsearch">elasticsearch (*output.ElasticsearchOutput, optional)</h3><h3 id="outputspec-file">file (*output.FileOutputConfig, optional)</h3><h3 id="outputspec-forward">forward (*output.ForwardOutput, optional)</h3><h3 id="outputspec-gcs">gcs (*output.GCSOutput, optional)</h3><h3 id="outputspec-gelf">gelf (*output.GelfOutputConfig, optional)</h3><h3 id="outputspec-http">http (*output.HTTPOutputConfig, optional)</h3><h3 id="outputspec-kafka">kafka (*output.KafkaOutputConfig, optional)</h3><h3 id="outputspec-kinesisfirehose">kinesisFirehose (*output.KinesisFirehoseOutputConfig, optional)</h3><h3 id="outputspec-kinesisstream">kinesisStream (*output.KinesisStreamOutputConfig, optional)</h3><h3 id="outputspec-logdna">logdna (*output.LogDNAOutput, optional)</h3><h3 id="outputspec-logz">logz (*output.LogZOutput, optional)</h3><h3 id="outputspec-loggingref">loggingRef (string, optional)</h3><h3 id="outputspec-loki">loki (*output.LokiOutput, optional)</h3><h3 id="outputspec-mattermost">mattermost (*output.MattermostOutputConfig, optional)</h3><h3 id="outputspec-newrelic">newrelic (*output.NewRelicOutputConfig, optional)</h3><h3 id="outputspec-nullout">nullout (*output.NullOutputConfig, optional)</h3><h3 id="outputspec-oss">oss (*output.OSSOutput, optional)</h3><h3 id="outputspec-opensearch">opensearch (*output.OpenSearchOutput, optional)</h3><h3 id="outputspec-redis">redis (*output.RedisOutputConfig, optional)</h3><h3 id="outputspec-relabel">relabel (*output.RelabelOutputConfig, optional)</h3><h3 id="outputspec-s3">s3 (*output.S3OutputConfig, optional)</h3><h3 id="outputspec-sqs">sqs (*output.SQSOutputConfig, optional)</h3><h3 id="outputspec-splunkhec">splunkHec (*output.SplunkHecOutput, optional)</h3><h3 id="outputspec-syslog">syslog (*output.SyslogOutputConfig, optional)</h3><h3 id="outputspec-vmwareloginsight">vmwareLogInsight (*output.VMwareLogInsightOutput, optional)</h3><h3 id="outputspec-vmwarelogintelligence">vmwareLogIntelligence (*output.VMwareLogIntelligenceOutputConfig, optional)</h3><h2 id="outputstatus">OutputStatus</h2><p>OutputStatus defines the observed state of Output</p><h3 id="outputstatus-active">active (*bool, optional)</h3><h3 id="outputstatus-problems">problems ([]string, optional)</h3><h3 id="outputstatus-problemscount">problemsCount (int, optional)</h3><h2 id="output">Output</h2><p>Output is the Schema for the outputs API</p><h3 id="output-">(metav1.TypeMeta, required)</h3><h3 id="output-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="output-spec">spec (OutputSpec, optional)</h3><h3 id="output-status">status (OutputStatus, optional)</h3><h2 id="outputlist">OutputList</h2><p>OutputList contains a list of Output</p><h3 id="outputlist-">(metav1.TypeMeta, required)</h3><h3 id="outputlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="outputlist-items">items ([]Output, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-9d8ed361c6ac392becad14253fc27fd4">4.7.1.12 - SyslogNGClusterFlow</h1><h2 id="syslogngclusterflow">SyslogNGClusterFlow</h2><p>SyslogNGClusterFlow is the Schema for the syslog-ng clusterflows API</p><h3 id="syslogngclusterflow-">(metav1.TypeMeta, required)</h3><h3 id="syslogngclusterflow-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="syslogngclusterflow-spec">spec (SyslogNGClusterFlowSpec, optional)</h3><h3 id="syslogngclusterflow-status">status (SyslogNGFlowStatus, optional)</h3><h2 id="syslogngclusterflowspec">SyslogNGClusterFlowSpec</h2><p>SyslogNGClusterFlowSpec is the Kubernetes spec for Flows</p><h3 id="syslogngclusterflowspec-filters">filters ([]SyslogNGFilter, optional)</h3><h3 id="syslogngclusterflowspec-globaloutputrefs">globalOutputRefs ([]string, optional)</h3><h3 id="syslogngclusterflowspec-loggingref">loggingRef (string, optional)</h3><h3 id="syslogngclusterflowspec-match">match (*SyslogNGMatch, optional)</h3><h3 id="syslogngclusterflowspec-outputmetrics">outputMetrics ([]filter.MetricsProbe, optional)</h3><p>Output metrics are applied before the log reaches the destination and contain output metadata like: <code>name,</code> <code>namespace</code> and <code>scope</code>. Scope shows whether the output is a local or global one. Available in Logging operator version 4.5 and later.</p><h2 id="syslogngclusterflowlist">SyslogNGClusterFlowList</h2><p>SyslogNGClusterFlowList contains a list of SyslogNGClusterFlow</p><h3 id="syslogngclusterflowlist-">(metav1.TypeMeta, required)</h3><h3 id="syslogngclusterflowlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="syslogngclusterflowlist-items">items ([]SyslogNGClusterFlow, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-8b95a382d4b401c66683fec0554bf659">4.7.1.13 - SyslogNGClusterOutput</h1><h2 id="syslogngclusteroutput">SyslogNGClusterOutput</h2><p>SyslogNGClusterOutput is the Schema for the syslog-ng clusteroutputs API</p><h3 id="syslogngclusteroutput-">(metav1.TypeMeta, required)</h3><h3 id="syslogngclusteroutput-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="syslogngclusteroutput-spec">spec (SyslogNGClusterOutputSpec, required)</h3><h3 id="syslogngclusteroutput-status">status (SyslogNGOutputStatus, optional)</h3><h2 id="syslogngclusteroutputspec">SyslogNGClusterOutputSpec</h2><p>SyslogNGClusterOutputSpec contains Kubernetes spec for SyslogNGClusterOutput</p><h3 id="syslogngclusteroutputspec-">(SyslogNGOutputSpec, required)</h3><h3 id="syslogngclusteroutputspec-protected">protected (bool, optional)</h3><h2 id="syslogngclusteroutputlist">SyslogNGClusterOutputList</h2><p>SyslogNGClusterOutputList contains a list of SyslogNGClusterOutput</p><h3 id="syslogngclusteroutputlist-">(metav1.TypeMeta, required)</h3><h3 id="syslogngclusteroutputlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="syslogngclusteroutputlist-items">items ([]SyslogNGClusterOutput, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-9b84f07030945b10cbc8314ab166b603">4.7.1.14 - SyslogNGConfig</h1><h2 id="syslogngconfig">SyslogNGConfig</h2><h3 id="syslogngconfig-">(metav1.TypeMeta, required)</h3><h3 id="syslogngconfig-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="syslogngconfig-spec">spec (SyslogNGSpec, optional)</h3><h3 id="syslogngconfig-status">status (SyslogNGConfigStatus, optional)</h3><h2 id="syslogngconfigstatus">SyslogNGConfigStatus</h2><h3 id="syslogngconfigstatus-active">active (*bool, optional)</h3><h3 id="syslogngconfigstatus-logging">logging (string, optional)</h3><h3 id="syslogngconfigstatus-problems">problems ([]string, optional)</h3><h3 id="syslogngconfigstatus-problemscount">problemsCount (int, optional)</h3><h2 id="syslogngconfiglist">SyslogNGConfigList</h2><h3 id="syslogngconfiglist-">(metav1.TypeMeta, required)</h3><h3 id="syslogngconfiglist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="syslogngconfiglist-items">items ([]SyslogNGConfig, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-de7a2ad119020fdf1efa724f2230d938">4.7.1.15 - SyslogNGFlowSpec</h1><h2 id="syslogngflowspec">SyslogNGFlowSpec</h2><p>SyslogNGFlowSpec is the Kubernetes spec for SyslogNGFlows</p><h3 id="syslogngflowspec-filters">filters ([]SyslogNGFilter, optional)</h3><h3 id="syslogngflowspec-globaloutputrefs">globalOutputRefs ([]string, optional)</h3><h3 id="syslogngflowspec-localoutputrefs">localOutputRefs ([]string, optional)</h3><h3 id="syslogngflowspec-loggingref">loggingRef (string, optional)</h3><h3 id="syslogngflowspec-match">match (*SyslogNGMatch, optional)</h3><h3 id="syslogngflowspec-outputmetrics">outputMetrics ([]filter.MetricsProbe, optional)</h3><p>Output metrics are applied before the log reaches the destination and contain output metadata like: <code>name,</code> <code>namespace</code> and <code>scope</code>. Scope shows whether the output is a local or global one. Available in Logging operator version 4.5 and later.</p><h2 id="syslogngfilter">SyslogNGFilter</h2><p>Filter definition for SyslogNGFlowSpec</p><h3 id="syslogngfilter-id">id (string, optional)</h3><h3 id="syslogngfilter-match">match (*filter.MatchConfig, optional)</h3><h3 id="syslogngfilter-parser">parser (*filter.ParserConfig, optional)</h3><h3 id="syslogngfilter-rewrite">rewrite ([]filter.RewriteConfig, optional)</h3><h2 id="syslogngflow">SyslogNGFlow</h2><p>Flow Kubernetes object</p><h3 id="syslogngflow-">(metav1.TypeMeta, required)</h3><h3 id="syslogngflow-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="syslogngflow-spec">spec (SyslogNGFlowSpec, optional)</h3><h3 id="syslogngflow-status">status (SyslogNGFlowStatus, optional)</h3><h2 id="syslogngflowlist">SyslogNGFlowList</h2><p>FlowList contains a list of Flow</p><h3 id="syslogngflowlist-">(metav1.TypeMeta, required)</h3><h3 id="syslogngflowlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="syslogngflowlist-items">items ([]SyslogNGFlow, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-eea1110e47d17724202c6751b18af627">4.7.1.16 - SyslogNGOutputSpec</h1><h2 id="syslogngoutputspec">SyslogNGOutputSpec</h2><p>SyslogNGOutputSpec defines the desired state of SyslogNGOutput</p><h3 id="syslogngoutputspec-elasticsearch">elasticsearch (*output.ElasticsearchOutput, optional)</h3><h3 id="syslogngoutputspec-elasticsearch-datastream">elasticsearch-datastream (*output.ElasticsearchDatastreamOutput, optional)</h3><p>Available in Logging operator version 4.9 and later.</p><h3 id="syslogngoutputspec-file">file (*output.FileOutput, optional)</h3><h3 id="syslogngoutputspec-http">http (*output.HTTPOutput, optional)</h3><h3 id="syslogngoutputspec-logscale">logscale (*output.LogScaleOutput, optional)</h3><h3 id="syslogngoutputspec-loggingref">loggingRef (string, optional)</h3><h3 id="syslogngoutputspec-loggly">loggly (*output.Loggly, optional)</h3><h3 id="syslogngoutputspec-loki">loki (*output.LokiOutput, optional)</h3><p>Available in Logging operator version 4.4 and later.</p><h3 id="syslogngoutputspec-mqtt">mqtt (*output.MQTT, optional)</h3><h3 id="syslogngoutputspec-mongodb">mongodb (*output.MongoDB, optional)</h3><h3 id="syslogngoutputspec-opentelemetry">opentelemetry (*output.OpenTelemetryOutput, optional)</h3><p>Available in Logging operator version 4.9 and later.</p><h3 id="syslogngoutputspec-openobserve">openobserve (*output.OpenobserveOutput, optional)</h3><p>Available in Logging operator version 4.5 and later.</p><h3 id="syslogngoutputspec-redis">redis (*output.RedisOutput, optional)</h3><h3 id="syslogngoutputspec-s3">s3 (*output.S3Output, optional)</h3><p>Available in Logging operator version 4.4 and later.</p><h3 id="syslogngoutputspec-splunk_hec_event">splunk_hec_event (*output.SplunkHECOutput, optional)</h3><h3 id="syslogngoutputspec-sumologic-http">sumologic-http (*output.SumologicHTTPOutput, optional)</h3><h3 id="syslogngoutputspec-sumologic-syslog">sumologic-syslog (*output.SumologicSyslogOutput, optional)</h3><h3 id="syslogngoutputspec-syslog">syslog (*output.SyslogOutput, optional)</h3><h2 id="syslogngoutput">SyslogNGOutput</h2><p>SyslogNGOutput is the Schema for the syslog-ng outputs API</p><h3 id="syslogngoutput-">(metav1.TypeMeta, required)</h3><h3 id="syslogngoutput-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="syslogngoutput-spec">spec (SyslogNGOutputSpec, optional)</h3><h3 id="syslogngoutput-status">status (SyslogNGOutputStatus, optional)</h3><h2 id="syslogngoutputlist">SyslogNGOutputList</h2><p>SyslogNGOutputList contains a list of SyslogNGOutput</p><h3 id="syslogngoutputlist-">(metav1.TypeMeta, required)</h3><h3 id="syslogngoutputlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="syslogngoutputlist-items">items ([]SyslogNGOutput, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-b5fd5711d1786f5011e175001c26f721">4.7.1.17 - SyslogNGSpec</h1><h2 id="syslogngspec">SyslogNGSpec</h2><p>SyslogNGSpec defines the desired state of SyslogNG</p><h3 id="syslogngspec-buffervolumemetrics">bufferVolumeMetrics (*BufferMetrics, optional)</h3><h3 id="syslogngspec-buffervolumemetricsimage">bufferVolumeMetricsImage (*BasicImageSpec, optional)</h3><h3 id="syslogngspec-buffervolumemetricslivenessprobe">bufferVolumeMetricsLivenessProbe (*corev1.Probe, optional)</h3><h3 id="syslogngspec-buffervolumemetricsresources">bufferVolumeMetricsResources (corev1.ResourceRequirements, optional)</h3><h3 id="syslogngspec-buffervolumemetricsservice">bufferVolumeMetricsService (*typeoverride.Service, optional)</h3><h3 id="syslogngspec-configcheck">configCheck (*ConfigCheck, optional)</h3><p>Overrides the default logging level configCheck setup. This field is not used directly, just copied over the field in the logging resource if defined.</p><h3 id="syslogngspec-configcheckpod">configCheckPod (*typeoverride.PodSpec, optional)</h3><h3 id="syslogngspec-configreloadimage">configReloadImage (*BasicImageSpec, optional)</h3><h3 id="syslogngspec-globaloptions">globalOptions (*GlobalOptions, optional)</h3><h3 id="syslogngspec-jsonkeydelim">jsonKeyDelim (string, optional)</h3><h3 id="syslogngspec-jsonkeyprefix">jsonKeyPrefix (string, optional)</h3><h3 id="syslogngspec-logiwsize">logIWSize (int, optional)</h3><h3 id="syslogngspec-maxconnections">maxConnections (int, optional)</h3><p>Available in Logging operator version 4.5 and later. Set the maximum number of connections for the source. For details, see <a href="https://axoflow.com/docs/axosyslog-core/chapter-routing-filters/concepts-flow-control/configuring-flow-control/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="syslogngspec-metrics">metrics (*Metrics, optional)</h3><h3 id="syslogngspec-metricsexporterimage">metricsExporterImage (*BasicImageSpec, optional)</h3><h3 id="syslogngspec-metricsservice">metricsService (*typeoverride.Service, optional)</h3><h3 id="syslogngspec-readinessdefaultcheck">readinessDefaultCheck (ReadinessDefaultCheck, optional)</h3><h3 id="syslogngspec-serviceaccount">serviceAccount (*typeoverride.ServiceAccount, optional)</h3><h3 id="syslogngspec-service">service (*typeoverride.Service, optional)</h3><h3 id="syslogngspec-skiprbaccreate">skipRBACCreate (bool, optional)</h3><h3 id="syslogngspec-sourcedateparser">sourceDateParser (*SourceDateParser, optional)</h3><p>Available in Logging operator version 4.5 and later. Parses date automatically from the timestamp registered by the container runtime. Note: <code>jsonKeyPrefix</code> and <code>jsonKeyDelim</code> are respected.</p><h3 id="syslogngspec-sourcemetrics">sourceMetrics ([]filter.MetricsProbe, optional)</h3><p>Available in Logging operator version 4.5 and later. Create <a href="/5.1/docs/examples/custom-syslog-ng-metrics/">custom log metrics for sources and outputs</a>.</p><h3 id="syslogngspec-statefulset">statefulSet (*typeoverride.StatefulSet, optional)</h3><h3 id="syslogngspec-syslogngimage">syslogNGImage (*BasicImageSpec, optional)</h3><h3 id="syslogngspec-tls">tls (SyslogNGTLS, optional)</h3><h2 id="sourcedateparser">SourceDateParser</h2><p>Available in Logging operator version 4.5 and later.</p><p>Parses date automatically from the timestamp registered by the container runtime.
Note: <code>jsonKeyPrefix</code> and <code>jsonKeyDelim</code> are respected.
It is disabled by default, but if enabled, then the default settings parse the timestamp written by the container runtime and parsed by Fluent Bit using the <code>cri</code> or the <code>docker</code> parser.</p><h3 id="sourcedateparser-format">format (*string, optional)</h3><p>Default: &ldquo;%FT%T.%f%z&rdquo;</p><h3 id="sourcedateparser-template">template (*string, optional)</h3><p>Default(depending on JSONKeyPrefix): &ldquo;${json.time}&rdquo;</p><h2 id="syslogngtls">SyslogNGTLS</h2><p>SyslogNGTLS defines the TLS configs</p><h3 id="syslogngtls-enabled">enabled (bool, required)</h3><h3 id="syslogngtls-secretname">secretName (string, optional)</h3><h3 id="syslogngtls-sharedkey">sharedKey (string, optional)</h3><h2 id="globaloptions">GlobalOptions</h2><h3 id="globaloptions-log_level">log_level (*string, optional)</h3><p>See the <a href="https://axoflow.com/docs/axosyslog-core/chapter-global-options/reference-options/#global-options-log-level">AxoSyslog Core documentation</a>.</p><h3 id="globaloptions-stats">stats (*Stats, optional)</h3><p>See the <a href="https://axoflow.com/docs/axosyslog-core/chapter-global-options/reference-options/#global-option-stats">AxoSyslog Core documentation</a>.</p><h3 id="globaloptions-stats_freq">stats_freq (*int, optional)</h3><p>Deprecated. Use stats/freq from 4.1+</p><h3 id="globaloptions-stats_level">stats_level (*int, optional)</h3><p>Deprecated. Use stats/level from 4.1+</p><h2 id="stats">Stats</h2><h3 id="stats-freq">freq (*int, optional)</h3><h3 id="stats-level">level (*int, optional)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-e07d1bc49d964a7c40eb66abea5f2677">4.7.2 - Logging extensions CRDs</h1><table>
<thead>
<tr>
<th>Name</th><th>Description</th><th>Version</th></tr></thead><tbody>
<tr>
<td><strong><a href="eventtailer_types/">EventTailer</a></strong></td><td>Eventtailer&rsquo;s main goal is to listen kubernetes events and transmit their changes to stdout. This way the logging-operator is able to process them.</td><td>extensions</td></tr><tr>
<td><strong><a href="hosttailer_types/">HostTailer</a></strong></td><td>HostTailer&rsquo;s main goal is to tail custom files and transmit their changes to stdout. This way the logging-operator is able to process them.</td><td>extensions</td></tr></tbody></table></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-1dd2e29e6fc6677a064f9d79bc2429ff">4.7.2.1 - EventTailer</h1><h2 id="eventtailerspec">EventTailerSpec</h2><p>EventTailerSpec defines the desired state of EventTailer</p><h3 id="eventtailerspec-containeroverrides">containerOverrides (*types.ContainerBase, optional)</h3><p>Override container fields for the given statefulset</p><h3 id="eventtailerspec-controlnamespace">controlNamespace (string, required)</h3><p>The resources of EventTailer will be placed into this namespace</p><h3 id="eventtailerspec-image">image (*tailer.ImageSpec, optional)</h3><p>Override image related fields for the given statefulset, highest precedence</p><h3 id="eventtailerspec-positionvolume">positionVolume (volume.KubernetesVolume, optional)</h3><p>Volume definition for tracking fluentbit file positions (optional)</p><h3 id="eventtailerspec-workloadoverrides">workloadOverrides (*types.PodSpecBase, optional)</h3><p>Override podSpec fields for the given statefulset</p><h3 id="eventtailerspec-workloadmetaoverrides">workloadMetaOverrides (*types.MetaBase, optional)</h3><p>Override metadata of the created resources</p><h2 id="eventtailerstatus">EventTailerStatus</h2><p>EventTailerStatus defines the observed state of EventTailer</p><h2 id="eventtailer">EventTailer</h2><p>EventTailer is the Schema for the eventtailers API</p><h3 id="eventtailer-">(metav1.TypeMeta, required)</h3><h3 id="eventtailer-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="eventtailer-spec">spec (EventTailerSpec, optional)</h3><h3 id="eventtailer-status">status (EventTailerStatus, optional)</h3><h2 id="eventtailerlist">EventTailerList</h2><p>EventTailerList contains a list of EventTailer</p><h3 id="eventtailerlist-">(metav1.TypeMeta, required)</h3><h3 id="eventtailerlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="eventtailerlist-items">items ([]EventTailer, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-f24e78a067096c5c4a1cb33b2be8447b">4.7.2.2 - HostTailer</h1><h2 id="hosttailerspec">HostTailerSpec</h2><p>HostTailerSpec defines the desired state of HostTailer</p><h3 id="hosttailerspec-enablerecreateworkloadonimmutablefieldchange">enableRecreateWorkloadOnImmutableFieldChange (bool, optional)</h3><p>EnableRecreateWorkloadOnImmutableFieldChange enables the operator to recreate the daemonset (and possibly other resource in the future) in case there is a change in an immutable field that otherwise couldn&rsquo;t be managed with a simple update.</p><h3 id="hosttailerspec-filetailers">fileTailers ([]FileTailer, optional)</h3><p>List of <a href="#filetailer">file tailers</a>.</p><h3 id="hosttailerspec-image">image (tailer.ImageSpec, optional)</h3><h3 id="hosttailerspec-systemdtailers">systemdTailers ([]SystemdTailer, optional)</h3><p>List of <a href="#systemdtailer">systemd tailers</a>.</p><h3 id="hosttailerspec-workloadoverrides">workloadOverrides (*types.PodSpecBase, optional)</h3><p>Override podSpec fields for the given daemonset</p><h3 id="hosttailerspec-workloadmetaoverrides">workloadMetaOverrides (*types.MetaBase, optional)</h3><p>Override metadata of the created resources</p><h2 id="hosttailerstatus">HostTailerStatus</h2><p>HostTailerStatus defines the observed state of <a href="#hosttailer">HostTailer</a>.</p><h2 id="hosttailer">HostTailer</h2><p>HostTailer is the Schema for the hosttailers API</p><h3 id="hosttailer-">(metav1.TypeMeta, required)</h3><h3 id="hosttailer-metadata">metadata (metav1.ObjectMeta, optional)</h3><h3 id="hosttailer-spec">spec (HostTailerSpec, optional)</h3><h3 id="hosttailer-status">status (HostTailerStatus, optional)</h3><h2 id="hosttailerlist">HostTailerList</h2><p>HostTailerList contains a list of <a href="#hosttailer">HostTailers</a>.</p><h3 id="hosttailerlist-">(metav1.TypeMeta, required)</h3><h3 id="hosttailerlist-metadata">metadata (metav1.ListMeta, optional)</h3><h3 id="hosttailerlist-items">items ([]HostTailer, required)</h3><h2 id="filetailer">FileTailer</h2><p>FileTailer configuration options</p><h3 id="filetailer-buffer_chunk_size">buffer_chunk_size (string, optional)</h3><p>Set the buffer chunk size per active filetailer</p><h3 id="filetailer-buffer_max_size">buffer_max_size (string, optional)</h3><p>Set the limit of the buffer size per active filetailer</p><h3 id="filetailer-containeroverrides">containerOverrides (*types.ContainerBase, optional)</h3><p>Override container fields for the given tailer</p><h3 id="filetailer-disabled">disabled (bool, optional)</h3><p>Disable tailing the file</p><h3 id="filetailer-image">image (*tailer.ImageSpec, optional)</h3><p>Override image field for the given trailer</p><h3 id="filetailer-name">name (string, required)</h3><p>Name for the tailer</p><h3 id="filetailer-path">path (string, optional)</h3><p>Path to the loggable file</p><h3 id="filetailer-read_from_head">read_from_head (bool, optional)</h3><p>Start reading from the head of new log files</p><h3 id="filetailer-skip_long_lines">skip_long_lines (string, optional)</h3><p>Skip long line when exceeding Buffer_Max_Size</p><h2 id="systemdtailer">SystemdTailer</h2><p>SystemdTailer configuration options</p><h3 id="systemdtailer-containeroverrides">containerOverrides (*types.ContainerBase, optional)</h3><p>Override container fields for the given tailer</p><h3 id="systemdtailer-disabled">disabled (bool, optional)</h3><p>Disable component</p><h3 id="systemdtailer-image">image (*tailer.ImageSpec, optional)</h3><p>Override image field for the given trailer</p><h3 id="systemdtailer-maxentries">maxEntries (int, optional)</h3><p>Maximum entries to read when starting to tail logs to avoid high pressure</p><h3 id="systemdtailer-name">name (string, required)</h3><p>Name for the tailer</p><h3 id="systemdtailer-path">path (string, optional)</h3><p>Override systemd log path</p><h3 id="systemdtailer-systemdfilter">systemdFilter (string, optional)</h3><p>Filter to select the systemd unit, for example: <code>kubelet.service</code>
If the <code>systemdFilter</code> is not specified, <code>_SYSTEMD_UNIT</code> is used.</p><p>For example, the following HostTailer creates a systemd tailer for the <code>kubelet.service</code> and for kernel logs, and logs the kernel logs under the <code>SYSLOG_IDENTIFIER</code> journal field.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-extensions.banzaicloud.io/v1alpha1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">HostTailer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">app.kubernetes.io/name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">systemd-hosttailer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">systemd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">systemdTailers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">maxEntries</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">100</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">kubelet</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">systemdFilter</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">kubelet.service</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">maxEntries</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">100</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">kernel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">systemdFilter</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SYSLOG_IDENTIFIER=kernel</span></span></span></code></pre></div><p>The generated container will have the following arguments:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">command</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">/fluent-bit/bin/fluent-bit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- -<span style="color:#000">i</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">systemd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- -<span style="color:#000">p</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">path=/var/log/journal</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- -<span style="color:#000">p</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">db=/var/pos/systemd-host-tailer-kernel.db</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- -<span style="color:#000">p</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">max_entries=100</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- -<span style="color:#000">p</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">systemd_filter=SYSLOG_IDENTIFIER=kernel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- -<span style="color:#000">o</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- -<span style="color:#000">p</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">format=plain</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- -<span style="color:#000">p</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">path=/dev/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- -<span style="color:#000">p</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">file=stdout</span></span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-9e73eeb4ad3474fcbb18858c80510ec4">4.8 - Supported Plugins</h1><p>For more information please click on the plugin name</p><center>
<table>
<thead>
<tr>
<th style="text-align:left">Name</th><th>Profile</th><th style="text-align:left">Description</th><th style="text-align:center">Status</th><th style="text-align:right">Version</th></tr></thead><tbody>
<tr>
<td style="text-align:left"><strong><a href="common/security/">Security</a></strong></td><td>common</td><td style="text-align:left"></td><td style="text-align:center"></td><td style="text-align:right"><a href></a></td></tr><tr>
<td style="text-align:left"><strong><a href="common/transport/">Transport</a></strong></td><td>common</td><td style="text-align:left"></td><td style="text-align:center"></td><td style="text-align:right"><a href></a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/concat/">Concat</a></strong></td><td>filters</td><td style="text-align:left">Fluentd Filter plugin to concatenate multiline log separated in multiple events.</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/fluent-plugins-nursery/fluent-plugin-concat">2.5.0</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/dedot/">Dedot</a></strong></td><td>filters</td><td style="text-align:left">Concatenate multiline log separated in multiple events</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/lunardial/fluent-plugin-dedot_filter">1.0.0</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/detect_exceptions/">Exception Detector</a></strong></td><td>filters</td><td style="text-align:left">Exception Detector</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/GoogleCloudPlatform/fluent-plugin-detect-exceptions">0.0.14</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/elasticsearch_genid/">ElasticsearchGenId</a></strong></td><td>filters</td><td style="text-align:left"></td><td style="text-align:center"></td><td style="text-align:right"><a href></a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/enhance_k8s/">Enhance K8s Metadata</a></strong></td><td>filters</td><td style="text-align:left">Fluentd output plugin to add extra Kubernetes metadata to the events.</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/SumoLogic/sumologic-kubernetes-collection/tree/main/fluent-plugin-enhance-k8s-metadata">2.0.0</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/geoip/">Geo IP</a></strong></td><td>filters</td><td style="text-align:left">Fluentd GeoIP filter</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/y-ken/fluent-plugin-geoip">1.3.2</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/grep/">Grep</a></strong></td><td>filters</td><td style="text-align:left">Grep events by the values</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://docs.fluentd.org/filter/grep">more info</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/kube_events_timestamp/">Kubernetes Events Timestamp</a></strong></td><td>filters</td><td style="text-align:left">Fluentd Filter plugin to select particular timestamp into an additional field</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/banzaicloud/fluentd-filter-kube-events-timestamp">0.1.4</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/parser/">Parser</a></strong></td><td>filters</td><td style="text-align:left">Parses a string field in event records and mutates its event record with the parsed result.</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://docs.fluentd.org/filter/parser">more info</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/prometheus/">Prometheus</a></strong></td><td>filters</td><td style="text-align:left">Prometheus Filter Plugin to count Incoming Records</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/fluent/fluent-plugin-prometheus#prometheus-outputfilter-plugin">2.0.2</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/record_modifier/">Record Modifier</a></strong></td><td>filters</td><td style="text-align:left">Modify each event record.</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/repeatedly/fluent-plugin-record-modifier">2.1.0</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/record_transformer/">Record Transformer</a></strong></td><td>filters</td><td style="text-align:left">Mutates/transforms incoming event streams.</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://docs.fluentd.org/filter/record_transformer">more info</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/stdout/">Stdout</a></strong></td><td>filters</td><td style="text-align:left">Prints events to stdout</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://docs.fluentd.org/filter/stdout">more info</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/sumologic/">SumoLogic</a></strong></td><td>filters</td><td style="text-align:left">Sumo Logic collection solution for Kubernetes</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/SumoLogic/sumologic-kubernetes-collection">2.3.1</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/tagnormaliser/">Tag Normaliser</a></strong></td><td>filters</td><td style="text-align:left">Re-tag based on log metadata</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/banzaicloud/fluent-plugin-tag-normaliser">0.1.1</a></td></tr><tr>
<td style="text-align:left"><strong><a href="filters/throttle/">Throttle</a></strong></td><td>filters</td><td style="text-align:left">A sentry plugin to throttle logs. Logs are grouped by a configurable key. When a group exceeds a configuration rate, logs are dropped for this group.</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/rubrikinc/fluent-plugin-throttle">0.0.5</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/aws_elasticsearch/">Amazon Elasticsearch</a></strong></td><td>outputs</td><td style="text-align:left">Fluent plugin for Amazon Elasticsearch</td><td style="text-align:center">Testing</td><td style="text-align:right"><a href="https://github.com/atomita/fluent-plugin-aws-elasticsearch-service">2.4.1</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/azurestore/">Azure Storage</a></strong></td><td>outputs</td><td style="text-align:left">Store logs in Azure Storage</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/microsoft/fluent-plugin-azure-storage-append-blob">0.2.1</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/buffer/">Buffer</a></strong></td><td>outputs</td><td style="text-align:left">Fluentd event buffer</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://docs.fluentd.org/configuration/buffer-section">mode info</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/cloudwatch/">Amazon CloudWatch</a></strong></td><td>outputs</td><td style="text-align:left">Send your logs to AWS CloudWatch</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/fluent-plugins-nursery/fluent-plugin-cloudwatch-logs/releases/tag/v0.14.2">0.14.2</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/datadog/">Datadog</a></strong></td><td>outputs</td><td style="text-align:left">Send your logs to Datadog</td><td style="text-align:center">Testing</td><td style="text-align:right"><a href="https://github.com/DataDog/fluent-plugin-datadog/releases/tag/v0.14.1">0.14.1</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/elasticsearch/">Elasticsearch</a></strong></td><td>outputs</td><td style="text-align:left">Send your logs to Elasticsearch</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/uken/fluent-plugin-elasticsearch/releases/tag/v5.1.4">5.1.1</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/file/">File</a></strong></td><td>outputs</td><td style="text-align:left">Output plugin writes events to files</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://docs.fluentd.org/output/file">more info</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/format/">Format</a></strong></td><td>outputs</td><td style="text-align:left">Specify how to format output record.</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://docs.fluentd.org/configuration/format-section">more info</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/format_rfc5424/">Format rfc5424</a></strong></td><td>outputs</td><td style="text-align:left">Specify how to format output record.</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/cloudfoundry/fluent-plugin-syslog_rfc5424#format-section">more info</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/forward/">Forward</a></strong></td><td>outputs</td><td style="text-align:left">Forwards events to other fluentd nodes.</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://docs.fluentd.org/output/forward">more info</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/gcs/">Google Cloud Storage</a></strong></td><td>outputs</td><td style="text-align:left">Store logs in Google Cloud Storage</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/banzaicloud/fluent-plugin-gcs">0.4.0</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/gelf/">Gelf</a></strong></td><td>outputs</td><td style="text-align:left">Output plugin writes events to GELF</td><td style="text-align:center">Testing</td><td style="text-align:right"><a href="https://github.com/hotschedules/fluent-plugin-gelf-hs">1.0.8</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/http/">Http</a></strong></td><td>outputs</td><td style="text-align:left">Sends logs to HTTP/HTTPS endpoints.</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://docs.fluentd.org/output/http">more info</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/kafka/">Kafka</a></strong></td><td>outputs</td><td style="text-align:left">Send your logs to Kafka</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/fluent/fluent-plugin-kafka/releases/tag/v0.17.5">0.17.5</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/kinesis_firehose/">Amazon Kinesis Firehose</a></strong></td><td>outputs</td><td style="text-align:left">Fluent plugin for Amazon Kinesis</td><td style="text-align:center">Testing</td><td style="text-align:right"><a href="https://github.com/awslabs/aws-fluent-plugin-kinesis/releases/tag/v3.4.2">3.4.2</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/kinesis_stream/">Amazon Kinesis Stream</a></strong></td><td>outputs</td><td style="text-align:left">Fluent plugin for Amazon Kinesis</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/awslabs/aws-fluent-plugin-kinesis/releases/tag/v3.4.2">3.4.2</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/logdna/">LogDNA</a></strong></td><td>outputs</td><td style="text-align:left">Send your logs to LogDNA</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/logdna/fluent-plugin-logdna/releases/tag/v0.4.0">0.4.0</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/logz/">LogZ</a></strong></td><td>outputs</td><td style="text-align:left">Store logs in LogZ.io</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/logzio/fluent-plugin-logzio/">0.0.21</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/loki/">Grafana Loki</a></strong></td><td>outputs</td><td style="text-align:left">Transfer logs to Loki</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/grafana/loki/tree/master/fluentd/fluent-plugin-grafana-loki">1.2.17</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/newrelic/">NewRelic Logs</a></strong></td><td>outputs</td><td style="text-align:left">Send logs to New Relic Logs</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/newrelic/newrelic-fluentd-output">1.2.1</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/opensearch/">OpenSearch</a></strong></td><td>outputs</td><td style="text-align:left">Send your logs to OpenSearch</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/fluent/fluent-plugin-opensearch/releases/tag/v1.0.5">1.0.5</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/oss/">Alibaba Cloud Storage</a></strong></td><td>outputs</td><td style="text-align:left">Store logs the Alibaba Cloud Object Storage Service</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/aliyun/fluent-plugin-oss">0.0.2</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/redis/">Redis</a></strong></td><td>outputs</td><td style="text-align:left">Sends logs to Redis endpoints.</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/fluent-plugins-nursery/fluent-plugin-redis">0.3.5</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/s3/">Amazon S3</a></strong></td><td>outputs</td><td style="text-align:left">Store logs in Amazon S3</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/fluent/fluent-plugin-s3/releases/tag/v1.6.1">1.6.1</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/splunk_hec/">Splunk Hec</a></strong></td><td>outputs</td><td style="text-align:left">Fluent Plugin Splunk Hec Release</td><td style="text-align:center">GA</td><td style="text-align:right"><a href>1.2.9</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/sqs/">SQS</a></strong></td><td>outputs</td><td style="text-align:left">Output plugin writes fluent-events as queue messages to Amazon SQS</td><td style="text-align:center">Testing</td><td style="text-align:right"><a href="https://github.com/ixixi/fluent-plugin-sqs">v2.1.0</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/sumologic/">SumoLogic</a></strong></td><td>outputs</td><td style="text-align:left">Send your logs to Sumologic</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/SumoLogic/fluentd-output-sumologic/releases/tag/1.8.0">1.8.0</a></td></tr><tr>
<td style="text-align:left"><strong><a href="outputs/syslog/">Syslog</a></strong></td><td>outputs</td><td style="text-align:left">Output plugin writes events to syslog</td><td style="text-align:center">GA</td><td style="text-align:right"><a href="https://github.com/cloudfoundry/fluent-plugin-syslog_rfc5424">0.9.0.rc.8</a></td></tr></tbody></table></center>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-8a164ca77d26df7144202dbce9fc83ed">4.8.1 - Security</h1><h2 id="security">Security</h2><h3 id="security-allow_anonymous_source">allow_anonymous_source (bool, optional)</h3><p>Allow anonymous source. <client> sections are required if disabled.</p><h3 id="security-self_hostname">self_hostname (string, required)</h3><p>Hostname</p><h3 id="security-shared_key">shared_key (string, required)</h3><p>Shared key for authentication.</p><h3 id="security-user_auth">user_auth (bool, optional)</h3><p>If true, use user based authentication.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-417b2dcf5d345902aeedec3805d3b518">4.8.2 - Transport</h1><h2 id="transport">Transport</h2><h3 id="transport-ca_cert_path">ca_cert_path (string, optional)</h3><p>Specify private CA contained path</p><h3 id="transport-ca_path">ca_path (string, optional)</h3><p>Specify path to CA certificate file</p><h3 id="transport-ca_private_key_passphrase">ca_private_key_passphrase (string, optional)</h3><p>private CA private key passphrase contained path</p><h3 id="transport-ca_private_key_path">ca_private_key_path (string, optional)</h3><p>private CA private key contained path</p><h3 id="transport-cert_path">cert_path (string, optional)</h3><p>Specify path to Certificate file</p><h3 id="transport-ciphers">ciphers (string, optional)</h3><p>Ciphers Default: &ldquo;ALL:!aNULL:!eNULL:!SSLv2&rdquo;</p><h3 id="transport-client_cert_auth">client_cert_auth (bool, optional)</h3><p>When this is set Fluentd will check all incoming HTTPS requests for a client certificate signed by the trusted CA, requests that don&rsquo;t supply a valid client certificate will fail.</p><h3 id="transport-insecure">insecure (bool, optional)</h3><p>Use secure connection when use tls) Default: false</p><h3 id="transport-private_key_passphrase">private_key_passphrase (string, optional)</h3><p>public CA private key passphrase contained path</p><h3 id="transport-private_key_path">private_key_path (string, optional)</h3><p>Specify path to private Key file</p><h3 id="transport-protocol">protocol (string, optional)</h3><p>Protocol Default: :tcp</p><h3 id="transport-version">version (string, optional)</h3><p>Version Default: &lsquo;TLSv1_2&rsquo;</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-054b25caf1e92a922927809d3e403385">4.8.3 - Fluentd filters</h1><p>You can use the following <strong>Fluentd</strong> filters in your <code>Flow</code> and <code>ClusterFlow</code> CRDs.</p></div><div class="td-content">
<h1 id="pg-349fa261ad6602912c90010a75fa2c8a">4.8.3.1 - Concat</h1><h1 id="concat-filterhttpsgithubcomfluent-plugins-nurseryfluent-plugin-concat"><a href="https://github.com/fluent-plugins-nursery/fluent-plugin-concat">Concat Filter</a></h1><h2 id="overview">Overview</h2><p>Fluentd Filter plugin to concatenate multiline log separated in multiple events.</p><h2 id="configuration">Configuration</h2><h2 id="concat">Concat</h2><h3 id="concat-continuous_line_regexp">continuous_line_regexp (string, optional)</h3><p>The regexp to match continuous lines. This is exclusive with n_lines.</p><h3 id="concat-flush_interval">flush_interval (int, optional)</h3><p>The number of seconds after which the last received event log is flushed. If set to 0, flushing is disabled (wait for next line forever).</p><h3 id="concat-keep_partial_key">keep_partial_key (bool, optional)</h3><p>If true, keep partial_key in concatenated records</p><p>Default: False</p><h3 id="concat-keep_partial_metadata">keep_partial_metadata (string, optional)</h3><p>If true, keep partial metadata</p><h3 id="concat-key">key (string, optional)</h3><p>Specify field name in the record to parse. If you leave empty the Container Runtime default will be used.</p><h3 id="concat-multiline_end_regexp">multiline_end_regexp (string, optional)</h3><p>The regexp to match ending of multiline. This is exclusive with n_lines.</p><h3 id="concat-multiline_start_regexp">multiline_start_regexp (string, optional)</h3><p>The regexp to match beginning of multiline. This is exclusive with n_lines.</p><h3 id="concat-n_lines">n_lines (int, optional)</h3><p>The number of lines. This is exclusive with multiline_start_regex.</p><h3 id="concat-partial_cri_logtag_key">partial_cri_logtag_key (string, optional)</h3><p>The key name that is referred to concatenate records on cri log</p><h3 id="concat-partial_cri_stream_key">partial_cri_stream_key (string, optional)</h3><p>The key name that is referred to detect stream name on cri log</p><p>Default: stream</p><h3 id="concat-partial_key">partial_key (string, optional)</h3><p>The field name that is the reference to concatenate records</p><h3 id="concat-partial_metadata_format">partial_metadata_format (string, optional)</h3><p>Input format of the partial metadata (fluentd or journald docker log driver)( docker-fluentd, docker-journald, docker-journald-lowercase)</p><h3 id="concat-partial_value">partial_value (string, optional)</h3><p>The value stored in the field specified by partial_key that represent partial log</p><h3 id="concat-separator">separator (*string, optional)</h3><p>The separator of lines. (default: &ldquo;\n&rdquo;)</p><h3 id="concat-stream_identity_key">stream_identity_key (string, optional)</h3><p>The key to determine which stream an event belongs to.</p><h3 id="concat-timeout_label">timeout_label (string, optional)</h3><p>The label name to handle events caused by timeout.</p><h3 id="concat-use_first_timestamp">use_first_timestamp (bool, optional)</h3><p>Use timestamp of first record when buffer is flushed.</p><p>Default: False</p><h3 id="concat-use_partial_cri_logtag">use_partial_cri_logtag (bool, optional)</h3><p>Use cri log tag to concatenate multiple records</p><h3 id="concat-use_partial_metadata">use_partial_metadata (string, optional)</h3><p>Use partial metadata to concatenate multiple records</p><h2 id="example-concat-filter-configurations">Example <code>Concat</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">concat</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">partial_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;partial_message&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">separator</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">n_lines</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">10</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>  @type concat
</span></span><span style="display:flex"><span>  @id test_concat
</span></span><span style="display:flex"><span>  key message
</span></span><span style="display:flex"><span>  n_lines 10
</span></span><span style="display:flex"><span>  partial_key partial_message
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-bb097fab5840c448f215a8825f17af78">4.8.3.2 - Dedot</h1><h1 id="dedot-filterhttpsgithubcomlunardialfluent-plugin-dedot_filter"><a href="https://github.com/lunardial/fluent-plugin-dedot_filter">Dedot Filter</a></h1><h2 id="overview">Overview</h2><p>Fluentd Filter plugin to de-dot field name for elasticsearch.</p><h2 id="configuration">Configuration</h2><h2 id="dedotfilterconfig">DedotFilterConfig</h2><h3 id="dedotfilterconfig-de_dot_nested">de_dot_nested (bool, optional)</h3><p>Will cause the plugin to recourse through nested structures (hashes and arrays), and remove dots in those key-names too.</p><p>Default: false</p><h3 id="dedotfilterconfig-de_dot_separator">de_dot_separator (string, optional)</h3><p>Separator</p><p>Default: _</p><h2 id="example-dedot-filter-configurations">Example <code>Dedot</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">dedot</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">de_dot_separator</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;-&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">de_dot_nested</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>  @type dedot
</span></span><span style="display:flex"><span>  @id test_dedot
</span></span><span style="display:flex"><span>  de_dot_nested true
</span></span><span style="display:flex"><span>  de_dot_separator -
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-55a61951fa9d47c3fc701c2b0c2534d4">4.8.3.3 - ElasticSearch GenId</h1><h2 id="elasticsearchgenid">ElasticsearchGenId</h2><h2 id="example-elasticsearch-genid-filter-configurations">Example <code>Elasticsearch Genid</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">   </span>- <span style="color:#204a87;font-weight:700">elasticsearch_genid</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">       </span><span style="color:#204a87;font-weight:700">hash_id_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">gen_id</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">   </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd Config Result</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span> @type elasticsearch_genid
</span></span><span style="display:flex"><span> @id test_elasticsearch_genid
</span></span><span style="display:flex"><span> hash_id_key gen_id
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h3 id="elasticsearchgenid-hash_id_key">hash_id_key (string, optional)</h3><p>You can specify generated hash storing key.</p><h3 id="elasticsearchgenid-hash_type">hash_type (string, optional)</h3><p>You can specify hash algorithm. Support algorithms md5, sha1, sha256, sha512. Default: sha1</p><h3 id="elasticsearchgenid-include_tag_in_seed">include_tag_in_seed (bool, optional)</h3><p>You can specify to use tag for hash generation seed.</p><h3 id="elasticsearchgenid-include_time_in_seed">include_time_in_seed (bool, optional)</h3><p>You can specify to use time for hash generation seed.</p><h3 id="elasticsearchgenid-record_keys">record_keys (string, optional)</h3><p>You can specify keys which are record in events for hash generation seed. This parameter should be used with use_record_as_seed parameter in practice.</p><h3 id="elasticsearchgenid-separator">separator (string, optional)</h3><p>You can specify separator charactor to creating seed for hash generation.</p><h3 id="elasticsearchgenid-use_entire_record">use_entire_record (bool, optional)</h3><p>You can specify to use entire record in events for hash generation seed.</p><h3 id="elasticsearchgenid-use_record_as_seed">use_record_as_seed (bool, optional)</h3><p>You can specify to use record in events for hash generation seed. This parameter should be used with record_keys parameter in practice.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-1e14b035cd2fa8152fe231991dc9b922">4.8.3.4 - Exception Detector</h1><h1 id="exception-detector">Exception Detector</h1><h2 id="overview">Overview</h2><p>This filter plugin consumes a log stream of JSON objects which contain single-line log messages. If a consecutive sequence of log messages form an exception stack trace, they forwarded as a single, combined JSON object. Otherwise, the input log data is forwarded as is. More info at <a href="https://github.com/GoogleCloudPlatform/fluent-plugin-detect-exceptions">https://github.com/GoogleCloudPlatform/fluent-plugin-detect-exceptions</a></p><blockquote>
<p>Note: As Tag management is not supported yet, this Plugin is <strong>mutually exclusive</strong> with <a href="../tagnormaliser">Tag normaliser</a></p></blockquote><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">detectExceptions</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">languages</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">java, python</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">multiline_flush_interval</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">0.1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="detectexceptions">DetectExceptions</h2><h3 id="detectexceptions-force_line_breaks">force_line_breaks (bool, optional)</h3><p>Force line breaks between each line when combining exception stacks.</p><p>Default: false</p><h3 id="detectexceptions-languages">languages ([]string, optional)</h3><p>Programming languages for which to detect exceptions.</p><p>Default: <code>[]</code></p><h3 id="detectexceptions-match_tag">match_tag (string, optional)</h3><p>Tag used in match directive.</p><p>Default: <code>kubernetes.**</code></p><h3 id="detectexceptions-max_bytes">max_bytes (int, optional)</h3><p>Maximum number of bytes to flush (0 means no limit)</p><p>Default: 0</p><h3 id="detectexceptions-max_lines">max_lines (int, optional)</h3><p>Maximum number of lines to flush (0 means no limit)</p><p>Default: 1000</p><h3 id="detectexceptions-message">message (string, optional)</h3><p>The field which contains the raw message text in the input JSON data.</p><p>Default: ""</p><h3 id="detectexceptions-multiline_flush_interval">multiline_flush_interval (string, optional)</h3><p>The interval of flushing the buffer for multiline format.</p><p>Default: nil</p><h3 id="detectexceptions-remove_tag_prefix">remove_tag_prefix (string, optional)</h3><p>The prefix to be removed from the input tag when outputting a record.</p><p>Default: kubernetes</p><h3 id="detectexceptions-stream">stream (string, optional)</h3><p>Separate log streams by this field in the input JSON data.</p><p>Default: ""</p><h2 id="example-exception-detector-filter-configurations">Example <code>Exception Detector</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">detectExceptions</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">multiline_flush_interval</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">0.1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">languages</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">java</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#000">python</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;match</span> <span style="color:#a40000">kubernetes.**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>  @type detect_exceptions
</span></span><span style="display:flex"><span>  @id test_detect_exceptions
</span></span><span style="display:flex"><span>  languages [&#34;java&#34;,&#34;python&#34;]
</span></span><span style="display:flex"><span>  multiline_flush_interval 0.1
</span></span><span style="display:flex"><span>  remove_tag_prefix kubernetes
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/match&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-91b6e53e4bb1647d0973b03564f40336">4.8.3.5 - Geo IP</h1><h1 id="fluentd-geoip-filter">Fluentd GeoIP filter</h1><h2 id="overview">Overview</h2><p>Fluentd Filter plugin to add information about geographical location of IP addresses with Maxmind GeoIP databases.
More information at <a href="https://github.com/y-ken/fluent-plugin-geoip">https://github.com/y-ken/fluent-plugin-geoip</a></p><h2 id="configuration">Configuration</h2><h2 id="geoip">GeoIP</h2><h3 id="geoip-backend_library">backend_library (string, optional)</h3><p>Specify backend library (geoip2_c, geoip, geoip2_compat)</p><h3 id="geoip-geoip2_database">geoip2_database (string, optional)</h3><p>Specify optional geoip2 database (using bundled GeoLite2-City.mmdb by default)</p><h3 id="geoip-geoip_database">geoip_database (string, optional)</h3><p>Specify optional geoip database (using bundled GeoLiteCity databse by default)</p><h3 id="geoip-geoip_lookup_keys">geoip_lookup_keys (string, optional)</h3><p>Specify one or more geoip lookup field which has ip address</p><p>Default: host</p><h3 id="geoip-records">records ([]Record, optional)</h3><p>Records are represented as maps: <code>key: value</code></p><h3 id="geoip-skip_adding_null_record">skip_adding_null_record (*bool, optional)</h3><p>To avoid get stacktrace error with <code>[null, null]</code> array for elasticsearch.</p><p>Default: true</p><h2 id="example-geoip-filter-configurations">Example <code>GeoIP</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">geoip</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">geoip_lookup_keys</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">remote_addr</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">records</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:700">city</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${city.names.en[&#34;remote_addr&#34;]}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">location_array</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&#39;&#39;[${location.longitude[&#34;remote&#34;]},${location.latitude[&#34;remote&#34;]}]&#39;&#39;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">country</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${country.iso_code[&#34;remote_addr&#34;]}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">country_name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${country.names.en[&#34;remote_addr&#34;]}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">postal_code</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">${postal.code[&#34;remote_addr&#34;]}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>  @type geoip
</span></span><span style="display:flex"><span>  @id test_geoip
</span></span><span style="display:flex"><span>  geoip_lookup_keys remote_addr
</span></span><span style="display:flex"><span>  skip_adding_null_record true
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;record&gt;</span>
</span></span><span style="display:flex"><span>    city ${city.names.en[&#34;remote_addr&#34;]}
</span></span><span style="display:flex"><span>    country ${country.iso_code[&#34;remote_addr&#34;]}
</span></span><span style="display:flex"><span>    country_name ${country.names.en[&#34;remote_addr&#34;]}
</span></span><span style="display:flex"><span>    location_array &#39;[${location.longitude[&#34;remote&#34;]},${location.latitude[&#34;remote&#34;]}]&#39;
</span></span><span style="display:flex"><span>    postal_code ${postal.code[&#34;remote_addr&#34;]}
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/record&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-d911e67edeb675049a9637d612f14d1a">4.8.3.6 - Grep</h1><h2 id="overview">Overview</h2><p><a href="https://docs.fluentd.org/filter/grep">Grep Filter</a></p><p>The grep filter plugin &ldquo;greps&rdquo; events by the values of specified fields.</p><h2 id="configuration">Configuration</h2><h2 id="grepconfig">GrepConfig</h2><h3 id="grepconfig-and">and ([]AndSection, optional)</h3><p><a href="#grepconfig-and">And Directive</a></p><h3 id="grepconfig-exclude">exclude ([]ExcludeSection, optional)</h3><p><a href="#grepconfig-exclude">Exclude Directive</a></p><h3 id="grepconfig-or">or ([]OrSection, optional)</h3><p><a href="#grepconfig-or">Or Directive</a></p><h3 id="grepconfig-regexp">regexp ([]RegexpSection, optional)</h3><p><a href="#grepconfig-regexp">Regexp Directive</a></p><h2 id="Regexp-Directive">Regexp Directive</h2><p>Specify filtering rule (as described in the <a href="https://docs.fluentd.org/filter/grep#less-than-regexp-greater-than-directive">Fluentd documentation</a>). This directive contains two parameters.</p><h3 id="regexp-directive-key">key (string, required)</h3><p>Specify field name in the record to parse.</p><h3 id="regexp-directive-pattern">pattern (string, required)</h3><p>Pattern expression to evaluate</p><h2 id="example-regexp-filter-configurations">Example <code>Regexp</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">grep</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">first</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/^5\d\d$/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>    @type grep
</span></span><span style="display:flex"><span>    @id demo-flow_1_grep
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;regexp&gt;</span>
</span></span><span style="display:flex"><span>      key first
</span></span><span style="display:flex"><span>      pattern /^5\d\d$/
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;/regexp&gt;</span>
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
<h2 id="exclude-directive">Exclude Directive</h2><p>Specify filtering rule to reject events (as described in the <a href="https://docs.fluentd.org/filter/grep#less-than-exclude-greater-than-directive">Fluentd documentation</a>). This directive contains two parameters.</p><h3 id="exclude-directive-key">key (string, required)</h3><p>Specify field name in the record to parse.</p><h3 id="exclude-directive-pattern">pattern (string, required)</h3><p>Pattern expression to evaluate</p><h2 id="example-exclude-filter-configurations">Example <code>Exclude</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">grep</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">exclude</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">first</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/^5\d\d$/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>    @type grep
</span></span><span style="display:flex"><span>    @id demo-flow_0_grep
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;exclude&gt;</span>
</span></span><span style="display:flex"><span>      key first
</span></span><span style="display:flex"><span>      pattern /^5\d\d$/
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;/exclude&gt;</span>
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
<h2 id="Or-Directive"><a href="https://docs.fluentd.org/filter/grep#less-than-or-greater-than-directive">Or Directive</a></h2><p>Specify filtering rule (as described in the <a href="https://docs.fluentd.org/filter/grep#less-than-or-greater-than-directive">Fluentd documentation</a>. This directive contains either <code>regexp</code> or <code>exclude</code> directive.</p><h3 id="or-directive-exclude">exclude ([]ExcludeSection, optional)</h3><p><a href="https://docs.fluentd.org/filter/grep#less-than-or-greater-than-directive">Exclude Directive</a></p><h3 id="or-directive-regexp">regexp ([]RegexpSection, optional)</h3><p><a href="https://docs.fluentd.org/filter/grep#less-than-or-greater-than-directive">Regexp Directive</a></p><h2 id="example-or-filter-configurations">Example <code>Or</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">grep</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">or</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:700">exclude</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">first</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/^5\d\d$/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">second</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/\.css$/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;or&gt;</span>
</span></span><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">&lt;exclude&gt;</span>
</span></span><span style="display:flex"><span>	key first
</span></span><span style="display:flex"><span>	pattern /^5\d\d$/
</span></span><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">&lt;/exclude&gt;</span>
</span></span><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">&lt;exclude&gt;</span>
</span></span><span style="display:flex"><span>	key second
</span></span><span style="display:flex"><span>	pattern /\.css$/
</span></span><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">&lt;/exclude&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/or&gt;</span></span></span></code></pre></div><hr>
<h2 id="And-Directive"><a href="https://docs.fluentd.org/filter/grep#less-than-and-greater-than-directive">And Directive</a></h2><p>Specify filtering rule (as described in the <a href="https://docs.fluentd.org/filter/grep#less-than-and-greater-than-directive">Fluentd documentation</a>. This directive contains either <code>regexp</code> or <code>exclude</code> directive.</p><h3 id="and-directive-exclude">exclude ([]ExcludeSection, optional)</h3><p><a href="https://docs.fluentd.org/filter/grep#less-than-and-greater-than-directive">Exclude Directive</a></p><h3 id="and-directive-regexp">regexp ([]RegexpSection, optional)</h3><p><a href="https://docs.fluentd.org/filter/grep#less-than-and-greater-than-directive">Regexp Directive</a></p><h2 id="example-and-filter-configurations">Example <code>And</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">grep</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">and</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">first</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/^5\d\d$/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">second</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/\.css$/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">&lt;and&gt;</span>
</span></span><span style="display:flex"><span>	  <span style="color:#204a87;font-weight:700">&lt;regexp&gt;</span>
</span></span><span style="display:flex"><span>	    key first
</span></span><span style="display:flex"><span>	    pattern /^5\d\d$/
</span></span><span style="display:flex"><span>	  <span style="color:#204a87;font-weight:700">&lt;/regexp&gt;</span>
</span></span><span style="display:flex"><span>	  <span style="color:#204a87;font-weight:700">&lt;regexp&gt;</span>
</span></span><span style="display:flex"><span>	    key second
</span></span><span style="display:flex"><span>	    pattern /\.css$/
</span></span><span style="display:flex"><span>	  <span style="color:#204a87;font-weight:700">&lt;/regexp&gt;</span>
</span></span><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">&lt;/and&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-4ed899f75f815259c224810fdfb84730">4.8.3.7 - Kubernetes Events Timestamp</h1><h1 id="kubernetes-events-timestamp-filterhttpsgithubcomkube-loggingfluentd-filter-kube-events-timestamp"><a href="https://github.com/kube-logging/fluentd-filter-kube-events-timestamp">Kubernetes Events Timestamp Filter</a></h1><h2 id="overview">Overview</h2><p>Fluentd Filter plugin to select particular timestamp into an additional field</p><h2 id="configuration">Configuration</h2><h2 id="kubeeventstimestampconfig">KubeEventsTimestampConfig</h2><h3 id="kubeeventstimestampconfig-mapped_time_key">mapped_time_key (string, optional)</h3><p>Added time field name</p><p>Default: triggerts</p><h3 id="kubeeventstimestampconfig-timestamp_fields">timestamp_fields ([]string, optional)</h3><p>Time field names in order of relevance</p><p>Default: event.eventTime, event.lastTimestamp, event.firstTimestamp</p><h2 id="example-kubernetes-events-timestamp-filter-configurations">Example <code>Kubernetes Events Timestamp</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">es-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">kube_events_timestamp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">timestamp_fields</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#4e9a06">&#34;event.eventTime&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#4e9a06">&#34;event.lastTimestamp&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#4e9a06">&#34;event.firstTimestamp&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">mapped_time_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">mytimefield</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">es-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span> <span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span> @type kube_events_timestamp
</span></span><span style="display:flex"><span> @id test-kube-events-timestamp
</span></span><span style="display:flex"><span> timestamp_fields [&#34;event.eventTime&#34;,&#34;event.lastTimestamp&#34;,&#34;event.firstTimestamp&#34;]
</span></span><span style="display:flex"><span> mapped_time_key mytimefield
</span></span><span style="display:flex"><span> <span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-5a6aa7b18aae1acb56e9fd8f8f8cd854">4.8.3.8 - Parser</h1><h1 id="parser-filterhttpsdocsfluentdorgfilterparser"><a href="https://docs.fluentd.org/filter/parser">Parser Filter</a></h1><h2 id="overview">Overview</h2><p>Parses a string field in event records and mutates its event record with the parsed result.</p><h2 id="configuration">Configuration</h2><h2 id="parserconfig">ParserConfig</h2><h3 id="parserconfig-emit_invalid_record_to_error">emit_invalid_record_to_error (*bool, optional)</h3><p>Emit invalid record to @ERROR label. Invalid cases are: key not exist, format is not matched, unexpected error</p><h3 id="parserconfig-hash_value_field">hash_value_field (string, optional)</h3><p>Store parsed values as a hash value in a field.</p><h3 id="parserconfig-inject_key_prefix">inject_key_prefix (string, optional)</h3><p>Store parsed values with specified key name prefix.</p><h3 id="parserconfig-key_name">key_name (string, optional)</h3><p>Specify field name in the record to parse. If you leave empty the Container Runtime default will be used.</p><h3 id="parserconfig-parse">parse (ParseSection, optional)</h3><p><a href="#parse-section">Parse Section</a></p><h3 id="parserconfig-parsers">parsers ([]ParseSection, optional)</h3><p>Deprecated, use <code>parse</code> instead</p><h3 id="parserconfig-remove_key_name_field">remove_key_name_field (bool, optional)</h3><p>Remove key_name field when parsing is succeeded</p><h3 id="parserconfig-replace_invalid_sequence">replace_invalid_sequence (bool, optional)</h3><p>If true, invalid string is replaced with safe characters and re-parse it.</p><h3 id="parserconfig-reserve_data">reserve_data (bool, optional)</h3><p>Keep original key-value pair in parsed result.</p><h3 id="parserconfig-reserve_time">reserve_time (bool, optional)</h3><p>Keep original event time in parsed result.</p><h2 id="parse-section">Parse Section</h2><h3 id="parse-section-custom_pattern_path">custom_pattern_path (*secret.Secret, optional)</h3><p>Only available when using type: grok, multiline_grok. File that includes custom grok patterns.</p><h3 id="parse-section-delimiter">delimiter (string, optional)</h3><p>Only available when using type: ltsv</p><p>Default: &ldquo;\t&rdquo;</p><h3 id="parse-section-delimiter_pattern">delimiter_pattern (string, optional)</h3><p>Only available when using type: ltsv</p><h3 id="parse-section-estimate_current_event">estimate_current_event (bool, optional)</h3><p>If true, use Fluent::EventTime.now(current time) as a timestamp when time_key is specified.</p><h3 id="parse-section-expression">expression (string, optional)</h3><p>Regexp expression to evaluate</p><h3 id="parse-section-format">format (string, optional)</h3><p>Only available when using type: multi_format</p><h3 id="parse-section-format_firstline">format_firstline (string, optional)</h3><p>Only available when using type: multi_format</p><h3 id="parse-section-grok_failure_key">grok_failure_key (string, optional)</h3><p>Only available when using type: grok, multiline_grok. The key has grok failure reason.</p><h3 id="parse-section-grok_name_key">grok_name_key (string, optional)</h3><p>Only available when using type: grok, multiline_grok. The key name to store grok section&rsquo;s name.</p><h3 id="parse-section-grok_pattern">grok_pattern (string, optional)</h3><p>Only available when using type: grok, multiline_grok. The pattern of grok. You cannot specify multiple grok pattern with this.</p><h3 id="parse-section-grok_patterns">grok_patterns ([]GrokSection, optional)</h3><p>Only available when using type: grok, multiline_grok. <a href="#grok-section">Grok Section</a> Specify grok pattern series set.</p><h3 id="parse-section-keep_time_key">keep_time_key (bool, optional)</h3><p>If true, keep time field in the record.</p><h3 id="parse-section-keys">keys (string, optional)</h3><p>Names for fields on each line. (seperated by coma)</p><h3 id="parse-section-label_delimiter">label_delimiter (string, optional)</h3><p>Only available when using type: ltsv</p><p>Default: &ldquo;:&rdquo;</p><h3 id="parse-section-local_time">local_time (bool, optional)</h3><p>If true, use local time. Otherwise, UTC is used. This is exclusive with utc.</p><p>Default: true</p><h3 id="parse-section-multiline">multiline ([]string, optional)</h3><p>The multiline parser plugin parses multiline logs.</p><h3 id="parse-section-multiline_start_regexp">multiline_start_regexp (string, optional)</h3><p>Only available when using type: multiline_grok The regexp to match beginning of multiline.</p><h3 id="parse-section-null_empty_string">null_empty_string (bool, optional)</h3><p>If true, empty string field is replaced with nil</p><h3 id="parse-section-null_value_pattern">null_value_pattern (string, optional)</h3><p>Specify null value pattern.</p><h3 id="parse-section-patterns">patterns ([]SingleParseSection, optional)</h3><p>Only available when using type: multi_format <a href="#parse-section">Parse Section</a></p><h3 id="parse-section-time_format">time_format (string, optional)</h3><p>Process value using specified format. This is available only when time_type is string</p><h3 id="parse-section-time_key">time_key (string, optional)</h3><p>Specify time field for event time. If the event doesn&rsquo;t have this field, current time is used.</p><h3 id="parse-section-time_type">time_type (string, optional)</h3><p>Parse/format value according to this type available values: float, unixtime, string</p><p>Default: string</p><h3 id="parse-section-timezone">timezone (string, optional)</h3><p>Use specified timezone. one can parse/format the time value in the specified timezone.</p><p>Default: nil</p><h3 id="parse-section-type">type (string, optional)</h3><p>Parse type: apache2, apache_error, nginx, syslog, csv, tsv, ltsv, json, multiline, none, logfmt, grok, multiline_grok</p><h3 id="parse-section-types">types (string, optional)</h3><p>Types casting the fields to proper types example: field1:type, field2:type</p><h3 id="parse-section-utc">utc (bool, optional)</h3><p>If true, use UTC. Otherwise, local time is used. This is exclusive with localtime</p><p>Default: false</p><h2 id="parse-section-single">Parse Section (single)</h2><h3 id="parse-section-custom_pattern_path">custom_pattern_path (*secret.Secret, optional)</h3><p>Only available when using format: grok, multiline_grok. File that includes custom grok patterns.</p><h3 id="parse-section-estimate_current_event">estimate_current_event (bool, optional)</h3><p>If true, use Fluent::EventTime.now(current time) as a timestamp when time_key is specified.</p><h3 id="parse-section-expression">expression (string, optional)</h3><p>Regexp expression to evaluate</p><h3 id="parse-section-format">format (string, optional)</h3><p>Only available when using type: multi_format</p><h3 id="parse-section-grok_failure_key">grok_failure_key (string, optional)</h3><p>Only available when using format: grok, multiline_grok. The key has grok failure reason.</p><h3 id="parse-section-grok_name_key">grok_name_key (string, optional)</h3><p>Only available when using format: grok, multiline_grok. The key name to store grok section&rsquo;s name.</p><h3 id="parse-section-grok_pattern">grok_pattern (string, optional)</h3><p>Only available when using format: grok, multiline_grok. The pattern of grok. You cannot specify multiple grok pattern with this.</p><h3 id="parse-section-grok_patterns">grok_patterns ([]GrokSection, optional)</h3><p>Only available when using format: grok, multiline_grok. <a href="#grok-section">Grok Section</a> Specify grok pattern series set.</p><h3 id="parse-section-keep_time_key">keep_time_key (bool, optional)</h3><p>If true, keep time field in the record.</p><h3 id="parse-section-local_time">local_time (bool, optional)</h3><p>If true, use local time. Otherwise, UTC is used. This is exclusive with utc.</p><p>Default: true</p><h3 id="parse-section-multiline_start_regexp">multiline_start_regexp (string, optional)</h3><p>Only available when using format: multiline_grok The regexp to match beginning of multiline.</p><h3 id="parse-section-null_empty_string">null_empty_string (bool, optional)</h3><p>If true, empty string field is replaced with nil</p><h3 id="parse-section-null_value_pattern">null_value_pattern (string, optional)</h3><p>Specify null value pattern.</p><h3 id="parse-section-time_format">time_format (string, optional)</h3><p>Process value using specified format. This is available only when time_type is string</p><h3 id="parse-section-time_key">time_key (string, optional)</h3><p>Specify time field for event time. If the event doesn&rsquo;t have this field, current time is used.</p><h3 id="parse-section-time_type">time_type (string, optional)</h3><p>Parse/format value according to this type available values: float, unixtime, string</p><p>Default: string</p><h3 id="parse-section-timezone">timezone (string, optional)</h3><p>Use specified timezone. one can parse/format the time value in the specified timezone.</p><p>Default: nil</p><h3 id="parse-section-type">type (string, optional)</h3><p>Parse type: apache2, apache_error, nginx, syslog, csv, tsv, ltsv, json, multiline, none, logfmt, grok, multiline_grok</p><h3 id="parse-section-types">types (string, optional)</h3><p>Types casting the fields to proper types example: field1:type, field2:type</p><h3 id="parse-section-utc">utc (bool, optional)</h3><p>If true, use UTC. Otherwise, local time is used. This is exclusive with localtime</p><p>Default: false</p><h2 id="grok-section">Grok Section</h2><h3 id="grok-section-keep_time_key">keep_time_key (bool, optional)</h3><p>If true, keep time field in the record.</p><h3 id="grok-section-name">name (string, optional)</h3><p>The name of grok section.</p><h3 id="grok-section-pattern">pattern (string, required)</h3><p>The pattern of grok.</p><h3 id="grok-section-time_format">time_format (string, optional)</h3><p>Process value using specified format. This is available only when time_type is string.</p><h3 id="grok-section-time_key">time_key (string, optional)</h3><p>Specify time field for event time. If the event doesn&rsquo;t have this field, current time is used.</p><p>Default: time</p><h3 id="grok-section-timezone">timezone (string, optional)</h3><p>Use specified timezone. one can parse/format the time value in the specified timezone.</p><h2 id="example-parser-filter-configurations">Example <code>Parser</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">parser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">remove_key_name_field</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">reserve_data</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">parse</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">multi_format</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">patterns</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">regexp</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">expression</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/foo/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">none</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">&lt;filter **&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>@<span style="color:#000">type parser</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>@<span style="color:#000">id test_parser</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">key_name message</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">remove_key_name_field true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">reserve_data true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">&lt;parse&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>@<span style="color:#000">type multi_format</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">&lt;pattern&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#000">format nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">&lt;/pattern&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">&lt;pattern&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#000">expression /foo/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#000">format regexp</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">&lt;/pattern&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">&lt;pattern&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#000">format none</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">&lt;/pattern&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">&lt;/parse&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-b1ababb8fff927a359f5ee10ddd9740d">4.8.3.9 - Prometheus</h1><h1 id="prometheus-filterhttpsgithubcomfluentfluent-plugin-prometheusprometheus-outputfilter-plugin"><a href="https://github.com/fluent/fluent-plugin-prometheus#prometheus-outputfilter-plugin">Prometheus Filter</a></h1><h2 id="overview">Overview</h2><p>Prometheus Filter Plugin to count Incoming Records</p><h2 id="configuration">Configuration</h2><h2 id="prometheusconfig">PrometheusConfig</h2><h3 id="prometheusconfig-labels">labels (Label, optional)</h3><h3 id="prometheusconfig-metrics">metrics ([]MetricSection, optional)</h3><p><a href="#metrics-section">Metrics Section</a></p><h2 id="metrics-section">Metrics Section</h2><h3 id="metrics-section-buckets">buckets (string, optional)</h3><p>Buckets of record for instrumentation</p><h3 id="metrics-section-desc">desc (string, required)</h3><p>Description of metric</p><h3 id="metrics-section-key">key (string, optional)</h3><p>Key name of record for instrumentation.</p><h3 id="metrics-section-labels">labels (Label, optional)</h3><p>Additional labels for this metric</p><h3 id="metrics-section-name">name (string, required)</h3><p>Metrics name</p><h3 id="metrics-section-type">type (string, required)</h3><p>Metrics type <a href="https://github.com/fluent/fluent-plugin-prometheus#counter-type">counter</a>, <a href="https://github.com/fluent/fluent-plugin-prometheus#gauge-type">gauge</a>, <a href="https://github.com/fluent/fluent-plugin-prometheus#summary-type">summary</a>, <a href="https://github.com/fluent/fluent-plugin-prometheus#histogram-type">histogram</a></p><h2 id="example-prometheus-filter-configurations">Example <code>Prometheus</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">tag_normaliser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">parser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">remove_key_name_field</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">reserve_data</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">parse</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">prometheus</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">metrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">total_counter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">desc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">The total number of foo in message.</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">counter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">foo</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">bar</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${hostname}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">${tag}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">$.kubernetes.namespace</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>    @type prometheus
</span></span><span style="display:flex"><span>    @id logging-demo-flow_2_prometheus
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;metric&gt;</span>
</span></span><span style="display:flex"><span>      desc The total number of foo in message.
</span></span><span style="display:flex"><span>      name total_counter
</span></span><span style="display:flex"><span>      type counter
</span></span><span style="display:flex"><span>      <span style="color:#204a87;font-weight:700">&lt;labels&gt;</span>
</span></span><span style="display:flex"><span>        foo bar
</span></span><span style="display:flex"><span>      <span style="color:#204a87;font-weight:700">&lt;/labels&gt;</span>
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;/metric&gt;</span>
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;labels&gt;</span>
</span></span><span style="display:flex"><span>      host ${hostname}
</span></span><span style="display:flex"><span>      namespace $.kubernetes.namespace
</span></span><span style="display:flex"><span>      tag ${tag}
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;/labels&gt;</span>
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-2c5a900f0f1960d731ab3d2e7e9ae2dd">4.8.3.10 - Record Modifier</h1><h1 id="record-modifierhttpsgithubcomrepeatedlyfluent-plugin-record-modifier"><a href="https://github.com/repeatedly/fluent-plugin-record-modifier">Record Modifier</a></h1><h2 id="overview">Overview</h2><p>Modify each event record.</p><h2 id="configuration">Configuration</h2><h2 id="recordmodifier">RecordModifier</h2><h3 id="recordmodifier-char_encoding">char_encoding (string, optional)</h3><p>Fluentd including some plugins treats logs as a BINARY by default to forward. To overide that, use a target encoding or a from:to encoding here.</p><h3 id="recordmodifier-prepare_value">prepare_value (string, optional)</h3><p>Prepare values for filtering in configure phase. Prepared values can be used in <code>&lt;record></code>. You can write any ruby code.</p><h3 id="recordmodifier-records">records ([]Record, optional)</h3><p>Add records. Records are represented as maps: <code>key: value</code>. For details, see <a href="https://github.com/repeatedly/fluent-plugin-record-modifier">https://github.com/repeatedly/fluent-plugin-record-modifier</a>.</p><h3 id="recordmodifier-remove_keys">remove_keys (string, optional)</h3><p>A comma-delimited list of keys to delete</p><h3 id="recordmodifier-replaces">replaces ([]Replace, optional)</h3><p>Replace specific value for keys</p><h3 id="recordmodifier-whitelist_keys">whitelist_keys (string, optional)</h3><p>This is exclusive with remove_keys</p><h2 id="example-record-modifier-filter-configurations">Example <code>Record Modifier</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">record_modifier</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">records</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#204a87;font-weight:700">foo</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;bar&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>  @type record_modifier
</span></span><span style="display:flex"><span>  @id test_record_modifier
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;record&gt;</span>
</span></span><span style="display:flex"><span>    foo bar
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/record&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
<h2 id="replace-directivehttpsgithubcomrepeatedlyfluent-plugin-record-modifierreplace_keys_value"><a href="https://github.com/repeatedly/fluent-plugin-record-modifier#replace_keys_value">Replace Directive</a></h2><p>Specify replace rule. This directive contains three parameters.</p><h3 id="replace-directive-replace_keys_value-expression">expression (string, required)</h3><p>Regular expression</p><h3 id="replace-directive-replace_keys_value-key">key (string, required)</h3><p>Key to search for</p><h3 id="replace-directive-replace_keys_value-replace">replace (string, required)</h3><p>Value to replace with</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-2adc391c4bf236f17f4dff5d5236127b">4.8.3.11 - Record Transformer</h1><h1 id="record-transformerhttpsdocsfluentdorgfilterrecord_transformer"><a href="https://docs.fluentd.org/filter/record_transformer">Record Transformer</a></h1><h2 id="overview">Overview</h2><p>Mutates/transforms incoming event streams.</p><h2 id="configuration">Configuration</h2><h2 id="recordtransformer">RecordTransformer</h2><h3 id="recordtransformer-auto_typecast">auto_typecast (bool, optional)</h3><p>Use original value type.</p><p>Default: true</p><h3 id="recordtransformer-enable_ruby">enable_ruby (bool, optional)</h3><p>When set to true, the full Ruby syntax is enabled in the <code>${...}</code> expression.</p><p>Default: false</p><h3 id="recordtransformer-keep_keys">keep_keys (string, optional)</h3><p>A comma-delimited list of keys to keep.</p><h3 id="recordtransformer-records">records ([]Record, optional)</h3><p>Add records docs at: <a href="https://docs.fluentd.org/filter/record_transformer">https://docs.fluentd.org/filter/record_transformer</a> Records are represented as maps: <code>key: value</code></p><h3 id="recordtransformer-remove_keys">remove_keys (string, optional)</h3><p>A comma-delimited list of keys to delete</p><h3 id="recordtransformer-renew_record">renew_record (bool, optional)</h3><p>Create new Hash to transform incoming data</p><p>Default: false</p><h3 id="recordtransformer-renew_time_key">renew_time_key (string, optional)</h3><p>Specify field name of the record to overwrite the time of events. Its value must be unix time.</p><h2 id="example-record-transformer-filter-configurations">Example <code>Record Transformer</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">record_transformer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">records</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#204a87;font-weight:700">foo</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;bar&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>  @type record_transformer
</span></span><span style="display:flex"><span>  @id test_record_transformer
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;record&gt;</span>
</span></span><span style="display:flex"><span>    foo bar
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/record&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-06af9b3099c8f9f37d675b5aee19c604">4.8.3.12 - StdOut</h1><h1 id="stdout-filterhttpsdocsfluentdorgfilterstdout"><a href="https://docs.fluentd.org/filter/stdout">Stdout Filter</a></h1><h2 id="overview">Overview</h2><p>Fluentd Filter plugin to print events to stdout</p><h2 id="configuration">Configuration</h2><h2 id="stdoutfilterconfig">StdOutFilterConfig</h2><h3 id="stdoutfilterconfig-output_type">output_type (string, optional)</h3><p>This is the option of stdout format.</p><h2 id="example-stdout-filter-configurations">Example <code>StdOut</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">stdout</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">output_type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">&lt;filter **&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>@<span style="color:#000">type stdout</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>@<span style="color:#000">id test_stdout</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">output_type json</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-9f71d81ccc4b25c0f75938abbc9a158d">4.8.3.13 - Tag Normaliser</h1><p>Fluentd Plugin to re-tag based on log metadata. More info at <a href="https://github.com/kube-logging/fluent-plugin-tag-normaliser">https://github.com/kube-logging/fluent-plugin-tag-normaliser</a></p><h2 id="available-kubernetes-metadata">Available Kubernetes metadata</h2><table>
<thead>
<tr>
<th>Parameter</th><th>Description</th><th>Example</th></tr></thead><tbody>
<tr>
<td><code>${pod_name}</code></td><td>Pod name</td><td>understood-butterfly-logging-demo-7dcdcfdcd7-h7p9n</td></tr><tr>
<td><code>${container_name}</code></td><td>Container name inside the Pod</td><td>logging-demo</td></tr><tr>
<td><code>${namespace_name}</code></td><td>Namespace name</td><td>default</td></tr><tr>
<td><code>${pod_id}</code></td><td>Kubernetes UUID for Pod</td><td>1f50d309-45a6-11e9-b795-025000000001</td></tr><tr>
<td><code>${labels}</code></td><td>Kubernetes Pod labels. This is a nested map. You can access nested attributes via <code>.</code></td><td><code>{"app":"logging-demo", "pod-template-hash":"7dcdcfdcd7" }</code></td></tr><tr>
<td><code>${host}</code></td><td>Node hostname the Pod runs on</td><td>docker-desktop</td></tr><tr>
<td><code>${docker_id}</code></td><td>Docker UUID of the container</td><td>3a38148aa37aa3&mldr;</td></tr></tbody></table><h2 id="configuration">Configuration</h2><h2 id="tag-normaliser-parameters">Tag Normaliser parameters</h2><h3 id="tag-normaliser-parameters-format">format (string, optional)</h3><p>Re-Tag log messages info at <a href="https://github.com/kube-logging/fluent-plugin-tag-normaliser">github</a></p><p>Default: ${namespace_name}.${pod_name}.${container_name}</p><h3 id="tag-normaliser-parameters-match_tag">match_tag (string, optional)</h3><p>Tag used in match directive.</p><p>Default: <code>kubernetes.**</code></p><h2 id="example-parser-filter-configurations">Example <code>Parser</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">tag_normaliser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">cluster1.${namespace_name}.${pod_name}.${labels.app}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;match</span> <span style="color:#a40000">kubernetes.**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>  @type tag_normaliser
</span></span><span style="display:flex"><span>  @id test_tag_normaliser
</span></span><span style="display:flex"><span>  format cluster1.${namespace_name}.${pod_name}.${labels.app}
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/match&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-c86a56fc7e085e5aea4460c0e18e5990">4.8.3.14 - Throttle</h1><h1 id="throttle-filterhttpsgithubcomrubrikincfluent-plugin-throttle"><a href="https://github.com/rubrikinc/fluent-plugin-throttle">Throttle Filter</a></h1><h2 id="overview">Overview</h2><p>A sentry plugin to throttle logs. Logs are grouped by a configurable key. When a group exceeds a configuration rate, logs are dropped for this group.</p><h2 id="configuration">Configuration</h2><h2 id="throttle">Throttle</h2><h3 id="throttle-group_bucket_limit">group_bucket_limit (int, optional)</h3><p>Maximum number logs allowed per groups over the period of group_bucket_period_s</p><p>Default: 6000</p><h3 id="throttle-group_bucket_period_s">group_bucket_period_s (int, optional)</h3><p>This is the period of of time over which group_bucket_limit applies</p><p>Default: 60</p><h3 id="throttle-group_drop_logs">group_drop_logs (bool, optional)</h3><p>When a group reaches its limit, logs will be dropped from further processing if this value is true</p><p>Default: true</p><h3 id="throttle-group_key">group_key (string, optional)</h3><p>Used to group logs. Groups are rate limited independently</p><p>Default: kubernetes.container_name</p><h3 id="throttle-group_reset_rate_s">group_reset_rate_s (int, optional)</h3><p>After a group has exceeded its bucket limit, logs are dropped until the rate per second falls below or equal to group_reset_rate_s.</p><p>Default: group_bucket_limit/group_bucket_period_s</p><h3 id="throttle-group_warning_delay_s">group_warning_delay_s (int, optional)</h3><p>When a group reaches its limit and as long as it is not reset, a warning message with the current log rate of the group is emitted repeatedly. This is the delay between every repetition.</p><p>Default: 10 seconds</p><h2 id="example-throttle-filter-configurations">Example <code>Throttle</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">throttle</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">group_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;$.kubernetes.container_name&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>  @type throttle
</span></span><span style="display:flex"><span>  @id test_throttle
</span></span><span style="display:flex"><span>  group_key $.kubernetes.container_name
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-3610a8928860c8aae138583bea272461">4.8.3.15 - User Agent</h1><h1 id="fluentd-useragent-filter">Fluentd UserAgent filter</h1><h2 id="overview">Overview</h2><p>Fluentd Filter plugin to parse user-agent
More information at <a href="https://github.com/bungoume/fluent-plugin-ua-parser">https://github.com/bungoume/fluent-plugin-ua-parser</a></p><h2 id="configuration">Configuration</h2><h2 id="useragent">UserAgent</h2><h3 id="useragent-delete_key">delete_key (bool, optional)</h3><p>Delete input key</p><p>Default: false</p><h3 id="useragent-flatten">flatten (bool, optional)</h3><p>Join hashed data by &lsquo;_&rsquo;</p><p>Default: false</p><h3 id="useragent-key_name">key_name (string, optional)</h3><p>Target key name</p><p>Default: user_agent</p><h3 id="useragent-out_key">out_key (string, optional)</h3><p>Output prefix key name</p><p>Default: ua</p><h2 id="example-useragent-filter-configurations">Example <code>UserAgent</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">useragent</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">key_name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">my_agent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">delete_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">out_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ua_fields</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">flatten</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>  @type ua_parser
</span></span><span style="display:flex"><span>  @id test_useragent
</span></span><span style="display:flex"><span>  key_name my_agent
</span></span><span style="display:flex"><span>  delete_key true
</span></span><span style="display:flex"><span>  out_key ua_fields
</span></span><span style="display:flex"><span>  flatten true
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-506383d863d6db46f320e08de47fb0c7">4.8.4 - Fluentd outputs</h1></div><div class="td-content">
<h1 id="pg-d52aa3c8a0eb89cb0544a82420222298">4.8.4.1 - </h1><h1 id="null-output-plugin-for-fluentd">Null output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>For details, see <a href="https://docs.fluentd.org/output/null">https://docs.fluentd.org/output/null</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">nullout</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">never_flush</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="nulloutputconfig">NullOutputConfig</h2><h3 id="nulloutputconfig-never_flush">never_flush (*bool, optional)</h3><p>The parameter for testing to simulate the output plugin that never succeeds to flush.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-28f1e98e5b5c5f770fb8b2e592e1abf0">4.8.4.2 - Alibaba Cloud</h1><h1 id="aliyun-oss-plugin-for-fluentd">Aliyun OSS plugin for Fluentd</h1><h2 id="overview">Overview</h2><p><strong>Fluent OSS output plugin</strong> buffers event logs in local files and uploads them to OSS periodically in background threads.</p><p>This plugin splits events by using the timestamp of event logs. For example, a log &lsquo;2019-04-09 message Hello&rsquo; is reached, and then another log &lsquo;2019-04-10 message World&rsquo; is reached in this order, the former is stored in &ldquo;20190409.gz&rdquo; file, and latter in &ldquo;20190410.gz&rdquo; file.</p><p><strong>Fluent OSS input plugin</strong> reads data from OSS periodically.</p><p>This plugin uses MNS on the same region of the OSS bucket. We must setup MNS and OSS event notification before using this plugin.</p><p><a href="https://help.aliyun.com/document_detail/52656.html">This document</a> shows how to setup MNS and OSS event notification.</p><p>This plugin will poll events from MNS queue and extract object keys from these events, and then will read those objects from OSS. For details, see <a href="https://github.com/aliyun/fluent-plugin-oss">https://github.com/aliyun/fluent-plugin-oss</a>.</p><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="output-config-access_key_id">access_key_id (*secret.Secret, required)</h3><p>Your access key id <a href="../secret/">Secret</a></p><h3 id="output-config-aaccess_key_secret">access_key_secret (*secret.Secret, required)</h3><p>Your access secret key <a href="../secret/">Secret</a></p><h3 id="output-config-auto_create_bucket">auto_create_bucket (bool, optional)</h3><p>desc &lsquo;Create OSS bucket if it does not exists</p><p>Default: false</p><h3 id="output-config-bucket">bucket (string, required)</h3><p>Your bucket name</p><h3 id="output-config-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="output-config-check_bucket">check_bucket (bool, optional)</h3><p>Check bucket if exists or not</p><p>Default: true</p><h3 id="output-config-check_object">check_object (bool, optional)</h3><p>Check object before creation</p><p>Default: true</p><h3 id="output-config-download_crc_enable">download_crc_enable (bool, optional)</h3><p>Download crc enabled</p><p>Default: true</p><h3 id="output-config-endpoint">endpoint (string, required)</h3><p>OSS endpoint to connect to&rsquo;</p><h3 id="output-config-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="output-config-hex_random_length">hex_random_length (int, optional)</h3><p>The length of <code>%{hex_random}</code> placeholder(4-16)</p><p>Default: 4</p><h3 id="output-config-index_format">index_format (string, optional)</h3><p><code>sprintf</code> format for <code>%{index}</code></p><p>Default: %d</p><h3 id="output-config-key_format">key_format (string, optional)</h3><p>The format of OSS object keys</p><p>Default: <code>%{path}/%{time_slice}_%{index}_%{thread_id}.%{file_extension}</code></p><h3 id="output-config-open_timeout">open_timeout (int, optional)</h3><p>Timeout for open connections</p><p>Default: 10</p><h3 id="output-config-oss_sdk_log_dir">oss_sdk_log_dir (string, optional)</h3><p>OSS SDK log directory</p><p>Default: /var/log/td-agent</p><h3 id="output-config-overwrite">overwrite (bool, optional)</h3><p>Overwrite already existing path</p><p>Default: false</p><h3 id="output-config-path">path (string, optional)</h3><p>Path prefix of the files on OSS</p><p>Default: fluent/logs</p><h3 id="output-config-read_timeout">read_timeout (int, optional)</h3><p>Timeout for read response</p><p>Default: 120</p><h3 id="output-config-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, Fluentd logs a warning message and increases the <code>fluentd_output_status_slow_flush_count</code> metric.</p><h3 id="output-config-store_as">store_as (string, optional)</h3><p>Archive format on OSS: gzip, json, text, lzo, lzma2</p><p>Default: gzip</p><h3 id="output-config-upload_crc_enable">upload_crc_enable (bool, optional)</h3><p>Upload crc enabled</p><p>Default: true</p><h3 id="output-config-warn_for_delay">warn_for_delay (string, optional)</h3><p>Given a threshold to treat events as delay, output warning logs if delayed events were put into OSS</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-aeea1cd1922e8ddddba7f377f910cc60">4.8.4.3 - Amazon CloudWatch</h1><h1 id="cloudwatch-output-plugin-for-fluentd">CloudWatch output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>This plugin outputs logs or metrics to Amazon CloudWatch. For details, see <a href="https://github.com/fluent-plugins-nursery/fluent-plugin-cloudwatch-logs">https://github.com/fluent-plugins-nursery/fluent-plugin-cloudwatch-logs</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">cloudwatch</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">aws_key_id</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-s3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">awsAccessKeyId</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">aws_sec_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-s3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">awsSecretAccessKey</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">log_group_name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">operator-log-group</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">log_stream_name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">operator-log-stream</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">region</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">us-east-1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">auto_create_stream true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">30s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">30s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">timekey_use_utc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="output-config-auto_create_stream">auto_create_stream (bool, optional)</h3><p>Create log group and stream automatically.</p><p>Default: false</p><h3 id="output-config-aws_key_id">aws_key_id (*secret.Secret, optional)</h3><p>AWS access key id <a href="../secret/">Secret</a></p><h3 id="output-config-aws_instance_profile_credentials_retries">aws_instance_profile_credentials_retries (int, optional)</h3><p>Instance Profile Credentials call retries</p><p>Default: nil</p><h3 id="output-config-aws_sec_key">aws_sec_key (*secret.Secret, optional)</h3><p>AWS secret key. <a href="../secret/">Secret</a></p><h3 id="output-config-aws_sts_role_arn">aws_sts_role_arn (string, optional)</h3><p>The role ARN to assume when using cross-account sts authentication</p><h3 id="output-config-aws_sts_session_name">aws_sts_session_name (string, optional)</h3><p>The session name to use with sts authentication</p><p>Default: &lsquo;fluentd&rsquo;</p><h3 id="output-config-aws_use_sts">aws_use_sts (bool, optional)</h3><p>Enable AssumeRoleCredentials to authenticate, rather than the default credential hierarchy. See &lsquo;Cross-Account Operation&rsquo; below for more detail.</p><h3 id="output-config-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="output-config-concurrency">concurrency (int, optional)</h3><p>Use to set the number of threads pushing data to CloudWatch.</p><p>Default: 1</p><h3 id="output-config-endpoint">endpoint (string, optional)</h3><p>Use this parameter to connect to the local API endpoint (for testing)</p><h3 id="output-config-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="output-config-http_proxy">http_proxy (string, optional)</h3><p>Use to set an optional HTTP proxy</p><h3 id="output-config-include_time_key">include_time_key (bool, optional)</h3><p>Include time key as part of the log entry</p><p>Default: UTC</p><h3 id="output-config-json_handler">json_handler (string, optional)</h3><p>Name of the library to be used to handle JSON data. For now, supported libraries are json (default) and yaml</p><h3 id="output-config-localtime">localtime (bool, optional)</h3><p>Use localtime timezone for include_time_key output (overrides UTC default)</p><h3 id="output-config-log_group_aws_tags">log_group_aws_tags (string, optional)</h3><p>Set a hash with keys and values to tag the log group resource</p><h3 id="output-config-log_group_aws_tags_key">log_group_aws_tags_key (string, optional)</h3><p>Specified field of records as AWS tags for the log group</p><h3 id="output-config-log_group_name">log_group_name (string, optional)</h3><p>Name of log group to store logs</p><h3 id="output-config-log_group_name_key">log_group_name_key (string, optional)</h3><p>Specified field of records as log group name</p><h3 id="output-config-log_rejected_request">log_rejected_request (string, optional)</h3><p>Output rejected_log_events_info request log.</p><p>Default: false</p><h3 id="output-config-log_stream_name">log_stream_name (string, optional)</h3><p>Name of log stream to store logs</p><h3 id="output-config-log_stream_name_key">log_stream_name_key (string, optional)</h3><p>Specified field of records as log stream name</p><h3 id="output-config-max_events_per_batch">max_events_per_batch (int, optional)</h3><p>Maximum number of events to send at once</p><p>Default: 10000</p><h3 id="output-config-max_message_length">max_message_length (int, optional)</h3><p>Maximum length of the message</p><h3 id="output-config-message_keys">message_keys (string, optional)</h3><p>Keys to send messages as events</p><h3 id="output-config-put_log_events_disable_retry_limit">put_log_events_disable_retry_limit (bool, optional)</h3><p>If true, put_log_events_retry_limit will be ignored</p><h3 id="output-config-put_log_events_retry_limit">put_log_events_retry_limit (int, optional)</h3><p>Maximum count of retry (if exceeding this, the events will be discarded)</p><h3 id="output-config-put_log_events_retry_wait">put_log_events_retry_wait (string, optional)</h3><p>Time before retrying PutLogEvents (retry interval increases exponentially like put_log_events_retry_wait * (2 ^ retry_count))</p><h3 id="output-config-region">region (string, required)</h3><p>AWS Region</p><h3 id="output-config-remove_log_group_aws_tags_key">remove_log_group_aws_tags_key (string, optional)</h3><p>Remove field specified by log_group_aws_tags_key</p><h3 id="output-config-remove_log_group_name_key">remove_log_group_name_key (string, optional)</h3><p>Remove field specified by log_group_name_key</p><h3 id="output-config-remove_log_stream_name_key">remove_log_stream_name_key (string, optional)</h3><p>Remove field specified by log_stream_name_key</p><h3 id="output-config-remove_retention_in_days">remove_retention_in_days (string, optional)</h3><p>Remove field specified by retention_in_days</p><h3 id="output-config-retention_in_days">retention_in_days (string, optional)</h3><p>Use to set the expiry time for log group when created with auto_create_stream. (default to no expiry)</p><h3 id="output-config-retention_in_days_key">retention_in_days_key (string, optional)</h3><p>Use specified field of records as retention period</p><h3 id="output-config-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="output-config-use_tag_as_group">use_tag_as_group (bool, optional)</h3><p>Use tag as a group name</p><h3 id="output-config-use_tag_as_stream">use_tag_as_stream (bool, optional)</h3><p>Use tag as a stream name</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-2b59c5fb4b2ccfdb47e90229617f245a">4.8.4.4 - Amazon Elasticsearch</h1><h1 id="amazon-elasticsearch-output-plugin-for-fluentd">Amazon Elasticsearch output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>For details, see <a href="https://github.com/atomita/fluent-plugin-aws-elasticsearch-service">https://github.com/atomita/fluent-plugin-aws-elasticsearch-service</a></p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">awsElasticsearch</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">logstash_format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">include_tag_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tag_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;@log_name&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">flush_interval</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">endpoint</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://CLUSTER_ENDPOINT_URL</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">region</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eu-west-1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">access_key_id</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">aws-key</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">secret_access_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">aws_secret</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="amazon-elasticsearch">Amazon Elasticsearch</h2><p>Send your logs to a Amazon Elasticsearch Service</p><h3 id="amazon-elasticsearch-">(*ElasticsearchOutput, optional)</h3><p>ElasticSearch</p><h3 id="amazon-elasticsearch-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="amazon-elasticsearch-endpoint">endpoint (*EndpointCredentials, optional)</h3><p>AWS Endpoint Credentials</p><h3 id="amazon-elasticsearch-flush_interval">flush_interval (string, optional)</h3><p>flush_interval</p><h3 id="amazon-elasticsearch-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h2 id="endpoint-credentials">Endpoint Credentials</h2><p>endpoint</p><h3 id="endpoint-credentials-access_key_id">access_key_id (*secret.Secret, optional)</h3><p>AWS access key id. This parameter is required when your agent is not running on EC2 instance with an IAM Role.</p><h3 id="endpoint-credentials-assume_role_arn">assume_role_arn (*secret.Secret, optional)</h3><p>Typically, you can use AssumeRole for cross-account access or federation.</p><h3 id="endpoint-credentials-assume_role_session_name">assume_role_session_name (*secret.Secret, optional)</h3><p>AssumeRoleWithWebIdentity <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html">https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html</a></p><h3 id="endpoint-credentials-assume_role_web_identity_token_file">assume_role_web_identity_token_file (*secret.Secret, optional)</h3><p>AssumeRoleWithWebIdentity <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html">https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html</a></p><h3 id="endpoint-credentials-ecs_container_credentials_relative_uri">ecs_container_credentials_relative_uri (*secret.Secret, optional)</h3><p>Set with AWS_CONTAINER_CREDENTIALS_RELATIVE_URI environment variable value</p><h3 id="endpoint-credentials-region">region (string, optional)</h3><p>AWS region. It should be in form like us-east-1, us-west-2. Default nil, which means try to find from environment variable AWS_REGION.</p><h3 id="endpoint-credentials-secret_access_key">secret_access_key (*secret.Secret, optional)</h3><p>AWS secret key. This parameter is required when your agent is not running on EC2 instance with an IAM Role.</p><h3 id="endpoint-credentials-sts_credentials_region">sts_credentials_region (*secret.Secret, optional)</h3><p>By default, the AWS Security Token Service (AWS STS) is available as a global service, and all AWS STS requests go to a single endpoint at <a href="https://sts.amazonaws.com">https://sts.amazonaws.com</a>. AWS recommends using Regional AWS STS endpoints instead of the global endpoint to reduce latency, build in redundancy, and increase session token validity. <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_enable-regions.html">https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_enable-regions.html</a></p><h3 id="endpoint-credentials-url">url (string, optional)</h3><p>AWS connection url.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-dec03311d9f65d4bec85b8a63c46e105">4.8.4.5 - Amazon Kinesis</h1><h1 id="kinesis-firehose-output-plugin-for-fluentd">Kinesis Firehose output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>For details, see <a href="https://github.com/awslabs/aws-fluent-plugin-kinesis#configuration-kinesis_firehose">https://github.com/awslabs/aws-fluent-plugin-kinesis#configuration-kinesis_firehose</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">kinesisFirehose</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">delivery_stream_name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-stream-name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">region</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">us-east-1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="kinesisfirehose">KinesisFirehose</h2><p>Send your logs to a Kinesis Firehose</p><h3 id="kinesisfirehose-aws_iam_retries">aws_iam_retries (int, optional)</h3><p>The number of attempts to make (with exponential backoff) when loading instance profile credentials from the EC2 metadata service using an IAM role. Defaults to 5 retries.</p><h3 id="kinesisfirehose-aws_key_id">aws_key_id (*secret.Secret, optional)</h3><p>AWS access key id. This parameter is required when your agent is not running on EC2 instance with an IAM Role.</p><h3 id="kinesisfirehose-aws_sec_key">aws_sec_key (*secret.Secret, optional)</h3><p>AWS secret key. This parameter is required when your agent is not running on EC2 instance with an IAM Role.</p><h3 id="kinesisfirehose-aws_ses_token">aws_ses_token (*secret.Secret, optional)</h3><p>AWS session token. This parameter is optional, but can be provided if using MFA or temporary credentials when your agent is not running on EC2 instance with an IAM Role.</p><h3 id="kinesisfirehose-append_new_line">append_new_line (*bool, optional)</h3><p>If it is enabled, the plugin adds new line character (\n) to each serialized record. Before appending \n, plugin calls chomp and removes separator from the end of each record as chomp_record is true. Therefore, you don&rsquo;t need to enable chomp_record option when you use kinesis_firehose output with default configuration (append_new_line is true). If you want to set append_new_line false, you can choose chomp_record false (default) or true (compatible format with plugin v2). (Default:true)</p><h3 id="kinesisfirehose-assume_role_credentials">assume_role_credentials (*KinesisFirehoseAssumeRoleCredentials, optional)</h3><p>Typically, you can use AssumeRole for cross-account access or federation.</p><h3 id="kinesisfirehose-batch_request_max_count">batch_request_max_count (int, optional)</h3><p>Integer, default 500. The number of max count of making batch request from record chunk. It can&rsquo;t exceed the default value because it&rsquo;s API limit.</p><h3 id="kinesisfirehose-batch_request_max_size">batch_request_max_size (int, optional)</h3><p>Integer. The number of max size of making batch request from record chunk. It can&rsquo;t exceed the default value because it&rsquo;s API limit.</p><h3 id="kinesisfirehose-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="kinesisfirehose-delivery_stream_name">delivery_stream_name (string, required)</h3><p>Name of the delivery stream to put data.</p><h3 id="kinesisfirehose-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="kinesisfirehose-process_credentials">process_credentials (*KinesisFirehoseProcessCredentials, optional)</h3><p>This loads AWS access credentials from an external process.</p><h3 id="kinesisfirehose-region">region (string, optional)</h3><p>AWS region of your stream. It should be in form like us-east-1, us-west-2. Default nil, which means try to find from environment variable AWS_REGION.</p><h3 id="kinesisfirehose-reset_backoff_if_success">reset_backoff_if_success (bool, optional)</h3><p>Boolean, default true. If enabled, when after retrying, the next retrying checks the number of succeeded records on the former batch request and reset exponential backoff if there is any success. Because batch request could be composed by requests across shards, simple exponential backoff for the batch request wouldn&rsquo;t work some cases.</p><h3 id="kinesisfirehose-retries_on_batch_request">retries_on_batch_request (int, optional)</h3><p>The plugin will put multiple records to Amazon Kinesis Data Streams in batches using PutRecords. A set of records in a batch may fail for reasons documented in the Kinesis Service API Reference for PutRecords. Failed records will be retried retries_on_batch_request times</p><h3 id="kinesisfirehose-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h2 id="assume-role-credentials">Assume Role Credentials</h2><p>assume_role_credentials</p><h3 id="assume-role-credentials-duration_seconds">duration_seconds (string, optional)</h3><p>The duration, in seconds, of the role session (900-3600)</p><h3 id="assume-role-credentials-external_id">external_id (string, optional)</h3><p>A unique identifier that is used by third parties when assuming roles in their customers&rsquo; accounts.</p><h3 id="assume-role-credentials-policy">policy (string, optional)</h3><p>An IAM policy in JSON format</p><h3 id="role_arn-string-required-assume-role-credentials-role_arn">role_arn (string, required) {#assume role credentials-role_arn}</h3><p>The Amazon Resource Name (ARN) of the role to assume</p><h3 id="assume-role-credentials-role_session_name">role_session_name (string, required)</h3><p>An identifier for the assumed role session</p><h2 id="process-credentials">Process Credentials</h2><p>process_credentials</p><h3 id="process-credentials-process">process (string, required)</h3><p>Command more info: <a href="https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/ProcessCredentials.html">https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/ProcessCredentials.html</a></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-0309d186051d45cea94e4ea4a3d95907">4.8.4.6 - Amazon Kinesis</h1><h1 id="kinesis-stream-output-plugin-for-fluentd">Kinesis Stream output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>For details, see <a href="https://github.com/awslabs/aws-fluent-plugin-kinesis#configuration-kinesis_streams">https://github.com/awslabs/aws-fluent-plugin-kinesis#configuration-kinesis_streams</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">kinesisStream</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">stream_name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-stream-name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">region</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">us-east-1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="kinesisstream">KinesisStream</h2><p>Send your logs to a Kinesis Stream</p><h3 id="kinesisstream-aws_iam_retries">aws_iam_retries (int, optional)</h3><p>The number of attempts to make (with exponential backoff) when loading instance profile credentials from the EC2 metadata service using an IAM role. Defaults to 5 retries.</p><h3 id="kinesisstream-aws_key_id">aws_key_id (*secret.Secret, optional)</h3><p>AWS access key id. This parameter is required when your agent is not running on EC2 instance with an IAM Role.</p><h3 id="kinesisstream-aws_sec_key">aws_sec_key (*secret.Secret, optional)</h3><p>AWS secret key. This parameter is required when your agent is not running on EC2 instance with an IAM Role.</p><h3 id="kinesisstream-aws_ses_token">aws_ses_token (*secret.Secret, optional)</h3><p>AWS session token. This parameter is optional, but can be provided if using MFA or temporary credentials when your agent is not running on EC2 instance with an IAM Role.</p><h3 id="kinesisstream-assume_role_credentials">assume_role_credentials (*KinesisStreamAssumeRoleCredentials, optional)</h3><p>Typically, you can use AssumeRole for cross-account access or federation.</p><h3 id="kinesisstream-batch_request_max_count">batch_request_max_count (int, optional)</h3><p>Integer, default 500. The number of max count of making batch request from record chunk. It can&rsquo;t exceed the default value because it&rsquo;s API limit.</p><h3 id="kinesisstream-batch_request_max_size">batch_request_max_size (int, optional)</h3><p>Integer. The number of max size of making batch request from record chunk. It can&rsquo;t exceed the default value because it&rsquo;s API limit.</p><h3 id="kinesisstream-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="kinesisstream-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="kinesisstream-partition_key">partition_key (string, optional)</h3><p>A key to extract partition key from JSON object. Default nil, which means partition key will be generated randomly.</p><h3 id="kinesisstream-process_credentials">process_credentials (*KinesisStreamProcessCredentials, optional)</h3><p>This loads AWS access credentials from an external process.</p><h3 id="kinesisstream-region">region (string, optional)</h3><p>AWS region of your stream. It should be in form like us-east-1, us-west-2. Default nil, which means try to find from environment variable AWS_REGION.</p><h3 id="kinesisstream-reset_backoff_if_success">reset_backoff_if_success (bool, optional)</h3><p>Boolean, default true. If enabled, when after retrying, the next retrying checks the number of succeeded records on the former batch request and reset exponential backoff if there is any success. Because batch request could be composed by requests across shards, simple exponential backoff for the batch request wouldn&rsquo;t work some cases.</p><h3 id="kinesisstream-retries_on_batch_request">retries_on_batch_request (int, optional)</h3><p>The plugin will put multiple records to Amazon Kinesis Data Streams in batches using PutRecords. A set of records in a batch may fail for reasons documented in the Kinesis Service API Reference for PutRecords. Failed records will be retried retries_on_batch_request times</p><h3 id="kinesisstream-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="kinesisstream-stream_name">stream_name (string, required)</h3><p>Name of the stream to put data.</p><h2 id="assume-role-credentials">Assume Role Credentials</h2><p>assume_role_credentials</p><h3 id="assume-role-credentials-duration_seconds">duration_seconds (string, optional)</h3><p>The duration, in seconds, of the role session (900-3600)</p><h3 id="assume-role-credentials-external_id">external_id (string, optional)</h3><p>A unique identifier that is used by third parties when assuming roles in their customers&rsquo; accounts.</p><h3 id="assume-role-credentials-policy">policy (string, optional)</h3><p>An IAM policy in JSON format</p><h3 id="assume-role-credentials-role_arn">role_arn (string, required)</h3><p>The Amazon Resource Name (ARN) of the role to assume</p><h3 id="assume-role-credentials-role_session_name">role_session_name (string, required)</h3><p>An identifier for the assumed role session</p><h2 id="process-credentials">Process Credentials</h2><p>process_credentials</p><h3 id="process-credentials-process">process (string, required)</h3><p>Command more info: <a href="https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/ProcessCredentials.html">https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/ProcessCredentials.html</a></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-f6b80b815b14c83b2fe835b820aa13d0">4.8.4.7 - Amazon S3</h1><h1 id="amazon-s3-plugin-for-fluentd">Amazon S3 plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>The <strong>s3</strong> output plugin buffers event logs in local file and upload it to S3 periodically. This plugin splits files exactly by using the time of event logs (not the time when the logs are received). For example, a log &lsquo;2011-01-02 message B&rsquo; is reached, and then another log &lsquo;2011-01-03 message B&rsquo; is reached in this order, the former one is stored in &ldquo;20110102.gz&rdquo; file, and latter one in &ldquo;20110103.gz&rdquo; file.</p><p>For a detailed example, see <a href="../../../../quickstarts/example-s3/">S3 Output Deployment</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">s3</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">aws_key_id</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-s3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">awsAccessKeyId</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">aws_sec_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-s3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">awsSecretAccessKey</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">s3_bucket</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-amazon-s3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">s3_region</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">eu-central-1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logs/${tag}/%Y/%m/%d/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">30s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_use_utc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="output-config-acl">acl (string, optional)</h3><p>Permission for the object in S3</p><h3 id="output-config-assume_role_credentials">assume_role_credentials (*S3AssumeRoleCredentials, optional)</h3><p><a href="#assume-role-credentials">Assume Role Credentials</a></p><h3 id="output-config-auto_create_bucket">auto_create_bucket (string, optional)</h3><p>Create S3 bucket if it does not exists</p><h3 id="aws_key_id-secretsecret-optional-output-config-aws_key_id">aws_key_id (*secret.Secret, optional) {#output config-aws_key_id}</h3><p>AWS access key id <a href="../secret/">Secret</a></p><h3 id="output-config-aws_iam_retries">aws_iam_retries (string, optional)</h3><p>The number of attempts to load instance profile credentials from the EC2 metadata service using IAM role</p><h3 id="output-config-aws_sec_key">aws_sec_key (*secret.Secret, optional)</h3><p>AWS secret key. <a href="../secret/">Secret</a></p><h3 id="output-config-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="output-config-check_apikey_on_start">check_apikey_on_start (string, optional)</h3><p>Check AWS key on start</p><h3 id="output-config-check_bucket">check_bucket (string, optional)</h3><p>Check bucket if exists or not</p><h3 id="output-config-check_object">check_object (string, optional)</h3><p>Check object before creation</p><h3 id="output-config-clustername">clustername (string, optional)</h3><p>Custom cluster name</p><p>Default: one-eye</p><h3 id="output-config-compress">compress (*Compress, optional)</h3><p>Parquet compressor</p><h3 id="output-config-compute_checksums">compute_checksums (string, optional)</h3><p>AWS SDK uses MD5 for API request/response by default</p><h3 id="output-config-enable_transfer_acceleration">enable_transfer_acceleration (string, optional)</h3><p>If true, S3 Transfer Acceleration will be enabled for uploads. IMPORTANT: You must first enable this feature on your destination S3 bucket</p><h3 id="output-config-force_path_style">force_path_style (string, optional)</h3><p>If true, the bucket name is always left in the request URI and never moved to the host as a sub-domain</p><h3 id="output-config-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="output-config-grant_full_control">grant_full_control (string, optional)</h3><p>Allows grantee READ, READ_ACP, and WRITE_ACP permissions on the object</p><h3 id="output-config-grant_read">grant_read (string, optional)</h3><p>Allows grantee to read the object data and its metadata</p><h3 id="output-config-grant_read_acp">grant_read_acp (string, optional)</h3><p>Allows grantee to read the object ACL</p><h3 id="output-config-grant_write_acp">grant_write_acp (string, optional)</h3><p>Allows grantee to write the ACL for the applicable object</p><h3 id="output-config-hex_random_length">hex_random_length (string, optional)</h3><p>The length of <code>%{hex_random}</code> placeholder(4-16)</p><h3 id="output-config-index_format">index_format (string, optional)</h3><p><code>sprintf</code> format for <code>%{index}</code></p><h3 id="output-config-instance_profile_credentials">instance_profile_credentials (*S3InstanceProfileCredentials, optional)</h3><p><a href="#instance-profile-credentials">Instance Profile Credentials</a></p><h3 id="output-config-oneeye_format">oneeye_format (bool, optional)</h3><p>One-eye format trigger</p><p>Default: false</p><h3 id="output-config-overwrite">overwrite (string, optional)</h3><p>Overwrite already existing path</p><h3 id="output-config-path">path (string, optional)</h3><p>Path prefix of the files on S3</p><h3 id="output-config-proxy_uri">proxy_uri (string, optional)</h3><p>URI of proxy environment</p><h3 id="output-config-s3_bucket">s3_bucket (string, required)</h3><p>S3 bucket name</p><h3 id="output-config-s3_endpoint">s3_endpoint (string, optional)</h3><p>Custom S3 endpoint (like minio)</p><h3 id="output-config-s3_metadata">s3_metadata (string, optional)</h3><p>Arbitrary S3 metadata headers to set for the object</p><h3 id="output-config-s3_object_key_format">s3_object_key_format (string, optional)</h3><p>The format of S3 object keys (default: <code>%{path}%{time_slice}_%{uuid_hash}_%{index}.%{file_extension}</code>)</p><p>Default: %{path}%{time_slice}<em>%{uuid_hash}</em>%{index}.%{file_extension}</p><h3 id="output-config-s3_region">s3_region (string, optional)</h3><p>S3 region name</p><h3 id="output-config-shared_credentials">shared_credentials (*S3SharedCredentials, optional)</h3><p><a href="#shared-credentials">Shared Credentials</a></p><h3 id="output-config-signature_version">signature_version (string, optional)</h3><p>Signature version for API Request (s3,v4)</p><h3 id="output-config-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="output-config-sse_customer_algorithm">sse_customer_algorithm (string, optional)</h3><p>Specifies the algorithm to use to when encrypting the object</p><h3 id="output-config-sse_customer_key">sse_customer_key (string, optional)</h3><p>Specifies the customer-provided encryption key for Amazon S3 to use in encrypting data</p><h3 id="output-config-sse_customer_key_md5">sse_customer_key_md5 (string, optional)</h3><p>Specifies the 128-bit MD5 digest of the encryption key according to RFC 1321</p><h3 id="ssekms_key_id-string-optional-output-config-ssekms_key_id">ssekms_key_id (string, optional) {#output config-ssekms_key_id}</h3><p>Specifies the AWS KMS key ID to use for object encryption</p><h3 id="ssl_verify_peer-string-optional-output-config-ssl_verify_peer">ssl_verify_peer (string, optional) {#output config-ssl_verify_peer}</h3><p>If false, the certificate of endpoint will not be verified</p><h3 id="output-config-storage_class">storage_class (string, optional)</h3><p>The type of storage to use for the object, for example STANDARD, REDUCED_REDUNDANCY, STANDARD_IA, ONEZONE_IA, INTELLIGENT_TIERING, GLACIER, DEEP_ARCHIVE, OUTPOSTS, GLACIER_IR For a complete list of possible values, see the <a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutObject.html#AmazonS3-PutObject-request-header-StorageClass">Amazon S3 API reference</a>.</p><h3 id="output-config-store_as">store_as (string, optional)</h3><p>Archive format on S3</p><h3 id="output-config-use_bundled_cert">use_bundled_cert (string, optional)</h3><p>Use aws-sdk-ruby bundled cert</p><h3 id="output-config-use_server_side_encryption">use_server_side_encryption (string, optional)</h3><p>The Server-side encryption algorithm used when storing this object in S3 (AES256, aws:kms)</p><h3 id="output-config-warn_for_delay">warn_for_delay (string, optional)</h3><p>Given a threshold to treat events as delay, output warning logs if delayed events were put into s3</p><h2 id="assume-role-credentials">Assume Role Credentials</h2><p>assume_role_credentials</p><h3 id="duration_seconds-string-optional-assume-role-credentials-duration_seconds">duration_seconds (string, optional) {#assume role-credentials-duration_seconds}</h3><p>The duration, in seconds, of the role session (900-3600)</p><h3 id="external_id-string-optional-assume-role-credentials-external_id">external_id (string, optional) {#assume role-credentials-external_id}</h3><p>A unique identifier that is used by third parties when assuming roles in their customers&rsquo; accounts.</p><h3 id="policy-string-optional-assume-role-credentials-policy">policy (string, optional) {#assume role-credentials-policy}</h3><p>An IAM policy in JSON format</p><h3 id="role_arn-string-required-assume-role-credentials-role_arn">role_arn (string, required) {#assume role-credentials-role_arn}</h3><p>The Amazon Resource Name (ARN) of the role to assume</p><h3 id="role_session_name-string-required-assume-role-credentials-role_session_name">role_session_name (string, required) {#assume role-credentials-role_session_name}</h3><p>An identifier for the assumed role session</p><h2 id="instance-profile-credentials">Instance Profile Credentials</h2><p>instance_profile_credentials</p><h3 id="http_open_timeout-string-optional-instance-profile-credentials-http_open_timeout">http_open_timeout (string, optional) {#instance profile-credentials-http_open_timeout}</h3><p>Number of seconds to wait for the connection to open</p><h3 id="http_read_timeout-string-optional-instance-profile-credentials-http_read_timeout">http_read_timeout (string, optional) {#instance profile-credentials-http_read_timeout}</h3><p>Number of seconds to wait for one block to be read</p><h3 id="ip_address-string-optional-instance-profile-credentials-ip_address">ip_address (string, optional) {#instance profile-credentials-ip_address}</h3><p>IP address</p><p>Default: 169.254.169.254</p><h3 id="port-string-optional-instance-profile-credentials-port">port (string, optional) {#instance profile-credentials-port}</h3><p>Port number</p><p>Default: 80</p><h3 id="retries-string-optional-instance-profile-credentials-retries">retries (string, optional) {#instance profile-credentials-retries}</h3><p>Number of times to retry when retrieving credentials</p><h2 id="shared-credentials">Shared Credentials</h2><p>shared_credentials</p><h3 id="shared-credentials-path">path (string, optional)</h3><p>Path to the shared file.</p><p>Default: $HOME/.aws/credentials</p><h3 id="shared-credentials-profile_name">profile_name (string, optional)</h3><p>Profile name. Default to &lsquo;default&rsquo; or ENV[&lsquo;AWS_PROFILE&rsquo;]</p><h2 id="parquet-compressor">Parquet compressor</h2><p>parquet compressor</p><h3 id="parquet-compressor-parquet_compression_codec">parquet_compression_codec (string, optional)</h3><p>Parquet compression codec. (uncompressed, snappy, gzip, lzo, brotli, lz4, zstd)</p><p>Default: snappy</p><h3 id="parquet-compressor-parquet_page_size">parquet_page_size (string, optional)</h3><p>Parquet file page size.</p><p>Default: 8192 bytes</p><h3 id="parquet-compressor-parquet_row_group_size">parquet_row_group_size (string, optional)</h3><p>Parquet file row group size.</p><p>Default: 128 MB</p><h3 id="parquet-compressor-record_type">record_type (string, optional)</h3><p>Record data format type. (avro csv jsonl msgpack tsv msgpack json)</p><p>Default: msgpack</p><h3 id="parquet-compressor-schema_file">schema_file (string, optional)</h3><p>Path to schema file.</p><h3 id="parquet-compressor-schema_type">schema_type (string, optional)</h3><p>Schema type. (avro, bigquery)</p><p>Default: avro</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-3fa3b93039c08434aba115eb9ab22b12">4.8.4.8 - Azure Storage</h1><h1 id="azure-storage-output-plugin-for-fluentd">Azure Storage output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>Azure Storage output plugin buffers logs in local file and upload them to Azure Storage periodically.
More info at <a href="https://github.com/microsoft/fluent-plugin-azure-storage-append-blob">https://github.com/microsoft/fluent-plugin-azure-storage-append-blob</a></p><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="output-config-auto_create_container">auto_create_container (bool, optional)</h3><p>Automatically create container if not exists</p><p>Default: true</p><h3 id="output-config-azure_cloud">azure_cloud (string, optional)</h3><p>Available in Logging operator version 4.5 and later. Azure Cloud to use, for example, AzurePublicCloud, AzureChinaCloud, AzureGermanCloud, AzureUSGovernmentCloud, AZURESTACKCLOUD (in uppercase). This field is supported only if the fluentd plugin honors it, for example, <a href="https://github.com/elsesiy/fluent-plugin-azure-storage-append-blob-lts">https://github.com/elsesiy/fluent-plugin-azure-storage-append-blob-lts</a></p><h3 id="output-config-azure_container">azure_container (string, required)</h3><p>Your azure storage container</p><h3 id="output-config-azure_imds_api_version">azure_imds_api_version (string, optional)</h3><p>Azure Instance Metadata Service API Version</p><h3 id="output-config-azure_object_key_format">azure_object_key_format (string, optional)</h3><p>Object key format</p><p>Default: %{path}%{time_slice}_%{index}.%{file_extension}</p><h3 id="output-config-azure_storage_access_key">azure_storage_access_key (*secret.Secret, optional)</h3><p>Your azure storage access key <a href="../secret/">Secret</a></p><h3 id="output-config-azure_storage_account">azure_storage_account (*secret.Secret, required)</h3><p>Your azure storage account <a href="../secret/">Secret</a></p><h3 id="output-config-azure_storage_sas_token">azure_storage_sas_token (*secret.Secret, optional)</h3><p>Your azure storage sas token <a href="../secret/">Secret</a></p><h3 id="output-config-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="output-config-format">format (string, optional)</h3><p>Compat format type: out_file, json, ltsv (default: out_file)</p><p>Default: json</p><h3 id="output-config-path">path (string, optional)</h3><p>Path prefix of the files on Azure</p><h3 id="output-config-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-67bcee478125d9574288135a71954591">4.8.4.9 - Buffer</h1><h2 id="buffer">Buffer</h2><h3 id="buffer-chunk_full_threshold">chunk_full_threshold (string, optional)</h3><p>The percentage of chunk size threshold for flushing. output plugin will flush the chunk when actual size reaches chunk_limit_size * chunk_full_threshold (== 8MB * 0.95 in default)</p><h3 id="buffer-chunk_limit_records">chunk_limit_records (int, optional)</h3><p>The max number of events that each chunks can store in it</p><h3 id="buffer-chunk_limit_size">chunk_limit_size (string, optional)</h3><p>The max size of each chunks: events will be written into chunks until the size of chunks become this size</p><p>Default: 8MB</p><h3 id="buffer-compress">compress (string, optional)</h3><p>If you set this option to gzip, you can get Fluentd to compress data records before writing to buffer chunks.</p><h3 id="buffer-delayed_commit_timeout">delayed_commit_timeout (string, optional)</h3><p>The timeout seconds until output plugin decides that async write operation fails</p><h3 id="buffer-disable_chunk_backup">disable_chunk_backup (bool, optional)</h3><p>Instead of storing unrecoverable chunks in the backup directory, just discard them. This option is new in Fluentd v1.2.6.</p><h3 id="buffer-disabled">disabled (bool, optional)</h3><p>Disable buffer section (default: false)</p><p>Default: false,hidden</p><h3 id="buffer-flush_at_shutdown">flush_at_shutdown (bool, optional)</h3><p>The value to specify to flush/write all buffer chunks at shutdown, or not</p><h3 id="buffer-flush_interval">flush_interval (string, optional)</h3><p>Default: 60s</p><h3 id="buffer-flush_mode">flush_mode (string, optional)</h3><p>Default: default (equals to lazy if time is specified as chunk key, interval otherwise) lazy: flush/write chunks once per timekey interval: flush/write chunks per specified time via flush_interval immediate: flush/write chunks immediately after events are appended into chunks</p><h3 id="buffer-flush_thread_burst_interval">flush_thread_burst_interval (string, optional)</h3><p>The sleep interval seconds of threads between flushes when output plugin flushes waiting chunks next to next</p><h3 id="buffer-flush_thread_count">flush_thread_count (int, optional)</h3><p>The number of threads of output plugins, which is used to write chunks in parallel</p><h3 id="buffer-flush_thread_interval">flush_thread_interval (string, optional)</h3><p>The sleep interval seconds of threads to wait next flush trial (when no chunks are waiting)</p><h3 id="buffer-overflow_action">overflow_action (string, optional)</h3><p>How output plugin behaves when its buffer queue is full throw_exception: raise exception to show this error in log block: block processing of input plugin to emit events into that buffer drop_oldest_chunk: drop/purge oldest chunk to accept newly incoming chunk</p><h3 id="buffer-path">path (string, optional)</h3><p>The path where buffer chunks are stored. The &lsquo;*&rsquo; is replaced with random characters. It&rsquo;s highly recommended to leave this default.</p><p>Default: operator generated</p><h3 id="buffer-queue_limit_length">queue_limit_length (int, optional)</h3><p>The queue length limitation of this buffer plugin instance</p><h3 id="buffer-queued_chunks_limit_size">queued_chunks_limit_size (int, optional)</h3><p>Limit the number of queued chunks. If you set smaller flush_interval, e.g. 1s, there are lots of small queued chunks in buffer. This is not good with file buffer because it consumes lots of fd resources when output destination has a problem. This parameter mitigates such situations.</p><h3 id="buffer-retry_exponential_backoff_base">retry_exponential_backoff_base (string, optional)</h3><p>The base number of exponential backoff for retries</p><h3 id="buffer-retry_forever">retry_forever (*bool, optional)</h3><p>If true, plugin will ignore retry_timeout and retry_max_times options and retry flushing forever</p><p>Default: true</p><h3 id="buffer-retry_max_interval">retry_max_interval (string, optional)</h3><p>The maximum interval seconds for exponential backoff between retries while failing</p><h3 id="buffer-retry_max_times">retry_max_times (int, optional)</h3><p>The maximum number of times to retry to flush while failing</p><h3 id="buffer-retry_randomize">retry_randomize (bool, optional)</h3><p>If true, output plugin will retry after randomized interval not to do burst retries</p><h3 id="buffer-retry_secondary_threshold">retry_secondary_threshold (string, optional)</h3><p>The ratio of retry_timeout to switch to use secondary while failing (Maximum valid value is 1.0)</p><h3 id="buffer-retry_timeout">retry_timeout (string, optional)</h3><p>The maximum seconds to retry to flush while failing, until plugin discards buffer chunks</p><h3 id="buffer-retry_type">retry_type (string, optional)</h3><p>exponential_backoff: wait seconds will become large exponentially per failures periodic: output plugin will retry periodically with fixed intervals (configured via retry_wait)</p><h3 id="buffer-retry_wait">retry_wait (string, optional)</h3><p>Seconds to wait before next retry to flush, or constant factor of exponential backoff</p><h3 id="buffer-tags">tags (*string, optional)</h3><p>When tag is specified as buffer chunk key, output plugin writes events into chunks separately per tags.</p><p>Default: tag,time</p><h3 id="buffer-timekey">timekey (string, required)</h3><p>Output plugin will flush chunks per specified time (enabled when time is specified in chunk keys)</p><p>Default: 10m</p><h3 id="buffer-timekey_use_utc">timekey_use_utc (bool, optional)</h3><p>Output plugin decides to use UTC or not to format placeholders using timekey</p><h3 id="buffer-timekey_wait">timekey_wait (string, optional)</h3><p>Output plugin writes chunks after timekey_wait seconds later after timekey expiration</p><p>Default: 1m</p><h3 id="buffer-timekey_zone">timekey_zone (string, optional)</h3><p>The timezone (-0700 or Asia/Tokyo) string for formatting timekey placeholders</p><h3 id="buffer-total_limit_size">total_limit_size (string, optional)</h3><p>The size limitation of this buffer plugin instance. Once the total size of stored buffer reached this threshold, all append operations will fail with error (and data will be lost)</p><h3 id="buffer-type">type (string, optional)</h3><p>Fluentd core bundles memory and file plugins. 3rd party plugins are also available when installed.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-cfa15a5d894da7ae0606dc5571b76531">4.8.4.10 - Datadog</h1><h1 id="datadog-output-plugin-for-fluentd">Datadog output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>It mainly contains a proper JSON formatter and a socket handler that streams logs directly to Datadog - so no need to use a log shipper if you don&rsquo;t want to.
For details, see <a href="https://github.com/DataDog/fluent-plugin-datadog">https://github.com/DataDog/fluent-plugin-datadog</a>.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">datadog</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">api_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&lt;YOUR_API_KEY&gt;&#39;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># For referencing a secret, see https://kube-logging.dev/docs/configuration/plugins/outputs/secret/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">dd_source</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&lt;INTEGRATION_NAME&gt;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">dd_tags</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&lt;KEY1:VALUE1&gt;,&lt;KEY2:VALUE2&gt;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">dd_sourcecategory</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;&lt;YOUR_SOURCE_CATEGORY&gt;&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="output-config-api_key">api_key (*secret.Secret, required)</h3><p>This parameter is required in order to authenticate your fluent agent.</p><p>Default: nil</p><h3 id="output-config-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="output-config-compression_level">compression_level (string, optional)</h3><p>Set the log compression level for HTTP (1 to 9, 9 being the best ratio)</p><p>Default: &ldquo;6&rdquo;</p><h3 id="output-config-dd_hostname">dd_hostname (string, optional)</h3><p>Used by Datadog to identify the host submitting the logs.</p><p>Default: &ldquo;hostname -f&rdquo;</p><h3 id="output-config-dd_source">dd_source (string, optional)</h3><p>This tells Datadog what integration it is</p><p>Default: nil</p><h3 id="output-config-dd_sourcecategory">dd_sourcecategory (string, optional)</h3><p>Multiple value attribute. Can be used to refine the source attribute</p><p>Default: nil</p><h3 id="output-config-dd_tags">dd_tags (string, optional)</h3><p>Custom tags with the following format &ldquo;key1:value1, key2:value2&rdquo;</p><p>Default: nil</p><h3 id="output-config-host">host (string, optional)</h3><p>Proxy endpoint when logs are not directly forwarded to Datadog</p><p>Default: &ldquo;http-intake.logs.datadoghq.com&rdquo;</p><h3 id="output-config-include_tag_key">include_tag_key (bool, optional)</h3><p>Automatically include the Fluentd tag in the record.</p><p>Default: false</p><h3 id="output-config-max_backoff">max_backoff (string, optional)</h3><p>The maximum time waited between each retry in seconds</p><p>Default: &ldquo;30&rdquo;</p><h3 id="output-config-max_retries">max_retries (string, optional)</h3><p>The number of retries before the output plugin stops. Set to -1 for unlimited retries</p><p>Default: &ldquo;-1&rdquo;</p><h3 id="output-config-no_ssl_validation">no_ssl_validation (bool, optional)</h3><p>Disable SSL validation (useful for proxy forwarding)</p><p>Default: false</p><h3 id="output-config-port">port (string, optional)</h3><p>Proxy port when logs are not directly forwarded to Datadog and ssl is not used</p><p>Default: &ldquo;80&rdquo;</p><h3 id="output-config-service">service (string, optional)</h3><p>Used by Datadog to correlate between logs, traces and metrics.</p><p>Default: nil</p><h3 id="output-config-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="output-config-ssl_port">ssl_port (string, optional)</h3><p>Port used to send logs over a SSL encrypted connection to Datadog. If use_http is disabled, use 10516 for the US region and 443 for the EU region.</p><p>Default: &ldquo;443&rdquo;</p><h3 id="output-config-tag_key">tag_key (string, optional)</h3><p>Where to store the Fluentd tag.</p><p>Default: &ldquo;tag&rdquo;</p><h3 id="output-config-timestamp_key">timestamp_key (string, optional)</h3><p>Name of the attribute which will contain timestamp of the log event. If nil, timestamp attribute is not added.</p><p>Default: &ldquo;@timestamp&rdquo;</p><h3 id="output-config-use_compression">use_compression (bool, optional)</h3><p>Enable log compression for HTTP</p><p>Default: true</p><h3 id="output-config-use_http">use_http (bool, optional)</h3><p>Enable HTTP forwarding. If you disable it, make sure to change the port to 10514 or ssl_port to 10516</p><p>Default: true</p><h3 id="output-config-use_json">use_json (bool, optional)</h3><p>Event format, if true, the event is sent in json format. Othwerwise, in plain text.</p><p>Default: true</p><h3 id="output-config-use_ssl">use_ssl (bool, optional)</h3><p>If true, the agent initializes a secure connection to Datadog. In clear TCP otherwise.</p><p>Default: true</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-d4855c4f7dc79bc11e74c046473de585">4.8.4.11 - Elasticsearch</h1><h1 id="elasticsearch-output-plugin-for-fluentd">Elasticsearch output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>For details, see <a href="https://github.com/uken/fluent-plugin-elasticsearch">https://github.com/uken/fluent-plugin-elasticsearch</a>.</p><p>Example Deployment: <a href="../../../../quickstarts/es-nginx/">Save all logs to Elasticsearch</a></p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">elasticsearch</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">elasticsearch-elasticsearch-cluster.default.svc.cluster.local</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">9200</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">scheme</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">ssl_verify</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">ssl_version</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">TLSv1_2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">30s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_use_utc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="elasticsearch">Elasticsearch</h2><p>Send your logs to Elasticsearch</p><h3 id="elasticsearch-api_key">api_key (*secret.Secret, optional)</h3><p>api_key parameter adds authentication header.</p><h3 id="elasticsearch-application_name">application_name (*string, optional)</h3><p>Specify the application name for the rollover index to be created.</p><p>Default: default</p><h3 id="elasticsearch-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="elasticsearch-bulk_message_request_threshold">bulk_message_request_threshold (string, optional)</h3><p>Configure bulk_message request splitting threshold size. Default value is 20MB. (20 * 1024 * 1024) If you specify this size as negative number, bulk_message request splitting feature will be disabled.</p><p>Default: 20MB</p><h3 id="elasticsearch-compression_level">compression_level (string, optional)</h3><p>Option for compressing the output data using gzip. Valid options: default_compression, best_compression, best_speed, no_compression.</p><p>Default: no_compression</p><h3 id="elasticsearch-content_type">content_type (string, optional)</h3><p>With content_type application/x-ndjson, elasticsearch plugin adds application/x-ndjson as Content-Profile in payload.</p><p>Default: application/json</p><h3 id="elasticsearch-custom_headers">custom_headers (string, optional)</h3><p>This parameter adds additional headers to request. Example: {&ldquo;token&rdquo;:&ldquo;secret&rdquo;}</p><p>Default: {}</p><h3 id="elasticsearch-customize_template">customize_template (string, optional)</h3><p>Specify the string and its value to be replaced in form of hash. Can contain multiple key value pair that would be replaced in the specified template_file. This setting only creates template and to add rollover index please check the rollover_index configuration.</p><h3 id="elasticsearch-data_stream_enable">data_stream_enable (*bool, optional)</h3><p>Use @type elasticsearch_data_stream</p><h3 id="elasticsearch-data_stream_ilm_name">data_stream_ilm_name (string, optional)</h3><p>Specify an existing ILM policy to be applied to the data stream. If not present, either the specified template&rsquo;s or a new ILM default policy is applied. Further details here <a href="https://github.com/uken/fluent-plugin-elasticsearch#configuration---elasticsearch-output-data-stream">https://github.com/uken/fluent-plugin-elasticsearch#configuration---elasticsearch-output-data-stream</a></p><p>Default: data_stream_name</p><h3 id="elasticsearch-data_stream_ilm_policy">data_stream_ilm_policy (string, optional)</h3><p>Specify data stream ILM policy contents as Hash.</p><h3 id="elasticsearch-data_stream_ilm_policy_overwrite">data_stream_ilm_policy_overwrite (bool, optional)</h3><p>Specify whether overwriting data stream ilm policy or not.</p><h3 id="elasticsearch-data_stream_name">data_stream_name (string, optional)</h3><p>You can specify Elasticsearch data stream name by this parameter. This parameter is mandatory for elasticsearch_data_stream. There are some limitations about naming rule. For more details <a href="https://www.elastic.co/guide/en/elasticsearch/reference/master/indices-create-data-stream.html#indices-create-data-stream-api-path-params">https://www.elastic.co/guide/en/elasticsearch/reference/master/indices-create-data-stream.html#indices-create-data-stream-api-path-params</a></p><h3 id="elasticsearch-data_stream_template_name">data_stream_template_name (string, optional)</h3><p>Specify an existing index template for the data stream. If not present, a new template is created and named after the data stream. Further details here <a href="https://github.com/uken/fluent-plugin-elasticsearch#configuration---elasticsearch-output-data-stream">https://github.com/uken/fluent-plugin-elasticsearch#configuration---elasticsearch-output-data-stream</a></p><p>Default: data_stream_name</p><h3 id="elasticsearch-default_elasticsearch_version">default_elasticsearch_version (string, optional)</h3><p>This parameter changes that ES plugin assumes default Elasticsearch version.</p><p>Default: 5</p><h3 id="elasticsearch-deflector_alias">deflector_alias (string, optional)</h3><p>Specify the deflector alias which would be assigned to the rollover index created. This is useful in case of using the Elasticsearch rollover API</p><h3 id="elasticsearch-enable_ilm">enable_ilm (bool, optional)</h3><p>Enable Index Lifecycle Management (ILM).</p><h3 id="elasticsearch-exception_backup">exception_backup (*bool, optional)</h3><p>Indicates whether to backup chunk when ignore exception occurs. (default: true)</p><p>Default: true</p><h3 id="elasticsearch-fail_on_detecting_es_version_retry_exceed">fail_on_detecting_es_version_retry_exceed (*bool, optional)</h3><p>fail_on_detecting_es_version_retry_exceed (default: true)</p><p>Default: true</p><h3 id="elasticsearch-fail_on_putting_template_retry_exceed">fail_on_putting_template_retry_exceed (*bool, optional)</h3><p>Indicates whether to fail when max_retry_putting_template is exceeded. If you have multiple output plugin, you could use this property to do not fail on fluentd statup.(default: true)</p><p>Default: true</p><h3 id="elasticsearch-flatten_hashes">flatten_hashes (bool, optional)</h3><p>Elasticsearch will complain if you send object and concrete values to the same field. For example, you might have logs that look this, from different places: {&ldquo;people&rdquo; => 100} {&ldquo;people&rdquo; => {&ldquo;some&rdquo; => &ldquo;thing&rdquo;}} The second log line will be rejected by the Elasticsearch parser because objects and concrete values can&rsquo;t live in the same field. To combat this, you can enable hash flattening.</p><h3 id="elasticsearch-flatten_hashes_separator">flatten_hashes_separator (string, optional)</h3><p>Flatten separator</p><h3 id="elasticsearch-host">host (string, optional)</h3><p>You can specify the Elasticsearch host using this parameter.</p><p>Default: localhost</p><h3 id="elasticsearch-hosts">hosts (string, optional)</h3><p>You can specify multiple Elasticsearch hosts with separator &ldquo;,&rdquo;. If you specify the <code>hosts</code> option, the <code>host</code> and <code>port</code> options are ignored.</p><h3 id="elasticsearch-http_backend">http_backend (string, optional)</h3><p>With http_backend typhoeus, elasticsearch plugin uses typhoeus faraday http backend. Typhoeus can handle HTTP keepalive.</p><p>Default: excon</p><h3 id="elasticsearch-id_key">id_key (string, optional)</h3><p><a href="https://github.com/uken/fluent-plugin-elasticsearch#id_key">https://github.com/uken/fluent-plugin-elasticsearch#id_key</a></p><h3 id="elasticsearch-ignore_exceptions">ignore_exceptions (string, optional)</h3><p>A list of exception that will be ignored - when the exception occurs the chunk will be discarded and the buffer retry mechanism won&rsquo;t be called. It is possible also to specify classes at higher level in the hierarchy. For example <code>ignore_exceptions ["Elasticsearch::Transport::Transport::ServerError"]</code> will match all subclasses of ServerError - Elasticsearch::Transport::Transport::Errors::BadRequest, Elasticsearch::Transport::Transport::Errors::ServiceUnavailable, etc.</p><h3 id="elasticsearch-ilm_policy">ilm_policy (string, optional)</h3><p>Specify ILM policy contents as Hash.</p><h3 id="elasticsearch-ilm_policy_id">ilm_policy_id (string, optional)</h3><p>Specify ILM policy id.</p><h3 id="elasticsearch-ilm_policy_overwrite">ilm_policy_overwrite (bool, optional)</h3><p>Specify whether overwriting ilm policy or not.</p><h3 id="elasticsearch-include_index_in_url">include_index_in_url (bool, optional)</h3><p>With this option set to true, Fluentd manifests the index name in the request URL (rather than in the request body). You can use this option to enforce an URL-based access control.</p><h3 id="elasticsearch-include_tag_key">include_tag_key (bool, optional)</h3><p>This will add the Fluentd tag in the JSON record.</p><p>Default: false</p><h3 id="elasticsearch-include_timestamp">include_timestamp (bool, optional)</h3><p>Adds a @timestamp field to the log, following all settings logstash_format does, except without the restrictions on index_name. This allows one to log to an alias in Elasticsearch and utilize the rollover API.</p><p>Default: false</p><h3 id="elasticsearch-index_date_pattern">index_date_pattern (*string, optional)</h3><p>Specify this to override the index date pattern for creating a rollover index.</p><p>Default: now/d</p><h3 id="elasticsearch-index_name">index_name (string, optional)</h3><p>The index name to write events to</p><p>Default: fluentd</p><h3 id="elasticsearch-index_prefix">index_prefix (string, optional)</h3><p>Specify the index prefix for the rollover index to be created.</p><p>Default: logstash</p><h3 id="elasticsearch-log_es_400_reason">log_es_400_reason (bool, optional)</h3><p>By default, the error logger won&rsquo;t record the reason for a 400 error from the Elasticsearch API unless you set log_level to debug. However, this results in a lot of log spam, which isn&rsquo;t desirable if all you want is the 400 error reasons. You can set this true to capture the 400 error reasons without all the other debug logs.</p><p>Default: false</p><h3 id="elasticsearch-logstash_dateformat">logstash_dateformat (string, optional)</h3><p>Set the Logstash date format.</p><p>Default: %Y.%m.%d</p><h3 id="elasticsearch-logstash_format">logstash_format (bool, optional)</h3><p>Enable Logstash log format.</p><p>Default: false</p><h3 id="elasticsearch-logstash_prefix">logstash_prefix (string, optional)</h3><p>Set the Logstash prefix.</p><p>Default: logstash</p><h3 id="elasticsearch-logstash_prefix_separator">logstash_prefix_separator (string, optional)</h3><p>Set the Logstash prefix separator.</p><p>Default: -</p><h3 id="elasticsearch-max_retry_get_es_version">max_retry_get_es_version (string, optional)</h3><p>You can specify the number of times to retry fetching the Elasticsearch version.</p><p>Default: 15</p><h3 id="elasticsearch-max_retry_putting_template">max_retry_putting_template (string, optional)</h3><p>You can specify times of retry putting template.</p><p>Default: 10</p><h3 id="elasticsearch-password">password (*secret.Secret, optional)</h3><p>Password for HTTP Basic authentication. <a href="../secret/">Secret</a></p><h3 id="elasticsearch-path">path (string, optional)</h3><p>Path for HTTP Basic authentication.</p><h3 id="elasticsearch-pipeline">pipeline (string, optional)</h3><p>This param is to set a pipeline id of your elasticsearch to be added into the request, you can configure ingest node.</p><h3 id="elasticsearch-port">port (int, optional)</h3><p>You can specify the Elasticsearch port using this parameter.</p><p>Default: 9200</p><h3 id="elasticsearch-prefer_oj_serializer">prefer_oj_serializer (bool, optional)</h3><p>With default behavior, Elasticsearch client uses Yajl as JSON encoder/decoder. Oj is the alternative high performance JSON encoder/decoder. When this parameter sets as true, Elasticsearch client uses Oj as JSON encoder/decoder.</p><p>Default: false</p><h3 id="elasticsearch-reconnect_on_error">reconnect_on_error (bool, optional)</h3><p>Indicates that the plugin should reset connection on any error (reconnect on next send). By default it will reconnect only on &ldquo;host unreachable exceptions&rdquo;. We recommended to set this true in the presence of elasticsearch shield.</p><p>Default: false</p><h3 id="elasticsearch-reload_after">reload_after (string, optional)</h3><p>When <code>reload_connections</code> is true, this is the integer number of operations after which the plugin will reload the connections. The default value is 10000.</p><h3 id="elasticsearch-reload_connections">reload_connections (*bool, optional)</h3><p>You can tune how the elasticsearch-transport host reloading feature works.(default: true)</p><p>Default: true</p><h3 id="elasticsearch-reload_on_failure">reload_on_failure (bool, optional)</h3><p>Indicates that the elasticsearch-transport will try to reload the nodes addresses if there is a failure while making the request. This can be useful to quickly remove a dead node from the list of addresses.</p><p>Default: false</p><h3 id="elasticsearch-remove_keys">remove_keys (string, optional)</h3><p><a href="https://github.com/uken/fluent-plugin-elasticsearch#remove_keys">https://github.com/uken/fluent-plugin-elasticsearch#remove_keys</a></p><h3 id="elasticsearch-remove_keys_on_update">remove_keys_on_update (string, optional)</h3><p>Remove keys on update will not update the configured keys in elasticsearch when a record is being updated. This setting only has any effect if the write operation is update or upsert.</p><h3 id="elasticsearch-remove_keys_on_update_key">remove_keys_on_update_key (string, optional)</h3><p>This setting allows remove_keys_on_update to be configured with a key in each record, in much the same way as target_index_key works.</p><h3 id="elasticsearch-request_timeout">request_timeout (string, optional)</h3><p>You can specify HTTP request timeout.</p><p>Default: 5s</p><h3 id="elasticsearch-resurrect_after">resurrect_after (string, optional)</h3><p>You can set in the elasticsearch-transport how often dead connections from the elasticsearch-transport&rsquo;s pool will be resurrected.</p><p>Default: 60s</p><h3 id="elasticsearch-retry_tag">retry_tag (string, optional)</h3><p>This setting allows custom routing of messages in response to bulk request failures. The default behavior is to emit failed records using the same tag that was provided.</p><h3 id="elasticsearch-rollover_index">rollover_index (bool, optional)</h3><p>Specify this as true when an index with rollover capability needs to be created. <a href="https://github.com/uken/fluent-plugin-elasticsearch#rollover_index">https://github.com/uken/fluent-plugin-elasticsearch#rollover_index</a></p><p>Default: false</p><h3 id="elasticsearch-routing_key">routing_key (string, optional)</h3><p>Similar to parent_key config, will add _routing into elasticsearch command if routing_key is set and the field does exist in input event.</p><h3 id="elasticsearch-ca_file">ca_file (*secret.Secret, optional)</h3><p>CA certificate</p><h3 id="elasticsearch-client_cert">client_cert (*secret.Secret, optional)</h3><p>Client certificate</p><h3 id="elasticsearch-client_key">client_key (*secret.Secret, optional)</h3><p>Client certificate key</p><h3 id="elasticsearch-client_key_pass">client_key_pass (*secret.Secret, optional)</h3><p>Client key password</p><h3 id="elasticsearch-scheme">scheme (string, optional)</h3><p>Connection scheme</p><p>Default: http</p><h3 id="elasticsearch-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="elasticsearch-sniffer_class_name">sniffer_class_name (string, optional)</h3><p>The default Sniffer used by the Elasticsearch::Transport class works well when Fluentd has a direct connection to all of the Elasticsearch servers and can make effective use of the _nodes API. This doesn&rsquo;t work well when Fluentd must connect through a load balancer or proxy. The parameter sniffer_class_name gives you the ability to provide your own Sniffer class to implement whatever connection reload logic you require. In addition, there is a new Fluent::Plugin::ElasticsearchSimpleSniffer class which reuses the hosts given in the configuration, which is typically the hostname of the load balancer or proxy. <a href="https://github.com/uken/fluent-plugin-elasticsearch#sniffer-class-name">https://github.com/uken/fluent-plugin-elasticsearch#sniffer-class-name</a></p><h3 id="elasticsearch-ssl_max_version">ssl_max_version (string, optional)</h3><p>Specify min/max SSL/TLS version</p><h3 id="elasticsearch-ssl_min_version">ssl_min_version (string, optional)</h3><h3 id="elasticsearch-ssl_verify">ssl_verify (*bool, optional)</h3><p>Skip ssl verification (default: true)</p><p>Default: true</p><h3 id="elasticsearch-ssl_version">ssl_version (string, optional)</h3><p>If you want to configure SSL/TLS version, you can specify ssl_version parameter. [SSLv23, TLSv1, TLSv1_1, TLSv1_2]</p><h3 id="elasticsearch-suppress_doc_wrap">suppress_doc_wrap (bool, optional)</h3><p>By default, record body is wrapped by &lsquo;doc&rsquo;. This behavior can not handle update script requests. You can set this to suppress doc wrapping and allow record body to be untouched.</p><p>Default: false</p><h3 id="elasticsearch-suppress_type_name">suppress_type_name (*bool, optional)</h3><p>Suppress type name to avoid warnings in Elasticsearch 7.x</p><h3 id="elasticsearch-tag_key">tag_key (string, optional)</h3><p>This will add the Fluentd tag in the JSON record.</p><p>Default: tag</p><h3 id="elasticsearch-target_index_key">target_index_key (string, optional)</h3><p>Tell this plugin to find the index name to write to in the record under this key in preference to other mechanisms. Key can be specified as path to nested record using dot (&rsquo;.&rsquo;) as a separator. <a href="https://github.com/uken/fluent-plugin-elasticsearch#target_index_key">https://github.com/uken/fluent-plugin-elasticsearch#target_index_key</a></p><h3 id="elasticsearch-target_type_key">target_type_key (string, optional)</h3><p>Similar to target_index_key config, find the type name to write to in the record under this key (or nested record). If key not found in record - fallback to type_name.</p><p>Default: fluentd</p><h3 id="elasticsearch-template_file">template_file (*secret.Secret, optional)</h3><p>The path to the file containing the template to install. <a href="../secret/">Secret</a></p><h3 id="elasticsearch-template_name">template_name (string, optional)</h3><p>The name of the template to define. If a template by the name given is already present, it will be left unchanged, unless template_overwrite is set, in which case the template will be updated.</p><h3 id="elasticsearch-template_overwrite">template_overwrite (bool, optional)</h3><p>Always update the template, even if it already exists.</p><p>Default: false</p><h3 id="elasticsearch-templates">templates (string, optional)</h3><p>Specify index templates in form of hash. Can contain multiple templates.</p><h3 id="elasticsearch-time_key">time_key (string, optional)</h3><p>By default, when inserting records in Logstash format, @timestamp is dynamically created with the time at log ingestion. If you&rsquo;d like to use a custom time, include an @timestamp with your record.</p><h3 id="elasticsearch-time_key_format">time_key_format (string, optional)</h3><p>The format of the time stamp field (@timestamp or what you specify with time_key). This parameter only has an effect when logstash_format is true as it only affects the name of the index we write to.</p><h3 id="elasticsearch-time_parse_error_tag">time_parse_error_tag (string, optional)</h3><p>With logstash_format true, elasticsearch plugin parses timestamp field for generating index name. If the record has invalid timestamp value, this plugin emits an error event to @ERROR label with time_parse_error_tag configured tag.</p><h3 id="elasticsearch-time_precision">time_precision (string, optional)</h3><p>Should the record not include a time_key, define the degree of sub-second time precision to preserve from the time portion of the routed event.</p><h3 id="elasticsearch-type_name">type_name (string, optional)</h3><p>Set the index type for elasticsearch. This is the fallback if <code>target_type_key</code> is missing.</p><p>Default: fluentd</p><h3 id="elasticsearch-unrecoverable_error_types">unrecoverable_error_types (string, optional)</h3><p>Default unrecoverable_error_types parameter is set up strictly. Because es_rejected_execution_exception is caused by exceeding Elasticsearch&rsquo;s thread pool capacity. Advanced users can increase its capacity, but normal users should follow default behavior. If you want to increase it and forcibly retrying bulk request, please consider to change unrecoverable_error_types parameter from default value. Change default value of thread_pool.bulk.queue_size in elasticsearch.yml)</p><h3 id="elasticsearch-use_legacy_template">use_legacy_template (*bool, optional)</h3><p>If set to true, the output uses the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.13/indices-templates-v1.html">legacy index template format</a>. Otherwise, it uses the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.13/index-templates.html">composable index template</a> format.</p><p>Default: true</p><h3 id="elasticsearch-user">user (string, optional)</h3><p>User for HTTP Basic authentication. This plugin will escape required URL encoded characters within <code>%{}</code> placeholders, for example, <code>%{demo+}</code></p><h3 id="elasticsearch-utc_index">utc_index (*bool, optional)</h3><p>By default, the records inserted into index logstash-YYMMDD with UTC (Coordinated Universal Time). This option allows to use local time if you describe utc_index to false.(default: true)</p><p>Default: true</p><h3 id="elasticsearch-validate_client_version">validate_client_version (bool, optional)</h3><p>When you use mismatched Elasticsearch server and client libraries, fluent-plugin-elasticsearch cannot send data into Elasticsearch.</p><p>Default: false</p><h3 id="elasticsearch-verify_es_version_at_startup">verify_es_version_at_startup (*bool, optional)</h3><p>Because Elasticsearch plugin should change behavior each of Elasticsearch major versions. For example, Elasticsearch 6 starts to prohibit multiple type_names in one index, and Elasticsearch 7 will handle only _doc type_name in index. If you want to disable to verify Elasticsearch version at start up, set it as false. When using the following configuration, ES plugin intends to communicate into Elasticsearch 6. (default: true)</p><p>Default: true</p><h3 id="elasticsearch-with_transporter_log">with_transporter_log (bool, optional)</h3><p>This is debugging purpose option to enable to obtain transporter layer log.</p><p>Default: false</p><h3 id="elasticsearch-write_operation">write_operation (string, optional)</h3><p>The write_operation can be any of: (index,create,update,upsert)</p><p>Default: index</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-11b10c2ba394f448a129e3e87a7da45d">4.8.4.12 - File</h1><h1 id="file-outputhttpsdocsfluentdorgoutputfile"><a href="https://docs.fluentd.org/output/file">File Output</a></h1><h2 id="overview">Overview</h2><p>This plugin has been designed to output logs or metrics to File.</p><h2 id="configuration">Configuration</h2><h2 id="fileoutputconfig">FileOutputConfig</h2><h3 id="fileoutputconfig-add_path_suffix">add_path_suffix (*bool, optional)</h3><p>Add path suffix(default: true)</p><p>Default: true</p><h3 id="fileoutputconfig-append">append (bool, optional)</h3><p>The flushed chunk is appended to existence file or not. The default is not appended.</p><h3 id="fileoutputconfig-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="fileoutputconfig-compress">compress (string, optional)</h3><p>Compresses flushed files using gzip. No compression is performed by default.</p><h3 id="fileoutputconfig-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="fileoutputconfig-path">path (string, required)</h3><p>The Path of the file. The actual path is path + time + &ldquo;.log&rdquo; by default.</p><h3 id="fileoutputconfig-path_suffix">path_suffix (string, optional)</h3><p>The suffix of output result.</p><p>Default: &ldquo;.log&rdquo;</p><h3 id="fileoutputconfig-recompress">recompress (bool, optional)</h3><p>Performs compression again even if the buffer chunk is already compressed.</p><p>Default: false</p><h3 id="fileoutputconfig-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="fileoutputconfig-symlink_path">symlink_path (bool, optional)</h3><p>Create symlink to temporary buffered file when buffer_type is file. This is useful for tailing file content to check logs.</p><p>Default: false</p><h2 id="example-file-output-configurations">Example <code>File</code> output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/tmp/logs/${tag}/%Y/%m/%d.%H.%M</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">append</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_use_utc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;match</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>	@type file
</span></span><span style="display:flex"><span>	@id test_file
</span></span><span style="display:flex"><span>	add_path_suffix true
</span></span><span style="display:flex"><span>	append true
</span></span><span style="display:flex"><span>	path /tmp/logs/${tag}/%Y/%m/%d.%H.%M
</span></span><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">&lt;buffer</span> <span style="color:#a40000">tag,time</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>	  @type file
</span></span><span style="display:flex"><span>	  path /buffers/test_file.*.buffer
</span></span><span style="display:flex"><span>	  retry_forever true
</span></span><span style="display:flex"><span>	  timekey 1m
</span></span><span style="display:flex"><span>	  timekey_use_utc true
</span></span><span style="display:flex"><span>	  timekey_wait 30s
</span></span><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">&lt;/buffer&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/match&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-ebcbedef5be28c9f30752486b0b2b01b">4.8.4.13 - Format</h1><h1 id="format-output-records">Format output records</h1><h2 id="overview">Overview</h2><p>Specify how to format output records. For details, see <a href="https://docs.fluentd.org/configuration/format-section">https://docs.fluentd.org/configuration/format-section</a>.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/tmp/logs/${tag}/%Y/%m/%d.%H.%M</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">single_value</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">add_newline</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">message_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">msg</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="format">Format</h2><h3 id="format-add_newline">add_newline (*bool, optional)</h3><p>When type is single_value add &lsquo;\n&rsquo; to the end of the message</p><p>Default: true</p><h3 id="format-message_key">message_key (string, optional)</h3><p>When type is single_value specify the key holding information</p><h3 id="format-type">type (string, optional)</h3><p>Output line formatting: out_file,json,ltsv,csv,msgpack,hash,single_value</p><p>Default: json</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-88fc6991b80563054a472b95a994e01b">4.8.4.14 - Format rfc5424</h1><h2 id="formatrfc5424">FormatRfc5424</h2><h3 id="formatrfc5424-app_name_field">app_name_field (string, optional)</h3><p>Sets app name in syslog from field in fluentd, delimited by &lsquo;.&rsquo;</p><p>Default: app_name</p><h3 id="formatrfc5424-hostname_field">hostname_field (string, optional)</h3><p>Sets host name in syslog from field in fluentd, delimited by &lsquo;.&rsquo;</p><p>Default: hostname</p><h3 id="formatrfc5424-log_field">log_field (string, optional)</h3><p>Sets log in syslog from field in fluentd, delimited by &lsquo;.&rsquo;</p><p>Default: log</p><h3 id="formatrfc5424-message_id_field">message_id_field (string, optional)</h3><p>Sets msg id in syslog from field in fluentd, delimited by &lsquo;.&rsquo;</p><p>Default: message_id</p><h3 id="formatrfc5424-proc_id_field">proc_id_field (string, optional)</h3><p>Sets proc id in syslog from field in fluentd, delimited by &lsquo;.&rsquo;</p><p>Default: proc_id</p><h3 id="formatrfc5424-rfc6587_message_size">rfc6587_message_size (*bool, optional)</h3><p>Prepends message length for syslog transmission</p><p>Default: true</p><h3 id="formatrfc5424-structured_data_field">structured_data_field (string, optional)</h3><p>Sets structured data in syslog from field in fluentd, delimited by &lsquo;.&rsquo; (default structured_data)</p><h3 id="formatrfc5424-type">type (string, optional)</h3><p>Output line formatting: out_file,json,ltsv,csv,msgpack,hash,single_value</p><p>Default: json</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-ed0a10704a55da5f7330009ec393e387">4.8.4.15 - Forward</h1><h2 id="forwardoutput">ForwardOutput</h2><h3 id="forwardoutput-ack_response_timeout">ack_response_timeout (int, optional)</h3><p>This option is used when require_ack_response is true. This default value is based on popular tcp_syn_retries.</p><p>Default: 190</p><h3 id="forwardoutput-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="forwardoutput-connect_timeout">connect_timeout (int, optional)</h3><p>The timeout time for socket connect. When the connection timed out during establishment, Errno::ETIMEDOUT is raised.</p><h3 id="forwardoutput-dns_round_robin">dns_round_robin (bool, optional)</h3><p>Enable client-side DNS round robin. Uniform randomly pick an IP address to send data when a hostname has several IP addresses. <code>heartbeat_type udp</code> is not available with <code>dns_round_robin true</code>. Use <code>heartbeat_type tcp</code> or <code>heartbeat_type none</code>.</p><h3 id="forwardoutput-expire_dns_cache">expire_dns_cache (int, optional)</h3><p>Set TTL to expire DNS cache in seconds. Set 0 not to use DNS Cache.</p><p>Default: 0</p><h3 id="forwardoutput-hard_timeout">hard_timeout (int, optional)</h3><p>The hard timeout used to detect server failure. The default value is equal to the send_timeout parameter.</p><p>Default: 60</p><h3 id="forwardoutput-heartbeat_interval">heartbeat_interval (int, optional)</h3><p>The interval of the heartbeat packer.</p><p>Default: 1</p><h3 id="forwardoutput-heartbeat_type">heartbeat_type (string, optional)</h3><p>The transport protocol to use for heartbeats. Set &ldquo;none&rdquo; to disable heartbeat. [transport, tcp, udp, none]</p><h3 id="forwardoutput-ignore_network_errors_at_startup">ignore_network_errors_at_startup (bool, optional)</h3><p>Ignore DNS resolution and errors at startup time.</p><h3 id="forwardoutput-keepalive">keepalive (bool, optional)</h3><p>Enable keepalive connection.</p><p>Default: false</p><h3 id="forwardoutput-keepalive_timeout">keepalive_timeout (int, optional)</h3><p>Expired time of keepalive. Default value is nil, which means to keep connection as long as possible.</p><p>Default: 0</p><h3 id="forwardoutput-phi_failure_detector">phi_failure_detector (bool, optional)</h3><p>Use the &ldquo;Phi accrual failure detector&rdquo; to detect server failure.</p><p>Default: true</p><h3 id="forwardoutput-phi_threshold">phi_threshold (int, optional)</h3><p>The threshold parameter used to detect server faults. <code>phi_threshold</code> is deeply related to <code>heartbeat_interval</code>. If you are using longer <code>heartbeat_interval</code>, please use the larger <code>phi_threshold</code>. Otherwise you will see frequent detachments of destination servers. The default value 16 is tuned for <code>heartbeat_interval</code> 1s.</p><p>Default: 16</p><h3 id="forwardoutput-recover_wait">recover_wait (int, optional)</h3><p>The wait time before accepting a server fault recovery.</p><p>Default: 10</p><h3 id="forwardoutput-require_ack_response">require_ack_response (bool, optional)</h3><p>Change the protocol to at-least-once. The plugin waits the ack from destination&rsquo;s in_forward plugin.</p><h3 id="forwardoutput-security">security (*common.Security, optional)</h3><p><a href="../../common/security/">Security</a></p><h3 id="forwardoutput-send_timeout">send_timeout (int, optional)</h3><p>The timeout time when sending event logs.</p><p>Default: 60</p><h3 id="forwardoutput-servers">servers ([]FluentdServer, required)</h3><p>Server definitions at least one is required <a href="#fluentd-server">Server</a></p><h3 id="forwardoutput-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="forwardoutput-time_as_integer">time_as_integer (bool, optional)</h3><p>Format forwarded events time as an epoch Integer with second resolution. Useful when forwarding to old ( &lt;= 0.12 ) Fluentd servers.</p><h3 id="forwardoutput-tls_allow_self_signed_cert">tls_allow_self_signed_cert (bool, optional)</h3><p>Allow self signed certificates or not.</p><p>Default: false</p><h3 id="forwardoutput-tls_cert_logical_store_name">tls_cert_logical_store_name (string, optional)</h3><p>The certificate logical store name on Windows system certstore. This parameter is for Windows only.</p><h3 id="forwardoutput-tls_cert_path">tls_cert_path (*secret.Secret, optional)</h3><p>The additional CA certificate path for TLS.</p><h3 id="forwardoutput-tls_cert_thumbprint">tls_cert_thumbprint (string, optional)</h3><p>The certificate thumbprint for searching from Windows system certstore This parameter is for Windows only.</p><h3 id="forwardoutput-tls_cert_use_enterprise_store">tls_cert_use_enterprise_store (bool, optional)</h3><p>Enable to use certificate enterprise store on Windows system certstore. This parameter is for Windows only.</p><h3 id="forwardoutput-tls_ciphers">tls_ciphers (string, optional)</h3><p>The cipher configuration of TLS transport.</p><p>Default: ALL:!aNULL:!eNULL:!SSLv2</p><h3 id="forwardoutput-tls_client_cert_path">tls_client_cert_path (*secret.Secret, optional)</h3><p>The client certificate path for TLS</p><h3 id="forwardoutput-tls_client_private_key_passphrase">tls_client_private_key_passphrase (*secret.Secret, optional)</h3><p>The client private key passphrase for TLS.</p><h3 id="forwardoutput-tls_client_private_key_path">tls_client_private_key_path (*secret.Secret, optional)</h3><p>The client private key path for TLS.</p><h3 id="forwardoutput-tls_insecure_mode">tls_insecure_mode (bool, optional)</h3><p>Skip all verification of certificates or not.</p><p>Default: false</p><h3 id="forwardoutput-tls_verify_hostname">tls_verify_hostname (bool, optional)</h3><p>Verify hostname of servers and certificates or not in TLS transport.</p><p>Default: true</p><h3 id="forwardoutput-tls_version">tls_version (string, optional)</h3><p>The default version of TLS transport. [TLSv1_1, TLSv1_2]</p><p>Default: TLSv1_2</p><h3 id="forwardoutput-transport">transport (string, optional)</h3><p>The transport protocol to use [ tcp, tls ]</p><h3 id="forwardoutput-verify_connection_at_startup">verify_connection_at_startup (bool, optional)</h3><p>Verify that a connection can be made with one of out_forward nodes at the time of startup.</p><p>Default: false</p><h2 id="fluentd-server">Fluentd Server</h2><p>server</p><h3 id="fluentd-server-host">host (string, required)</h3><p>The IP address or host name of the server.</p><h3 id="fluentd-server-name">name (string, optional)</h3><p>The name of the server. Used for logging and certificate verification in TLS transport (when host is address).</p><h3 id="fluentd-server-password">password (*secret.Secret, optional)</h3><p>The password for authentication.</p><h3 id="fluentd-server-port">port (int, optional)</h3><p>The port number of the host. Note that both TCP packets (event stream) and UDP packets (heartbeat message) are sent to this port.</p><p>Default: 24224</p><h3 id="fluentd-server-shared_key">shared_key (*secret.Secret, optional)</h3><p>The shared key per server.</p><h3 id="fluentd-server-standby">standby (bool, optional)</h3><p>Marks a node as the standby node for an Active-Standby model between Fluentd nodes. When an active node goes down, the standby node is promoted to an active node. The standby node is not used by the out_forward plugin until then.</p><h3 id="fluentd-server-username">username (*secret.Secret, optional)</h3><p>The username for authentication.</p><h3 id="fluentd-server-weight">weight (int, optional)</h3><p>The load balancing weight. If the weight of one server is 20 and the weight of the other server is 30, events are sent in a 2:3 ratio.</p><p>Default: 60</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-18e50786ba4697ffac3ab83b4c57e6e5">4.8.4.16 - GELF</h1><h1 id="gelf-outputhttpsgithubcomhotschedulesfluent-plugin-gelf-hs"><a href="https://github.com/hotschedules/fluent-plugin-gelf-hs">GELF Output</a></h1><h2 id="overview">Overview</h2><p>Fluentd output plugin for GELF. For details, see <a href="https://github.com/bmichalkiewicz/fluent-plugin-gelf-best">https://github.com/bmichalkiewicz/fluent-plugin-gelf-best</a>.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">gelf</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">gelf-host</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">12201</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="buffer-buffer-optional-output-config-buffer">buffer (*Buffer, optional) {#output config-buffer}</h3><p>Available since ghcr.io/kube-logging/fluentd:v1.16-full-build.139 <a href="../buffer/">Buffer</a></p><h3 id="host-string-required-output-config-host">host (string, required) {#output config-host}</h3><p>Destination host</p><h3 id="max_bytes-int-optional-output-config-max_bytes">max_bytes (int, optional) {#output config-max_bytes}</h3><p>MaxBytes specifies the maximum size, in bytes, of each individual log message. For details, see <a href="https://github.com/Graylog2/graylog2-server/issues/873">https://github.com/Graylog2/graylog2-server/issues/873</a> Available since ghcr.io/kube-logging/fluentd:v1.16-4.10-full</p><p>Default: 3200</p><h3 id="output-config-port">port (int, required)</h3><p>Destination host port</p><h3 id="output-config-protocol">protocol (string, optional)</h3><p>Transport Protocol</p><p>Default: &ldquo;udp&rdquo;</p><h3 id="output-config-tls">tls (*bool, optional)</h3><p>Enable TlS</p><p>Default: false</p><h3 id="output-config-tls_options">tls_options (map[string]string, optional)</h3><p>TLS Options. For details, see <a href="https://github.com/graylog-labs/gelf-rb/blob/72916932b789f7a6768c3cdd6ab69a3c942dbcef/lib/gelf/transport/tcp_tls.rb#L7-L12">https://github.com/graylog-labs/gelf-rb/blob/72916932b789f7a6768c3cdd6ab69a3c942dbcef/lib/gelf/transport/tcp_tls.rb#L7-L12</a>.</p><p>Default: {}</p><h2 id="example-gelf-output-configurations">Example <code>GELF</code> output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">gelf-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">gelf</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">gelf-host</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">12201</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;match</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>	@type gelf
</span></span><span style="display:flex"><span>	@id test_gelf
</span></span><span style="display:flex"><span>	host gelf-host
</span></span><span style="display:flex"><span>	port 12201
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/match&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-a6993ae75e6633de7954ded98992861c">4.8.4.17 - Google Cloud Storage</h1><h2 id="overview">Overview</h2><p>Store logs in Google Cloud Storage. For details, see <a href="https://github.com/kube-logging/fluent-plugin-gcs">https://github.com/kube-logging/fluent-plugin-gcs</a>.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">gcs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">project</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-example</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">bucket</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">banzai-log-test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logs/${tag}/%Y/%m/%d/</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="gcsoutput">GCSOutput</h2><h3 id="gcsoutput-acl">acl (string, optional)</h3><p>Permission for the object in GCS: <code>auth_read</code> <code>owner_full</code> <code>owner_read</code> <code>private</code> <code>project_private</code> <code>public_read</code></p><h3 id="gcsoutput-auto_create_bucket">auto_create_bucket (bool, optional)</h3><p>Create GCS bucket if it does not exists</p><p>Default: true</p><h3 id="gcsoutput-bucket">bucket (string, required)</h3><p>Name of a GCS bucket</p><h3 id="gcsoutput-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="gcsoutput-client_retries">client_retries (int, optional)</h3><p>Number of times to retry requests on server error</p><h3 id="gcsoutput-client_timeout">client_timeout (int, optional)</h3><p>Default timeout to use in requests</p><h3 id="gcsoutput-credentials_json">credentials_json (*secret.Secret, optional)</h3><p>GCS service account credentials in JSON format <a href="../secret/">Secret</a></p><h3 id="gcsoutput-encryption_key">encryption_key (string, optional)</h3><p>Customer-supplied, AES-256 encryption key</p><h3 id="gcsoutput-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="gcsoutput-hex_random_length">hex_random_length (int, optional)</h3><p>Max length of <code>%{hex_random}</code> placeholder(4-16)</p><p>Default: 4</p><h3 id="gcsoutput-keyfile">keyfile (string, optional)</h3><p>Path of GCS service account credentials JSON file</p><h3 id="gcsoutput-object_key_format">object_key_format (string, optional)</h3><p>Format of GCS object keys</p><p>Default: <code>%{path}%{time_slice}_%{index}.%{file_extension}</code></p><h3 id="gcsoutput-object_metadata">object_metadata ([]ObjectMetadata, optional)</h3><p>User provided web-safe keys and arbitrary string values that will returned with requests for the file as &ldquo;x-goog-meta-&rdquo; response headers. <a href="#objectmetadata">Object Metadata</a></p><h3 id="gcsoutput-overwrite">overwrite (bool, optional)</h3><p>Overwrite already existing path</p><p>Default: false</p><h3 id="gcsoutput-path">path (string, optional)</h3><p>Path prefix of the files on GCS</p><h3 id="gcsoutput-project">project (string, required)</h3><p>Project identifier for GCS</p><h3 id="gcsoutput-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="gcsoutput-storage_class">storage_class (string, optional)</h3><p>Storage class of the file: <code>dra</code> <code>nearline</code> <code>coldline</code> <code>multi_regional</code> <code>regional</code> <code>standard</code></p><h3 id="gcsoutput-store_as">store_as (string, optional)</h3><p>Archive format on GCS: gzip json text</p><p>Default: gzip</p><h3 id="gcsoutput-transcoding">transcoding (bool, optional)</h3><p>Enable the decompressive form of transcoding</p><h2 id="objectmetadata">ObjectMetadata</h2><h3 id="objectmetadata-key">key (string, required)</h3><p>Key</p><h3 id="objectmetadata-value">value (string, required)</h3><p>Value</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-a56bffbadd1b6a7c1ede4f727316205c">4.8.4.18 - Grafana Loki</h1><h1 id="loki-output-plugin">Loki output plugin</h1><h2 id="overview">Overview</h2><p>Fluentd output plugin to ship logs to a Loki server. For details, see <a href="https://grafana.com/docs/loki/latest/clients/fluentd/">https://grafana.com/docs/loki/latest/clients/fluentd/</a>.</p><p>For a detailed example, see <a href="../../../../quickstarts/loki-nginx/">Store Nginx Access Logs in Grafana Loki with Logging Operator</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">loki</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://loki:3100</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">30s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_use_utc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="output-config-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="output-config-ca_cert">ca_cert (*secret.Secret, optional)</h3><p>TLS: CA certificate file for server certificate verification <a href="../secret/">Secret</a></p><h3 id="output-config-cert">cert (*secret.Secret, optional)</h3><p>TLS: parameters for presenting a client certificate <a href="../secret/">Secret</a></p><h3 id="output-config-configure_kubernetes_labels">configure_kubernetes_labels (*bool, optional)</h3><p>Configure Kubernetes metadata in a Prometheus like format</p><p>Default: false</p><h3 id="output-config-drop_single_key">drop_single_key (*bool, optional)</h3><p>If a record only has 1 key, then just set the log line to the value and discard the key.</p><p>Default: false</p><h3 id="output-config-extra_labels">extra_labels (map[string]string, optional)</h3><p>Set of extra labels to include with every Loki stream.</p><h3 id="output-config-extract_kubernetes_labels">extract_kubernetes_labels (*bool, optional)</h3><p>Extract kubernetes labels as loki labels</p><p>Default: false</p><h3 id="output-config-include_thread_label">include_thread_label (*bool, optional)</h3><p>whether to include the fluentd_thread label when multiple threads are used for flushing.</p><p>Default: true</p><h3 id="output-config-insecure_tls">insecure_tls (*bool, optional)</h3><p>TLS: disable server certificate verification</p><p>Default: false</p><h3 id="output-config-key">key (*secret.Secret, optional)</h3><p>TLS: parameters for presenting a client certificate <a href="../secret/">Secret</a></p><h3 id="output-config-labels">labels (Label, optional)</h3><p>Set of labels to include with every Loki stream.</p><h3 id="output-config-line_format">line_format (string, optional)</h3><p>Format to use when flattening the record to a log line: json, key_value (default: key_value)</p><p>Default: json</p><h3 id="output-config-password">password (*secret.Secret, optional)</h3><p>Specify password if the Loki server requires authentication. <a href="../secret/">Secret</a></p><h3 id="output-config-remove_keys">remove_keys ([]string, optional)</h3><p>Comma separated list of needless record keys to remove</p><p>Default: []</p><h3 id="output-config-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, Fluentd logs a warning message and increases the <code>fluentd_output_status_slow_flush_count</code> metric.</p><h3 id="output-config-tenant">tenant (string, optional)</h3><p>Loki is a multi-tenant log storage platform and all requests sent must include a tenant.</p><h3 id="output-config-url">url (string, optional)</h3><p>The url of the Loki server to send logs to.</p><p>Default: <code>https://logs-us-west1.grafana.net</code></p><h3 id="output-config-username">username (*secret.Secret, optional)</h3><p>Specify a username if the Loki server requires authentication. <a href="../secret/">Secret</a></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-ae38f1f9de3603c1e55fe2fb4eeba9b0">4.8.4.19 - Http</h1><h1 id="http-plugin-for-fluentd">Http plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>Sends logs to HTTP/HTTPS endpoints. For details, see <a href="https://docs.fluentd.org/output/http">https://docs.fluentd.org/output/http</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">http</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">endpoint</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://logserver.com:9000/api</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">tags</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">flush_interval</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="output-config-auth">auth (*HTTPAuth, optional)</h3><p><a href="#http-auth-config">HTTP auth</a></p><h3 id="output-config-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="output-config-compress">compress (string, optional)</h3><p>The option to compress HTTP request body. [text,gzip]</p><p>Default: text</p><h3 id="output-config-content_type">content_type (string, optional)</h3><p>Content-Profile for HTTP request.</p><h3 id="output-config-endpoint">endpoint (string, required)</h3><p>Endpoint for HTTP request.</p><h3 id="output-config-error_response_as_unrecoverable">error_response_as_unrecoverable (*bool, optional)</h3><p>Raise UnrecoverableError when the response code is non success, 1xx/3xx/4xx/5xx. If false, the plugin logs error message instead of raising UnrecoverableError.</p><p>Default: true</p><h3 id="output-config-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="http_method-string-optional-output-config-http_method">http_method (string, optional) {#output config-http_method}</h3><p>Method for HTTP request. [post, put]</p><p>Default: post</p><h3 id="output-config-headers">headers (map[string]string, optional)</h3><p>Additional headers for HTTP request.</p><h3 id="headers_from_placeholders-mapstringstring-optional-output-config-headers_from_placeholders">headers_from_placeholders (map[string]string, optional) {#output config-headers_from_placeholders}</h3><p>Additional headers from placeholders for HTTP request.</p><h3 id="output-config-json_array">json_array (bool, optional)</h3><p>Using array format of JSON. This parameter is used and valid only for json format. When json_array as true, Content-Profile should be application/json and be able to use JSON data for the HTTP request body.</p><p>Default: false</p><h3 id="output-config-open_timeout">open_timeout (int, optional)</h3><p>Connection open timeout in seconds.</p><h3 id="output-config-proxy">proxy (string, optional)</h3><p>Proxy for HTTP request.</p><h3 id="output-config-read_timeout">read_timeout (int, optional)</h3><p>Read timeout in seconds.</p><h3 id="output-config-retryable_response_codes">retryable_response_codes ([]int, optional)</h3><p>List of retryable response codes. If the response code is included in this list, the plugin retries the buffer flush. Since Fluentd v2 the Status code 503 is going to be removed from default.</p><p>Default: [503]</p><h3 id="output-config-reuse_connections">reuse_connections (bool, optional)</h3><p>Try to reuse connection. This will improve performance.</p><p>Default: false</p><h3 id="output-config-ssl_timeout">ssl_timeout (int, optional)</h3><p>TLS timeout in seconds.</p><h3 id="output-config-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="output-config-tls_ca_cert_path">tls_ca_cert_path (*secret.Secret, optional)</h3><p>The CA certificate path for TLS.</p><h3 id="output-config-tls_ciphers">tls_ciphers (string, optional)</h3><p>The cipher configuration of TLS transport.</p><p>Default: ALL:!aNULL:!eNULL:!SSLv2</p><h3 id="output-config-tls_client_cert_path">tls_client_cert_path (*secret.Secret, optional)</h3><p>The client certificate path for TLS.</p><h3 id="output-config-tls_private_key_passphrase">tls_private_key_passphrase (*secret.Secret, optional)</h3><p>The client private key passphrase for TLS.</p><h3 id="output-config-tls_private_key_path">tls_private_key_path (*secret.Secret, optional)</h3><p>The client private key path for TLS.</p><h3 id="output-config-tls_verify_mode">tls_verify_mode (string, optional)</h3><p>The verify mode of TLS. [peer, none]</p><p>Default: peer</p><h3 id="output-config-tls_version">tls_version (string, optional)</h3><p>The default version of TLS transport. [TLSv1_1, TLSv1_2]</p><p>Default: TLSv1_2</p><h2 id="http-auth-config">HTTP auth config</h2><p>http_auth</p><h3 id="password-secretsecret-required-http-auth-config-password">password (*secret.Secret, required) {#http auth-config-password}</h3><p>Password for basic authentication. <a href="../secret/">Secret</a></p><h3 id="username-secretsecret-required-http-auth-config-username">username (*secret.Secret, required) {#http auth-config-username}</h3><p>Username for basic authentication. <a href="../secret/">Secret</a></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-1b992ac5779a83a537b40f5defa1bfa5">4.8.4.20 - Kafka</h1><h1 id="kafka-output-plugin-for-fluentd">Kafka output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>For details, see <a href="https://github.com/fluent/fluent-plugin-kafka">https://github.com/fluent/fluent-plugin-kafka</a>.</p><p>For an example deployment, see <a href="../../../../quickstarts/kafka-nginx/">Transport Nginx Access Logs into Kafka with Logging Operator</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">kafka</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">brokers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">kafka-headless.kafka.svc.cluster.local:29092</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">default_topic</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">topic</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">sasl_over_ssl</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">tags</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">topic</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">30s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_use_utc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="kafka">Kafka</h2><p>Send your logs to Kafka. Set <code>use_rdkafka</code> to <code>true</code> to use the rdkafka2 client, which offers higher performance than ruby-kafka. (Note: requires fluentd image version v1.16-4.9-full or higher)
-<a href="https://github.com/fluent/fluent-plugin-kafka#output-plugin">more info</a></p><h3 id="kafka-ack_timeout">ack_timeout (int, optional)</h3><p>How long the producer waits for acks. The unit is seconds</p><p>Default: nil => Uses default of ruby-kafka library</p><h3 id="kafka-brokers">brokers (string, required)</h3><p>The list of all seed brokers, with their host and port information.</p><h3 id="kafka-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="kafka-client_id">client_id (string, optional)</h3><p>Client ID</p><p>Default: &ldquo;kafka&rdquo;</p><h3 id="kafka-compression_codec">compression_codec (string, optional)</h3><p>The codec the producer uses to compress messages . The available options are gzip and snappy.</p><p>Default: nil</p><h3 id="kafka-default_message_key">default_message_key (string, optional)</h3><p>The name of default message key .</p><p>Default: nil</p><h3 id="kafka-default_partition_key">default_partition_key (string, optional)</h3><p>The name of default partition key .</p><p>Default: nil</p><h3 id="kafka-default_topic">default_topic (string, optional)</h3><p>The name of default topic .</p><p>Default: nil</p><h3 id="kafka-discard_kafka_delivery_failed">discard_kafka_delivery_failed (bool, optional)</h3><p>Discard the record where Kafka DeliveryFailed occurred</p><p>Default: false</p><h3 id="kafka-exclude_partion_key">exclude_partion_key (bool, optional)</h3><p>Exclude Partition key</p><p>Default: false</p><h3 id="kafka-exclude_topic_key">exclude_topic_key (bool, optional)</h3><p>Exclude Topic key</p><p>Default: false</p><h3 id="kafka-format">format (*Format, required)</h3><p><a href="../format/">Format</a></p><h3 id="kafka-get_kafka_client_log">get_kafka_client_log (bool, optional)</h3><p>Get Kafka Client log</p><p>Default: false</p><h3 id="kafka-headers">headers (map[string]string, optional)</h3><p>Headers</p><p>Default: {}</p><h3 id="kafka-headers_from_record">headers_from_record (map[string]string, optional)</h3><p>Headers from Record</p><p>Default: {}</p><h3 id="kafka-idempotent">idempotent (bool, optional)</h3><p>Idempotent</p><p>Default: false</p><h3 id="kafka-kafka_agg_max_bytes">kafka_agg_max_bytes (int, optional)</h3><p>Maximum value of total message size to be included in one batch transmission. .</p><p>Default: 4096</p><h3 id="kafka-kafka_agg_max_messages">kafka_agg_max_messages (int, optional)</h3><p>Maximum number of messages to include in one batch transmission. .</p><p>Default: nil</p><h3 id="kafka-keytab">keytab (*secret.Secret, optional)</h3><h3 id="kafka-max_send_limit_bytes">max_send_limit_bytes (int, optional)</h3><p>Max byte size to send message to avoid MessageSizeTooLarge. Messages over the limit will be dropped</p><p>Default: no limit</p><h3 id="kafka-max_send_retries">max_send_retries (int, optional)</h3><p>Number of times to retry sending of messages to a leader</p><p>Default: 1</p><h3 id="kafka-message_key_key">message_key_key (string, optional)</h3><p>Message Key</p><p>Default: &ldquo;message_key&rdquo;</p><h3 id="kafka-partition_key">partition_key (string, optional)</h3><p>Partition</p><p>Default: &ldquo;partition&rdquo;</p><h3 id="kafka-partition_key_key">partition_key_key (string, optional)</h3><p>Partition Key</p><p>Default: &ldquo;partition_key&rdquo;</p><h3 id="kafka-password">password (*secret.Secret, optional)</h3><p>Password when using PLAIN/SCRAM SASL authentication</p><h3 id="kafka-principal">principal (string, optional)</h3><h3 id="kafka-rdkafka_options">rdkafka_options (*RdkafkaOptions, optional)</h3><p>RdkafkaOptions represents the global configuration properties for librdkafka. See <a href="#RdkafkaOptions">RdkafkaOptions</a> for details.</p><h3 id="kafka-required_acks">required_acks (int, optional)</h3><p>The number of acks required per request .</p><p>Default: -1</p><h3 id="kafka-ssl_ca_cert">ssl_ca_cert (*secret.Secret, optional)</h3><p>CA certificate</p><h3 id="kafka-ssl_ca_certs_from_system">ssl_ca_certs_from_system (*bool, optional)</h3><p>System&rsquo;s CA cert store</p><p>Default: false</p><h3 id="kafka-ssl_client_cert">ssl_client_cert (*secret.Secret, optional)</h3><p>Client certificate</p><h3 id="kafka-ssl_client_cert_chain">ssl_client_cert_chain (*secret.Secret, optional)</h3><p>Client certificate chain</p><h3 id="kafka-ssl_client_cert_key">ssl_client_cert_key (*secret.Secret, optional)</h3><p>Client certificate key</p><h3 id="kafka-ssl_verify_hostname">ssl_verify_hostname (*bool, optional)</h3><p>Verify certificate hostname</p><h3 id="kafka-sasl_over_ssl">sasl_over_ssl (*bool, optional)</h3><p>SASL over SSL</p><p>Default: true</p><h3 id="kafka-scram_mechanism">scram_mechanism (string, optional)</h3><p>If set, use SCRAM authentication with specified mechanism. When unset, default to PLAIN authentication</p><h3 id="kafka-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, Fluentd logs a warning message and increases the <code>fluentd_output_status_slow_flush_count</code> metric.</p><h3 id="kafka-topic_key">topic_key (string, optional)</h3><p>Topic Key</p><p>Default: &ldquo;topic&rdquo;</p><h3 id="kafka-use_default_for_unknown_topic">use_default_for_unknown_topic (bool, optional)</h3><p>Use default for unknown topics</p><p>Default: false</p><h3 id="kafka-use_rdkafka">use_rdkafka (bool, optional)</h3><p>Use rdkafka2 instead of the legacy kafka2 output plugin. This plugin requires fluentd image version v1.16-4.9-full or higher.</p><h3 id="kafka-username">username (*secret.Secret, optional)</h3><p>Username when using PLAIN/SCRAM SASL authentication</p><h2 id="rdkafkaoptions">RdkafkaOptions</h2><p>RdkafkaOptions represents the global configuration properties for librdkafka.</p><h3 id="rdkafkaoptions-allow.auto.create.topics">allow.auto.create.topics (bool, optional)</h3><p>Allow automatic topic creation on the broker when subscribing to or assigning non-existent topics. The broker must also be configured with <code>auto.create.topics.enable=true</code> for this configuration to take effect. Note: the default value (true) for the producer is different from the default value (false) for the consumer. Furthermore, the consumer default value is different from the Java consumer (true), and this property is not supported by the Java producer. Requires broker version >= 0.11.0.0. For older broker versions only the broker configuration applies.</p><h3 id="rdkafkaoptions-api.version.fallback.ms">api.version.fallback.ms (int, optional)</h3><p>Dictates how long the <code>broker.version.fallback</code> fallback is used in the case the ApiVersionRequest fails.</p><h3 id="rdkafkaoptions-api.version.request">api.version.request (bool, optional)</h3><p>Request broker&rsquo;s supported API versions to adjust functionality to available protocol features. If set to false, or the ApiVersionRequest fails, the fallback version <code>broker.version.fallback</code> will be used. Requires broker version >=0.10.0. If the request is not supported by (an older) broker, the <code>broker.version.fallback</code> fallback is used.</p><h3 id="rdkafkaoptions-api.version.request.timeout.ms">api.version.request.timeout.ms (int, optional)</h3><p>Timeout for broker API version requests.</p><h3 id="rdkafkaoptions-background_event_cb">background_event_cb (string, optional)</h3><p>Background queue event callback (set with rd_kafka_conf_set_background_event_cb())</p><h3 id="rdkafkaoptions-bootstrap.servers">bootstrap.servers (string, optional)</h3><p>Alias for <code>metadata.broker.list</code>: Initial list of brokers as a CSV list of broker host or host:port. The application may also use <code>rd_kafka_brokers_add()</code> to add brokers during runtime.</p><h3 id="rdkafkaoptions-broker.address.family">broker.address.family (string, optional)</h3><p>Allowed broker IP address families: any, v4, v6</p><h3 id="rdkafkaoptions-broker.address.ttl">broker.address.ttl (int, optional)</h3><p>How long to cache the broker address resolving results (milliseconds).</p><h3 id="rdkafkaoptions-broker.version.fallback">broker.version.fallback (string, optional)</h3><p>Older broker versions (before 0.10.0) provide no way for a client to query for supported protocol features (ApiVersionRequest, see <code>api.version.request</code>), making it impossible for the client to know what features it may use. As a workaround, a user may set this property to the expected broker version and the client will automatically adjust its feature set accordingly if the ApiVersionRequest fails (or is disabled). The fallback broker version will be used for <code>api.version.fallback.ms</code>. Valid values are: 0.9.0, 0.8.2, 0.8.1, 0.8.0. Any other value >= 0.10, such as 0.10.2.1, enables ApiVersionRequests.</p><h3 id="rdkafkaoptions-builtin.features">builtin.features (string, optional)</h3><p>Indicates the builtin features for this build of librdkafka. An application can either query this value or attempt to set it with its list of required features to check for library support.</p><h3 id="rdkafkaoptions-client.id">client.id (string, optional)</h3><p>Client identifier.</p><h3 id="rdkafkaoptions-closesocket_cb">closesocket_cb (string, optional)</h3><p>Socket close callback</p><h3 id="rdkafkaoptions-connect_cb">connect_cb (string, optional)</h3><p>Socket connect callback</p><h3 id="rdkafkaoptions-connections.max.idle.ms">connections.max.idle.ms (int, optional)</h3><p>Close broker connections after the specified time of inactivity. Disable with 0. If this property is left at its default value, some heuristics are performed to determine a suitable default value. This is currently limited to identifying brokers on Azure (see librdkafka issue #3109 for more info).</p><h3 id="rdkafkaoptions-debug">debug (string, optional)</h3><p>A comma-separated list of debug contexts to enable. Detailed Producer debugging: broker,topic,msg. Consumer: consumer,cgrp,topic,fetch</p><h3 id="rdkafkaoptions-default_topic_conf">default_topic_conf (string, optional)</h3><p>Default topic configuration for automatically subscribed topics</p><h3 id="rdkafkaoptions-enable.random.seed">enable.random.seed (bool, optional)</h3><p>If enabled, librdkafka will initialize the PRNG with srand(current_time.milliseconds) on the first invocation of rd_kafka_new() (required only if rand_r() is not available on your platform). If disabled the application must call srand() prior to calling rd_kafka_new().</p><h3 id="rdkafkaoptions-enable.ssl.certificate.verification">enable.ssl.certificate.verification (bool, optional)</h3><p>Enable OpenSSL&rsquo;s builtin broker (server) certificate verification. This verification can be extended by the application by implementing a certificate_verify_cb.</p><h3 id="rdkafkaoptions-enable.sasl.oauthbearer.unsecure.jwt">enable.sasl.oauthbearer.unsecure.jwt (bool, optional)</h3><p>Enable the builtin unsecure JWT OAUTHBEARER token handler if no oauthbearer_refresh_cb has been set. This builtin handler should only be used for development or testing, and not in production.</p><h3 id="rdkafkaoptions-enabled_events">enabled_events (int, optional)</h3><p>See <code>rd_kafka_conf_set_events()</code></p><h3 id="rdkafkaoptions-error_cb">error_cb (string, optional)</h3><p>Error callback (set with rd_kafka_conf_set_error_cb())</p><h3 id="rdkafkaoptions-interceptors">interceptors (string, optional)</h3><p>Interceptors added through rd_kafka_conf_interceptor_add_..() and any configuration handled by interceptors.</p><h3 id="rdkafkaoptions-internal.termination.signal">internal.termination.signal (int, optional)</h3><p>Signal that librdkafka will use to quickly terminate on rd_kafka_destroy(). If this signal is not set then there will be a delay before rd_kafka_wait_destroyed() returns true as internal threads are timing out their system calls. If this signal is set however the delay will be minimal. The application should mask this signal as an internal signal handler is installed.</p><h3 id="rdkafkaoptions-log_cb">log_cb (string, optional)</h3><p>Log callback (set with rd_kafka_conf_set_log_cb())</p><h3 id="rdkafkaoptions-log.connection.close">log.connection.close (bool, optional)</h3><p>Log broker disconnects. It might be useful to turn this off when interacting with 0.9 brokers with an aggressive <code>connections.max.idle.ms</code> value.</p><h3 id="rdkafkaoptions-log_level">log_level (int, optional)</h3><p>Logging level (syslog(3) levels)</p><h3 id="rdkafkaoptions-log.queue">log.queue (bool, optional)</h3><p>Disable spontaneous log_cb from internal librdkafka threads, instead enqueue log messages on queue set with <code>rd_kafka_set_log_queue()</code> and serve log callbacks or events through the standard poll APIs. <strong>NOTE</strong>: Log messages will linger in a temporary queue until the log queue has been set.</p><h3 id="rdkafkaoptions-log.thread.name">log.thread.name (bool, optional)</h3><p>Print internal thread name in log messages (useful for debugging librdkafka internals)</p><h3 id="rdkafkaoptions-max.in.flight">max.in.flight (int, optional)</h3><p>Alias for <code>max.in.flight.requests.per.connection</code>: Maximum number of in-flight requests per broker connection. This is a generic property applied to all broker communication, however it is primarily relevant to produce requests. In particular, note that other mechanisms limit the number of outstanding consumer fetch request per broker to one.</p><h3 id="rdkafkaoptions-max.in.flight.requests.per.connection">max.in.flight.requests.per.connection (int, optional)</h3><p>Maximum number of in-flight requests per broker connection. This is a generic property applied to all broker communication, however it is primarily relevant to produce requests. In particular, note that other mechanisms limit the number of outstanding consumer fetch request per broker to one.</p><h3 id="rdkafkaoptions-message.copy.max.bytes">message.copy.max.bytes (int, optional)</h3><p>Maximum size for message to be copied to buffer. Messages larger than this will be passed by reference (zero-copy) at the expense of larger iovecs.</p><h3 id="rdkafkaoptions-message.max.bytes">message.max.bytes (int, optional)</h3><p>Maximum Kafka protocol request message size. Due to differing framing overhead between protocol versions the producer is unable to reliably enforce a strict max message limit at produce time and may exceed the maximum size by one message in protocol ProduceRequests, the broker will enforce the the topic&rsquo;s <code>max.message.bytes</code> limit (see Apache Kafka documentation).</p><h3 id="rdkafkaoptions-metadata.broker.list">metadata.broker.list (string, optional)</h3><p>Initial list of brokers as a CSV list of broker host or host:port. The application may also use <code>rd_kafka_brokers_add()</code> to add brokers during runtime.</p><h3 id="rdkafkaoptions-metadata.max.age.ms">metadata.max.age.ms (int, optional)</h3><p>Metadata cache max age. Defaults to topic.metadata.refresh.interval.ms * 3</p><h3 id="rdkafkaoptions-oauthbearer_token_refresh_cb">oauthbearer_token_refresh_cb (string, optional)</h3><p>SASL/OAUTHBEARER token refresh callback (set with rd_kafka_conf_set_oauthbearer_token_refresh_cb(), triggered by rd_kafka_poll(), et.al). This callback will be triggered when it is time to refresh the client&rsquo;s OAUTHBEARER token. Also see rd_kafka_conf_enable_sasl_queue().</p><h3 id="rdkafkaoptions-opaque">opaque (string, optional)</h3><p>Application opaque (set with rd_kafka_conf_set_opaque())</p><h3 id="rdkafkaoptions-open_cb">open_cb (string, optional)</h3><p>File open callback to provide race-free CLOEXEC</p><h3 id="rdkafkaoptions-plugin.library.paths">plugin.library.paths (string, optional)</h3><p>List of plugin libraries to load (; separated). The library search path is platform dependent (see dlopen(3) for Unix and LoadLibrary() for Windows). If no filename extension is specified the platform-specific extension (such as .dll or .so) will be appended automatically.</p><h3 id="rdkafkaoptions-receive.message.max.bytes">receive.message.max.bytes (int, optional)</h3><p>Maximum Kafka protocol response message size. This serves as a safety precaution to avoid memory exhaustion in case of protocol hickups. This value must be at least <code>fetch.max.bytes</code> + 512 to allow for protocol overhead; the value is adjusted automatically unless the configuration property is explicitly set.</p><h3 id="rdkafkaoptions-reconnect.backoff.max.ms">reconnect.backoff.max.ms (int, optional)</h3><p>The maximum time to wait before reconnecting to a broker after the connection has been closed.</p><h3 id="rdkafkaoptions-reconnect.backoff.ms">reconnect.backoff.ms (int, optional)</h3><p>The initial time to wait before reconnecting to a broker after the connection has been closed. The time is increased exponentially until <code>reconnect.backoff.max.ms</code> is reached. -25% to +50% jitter is applied to each reconnect backoff. A value of 0 disables the backoff and reconnects immediately.</p><h3 id="rdkafkaoptions-resolve_cb">resolve_cb (string, optional)</h3><p>Address resolution callback (set with rd_kafka_conf_set_resolve_cb())</p><h3 id="rdkafkaoptions-ssl.ca.location">ssl.ca.location (string, optional)</h3><p>File or directory path to CA certificate(s) for verifying the broker&rsquo;s key. Defaults: On Windows the system&rsquo;s CA certificates are automatically looked up in the Windows Root certificate store. On Mac OSX this configuration defaults to <code>probe</code>. It is recommended to install openssl using Homebrew, to provide CA certificates. On Linux install the distribution&rsquo;s ca-certificates package. If OpenSSL is statically linked or <code>ssl.ca.location</code> is set to <code>probe</code> a list of standard paths will be probed and the first one found will be used as the default CA certificate location path. If OpenSSL is dynamically linked the OpenSSL library&rsquo;s default path will be used (see <code>OPENSSLDIR</code> in <code>openssl version -a</code>).</p><h3 id="rdkafkaoptions-ssl.ca.pem">ssl.ca.pem (string, optional)</h3><p>CA certificate string (PEM format) for verifying the broker&rsquo;s key.</p><h3 id="rdkafkaoptions-ssl.certificate.location">ssl.certificate.location (string, optional)</h3><p>Path to client&rsquo;s public key (PEM) used for authentication.</p><h3 id="rdkafkaoptions-ssl.certificate.pem">ssl.certificate.pem (string, optional)</h3><p>Client&rsquo;s public key string (PEM format) used for authentication.</p><h3 id="rdkafkaoptions-ssl.cipher.suites">ssl.cipher.suites (string, optional)</h3><p>A cipher suite is a named combination of authentication, encryption, MAC and key exchange algorithm used to negotiate the security settings for a network connection using TLS or SSL network protocol. See manual page for <code>ciphers(1)</code> and `SSL_CTX_set_cipher_list(3).</p><h3 id="rdkafkaoptions-ssl.crl.location">ssl.crl.location (string, optional)</h3><p>Path to CRL for verifying broker&rsquo;s certificate validity.</p><h3 id="rdkafkaoptions-ssl.curves.list">ssl.curves.list (string, optional)</h3><p>The supported-curves extension in the TLS ClientHello message specifies the curves (standard/named, or &rsquo;explicit&rsquo; GF(2^k) or GF(p)) the client is willing to have the server use. See manual page for <code>SSL_CTX_set1_curves_list(3)</code>. OpenSSL >= 1.0.2 required.</p><h3 id="rdkafkaoptions-ssl.endpoint.identification.algorithm">ssl.endpoint.identification.algorithm (string, optional)</h3><p>Endpoint identification algorithm to validate broker hostname using broker certificate. https - Server (broker) hostname verification as specified in RFC2818. none - No endpoint verification. OpenSSL >= 1.0.2 required.</p><h3 id="rdkafkaoptions-ssl.engine.id">ssl.engine.id (string, optional)</h3><p>OpenSSL engine id is the name used for loading engine.</p><h3 id="rdkafkaoptions-ssl.engine.location">ssl.engine.location (string, optional)</h3><p><strong>DEPRECATED</strong> Path to OpenSSL engine library. OpenSSL >= 1.1.x required. DEPRECATED: OpenSSL engine support is deprecated and should be replaced by OpenSSL 3 providers.</p><h3 id="rdkafkaoptions-ssl.key.location">ssl.key.location (string, optional)</h3><p>Path to client&rsquo;s private key (PEM) used for authentication.</p><h3 id="rdkafkaoptions-ssl.key.password">ssl.key.password (string, optional)</h3><p>Private key passphrase (for use with <code>ssl.key.location</code> and <code>set_ssl_cert()</code>).</p><h3 id="rdkafkaoptions-ssl.key.pem">ssl.key.pem (string, optional)</h3><p>Client&rsquo;s private key string (PEM format) used for authentication.</p><h3 id="rdkafkaoptions-ssl.keystore.location">ssl.keystore.location (string, optional)</h3><p>Path to client&rsquo;s keystore (PKCS#12) used for authentication.</p><h3 id="rdkafkaoptions-ssl.keystore.password">ssl.keystore.password (string, optional)</h3><p>Client&rsquo;s keystore (PKCS#12) password.</p><h3 id="rdkafkaoptions-ssl.providers">ssl.providers (string, optional)</h3><p>Comma-separated list of OpenSSL 3.0.x implementation providers. E.g., &ldquo;default,legacy&rdquo;.</p><h3 id="rdkafkaoptions-ssl.sigalgs.list">ssl.sigalgs.list (string, optional)</h3><p>The client uses the TLS ClientHello signature_algorithms extension to indicate to the server which signature/hash algorithm pairs may be used in digital signatures. See manual page for <code>SSL_CTX_set1_sigalgs_list(3)</code>. OpenSSL >= 1.0.2 required.</p><h3 id="rdkafkaoptions-sasl.kerberos.keytab">sasl.kerberos.keytab (string, optional)</h3><p>Path to Kerberos keytab file. This configuration property is only used as a variable in sasl.kerberos.kinit.cmd as &mldr; -t &ldquo;%{sasl.kerberos.keytab}&rdquo;.</p><h3 id="rdkafkaoptions-sasl.kerberos.kinit.cmd">sasl.kerberos.kinit.cmd (string, optional)</h3><p>Shell command to refresh or acquire the client&rsquo;s Kerberos ticket. This command is executed on client creation and every sasl.kerberos.min.time.before.relogin (0=disable).</p><h3 id="rdkafkaoptions-sasl.kerberos.min.time.before.relogin">sasl.kerberos.min.time.before.relogin (int, optional)</h3><p>Minimum time in milliseconds between key refresh attempts. Disable automatic key refresh by setting this property to 0.</p><h3 id="rdkafkaoptions-sasl.kerberos.principal">sasl.kerberos.principal (string, optional)</h3><p>This client&rsquo;s Kerberos principal name. (Not supported on Windows, will use the logon user&rsquo;s principal).</p><h3 id="rdkafkaoptions-sasl.kerberos.service.name">sasl.kerberos.service.name (string, optional)</h3><p>Kerberos principal name that Kafka runs as, not including /hostname@REALM.</p><h3 id="rdkafkaoptions-sasl.mechanisms">sasl.mechanisms (string, optional)</h3><p>SASL mechanism to use for authentication. Supported: GSSAPI, PLAIN, SCRAM-SHA-256, SCRAM-SHA-512, OAUTHBEARER. NOTE: Despite the name only one mechanism must be configured.</p><h3 id="rdkafkaoptions-sasl.oauthbearer.client.id">sasl.oauthbearer.client.id (string, optional)</h3><p>Public identifier for the application. Must be unique across all clients that the authorization server handles. Only used when sasl.oauthbearer.method is set to &ldquo;oidc&rdquo;.</p><h3 id="rdkafkaoptions-sasl.oauthbearer.client.secret">sasl.oauthbearer.client.secret (string, optional)</h3><p>Client secret only known to the application and the authorization server. This should be a sufficiently random string that is not guessable. Only used when sasl.oauthbearer.method is set to &ldquo;oidc&rdquo;.</p><h3 id="rdkafkaoptions-sasl.oauthbearer.config">sasl.oauthbearer.config (string, optional)</h3><p>SASL/OAUTHBEARER configuration. The format is implementation-dependent and must be parsed accordingly. The default unsecured token implementation (see <a href="https://tools.ietf.org/html/rfc7515#appendix-A.5">https://tools.ietf.org/html/rfc7515#appendix-A.5</a>) recognizes space-separated name=value pairs with valid names including principalClaimName, principal, scopeClaimName, scope, and lifeSeconds. The default value for principalClaimName is &ldquo;sub&rdquo;, the default value for scopeClaimName is &ldquo;scope&rdquo;, and the default value for lifeSeconds is 3600. The scope value is CSV format with the default value being no/empty scope. For example: principalClaimName=azp principal=admin scopeClaimName=roles scope=role1,role2 lifeSeconds=600. In addition, SASL extensions can be communicated to the broker via extension_NAME=value. For example: principal=admin extension_traceId=123.</p><h3 id="rdkafkaoptions-sasl.oauthbearer.extensions">sasl.oauthbearer.extensions (string, optional)</h3><p>Allow additional information to be provided to the broker. Comma-separated list of key=value pairs. E.g., &ldquo;supportFeatureX=true,organizationId=sales-emea&rdquo;.Only used when sasl.oauthbearer.method is set to &ldquo;oidc&rdquo;.</p><h3 id="rdkafkaoptions-sasl.oauthbearer.method">sasl.oauthbearer.method (string, optional)</h3><p>Set to &ldquo;default&rdquo; or &ldquo;oidc&rdquo; to control which login method to be used. If set to &ldquo;oidc&rdquo;, the following properties must also be specified: sasl.oauthbearer.client.id, sasl.oauthbearer.client.secret, and sasl.oauthbearer.token.endpoint.url.</p><h3 id="rdkafkaoptions-sasl.oauthbearer.scope">sasl.oauthbearer.scope (string, optional)</h3><p>Client use this to specify the scope of the access request to the broker. Only used when sasl.oauthbearer.method is set to &ldquo;oidc&rdquo;.</p><h3 id="rdkafkaoptions-sasl.oauthbearer.token.endpoint.url">sasl.oauthbearer.token.endpoint.url (string, optional)</h3><p>OAuth/OIDC issuer token endpoint HTTP(S) URI used to retrieve token. Only used when sasl.oauthbearer.method is set to &ldquo;oidc&rdquo;.</p><h3 id="rdkafkaoptions-sasl.password">sasl.password (string, optional)</h3><p>SASL password for use with the PLAIN and SASL-SCRAM-.. mechanism.</p><h3 id="rdkafkaoptions-sasl.username">sasl.username (string, optional)</h3><p>SASL username for use with the PLAIN and SASL-SCRAM-.. mechanisms.</p><h3 id="rdkafkaoptions-security.protocol">security.protocol (string, optional)</h3><p>Protocol used to communicate with brokers.</p><h3 id="rdkafkaoptions-socket.blocking.max.ms">socket.blocking.max.ms (int, optional)</h3><p>DEPRECATED No longer used.</p><h3 id="rdkafkaoptions-socket_cb">socket_cb (string, optional)</h3><p>Socket creation callback to provide race-free CLOEXEC</p><h3 id="rdkafkaoptions-socket.connection.setup.timeout.ms">socket.connection.setup.timeout.ms (int, optional)</h3><p>Maximum time allowed for broker connection setup (TCP connection setup as well SSL and SASL handshake). If the connection to the broker is not fully functional after this the connection will be closed and retried.</p><h3 id="rdkafkaoptions-socket.keepalive.enable">socket.keepalive.enable (bool, optional)</h3><p>Enable TCP keep-alives (SO_KEEPALIVE) on broker sockets</p><h3 id="rdkafkaoptions-socket.max.fails">socket.max.fails (int, optional)</h3><p>Disconnect from broker when this number of send failures (e.g., timed out requests) is reached. Disable with 0. WARNING: It is highly recommended to leave this setting at its default value of 1 to avoid the client and broker to become desynchronized in case of request timeouts. NOTE: The connection is automatically re-established.</p><h3 id="rdkafkaoptions-socket.nagle.disable">socket.nagle.disable (bool, optional)</h3><p>Disable the Nagle algorithm (TCP_NODELAY) on broker sockets.</p><h3 id="rdkafkaoptions-socket.receive.buffer.bytes">socket.receive.buffer.bytes (int, optional)</h3><p>Broker socket receive buffer size. System default is used if 0.</p><h3 id="rdkafkaoptions-socket.send.buffer.bytes">socket.send.buffer.bytes (int, optional)</h3><p>Broker socket send buffer size. System default is used if 0.</p><h3 id="rdkafkaoptions-socket.timeout.ms">socket.timeout.ms (int, optional)</h3><p>Default timeout for network requests. Producer: ProduceRequests will use the lesser value of <code>socket.timeout.ms</code> and remaining <code>message.timeout.ms</code> for the first message in the batch. Consumer: FetchRequests will use <code>fetch.wait.max.ms</code> + <code>socket.timeout.ms</code>. Admin: Admin requests will use <code>socket.timeout.ms</code> or explicitly set <code>rd_kafka_AdminOptions_set_operation_timeout()</code> value.</p><h3 id="rdkafkaoptions-statistics.interval.ms">statistics.interval.ms (int, optional)</h3><p>librdkafka statistics emit interval. The application also needs to register a stats callback using <code>rd_kafka_conf_set_stats_cb()</code>. The granularity is 1000ms. A value of 0 disables statistics.</p><h3 id="rdkafkaoptions-stats_cb">stats_cb (string, optional)</h3><p>Statistics callback (set with rd_kafka_conf_set_stats_cb())</p><h3 id="rdkafkaoptions-throttle_cb">throttle_cb (string, optional)</h3><p>Throttle callback (set with rd_kafka_conf_set_throttle_cb())</p><h3 id="rdkafkaoptions-topic.blacklist">topic.blacklist (string, optional)</h3><p>Topic blacklist, a comma-separated list of regular expressions for matching topic names that should be ignored in broker metadata information as if the topics did not exist.</p><h3 id="rdkafkaoptions-topic.metadata.propagation.max.ms">topic.metadata.propagation.max.ms (int, optional)</h3><p>Apache Kafka topic creation is asynchronous and it takes some time for a new topic to propagate throughout the cluster to all brokers. If a client requests topic metadata after manual topic creation but before the topic has been fully propagated to the broker the client is requesting metadata from, the topic will seem to be non-existent and the client will mark the topic as such, failing queued produced messages with <code>ERR__UNKNOWN_TOPIC</code>. This setting delays marking a topic as non-existent until the configured propagation max time has passed. The maximum propagation time is calculated from the time the topic is first referenced in the client, e.g., on produce().</p><h3 id="rdkafkaoptions-topic.metadata.refresh.fast.interval.ms">topic.metadata.refresh.fast.interval.ms (int, optional)</h3><p>When a topic loses its leader a new metadata request will be enqueued immediately and then with this initial interval, exponentially increasing upto <code>retry.backoff.max.ms</code>, until the topic metadata has been refreshed. If not set explicitly, it will be defaulted to <code>retry.backoff.ms</code>. This is used to recover quickly from transitioning leader brokers.</p><h3 id="rdkafkaoptions-topic.metadata.refresh.interval.ms">topic.metadata.refresh.interval.ms (int, optional)</h3><p>Period of time in milliseconds at which topic and broker metadata is refreshed in order to proactively discover any new brokers, topics, partitions or partition leader changes. Use -1 to disable the intervalled refresh (not recommended). If there are no locally referenced topics (no topic objects created, no messages produced, no subscription or no assignment) then only the broker list will be refreshed every interval but no more often than every 10s.</p><h3 id="rdkafkaoptions-topic.metadata.refresh.sparse">topic.metadata.refresh.sparse (bool, optional)</h3><p>Sparse metadata requests (consumes less network bandwidth)</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-3736a73536ae2ea19873950bfc5c1521">4.8.4.21 - LogDNA</h1><h1 id="logdna-outputhttpsgithubcomlogdnafluent-plugin-logdna"><a href="https://github.com/logdna/fluent-plugin-logdna">LogDNA Output</a></h1><h2 id="overview">Overview</h2><p>This plugin has been designed to output logs to LogDNA.</p><h2 id="configuration">Configuration</h2><h2 id="logdna">LogDNA</h2><p>Send your logs to LogDNA</p><h3 id="logdna-api_key">api_key (string, required)</h3><p>LogDNA Api key</p><h3 id="logdna-app">app (string, optional)</h3><p>Application name</p><h3 id="logdna-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="logdna-hostname">hostname (string, required)</h3><p>Hostname</p><h3 id="logdna-ingester_domain">ingester_domain (string, optional)</h3><p>Custom Ingester URL, Optional</p><p>Default: <code>https://logs.logdna.com</code></p><h3 id="logdna-ingester_endpoint">ingester_endpoint (string, optional)</h3><p>Custom Ingester Endpoint, Optional</p><p>Default: /logs/ingest</p><h3 id="logdna-request_timeout">request_timeout (string, optional)</h3><p>HTTPS POST Request Timeout, Optional. Supports s and ms Suffices</p><p>Default: 30 s</p><h3 id="logdna-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, Fluentd logs a warning message and increases the <code>fluentd_output_status_slow_flush_count</code> metric.</p><h3 id="logdna-tags">tags (string, optional)</h3><p>Comma-Separated List of Tags, Optional</p><h2 id="example-logdna-filter-configurations">Example <code>LogDNA</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logdna-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">logdna</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">api_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">xxxxxxxxxxxxxxxxxxxxxxxxxxx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">hostname</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-operator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">my-app</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tags</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">web,dev</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">ingester_domain https://logs.logdna.com</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">ingester_endpoint /logs/ingest</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">&lt;match **&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span>@<span style="color:#000">type logdna</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span>@<span style="color:#000">id test_logdna</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span><span style="color:#000">api_key xxxxxxxxxxxxxxxxxxxxxxxxxxy</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span><span style="color:#000">app my-app</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span><span style="color:#000">hostname logging-operator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">&lt;/match&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-f5b4f39075d38f596892cbc946ca5735">4.8.4.22 - LogZ</h1><h1 id="logz-output-plugin-for-fluentd">LogZ output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>For details, see <a href="https://github.com/tarokkk/fluent-plugin-logzio">https://github.com/tarokkk/fluent-plugin-logzio</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">logz</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">endpoint</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://listener.logz.io</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">8071</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">token</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">         </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logz-token</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">           </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">token</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">output_include_tags</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">output_include_time</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">flush_mode</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">interval</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">flush_thread_count</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">4</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">flush_interval</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">5s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">chunk_limit_size</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">16m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">queue_limit_length</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">4096</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="logzio">Logzio</h2><p>LogZ Send your logs to LogZ.io</p><h3 id="logzio-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="logzio-bulk_limit">bulk_limit (int, optional)</h3><p>Limit to the size of the Logz.io upload bulk. Defaults to 1000000 bytes leaving about 24kB for overhead.</p><h3 id="logzio-bulk_limit_warning_limit">bulk_limit_warning_limit (int, optional)</h3><p>Limit to the size of the Logz.io warning message when a record exceeds bulk_limit to prevent a recursion when Fluent warnings are sent to the Logz.io output.</p><h3 id="logzio-endpoint">endpoint (*Endpoint, required)</h3><p>Define LogZ endpoint URL</p><h3 id="logzio-gzip">gzip (bool, optional)</h3><p>Should the plugin ship the logs in gzip compression. Default is false.</p><h3 id="logzio-http_idle_timeout">http_idle_timeout (int, optional)</h3><p>Timeout in seconds that the http persistent connection will stay open without traffic.</p><h3 id="logzio-output_include_tags">output_include_tags (bool, optional)</h3><p>Should the appender add the fluentd tag to the document, called &ldquo;fluentd_tag&rdquo;</p><h3 id="logzio-output_include_time">output_include_time (bool, optional)</h3><p>Should the appender add a timestamp to your logs on their process time (recommended).</p><h3 id="logzio-retry_count">retry_count (int, optional)</h3><p>How many times to resend failed bulks.</p><h3 id="logzio-retry_sleep">retry_sleep (int, optional)</h3><p>How long to sleep initially between retries, exponential step-off.</p><h3 id="logzio-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, Fluentd logs a warning message and increases the <code>fluentd_output_status_slow_flush_count</code> metric.</p><h2 id="endpoint">Endpoint</h2><p>Endpoint defines connection details for LogZ.io.</p><h3 id="endpoint-port">port (int, optional)</h3><p>Port over which to connect to LogZ URL.</p><p>Default: 8071</p><h3 id="endpoint-token">token (*secret.Secret, optional)</h3><p>LogZ API Token. <a href="../secret/">Secret</a></p><h3 id="endpoint-url">url (string, optional)</h3><p>LogZ URL.</p><p>Default: <a href="https://listener.logz.io">https://listener.logz.io</a></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-683bbb879ced9c27f3943b7a4809b29e">4.8.4.23 - Mattermost</h1><h1 id="mattermost-plugin-for-fluentd">Mattermost plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>Sends logs to Mattermost via webhooks.
For details, see <a href="https://github.com/levigo-systems/fluent-plugin-mattermost">https://github.com/levigo-systems/fluent-plugin-mattermost</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">mattermost</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">webhook_url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://xxx.xx/hooks/xxxxxxxxxxxxxxx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">channel_id</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">xxxxxxxxxxxxxxx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">message_color</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;#FFA500&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">enable_tls</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="output-config-ca_path">ca_path (*secret.Secret, optional)</h3><p>The path of the CA certificates.</p><h3 id="output-config-channel_id">channel_id (string, optional)</h3><p>The ID of the channel where you want to receive the information.</p><h3 id="output-config-enable_tls">enable_tls (*bool, optional)</h3><p>You can set the communication channel if it uses TLS.</p><p>Default: true</p><h3 id="output-config-message">message (string, optional)</h3><p>The message you want to send. It can be a static message, which you add at this point, or you can receive the Fluentd infos with the %s</p><h3 id="output-config-message_color">message_color (string, optional)</h3><p>Color of the message you are sending, in hexadecimal format.</p><p>Default: #A9A9A9</p><h3 id="output-config-message_title">message_title (string, optional)</h3><p>The title you want to add to the message.</p><p>Default: fluent_title_default</p><h3 id="output-config-webhook_url">webhook_url (*secret.Secret, required)</h3><p>Incoming Webhook URI (Required for Incoming Webhook mode).</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-434371d7a3888abd2a15c4cd22f941cc">4.8.4.24 - NewRelic</h1><h1 id="new-relic-logs-plugin-for-fluentd">New Relic Logs plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>Output plugin send log data to New Relic Logs</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">newrelic</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">license_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-newrelic</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">licenseKey</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="output-config-api_key">api_key (*secret.Secret, optional)</h3><p>New Relic API Insert key <a href="../secret/">Secret</a></p><h3 id="output-config-base_uri">base_uri (string, optional)</h3><p>New Relic ingestion endpoint <a href="../secret/">Secret</a></p><p>Default: <code>https://log-api.newrelic.com/log/v1</code></p><h3 id="output-config-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="output-config-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="output-config-license_key">license_key (*secret.Secret, optional)</h3><p>New Relic License Key (recommended) <a href="../secret/">Secret</a>.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-bb72140946679f3fa6eaf82e404ea444">4.8.4.25 - OpenSearch</h1><h1 id="opensearch-output-plugin-for-fluentd">OpenSearch output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>For details, see <a href="https://github.com/fluent/fluent-plugin-opensearch">https://github.com/fluent/fluent-plugin-opensearch</a>.</p><p>For an example deployment, see <a href="../../../../quickstarts/es-nginx/">Save all logs to OpenSearch</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">opensearch</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">opensearch-cluster.default.svc.cluster.local</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">9200</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">scheme</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">ssl_verify</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">ssl_version</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">TLSv1_2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">30s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_use_utc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="opensearch">OpenSearch</h2><p>Send your logs to OpenSearch</p><h3 id="opensearch-application_name">application_name (*string, optional)</h3><p>Specify the application name for the rollover index to be created.</p><p>Default: default</p><h3 id="opensearch-buffer">buffer (*Buffer, optional)</h3><h3 id="opensearch-bulk_message_request_threshold">bulk_message_request_threshold (string, optional)</h3><p>Configure bulk_message request splitting threshold size. Default value is 20MB. (20 * 1024 * 1024) If you specify this size as negative number, bulk_message request splitting feature will be disabled.</p><p>Default: 20MB</p><h3 id="opensearch-catch_transport_exception_on_retry">catch_transport_exception_on_retry (*bool, optional)</h3><p>catch_transport_exception_on_retry (default: true)</p><p>Default: true</p><h3 id="opensearch-compression_level">compression_level (string, optional)</h3><p>compression_level</p><h3 id="opensearch-custom_headers">custom_headers (string, optional)</h3><p>This parameter adds additional headers to request. Example: <code>{"token":"secret"}</code></p><p>Default: {}</p><h3 id="opensearch-customize_template">customize_template (string, optional)</h3><p>Specify the string and its value to be replaced in form of hash. Can contain multiple key value pair that would be replaced in the specified template_file. This setting only creates template and to add rollover index please check the rollover_index configuration.</p><h3 id="opensearch-data_stream_enable">data_stream_enable (*bool, optional)</h3><p>Use @type opensearch_data_stream</p><h3 id="opensearch-data_stream_name">data_stream_name (string, optional)</h3><p>You can specify Opensearch data stream name by this parameter. This parameter is mandatory for opensearch_data_stream.</p><h3 id="opensearch-data_stream_template_name">data_stream_template_name (string, optional)</h3><p>Specify an existing index template for the data stream. If not present, a new template is created and named after the data stream.</p><p>Default: data_stream_name</p><h3 id="opensearch-default_opensearch_version">default_opensearch_version (int, optional)</h3><p>max_retry_get_os_version</p><p>Default: 1</p><h3 id="opensearch-emit_error_for_missing_id">emit_error_for_missing_id (bool, optional)</h3><p>emit_error_for_missing_id</p><p>Default: false</p><h3 id="opensearch-emit_error_label_event">emit_error_label_event (*bool, optional)</h3><p>emit_error_label_event (default: true)</p><p>Default: true</p><h3 id="opensearch-endpoint">endpoint (*OpenSearchEndpointCredentials, optional)</h3><p>AWS Endpoint Credentials</p><h3 id="opensearch-exception_backup">exception_backup (*bool, optional)</h3><p>Indicates whether to backup chunk when ignore exception occurs.</p><p>Default: true</p><h3 id="opensearch-fail_on_detecting_os_version_retry_exceed">fail_on_detecting_os_version_retry_exceed (*bool, optional)</h3><p>fail_on_detecting_os_version_retry_exceed (default: true)</p><p>Default: true</p><h3 id="opensearch-fail_on_putting_template_retry_exceed">fail_on_putting_template_retry_exceed (*bool, optional)</h3><p>Indicates whether to fail when max_retry_putting_template is exceeded. If you have multiple output plugin, you could use this property to do not fail on Fluentd statup.(default: true)</p><p>Default: true</p><h3 id="opensearch-flatten_hashes">flatten_hashes (bool, optional)</h3><p><a href="https://github.com/fluent/fluent-plugin-opensearch#hash-flattening">https://github.com/fluent/fluent-plugin-opensearch#hash-flattening</a></p><h3 id="opensearch-flatten_hashes_separator">flatten_hashes_separator (string, optional)</h3><p>Flatten separator</p><h3 id="opensearch-host">host (string, optional)</h3><p>You can specify OpenSearch host by this parameter.</p><p>Default: localhost</p><h3 id="opensearch-hosts">hosts (string, optional)</h3><p>You can specify multiple OpenSearch hosts with separator &ldquo;,&rdquo;. If you specify hosts option, host and port options are ignored.</p><h3 id="opensearch-http_backend">http_backend (string, optional)</h3><p>With http_backend typhoeus, the opensearch plugin uses typhoeus faraday http backend. Typhoeus can handle HTTP keepalive.</p><p>Default: excon</p><h3 id="opensearch-http_backend_excon_nonblock">http_backend_excon_nonblock (*bool, optional)</h3><p>http_backend_excon_nonblock</p><p>Default: true</p><h3 id="opensearch-id_key">id_key (string, optional)</h3><p>Field on your data to identify the data uniquely</p><h3 id="opensearch-ignore_exceptions">ignore_exceptions (string, optional)</h3><p>A list of exception that will be ignored - when the exception occurs the chunk will be discarded and the buffer retry mechanism won&rsquo;t be called. It is possible also to specify classes at higher level in the hierarchy.</p><h3 id="opensearch-include_index_in_url">include_index_in_url (bool, optional)</h3><p>With this option set to true, Fluentd manifests the index name in the request URL (rather than in the request body). You can use this option to enforce an URL-based access control.</p><h3 id="opensearch-include_tag_key">include_tag_key (bool, optional)</h3><p>This will add the Fluentd tag in the JSON record.</p><p>Default: false</p><h3 id="opensearch-include_timestamp">include_timestamp (bool, optional)</h3><p>Adds a @timestamp field to the log, following all settings logstash_format does, except without the restrictions on index_name. This allows one to log to an alias in OpenSearch and utilize the rollover API.</p><p>Default: false</p><h3 id="opensearch-index_date_pattern">index_date_pattern (*string, optional)</h3><p>Specify this to override the index date pattern for creating a rollover index.</p><p>Default: now/d</p><h3 id="opensearch-index_name">index_name (string, optional)</h3><p>The index name to write events to</p><p>Default: fluentd</p><h3 id="opensearch-index_separator">index_separator (string, optional)</h3><p>index_separator</p><p>Default: -</p><h3 id="opensearch-log_os_400_reason">log_os_400_reason (bool, optional)</h3><p>log_os_400_reason</p><p>Default: false</p><h3 id="opensearch-logstash_dateformat">logstash_dateformat (string, optional)</h3><p>Set the Logstash date format.</p><p>Default: %Y.%m.%d</p><h3 id="opensearch-logstash_format">logstash_format (bool, optional)</h3><p>Enable Logstash log format.</p><p>Default: false</p><h3 id="opensearch-logstash_prefix">logstash_prefix (string, optional)</h3><p>Set the Logstash prefix.</p><p>Default: logstash</p><h3 id="opensearch-logstash_prefix_separator">logstash_prefix_separator (string, optional)</h3><p>Set the Logstash prefix separator.</p><p>Default: -</p><h3 id="opensearch-max_retry_get_os_version">max_retry_get_os_version (int, optional)</h3><p>max_retry_get_os_version</p><p>Default: 15</p><h3 id="opensearch-max_retry_putting_template">max_retry_putting_template (string, optional)</h3><p>You can specify times of retry putting template.</p><p>Default: 10</p><h3 id="opensearch-parent_key">parent_key (string, optional)</h3><p>parent_key</p><h3 id="opensearch-password">password (*secret.Secret, optional)</h3><p>Password for HTTP Basic authentication. <a href="../secret/">Secret</a></p><h3 id="opensearch-path">path (string, optional)</h3><p>Path for HTTP Basic authentication.</p><h3 id="opensearch-pipeline">pipeline (string, optional)</h3><p>This param is to set a pipeline ID of your OpenSearch to be added into the request, you can configure ingest node.</p><h3 id="opensearch-port">port (int, optional)</h3><p>You can specify OpenSearch port by this parameter.</p><p>Default: 9200</p><h3 id="opensearch-prefer_oj_serializer">prefer_oj_serializer (bool, optional)</h3><p>With default behavior, OpenSearch client uses Yajl as JSON encoder/decoder. Oj is the alternative high performance JSON encoder/decoder. When this parameter sets as true, OpenSearch client uses Oj as JSON encoder/decoder.</p><p>Default: false</p><h3 id="opensearch-reconnect_on_error">reconnect_on_error (bool, optional)</h3><p>Indicates that the plugin should reset connection on any error (reconnect on next send). By default it will reconnect only on &ldquo;host unreachable exceptions&rdquo;. We recommended to set this true in the presence of OpenSearch shield.</p><p>Default: false</p><h3 id="opensearch-reload_after">reload_after (string, optional)</h3><p>When reload_connections true, this is the integer number of operations after which the plugin will reload the connections. The default value is 10000.</p><h3 id="opensearch-reload_connections">reload_connections (*bool, optional)</h3><p>You can tune how the OpenSearch-transport host reloading feature works.(default: true)</p><p>Default: true</p><h3 id="opensearch-reload_on_failure">reload_on_failure (bool, optional)</h3><p>Indicates that the OpenSearch-transport will try to reload the nodes addresses if there is a failure while making the request, this can be useful to quickly remove a dead node from the list of addresses.</p><p>Default: false</p><h3 id="opensearch-remove_keys">remove_keys (string, optional)</h3><p><a href="https://github.com/fluent/fluent-plugin-opensearch#remove_keys">https://github.com/fluent/fluent-plugin-opensearch#remove_keys</a></p><h3 id="opensearch-remove_keys_on_update">remove_keys_on_update (string, optional)</h3><p>Remove keys on update will not update the configured keys in OpenSearch when a record is being updated. This setting only has any effect if the write operation is update or upsert.</p><h3 id="opensearch-remove_keys_on_update_key">remove_keys_on_update_key (string, optional)</h3><p>This setting allows remove_keys_on_update to be configured with a key in each record, in much the same way as target_index_key works.</p><h3 id="opensearch-request_timeout">request_timeout (string, optional)</h3><p>You can specify HTTP request timeout.</p><p>Default: 5s</p><h3 id="opensearch-resurrect_after">resurrect_after (string, optional)</h3><p>You can set in the OpenSearch-transport how often dead connections from the OpenSearch-transport&rsquo;s pool will be resurrected.</p><p>Default: 60s</p><h3 id="opensearch-retry_tag">retry_tag (string, optional)</h3><p>This setting allows custom routing of messages in response to bulk request failures. The default behavior is to emit failed records using the same tag that was provided.</p><h3 id="opensearch-routing_key">routing_key (string, optional)</h3><p>routing_key</p><h3 id="opensearch-ca_file">ca_file (*secret.Secret, optional)</h3><p>CA certificate</p><h3 id="opensearch-client_cert">client_cert (*secret.Secret, optional)</h3><p>Client certificate</p><h3 id="opensearch-client_key">client_key (*secret.Secret, optional)</h3><p>Client certificate key</p><h3 id="opensearch-client_key_pass">client_key_pass (*secret.Secret, optional)</h3><p>Client key password</p><h3 id="opensearch-scheme">scheme (string, optional)</h3><p>Connection scheme</p><p>Default: http</p><h3 id="opensearch-selector_class_name">selector_class_name (string, optional)</h3><p>selector_class_name</p><h3 id="opensearch-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, Fluentd logs a warning message and increases the <code>fluentd_output_status_slow_flush_count</code> metric.</p><h3 id="opensearch-sniffer_class_name">sniffer_class_name (string, optional)</h3><p>The default Sniffer used by the OpenSearch::Transport class works well when Fluentd has a direct connection to all of the OpenSearch servers and can make effective use of the _nodes API. This doesn&rsquo;t work well when Fluentd must connect through a load balancer or proxy. The <code>sniffer_class_name</code> parameter gives you the ability to provide your own Sniffer class to implement whatever connection reload logic you require. In addition, there is a new Fluent::Plugin::OpenSearchSimpleSniffer class which reuses the hosts given in the configuration, which is typically the hostname of the load balancer or proxy. For example, a configuration like this would cause connections to logging-os to reload every 100 operations: <a href="https://github.com/fluent/fluent-plugin-opensearch#sniffer-class-name">https://github.com/fluent/fluent-plugin-opensearch#sniffer-class-name</a>.</p><h3 id="opensearch-ssl_verify">ssl_verify (*bool, optional)</h3><p>Skip ssl verification (default: true)</p><p>Default: true</p><h3 id="opensearch-ssl_version">ssl_version (string, optional)</h3><p>If you want to configure SSL/TLS version, you can specify ssl_version parameter. [SSLv23, TLSv1, TLSv1_1, TLSv1_2]</p><h3 id="opensearch-suppress_doc_wrap">suppress_doc_wrap (bool, optional)</h3><p>By default, record body is wrapped by &lsquo;doc&rsquo;. This behavior can not handle update script requests. You can set this to suppress doc wrapping and allow record body to be untouched.</p><p>Default: false</p><h3 id="opensearch-suppress_type_name">suppress_type_name (*bool, optional)</h3><p>Suppress type name to avoid warnings in OpenSearch</p><h3 id="opensearch-tag_key">tag_key (string, optional)</h3><p>This will add the Fluentd tag in the JSON record.</p><p>Default: tag</p><h3 id="opensearch-target_index_affinity">target_index_affinity (bool, optional)</h3><p>target_index_affinity</p><p>Default: false</p><h3 id="opensearch-target_index_key">target_index_key (string, optional)</h3><p>Tell this plugin to find the index name to write to in the record under this key in preference to other mechanisms. Key can be specified as path to nested record using dot (&rsquo;.&rsquo;) as a separator.</p><h3 id="opensearch-template_file">template_file (*secret.Secret, optional)</h3><p>The path to the file containing the template to install. <a href="../secret/">Secret</a></p><h3 id="opensearch-template_name">template_name (string, optional)</h3><p>The name of the template to define. If a template by the name given is already present, it will be left unchanged, unless template_overwrite is set, in which case the template will be updated.</p><h3 id="opensearch-template_overwrite">template_overwrite (bool, optional)</h3><p>Always update the template, even if it already exists.</p><p>Default: false</p><h3 id="opensearch-templates">templates (string, optional)</h3><p>Specify index templates in form of hash. Can contain multiple templates.</p><h3 id="opensearch-time_key">time_key (string, optional)</h3><p>By default, when inserting records in Logstash format, @timestamp is dynamically created with the time at log ingestion. If you&rsquo;d like to use a custom time, include an @timestamp with your record.</p><h3 id="opensearch-time_key_exclude_timestamp">time_key_exclude_timestamp (bool, optional)</h3><p>time_key_exclude_timestamp</p><p>Default: false</p><h3 id="opensearch-time_key_format">time_key_format (string, optional)</h3><p>The format of the time stamp field (@timestamp or what you specify with <code>time_key</code>). This parameter only has an effect when logstash_format is true as it only affects the name of the index we write to.</p><h3 id="opensearch-time_parse_error_tag">time_parse_error_tag (string, optional)</h3><p>With logstash_format true, OpenSearch plugin parses timestamp field for generating index name. If the record has invalid timestamp value, this plugin emits an error event to @ERROR label with <code>time_parse_error_tag</code> configured tag.</p><h3 id="opensearch-time_precision">time_precision (string, optional)</h3><p>Should the record not include a time_key, define the degree of sub-second time precision to preserve from the time portion of the routed event.</p><h3 id="opensearch-truncate_caches_interval">truncate_caches_interval (string, optional)</h3><p>truncate_caches_interval</p><h3 id="opensearch-unrecoverable_error_types">unrecoverable_error_types (string, optional)</h3><p>Default unrecoverable_error_types parameter is set up strictly. Because rejected_execution_exception is caused by exceeding OpenSearch&rsquo;s thread pool capacity. Advanced users can increase its capacity, but normal users should follow default behavior.</p><h3 id="opensearch-unrecoverable_record_types">unrecoverable_record_types (string, optional)</h3><p>unrecoverable_record_types</p><h3 id="opensearch-use_legacy_template">use_legacy_template (*bool, optional)</h3><p>Specify wether to use legacy template or not.</p><p>Default: true</p><h3 id="opensearch-user">user (string, optional)</h3><p>User for HTTP Basic authentication. This plugin will escape required URL encoded characters within %{} placeholders. e.g. <code>%{demo+}</code></p><h3 id="opensearch-utc_index">utc_index (*bool, optional)</h3><p>By default, the records inserted into index logstash-YYMMDD with UTC (Coordinated Universal Time). This option allows to use local time if you describe <code>utc_index</code> to false.</p><p>Default: true</p><h3 id="opensearch-validate_client_version">validate_client_version (bool, optional)</h3><p>When you use mismatched OpenSearch server and client libraries, fluent-plugin-opensearch cannot send data into OpenSearch.</p><p>Default: false</p><h3 id="opensearch-verify_os_version_at_startup">verify_os_version_at_startup (*bool, optional)</h3><p>verify_os_version_at_startup (default: true)</p><p>Default: true</p><h3 id="opensearch-with_transporter_log">with_transporter_log (bool, optional)</h3><p>This is debugging purpose option to enable to obtain transporter layer log.</p><p>Default: false</p><h3 id="opensearch-write_operation">write_operation (string, optional)</h3><p>The write_operation can be any of: (index,create,update,upsert)</p><p>Default: index</p><h2 id="opensearchendpointcredentials">OpenSearchEndpointCredentials</h2><h3 id="opensearchendpointcredentials-access_key_id">access_key_id (*secret.Secret, optional)</h3><p>AWS access key id. This parameter is required when your agent is not running on EC2 instance with an IAM Role.</p><h3 id="opensearchendpointcredentials-assume_role_arn">assume_role_arn (*secret.Secret, optional)</h3><p>Typically, you can use AssumeRole for cross-account access or federation.</p><h3 id="opensearchendpointcredentials-assume_role_session_name">assume_role_session_name (*secret.Secret, optional)</h3><p><a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html">AssumeRoleWithWebIdentity</a></p><h3 id="opensearchendpointcredentials-assume_role_web_identity_token_file">assume_role_web_identity_token_file (*secret.Secret, optional)</h3><p><a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html">AssumeRoleWithWebIdentity</a></p><h3 id="opensearchendpointcredentials-ecs_container_credentials_relative_uri">ecs_container_credentials_relative_uri (*secret.Secret, optional)</h3><p>Set with AWS_CONTAINER_CREDENTIALS_RELATIVE_URI environment variable value</p><h3 id="opensearchendpointcredentials-region">region (string, optional)</h3><p>AWS region. It should be in form like us-east-1, us-west-2. Default nil, which means try to find from environment variable AWS_REGION.</p><h3 id="opensearchendpointcredentials-secret_access_key">secret_access_key (*secret.Secret, optional)</h3><p>AWS secret key. This parameter is required when your agent is not running on EC2 instance with an IAM Role.</p><h3 id="opensearchendpointcredentials-sts_credentials_region">sts_credentials_region (*secret.Secret, optional)</h3><p>By default, the AWS Security Token Service (AWS STS) is available as a global service, and all AWS STS requests go to a single endpoint at <a href="https://sts.amazonaws.com">https://sts.amazonaws.com</a>. AWS recommends using Regional AWS STS endpoints instead of the global endpoint to reduce latency, build in redundancy, and increase session token validity. <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_enable-regions.html">https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_enable-regions.html</a></p><h3 id="opensearchendpointcredentials-url">url (string, required)</h3><p>AWS connection url.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-ef25dbf7203fc85cd0c4a189a702360a">4.8.4.26 - Redis</h1><h1 id="redis-plugin-for-fluentd">Redis plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>Sends logs to Redis endpoints. For details, see <a href="https://github.com/fluent-plugins-nursery/fluent-plugin-redis">https://github.com/fluent-plugins-nursery/fluent-plugin-redis</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">redis</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">redis-master.prod.svc.cluster.local</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">tags</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">flush_interval</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="output-config-allow_duplicate_key">allow_duplicate_key (bool, optional)</h3><p>Allow inserting key duplicate. It will work as update values.</p><p>Default: false</p><h3 id="output-config-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="output-config-db_number">db_number (int, optional)</h3><p>DbNumber database number is optional.</p><p>Default: 0</p><h3 id="output-config-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="output-config-host">host (string, optional)</h3><p>Host Redis endpoint</p><p>Default: localhost</p><h3 id="output-config-insert_key_prefix">insert_key_prefix (string, optional)</h3><p>insert_key_prefix</p><p>Default: &ldquo;${tag}&rdquo;</p><h3 id="output-config-password">password (*secret.Secret, optional)</h3><p>Redis Server password</p><h3 id="output-config-port">port (int, optional)</h3><p>Port of the Redis server</p><p>Default: 6379</p><h3 id="output-config-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, Fluentd logs a warning message and increases the <code>fluentd_output_status_slow_flush_count</code> metric.</p><h3 id="output-config-strftime_format">strftime_format (string, optional)</h3><p>Users can set strftime format.</p><p>Default: &ldquo;%s&rdquo;</p><h3 id="output-config-ttl">ttl (int, optional)</h3><p>If 0 or negative value is set, ttl is not set in each key.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-67b66da64354abd24b6cf4012f300c3a">4.8.4.27 - Relabel</h1><p>Available in Logging Operator version 4.2 and later.</p><p>The relabel output uses the <a href="https://docs.fluentd.org/output/relabel">relabel output plugin of Fluentd</a> to route events back to a specific Flow, where they can be processed again.</p><p>This is useful, for example, if you need to preprocess a subset of logs differently, but then do the same processing on all messages at the end. In this case, you can create multiple flows for preprocessing based on specific log matchers and then aggregate everything into a single final flow for postprocessing.</p><p>The value of the <code>label</code> parameter of the relabel output must be the same as the value of the <code>flowLabel</code> parameter of the Flow (or ClusterFlow) where you want to send the messages.</p><p>For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ClusterOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">final-relabel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">relabel</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">label</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;@final-flow&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">serviceFlow1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">namespace1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:700">[]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">globalOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">final-relabel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">service1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">serviceFlow2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">namespace2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:700">[]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">globalOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">final-relabel</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">app</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">service2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ClusterFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">final-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">flowLabel</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#39;@final-flow&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">includeLabelInRouter</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:700">[]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Using the relabel output also makes it possible to pass the messages emitted by the <a href="/5.1/docs/configuration/plugins/filters/concat/">Concat</a> plugin in case of a timeout. Set the <code>timeout_label</code> of the concat plugin to the flowLabel of the flow where you want to send the timeout messages.</p><h2 id="output-config">Output Config</h2><h3 id="label-string-required-output-config-label">label (string, required) {#output config-label}</h3><p>Specifies new label for events</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-65dde214a849324898de8fc0878b8ff4">4.8.4.28 - Splunk</h1><h1 id="splunk-via-hec-output-plugin-for-fluentd">Splunk via Hec output plugin for Fluentd</h1><h2 id="overview">Overview</h2><p>For details, see <a href="https://github.com/splunk/fluent-plugin-splunk-hec">https://github.com/splunk/fluent-plugin-splunk-hec</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">splunkHec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">hec_host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">splunk.default.svc.cluster.local</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">hec_port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">8088</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">protocol</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="splunkhecoutput">SplunkHecOutput</h2><p>SplunkHecOutput sends your logs to Splunk via Hec</p><h3 id="splunkhecoutput-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="splunkhecoutput-ca_file">ca_file (*secret.Secret, optional)</h3><p>The path to a file containing a PEM-format CA certificate. <a href="../secret/">Secret</a></p><h3 id="splunkhecoutput-ca_path">ca_path (*secret.Secret, optional)</h3><p>The path to a directory containing CA certificates in PEM format. <a href="../secret/">Secret</a></p><h3 id="splunkhecoutput-client_cert">client_cert (*secret.Secret, optional)</h3><p>The path to a file containing a PEM-format CA certificate for this client. <a href="../secret/">Secret</a></p><h3 id="splunkhecoutput-client_key">client_key (*secret.Secret, optional)</h3><p>The private key for this client.&rsquo; <a href="../secret/">Secret</a></p><h3 id="splunkhecoutput-coerce_to_utf8">coerce_to_utf8 (*bool, optional)</h3><p>Indicates whether to allow non-UTF-8 characters in user logs. If set to true, any non-UTF-8 character is replaced by the string specified in non_utf8_replacement_string. If set to false, the Ingest API errors out any non-UTF-8 characters. .</p><p>Default: true</p><h3 id="splunkhecoutput-data_type">data_type (string, optional)</h3><p>The type of data that will be sent to Sumo Logic, either event or metric</p><p>Default: event</p><h3 id="splunkhecoutput-fields">fields (Fields, optional)</h3><p>In this case, parameters inside <code>&lt;fields></code> are used as indexed fields and removed from the original input events</p><h3 id="splunkhecoutput-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="splunkhecoutput-hec_host">hec_host (string, required)</h3><p>You can specify SplunkHec host by this parameter.</p><h3 id="splunkhecoutput-hec_port">hec_port (int, optional)</h3><p>The port number for the Hec token or the Hec load balancer.</p><p>Default: 8088</p><h3 id="splunkhecoutput-hec_token">hec_token (*secret.Secret, required)</h3><p>Identifier for the Hec token. <a href="../secret/">Secret</a></p><h3 id="splunkhecoutput-host">host (string, optional)</h3><p>The host location for events. Cannot set both host and host_key parameters at the same time. (Default:hostname)</p><h3 id="splunkhecoutput-host_key">host_key (string, optional)</h3><p>Key for the host location. Cannot set both host and host_key parameters at the same time.</p><h3 id="splunkhecoutput-idle_timeout">idle_timeout (int, optional)</h3><p>If a connection has not been used for this number of seconds it will automatically be reset upon the next use to avoid attempting to send to a closed connection. nil means no timeout.</p><h3 id="splunkhecoutput-index">index (string, optional)</h3><p>Identifier for the Splunk index to be used for indexing events. If this parameter is not set, the indexer is chosen by HEC. Cannot set both index and index_key parameters at the same time.</p><h3 id="splunkhecoutput-index_key">index_key (string, optional)</h3><p>The field name that contains the Splunk index name. Cannot set both index and index_key parameters at the same time.</p><h3 id="splunkhecoutput-insecure_ssl">insecure_ssl (*bool, optional)</h3><p>Indicates if insecure SSL connection is allowed</p><p>Default: false</p><h3 id="splunkhecoutput-keep_keys">keep_keys (bool, optional)</h3><p>By default, all the fields used by the *_key parameters are removed from the original input events. To change this behavior, set this parameter to true. This parameter is set to false by default. When set to true, all fields defined in <code>index_key</code>, <code>host_key</code>, <code>source_key</code>, <code>sourcetype_key</code>, <code>metric_name_key</code>, and <code>metric_value_key</code> are saved in the original event.</p><h3 id="splunkhecoutput-metric_name_key">metric_name_key (string, optional)</h3><p>Field name that contains the metric name. This parameter only works in conjunction with the metrics_from_event parameter. When this prameter is set, the <code>metrics_from_event</code> parameter is automatically set to false.</p><p>Default: true</p><h3 id="splunkhecoutput-metric_value_key">metric_value_key (string, optional)</h3><p>Field name that contains the metric value, this parameter is required when <code>metric_name_key</code> is configured.</p><h3 id="splunkhecoutput-metrics_from_event">metrics_from_event (*bool, optional)</h3><p>When data_type is set to &ldquo;metric&rdquo;, the ingest API will treat every key-value pair in the input event as a metric name-value pair. Set metrics_from_event to false to disable this behavior and use <code>metric_name_key</code> and <code>metric_value_key</code> to define metrics. (Default:true)</p><h3 id="splunkhecoutput-non_utf8_replacement_string">non_utf8_replacement_string (string, optional)</h3><p>If coerce_to_utf8 is set to true, any non-UTF-8 character is replaced by the string you specify in this parameter. .</p><p>Default: &rsquo; '</p><h3 id="splunkhecoutput-open_timeout">open_timeout (int, optional)</h3><p>The amount of time to wait for a connection to be opened.</p><h3 id="splunkhecoutput-protocol">protocol (string, optional)</h3><p>This is the protocol to use for calling the Hec API. Available values are: http, https.</p><p>Default: https</p><h3 id="splunkhecoutput-read_timeout">read_timeout (int, optional)</h3><p>The amount of time allowed between reading two chunks from the socket.</p><h3 id="splunkhecoutput-ssl_ciphers">ssl_ciphers (string, optional)</h3><p>List of SSL ciphers allowed.</p><h3 id="splunkhecoutput-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="splunkhecoutput-source">source (string, optional)</h3><p>The source field for events. If this parameter is not set, the source will be decided by HEC. Cannot set both source and source_key parameters at the same time.</p><h3 id="splunkhecoutput-source_key">source_key (string, optional)</h3><p>Field name to contain source. Cannot set both source and source_key parameters at the same time.</p><h3 id="splunkhecoutput-sourcetype">sourcetype (string, optional)</h3><p>The sourcetype field for events. When not set, the sourcetype is decided by HEC. Cannot set both source and <code>source_key</code> parameters at the same time.</p><h3 id="splunkhecoutput-sourcetype_key">sourcetype_key (string, optional)</h3><p>Field name that contains the sourcetype. Cannot set both source and source_key parameters at the same time.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-f239285458b59ea6270063a2b99b095d">4.8.4.29 - SQS</h1><h1 id="sqs-outputhttpsgithubcomixixifluent-plugin-sqs"><a href="https://github.com/ixixi/fluent-plugin-sqs">SQS Output</a></h1><h2 id="overview">Overview</h2><p>Fluentd output plugin for SQS.</p><h2 id="configuration">Configuration</h2><h2 id="output-config">Output Config</h2><h3 id="output-config-aws_key_id">aws_key_id (*secret.Secret, optional)</h3><p>AWS access key id</p><h3 id="output-config-aws_sec_key">aws_sec_key (*secret.Secret, optional)</h3><p>AWS secret key</p><h3 id="output-config-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="output-config-create_queue">create_queue (*bool, optional)</h3><p>Create SQS queue</p><p>Default: true</p><h3 id="output-config-delay_seconds">delay_seconds (int, optional)</h3><p>Delivery delay seconds</p><p>Default: 0</p><h3 id="output-config-include_tag">include_tag (*bool, optional)</h3><p>Include tag</p><p>Default: true</p><h3 id="output-config-message_group_id">message_group_id (string, optional)</h3><p>Message group id for FIFO queue</p><h3 id="output-config-queue_name">queue_name (string, optional)</h3><p>SQS queue name - required if sqs_url is not set</p><h3 id="output-config-region">region (string, optional)</h3><p>AWS region</p><p>Default: ap-northeast-1</p><h3 id="sqs_url-string-optional-output-config-sqs_url">sqs_url (string, optional) {#output config-sqs_url}</h3><p>SQS queue url e.g. <code>https://sqs.us-west-2.amazonaws.com/123456789012/myqueue</code></p><h3 id="output-config-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="output-config-tag_property_name">tag_property_name (string, optional)</h3><p>Tags property name in json</p><p>Default: &lsquo;__tag&rsquo;</p><h2 id="example-sqs-output-configurations">Example <code>SQS</code> output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sqs-output-sample</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">sqs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">queue_name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">some-aws-sqs-queue</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">create_queue</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">region</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">us-east-1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;match</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>    @type sqs
</span></span><span style="display:flex"><span>    @id test_sqs
</span></span><span style="display:flex"><span>    queue_name some-aws-sqs-queue
</span></span><span style="display:flex"><span>    create_queue false
</span></span><span style="display:flex"><span>    region us-east-1
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/match&gt;</span>
</span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-014aa24ff26bb6369dc8484f097d845d">4.8.4.30 - Syslog</h1><h1 id="syslog-outputhttpsgithubcomcloudfoundryfluent-plugin-syslog_rfc5424"><a href="https://github.com/cloudfoundry/fluent-plugin-syslog_rfc5424">Syslog Output</a></h1><h2 id="overview">Overview</h2><p>Fluentd output plugin for remote syslog with RFC5424 headers logs.</p><h2 id="configuration">Configuration</h2><h2 id="syslogoutputconfig">SyslogOutputConfig</h2><h3 id="syslogoutputconfig-allow_self_signed_cert">allow_self_signed_cert (*bool, optional)</h3><p>allow_self_signed_cert for mutual tls</p><p>Default: false</p><h3 id="syslogoutputconfig-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="syslogoutputconfig-client_cert_path">client_cert_path (*secret.Secret, optional)</h3><p>file path for private_key_path</p><h3 id="syslogoutputconfig-enable_system_cert_store">enable_system_cert_store (*bool, optional)</h3><p>cert_store to set ca_certificate for ssl context</p><h3 id="syslogoutputconfig-format">format (*FormatRfc5424, optional)</h3><p><a href="../format_rfc5424/">Format</a></p><h3 id="syslogoutputconfig-fqdn">fqdn (string, optional)</h3><p>Fqdn</p><p>Default: &ldquo;nil&rdquo;</p><h3 id="syslogoutputconfig-host">host (string, required)</h3><p>Destination host address</p><h3 id="syslogoutputconfig-insecure">insecure (*bool, optional)</h3><p>skip ssl validation</p><p>Default: false</p><h3 id="syslogoutputconfig-port">port (int, optional)</h3><p>Destination host port</p><p>Default: &ldquo;514&rdquo;</p><h3 id="syslogoutputconfig-private_key_passphrase">private_key_passphrase (*secret.Secret, optional)</h3><p>PrivateKeyPassphrase for private key</p><p>Default: &ldquo;nil&rdquo;</p><h3 id="syslogoutputconfig-private_key_path">private_key_path (*secret.Secret, optional)</h3><p>file path for private_key_path</p><h3 id="syslogoutputconfig-slow_flush_log_threshold">slow_flush_log_threshold (string, optional)</h3><p>The threshold for chunk flush performance check. Parameter type is float, not time, default: 20.0 (seconds) If chunk flush takes longer time than this threshold, fluentd logs warning message and increases metric fluentd_output_status_slow_flush_count.</p><h3 id="syslogoutputconfig-transport">transport (string, optional)</h3><p>Transport Protocol</p><p>Default: &ldquo;tls&rdquo;</p><h3 id="syslogoutputconfig-trusted_ca_path">trusted_ca_path (*secret.Secret, optional)</h3><p>file path to ca to trust</p><h3 id="syslogoutputconfig-verify_fqdn">verify_fqdn (*bool, optional)</h3><p>verify_fqdn</p><p>Default: nil</p><h3 id="syslogoutputconfig-version">version (string, optional)</h3><p>TLS Version</p><p>Default: &ldquo;TLSv1_2&rdquo;</p><h2 id="example-file-output-configurations">Example <code>File</code> output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslog</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SYSLOG-HOST</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">123</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">app_name_field</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example.custom_field_1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">proc_id_field</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example.custom_field_2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timekey_use_utc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span></span></span></code></pre></div><p>Fluentd config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;match</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>	@type syslog_rfc5424
</span></span><span style="display:flex"><span>	@id test_syslog
</span></span><span style="display:flex"><span>	host SYSLOG-HOST
</span></span><span style="display:flex"><span>	port 123
</span></span><span style="display:flex"><span> <span style="color:#204a87;font-weight:700">&lt;format&gt;</span>
</span></span><span style="display:flex"><span>   @type syslog_rfc5424
</span></span><span style="display:flex"><span>   app_name_field example.custom_field_1
</span></span><span style="display:flex"><span>   proc_id_field example.custom_field_2
</span></span><span style="display:flex"><span> <span style="color:#204a87;font-weight:700">&lt;/format&gt;</span>
</span></span><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">&lt;buffer</span> <span style="color:#a40000">tag,time</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>	  @type file
</span></span><span style="display:flex"><span>	  path /buffers/test_file.*.buffer
</span></span><span style="display:flex"><span>	  retry_forever true
</span></span><span style="display:flex"><span>	  timekey 1m
</span></span><span style="display:flex"><span>	  timekey_use_utc true
</span></span><span style="display:flex"><span>	  timekey_wait 30s
</span></span><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">&lt;/buffer&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/match&gt;</span></span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-1f1e7ebd2a7521c62ebb908f2d9dc6d4">4.8.4.31 - VMware Log Intelligence</h1><h2 id="overview">Overview</h2><p>VMware Log Intelligence output plugin for Fluentd. For details, see <a href="https://github.com/vmware/fluent-plugin-vmware-log-intelligence">https://github.com/vmware/fluent-plugin-vmware-log-intelligence</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">vmwarelogintelligence</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">endpoint_url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://data.upgrade.symphony-dev.com/le-mans/v1/streams/ingestion-pipeline-stream</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">verify_ssl</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">http_compress</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">headers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">content_type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;application/json&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">authorization</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">vmware-log-intelligence-token</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">authorization</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">structure</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">chunk_limit_records</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">300</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">flush_interval</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">3s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">retry_max_times</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="vmwarelogintelligence">VMwareLogIntelligence</h2><h3 id="vmwarelogintelligence-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="vmwarelogintelligence-endpoint_url">endpoint_url (string, required)</h3><p>Log Intelligence endpoint to send logs to <a href="https://github.com/vmware/fluent-plugin-vmware-log-intelligence?tab=readme-ov-file#label-endpoint_url">https://github.com/vmware/fluent-plugin-vmware-log-intelligence?tab=readme-ov-file#label-endpoint_url</a></p><h3 id="vmwarelogintelligence-format">format (*Format, optional)</h3><p><a href="../format/">Format</a></p><h3 id="vmwarelogintelligence-http_compress">http_compress (*bool, optional)</h3><p>Compress http request <a href="https://github.com/vmware/fluent-plugin-vmware-log-intelligence?tab=readme-ov-file#label-http_compress">https://github.com/vmware/fluent-plugin-vmware-log-intelligence?tab=readme-ov-file#label-http_compress</a></p><h3 id="vmwarelogintelligence-headers">headers (LogIntelligenceHeaders, required)</h3><p>Required headers for sending logs to VMware Log Intelligence <a href="https://github.com/vmware/fluent-plugin-vmware-log-intelligence?tab=readme-ov-file#label-3Cheaders-3E">https://github.com/vmware/fluent-plugin-vmware-log-intelligence?tab=readme-ov-file#label-3Cheaders-3E</a></p><h3 id="vmwarelogintelligence-verify_ssl">verify_ssl (*bool, required)</h3><p>Verify SSL (default: true) <a href="https://github.com/vmware/fluent-plugin-vmware-log-intelligence?tab=readme-ov-file#label-verify_ssl">https://github.com/vmware/fluent-plugin-vmware-log-intelligence?tab=readme-ov-file#label-verify_ssl</a></p><p>Default: true</p><h2 id="vmwarelogintelligenceheaders">VMwareLogIntelligenceHeaders</h2><p>headers
<a href="https://github.com/vmware/fluent-plugin-vmware-log-intelligence?tab=readme-ov-file#label-3Cheaders-3E">https://github.com/vmware/fluent-plugin-vmware-log-intelligence?tab=readme-ov-file#label-3Cheaders-3E</a></p><h3 id="vmwarelogintelligenceheaders-authorization">authorization (*secret.Secret, required)</h3><p>Authorization Bearer token for http request to VMware Log Intelligence <a href="../secret/">Secret</a></p><h3 id="vmwarelogintelligenceheaders-content_type">content_type (string, required)</h3><p>Content Type for http request to VMware Log Intelligence</p><p>Default: application/json</p><h3 id="vmwarelogintelligenceheaders-structure">structure (string, required)</h3><p>Structure for http request to VMware Log Intelligence</p><p>Default: simple</p><h2 id="logintelligenceheadersout">LogIntelligenceHeadersOut</h2><p>LogIntelligenceHeadersOut is used to convert the input LogIntelligenceHeaders to a fluentd
output that uses the correct key names for the VMware Log Intelligence plugin. This allows the
Ouput to accept the config is snake_case (as other output plugins do) but output the fluentd
<headers> config with the proper key names (ie. content_type -> Content-Type)</p><h3 id="logintelligenceheadersout-authorization">Authorization (*secret.Secret, required)</h3><p>Authorization Bearer token for http request to VMware Log Intelligence</p><h3 id="logintelligenceheadersout-content-type">Content-Type (string, required)</h3><p>Content Type for http request to VMware Log Intelligence</p><p>Default: application/json</p><h3 id="logintelligenceheadersout-structure">structure (string, required)</h3><p>Structure for http request to VMware Log Intelligence</p><p>Default: simple</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-0102b64d79d8ea746d1515b5bde58add">4.8.4.32 - VMware LogInsight</h1><h2 id="overview">Overview</h2><p>VMware LogInsight output plugin for Fluentd. For details, see <a href="https://github.com/vmware/fluent-plugin-vmware-loginsight">https://github.com/vmware/fluent-plugin-vmware-loginsight</a>.</p><h2 id="example-output-configurations">Example output configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">vmwareLogInsight</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">scheme</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">ssl_verify</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">MY_LOGINSIGHT_HOST</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">9543</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">agent_id</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">log_text_keys</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span>- <span style="color:#000">log</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span>- <span style="color:#000">msg</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">	</span>- <span style="color:#000">message</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">http_conn_debug</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="vmwareloginsight">VMwareLogInsight</h2><p>Send your logs to VMware LogInsight</p><h3 id="vmwareloginsight-agent_id">agent_id (string, optional)</h3><p>agent_id generated by your LI</p><p>Default: 0</p><h3 id="vmwareloginsight-authentication">authentication (*string, optional)</h3><p>Type of authentication to use (nil,basic)</p><p>Default: nil</p><h3 id="vmwareloginsight-buffer">buffer (*Buffer, optional)</h3><p><a href="../buffer/">Buffer</a></p><h3 id="vmwareloginsight-ca_file">ca_file (*secret.Secret, optional)</h3><p><a href="../secret/">Secret</a></p><h3 id="vmwareloginsight-config_param">config_param (map[string]string, optional)</h3><p>Rename fields names</p><p>Default: {&ldquo;source&rdquo; => &ldquo;log_source&rdquo;}</p><h3 id="vmwareloginsight-flatten_hashes">flatten_hashes (*bool, optional)</h3><p>Flatten hashes to create one key/val pair w/o losing log data</p><p>Default: true</p><h3 id="vmwareloginsight-flatten_hashes_separator">flatten_hashes_separator (string, optional)</h3><p>Separator to use for joining flattened keys</p><p>Default: _</p><h3 id="vmwareloginsight-http_conn_debug">http_conn_debug (bool, optional)</h3><p>If set, enables debug logs for http connection</p><p>Default: false</p><h3 id="vmwareloginsight-http_method">http_method (string, optional)</h3><p>HTTP method (post)</p><p>Default: post</p><h3 id="vmwareloginsight-host">host (string, optional)</h3><p>VMware Aria Operations For Logs Host ex. localhost</p><h3 id="vmwareloginsight-log_text_keys">log_text_keys ([]string, optional)</h3><p>Keys from log event whose values should be added as log message/text to VMware Aria Operations For Logs. These key/value pairs won&rsquo;t be expanded/flattened and won&rsquo;t be added as metadata/fields.</p><p>Default: [&ldquo;log&rdquo;, &ldquo;message&rdquo;, &ldquo;msg&rdquo;]</p><h3 id="vmwareloginsight-max_batch_size">max_batch_size (int, optional)</h3><p>Number of bytes per post request</p><p>Default: 4000000</p><h3 id="vmwareloginsight-password">password (*secret.Secret, optional)</h3><p><a href="../secret/">Secret</a></p><h3 id="vmwareloginsight-path">path (string, optional)</h3><p>VMware Aria Operations For Logs ingestion api path ex. &lsquo;api/v1/events/ingest&rsquo;</p><p>Default: api/v1/events/ingest</p><h3 id="vmwareloginsight-port">port (int, optional)</h3><p>VMware Aria Operations For Logs port ex. 9000</p><p>Default: 80</p><h3 id="vmwareloginsight-raise_on_error">raise_on_error (bool, optional)</h3><p>Raise errors that were rescued during HTTP requests?</p><p>Default: false</p><h3 id="vmwareloginsight-rate_limit_msec">rate_limit_msec (int, optional)</h3><p>Simple rate limiting: ignore any records within <code>rate_limit_msec</code> since the last one</p><p>Default: 0</p><h3 id="vmwareloginsight-request_retries">request_retries (int, optional)</h3><p>Number of retries</p><p>Default: 3</p><h3 id="vmwareloginsight-request_timeout">request_timeout (int, optional)</h3><p>http connection ttl for each request</p><p>Default: 5</p><h3 id="vmwareloginsight-ssl_verify">ssl_verify (*bool, optional)</h3><p>SSL verification flag</p><p>Default: true</p><h3 id="vmwareloginsight-scheme">scheme (string, optional)</h3><p>HTTP scheme (http,https)</p><p>Default: http</p><h3 id="vmwareloginsight-serializer">serializer (string, optional)</h3><p>Serialization (json)</p><p>Default: json</p><h3 id="vmwareloginsight-shorten_keys">shorten_keys (map[string]string, optional)</h3><p>Keys from log event to rewrite for instance from &lsquo;kubernetes_namespace&rsquo; to &lsquo;k8s_namespace&rsquo; tags will be rewritten with substring substitution and applied in the order present in the hash. Hashes enumerate their values in the order that the corresponding keys were inserted, see: <a href="https://ruby-doc.org/core-2.2.2/Hash.html">https://ruby-doc.org/core-2.2.2/Hash.html</a></p><p>Default: { &lsquo;kubernetes_&rsquo;:&lsquo;k8s_&rsquo;, &rsquo;namespace&rsquo;:&rsquo;ns&rsquo;, &rsquo;labels_&rsquo;:&rsquo;&rsquo;, &lsquo;_name&rsquo;:&rsquo;&rsquo;, &lsquo;<em>hash&rsquo;:&rsquo;&rsquo;, &lsquo;container</em>&rsquo;:&rsquo;&rsquo; }</p><h3 id="vmwareloginsight-username">username (*secret.Secret, optional)</h3><p><a href="../secret/">Secret</a></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-3effea023502f5f282b1bcfc984721f7">4.8.4.33 - Secret definition</h1><h2 id="define-secret-value">Define secret value</h2><p>Secrets can be used in logging-operator <code>Output</code> definitions.</p><blockquote>
<p>Secrets <em>MUST</em> be in the <em>SAME</em> namespace as the <code>Output</code> or <code>ClusterOutput</code> custom resource</p></blockquote><p><strong>Example secret definition</strong></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">aws_key_id</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;kubernetes-secret-name&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;kubernetes-secret-key&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For debug purposes you can define secret values directly. However this is <em>NOT</em> recommended in production.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">aws_key_id</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;secretvalue&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="define-secret-mount">Define secret mount</h2><p>There are cases when you can&rsquo;t inject secret into the configuration because the plugin need a file to read from. For this cases you can use <code>mountFrom</code>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">tls_cert_path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">mountFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;kubernetes-secret-name&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;kubernetes-secret-key&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>The operator will collect the secret and copy it to the <code>fluentd-output</code> secret. The fluentd configuration will contain the secret path.</p><p><strong>Example rendered configuration</strong></p><pre tabindex="0"><code>&lt;match **&gt;
    @type forward
    tls_cert_path /fluentd/etc/secret/default-fluentd-tls-tls.crt
    ...
&lt;/match&gt;
</code></pre><h3 id="how-it-works">How it works?</h3><p>Behind the scene the operator marks the secret with an annotation and watches it for changes as long as the annotation is present.</p><p><strong>Example annotated secret</strong></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Secret</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Opaque</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">annotations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">logging.banzaicloud.io/default</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">watched</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluentd-tls</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">data</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">tls.crt</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SGVsbG8gV29ybGQ=</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><blockquote>
<p>The annotation format is <code>logging.banzaicloud.io/&lt;loggingRef>: watched</code>. Since the <code>name</code> part of the an annotation can&rsquo;t be empty the <code>default</code> applies to empty <code>loggingRef</code> value as well.</p></blockquote><p>The mount path is generated from the secret information</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>/fluentd/etc/secret/<span style="color:#000">$namespace</span>-<span style="color:#000">$secret_name</span>-<span style="color:#000">$secret_key</span>
</span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-f82c0e1c4bdef1d77adef0a24aa2326c">4.8.5 - syslog-ng filters</h1><p>You can use the following <strong>syslog-ng</strong> filters in your <code>SyslogNGFlow</code> and <code>SyslogNGClusterFlow</code> resources.</p></div><div class="td-content">
<h1 id="pg-ed56f7c86144eb14193213bc7f89126f">4.8.5.1 - Match</h1><p>Match filters can be used to select the log records to process. These filters have the same options and syntax as <a href="/5.1/docs/configuration/log-routing-syslog-ng/">syslog-ng flow match expressions</a>. When matching for labels or annotations, the available labels and annotations depend on the incoming message received from the log collector agent. See this <a href="https://kubernetes.io/docs/reference/labels-annotations-taints/">list of common Kubernetes labels and annotations</a> for details.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">or</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">apache</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">string</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json.kubernetes.labels.app.kubernetes.io/name</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">string</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="matchexpr">MatchExpr</h2><h3 id="matchexpr-and">and ([]MatchExpr, optional)</h3><h3 id="matchexpr-not">not (*MatchExpr, optional)</h3><h3 id="matchexpr-or">or ([]MatchExpr, optional)</h3><h3 id="matchexpr-regexp">regexp (*RegexpMatchExpr, optional)</h3><p><a href="#Regexp-Directive">Regexp Directive</a></p><h2 id="Regexp-Directive">Regexp Directive</h2><p>Specify filtering rule. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/customizing-message-format/reference-template-functions/#template-function-list">AxoSyslog Core documentation</a></p><h3 id="regexp-directive-flags">flags ([]string, optional)</h3><p>Pattern flags. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/regular-expressions/reference-regexp-types/regexp-flags-options/">AxoSyslog Core documentation</a></p><h3 id="regexp-directive-pattern">pattern (string, required)</h3><p>Pattern expression to evaluate</p><h3 id="regexp-directive-template">template (string, optional)</h3><p>Specify a template of the record fields to match against.</p><h3 id="regexp-directive-type">type (string, optional)</h3><p>Pattern type. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/regular-expressions/reference-regexp-types/regexp-type-options/">AxoSyslog Core documentation</a></p><h3 id="regexp-directive-value">value (string, optional)</h3><p>Specify a field name of the record to match against the value of.</p><h2 id="example-regexp-filter-configurations">Example <code>Regexp</code> filter configurations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">demo-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">first</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">^5\d\d$</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">demo-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>syslog-ng config result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>log <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>    source<span style="color:#ce5c00;font-weight:700">(</span>main_input<span style="color:#ce5c00;font-weight:700">)</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>    filter <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>      match<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;^5\d\d</span>$<span style="color:#4e9a06">&#34;</span> value<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;first&#34;</span><span style="color:#ce5c00;font-weight:700">))</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>    <span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>    destination<span style="color:#ce5c00;font-weight:700">(</span>output_default_demo-output<span style="color:#ce5c00;font-weight:700">)</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span></code></pre></div><hr>
</div><div class="td-content" style="page-break-before:always">
<h1 id="pg-4afe8af7a86227831c993a592f328feb">4.8.5.2 - Parser</h1><p>Parser filters can be used to extract key-value pairs from message data. Logging operator currently supports the following parsers:</p><ul>
<li><a href="#metricsprobe">metrics-probe</a></li><li><a href="#regexp">regexp</a></li><li><a href="#syslog">syslog-parser</a></li></ul><h2 id="regexp">Regexp parser</h2><p>The regexp parser can use regular expressions to parse fields from a message.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">parser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">regexp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">patterns</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;.*test_field -&gt; (?&lt;test_field&gt;.*)$&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">prefix</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">.regexp.</span></span></span></code></pre></div><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-regexp/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="syslog">Syslog parser</h2><p>The syslog parser can parse syslog messages. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-syslog/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">parser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">syslog-parser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}</span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="parserhttpsaxoflowcomdocsaxosyslog-corechapter-parsers"><a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/">Parser</a></h2><h3 id="parser-metrics-probe">metrics-probe (*MetricsProbe, optional)</h3><p>Counts the messages that pass through the flow, and creates labeled stats counters based on the fields of the passing messages. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/metrics-probe/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="regexp-parser-patterns">regexp ([]string, required)</h3><p>The regular expression patterns that you want to find a match. <code>regexp-parser()</code> supports multiple patterns, and stops the processing at the first successful match. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-regexp/parser-regexp-options/#patterns">regexp-parser() documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="parser-syslog-parser">syslog-parser (*SyslogParser, optional)</h3><p>Parse message as a <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-syslog/">syslog message</a>.</p><h2 id="regexp-parserhttpsaxoflowcomdocsaxosyslog-corechapter-parsersparser-regexp"><a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-regexp/">Regexp parser</a></h2><h3 id="regexp-parser-flags">flags ([]string, optional)</h3><p>Flags to influence the behavior of the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-regexp/parser-regexp-options/">regexp-parser()</a>. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-regexp/parser-regexp-options/#flags">regexp-parser() documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="regexp-parser-patterns">patterns ([]string, required)</h3><p>The regular expression patterns that you want to find a match. <code>regexp-parser()</code> supports multiple patterns, and stops the processing at the first successful match. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-regexp/parser-regexp-options/#patterns">regexp-parser() documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="regexp-parser-prefix">prefix (string, optional)</h3><p>Insert a prefix before the name part of the parsed name-value pairs to help further processing. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-regexp/parser-regexp-options/#prefix">regexp-parser() documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="regexp-parser-template">template (string, optional)</h3><p>Specify a template of the record fields to match against. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-regexp/parser-regexp-options/#template">regexp-parser() documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="syslogparser">SyslogParser</h2><p>Parse message as a <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-syslog/">syslog message</a>.</p><h3 id="syslogparser-flags">flags ([]string, optional)</h3><p>Flags to influence the behavior of the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-syslog/parser-syslog-options/">syslog-parser()</a>. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/parser-syslog/parser-syslog-options/#flags">syslog-parser() documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="metricsprobe">MetricsProbe</h2><p>Counts the messages that pass through the flow, and creates labeled stats counters based on the fields of the passing messages. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/metrics-probe/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">SyslogNGFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">flow-mertrics-probe</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">parser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">metrics-probe</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;flow_events&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${json.kubernetes.namespace_name}&#34;</span></span></span></code></pre></div><h3 id="metricsprobe-key">key (string, optional)</h3><p>The name of the counter to create. Note that the value of this option is always prefixed with <code>syslogng_</code>, so for example <code>key("my-custom-key")</code> becomes <code>syslogng_my-custom-key</code>.</p><h3 id="metricsprobe-labels">labels (ArrowMap, optional)</h3><p>The labels used to create separate counters, based on the fields of the messages processed by <code>metrics-probe()</code>. The keys of the map are the name of the label, and the values are syslog-ng templates.</p><h3 id="metricsprobe-level">level (int, optional)</h3><p>Sets the stats level of the generated metrics (default 0).</p><h3 id="metricsprobe--">- (struct{}, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-71055e789d2740b4a21574d9424fd407">4.8.5.3 - Rewrite</h1><p>Rewrite filters can be used to modify record contents. Logging operator currently supports the following rewrite functions:</p><ul>
<li><a href="#groupunset">group_unset</a></li><li><a href="#rename">rename</a></li><li><a href="#set">set</a></li><li><a href="#subst">substitute</a></li><li><a href="#unset">unset</a></li></ul><blockquote>
<p>Note: All rewrite functions support an optional <code>condition</code> which has the same syntax as the <a href="../match/">match filter</a>.</p></blockquote><p>For details on how rewrite rules work in syslog-ng, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/modifying-messages/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="groupunset">Group unset</h2><p>The <code>group_unset</code> function removes from the record a group of fields matching a pattern.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">rewrite</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">group_unset</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;json.kubernetes.annotations.*&#34;</span></span></span></code></pre></div><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/modifying-messages/rewrite-unset/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="rename">Rename</h2><p>The <code>rename</code> function changes the name of an existing field name.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">rewrite</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">rename</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">oldName</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;json.kubernetes.labels.app&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">newName</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;json.kubernetes.labels.app.kubernetes.io/name&#34;</span></span></span></code></pre></div><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/modifying-messages/rewrite-rename/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="set">Set</h2><p>The <code>set</code> function sets the value of a field.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">rewrite</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">set</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">field</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;json.kubernetes.cluster&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;prod-us&#34;</span></span></span></code></pre></div><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/modifying-messages/rewrite-set/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="subst">Substitute (subst)</h2><p>The <code>subst</code> function replaces parts of a field with a replacement value based on a pattern.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">rewrite</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">subst</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">pattern</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;\d\d\d\d-\d\d\d\d-\d\d\d\d-\d\d\d\d&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">replace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[redacted bank card number]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">field</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;MESSAGE&#34;</span></span></span></code></pre></div><p>The function also supports the <code>type</code> and <code>flags</code> fields for specifying pattern type and flags as described in the <a href="../match/">match expression regexp function</a>.</p><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/modifying-messages/rewrite-replace/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="unset">Unset</h2><p>You can unset macros or fields of the message.</p><blockquote>
<p>Note: Unsetting a field completely deletes any previous value of the field.</p></blockquote><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">rewrite</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">unset</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">field</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;json.kubernetes.cluster&#34;</span></span></span></code></pre></div><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/modifying-messages/rewrite-unset/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="configuration">Configuration</h2><h2 id="rewriteconfig">RewriteConfig</h2><h3 id="rewriteconfig-group_unset">group_unset (*GroupUnsetConfig, optional)</h3><h3 id="rewriteconfig-rename">rename (*RenameConfig, optional)</h3><h3 id="rewriteconfig-set">set (*SetConfig, optional)</h3><h3 id="rewriteconfig-subst">subst (*SubstituteConfig, optional)</h3><h3 id="rewriteconfig-unset">unset (*UnsetConfig, optional)</h3><h2 id="renameconfig">RenameConfig</h2><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/modifying-messages/rewrite-rename/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="renameconfig-condition">condition (*MatchExpr, optional)</h3><h3 id="renameconfig-newname">newName (string, required)</h3><h3 id="renameconfig-oldname">oldName (string, required)</h3><h2 id="setconfig">SetConfig</h2><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/modifying-messages/rewrite-set/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="setconfig-condition">condition (*MatchExpr, optional)</h3><h3 id="setconfig-field">field (string, required)</h3><h3 id="setconfig-value">value (string, required)</h3><h2 id="substituteconfig">SubstituteConfig</h2><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/modifying-messages/rewrite-set/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="substituteconfig-condition">condition (*MatchExpr, optional)</h3><h3 id="substituteconfig-field">field (string, required)</h3><h3 id="substituteconfig-flags">flags ([]string, optional)</h3><h3 id="substituteconfig-pattern">pattern (string, required)</h3><h3 id="substituteconfig-replace">replace (string, required)</h3><h3 id="substituteconfig-type">type (string, optional)</h3><h2 id="unsetconfig">UnsetConfig</h2><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/modifying-messages/rewrite-unset/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="unsetconfig-condition">condition (*MatchExpr, optional)</h3><h3 id="unsetconfig-field">field (string, required)</h3><h2 id="groupunsetconfig">GroupUnsetConfig</h2><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/modifying-messages/rewrite-unset/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="groupunsetconfig-condition">condition (*MatchExpr, optional)</h3><h3 id="groupunsetconfig-pattern">pattern (string, required)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-810c80c2dbdca02f7ade52079fd88712">4.8.6 - syslog-ng outputs</h1><p>SyslogNGOutput and SyslogNGClusterOutput resources have almost the same structure as Output and ClusterOutput resources, with the main difference being the number and kind of supported destinations.</p><p>You can use the following <strong>syslog-ng</strong> outputs in your <code>SyslogNGOutput</code> and <code>SyslogNGClusterOutput</code> resources.</p></div><div class="td-content">
<h1 id="pg-d2c9db8ba7a6ba7639262daaea30cbd6">4.8.6.1 - Authentication for syslog-ng outputs</h1><h2 id="overview">Overview</h2><p>GRPC-based outputs use this configuration instead of the simple <code>tls</code> field found at most HTTP based destinations. For details, see the documentation of a related syslog-ng destination, for example, <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-loki/#auth">Grafana Loki</a>.</p><h2 id="configuration">Configuration</h2><h2 id="auth">Auth</h2><p>Authentication settings. Only one authentication method can be set. Default: Insecure</p><h3 id="auth-adc">adc (*ADC, optional)</h3><p>Application Default Credentials (ADC).</p><h3 id="auth-alts">alts (*ALTS, optional)</h3><p>Application Layer Transport Security (ALTS) is a simple to use authentication, only available within Google’s infrastructure.</p><h3 id="auth-insecure">insecure (*Insecure, optional)</h3><p>This is the default method, authentication is disabled (<code>auth(insecure())</code>).</p><h3 id="auth-tls">tls (*GrpcTLS, optional)</h3><p>This option sets various options related to TLS encryption, for example, key/certificate files and trusted CA locations. TLS can be used only with tcp-based transport protocols. For details, see <a href="../tls/">TLS for syslog-ng outputs</a> and the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="adc">ADC</h2><h2 id="insecure">Insecure</h2><h2 id="alts">ALTS</h2><h3 id="alts-target-service-accounts">target-service-accounts ([]string, optional)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-0125a4a4d818b30d9054879982e084a1">4.8.6.2 - Disk buffer</h1><p>The parameters of the syslog-ng disk buffer. Using a disk buffer on the output helps avoid message loss in case of a system failure on the destination side.
For details on how <a href="https://axoflow.com/docs/axosyslog-core/chapter-routing-filters/concepts-diskbuffer/">syslog-ng disk buffers work, see the documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="diskbuffer-compaction">compaction (*bool, optional)</h3><p>Prunes the unused space in the LogMessage representation</p><h3 id="diskbuffer-dir">dir (string, optional)</h3><p>Description: Defines the folder where the disk-buffer files are stored.</p><h3 id="diskbuffer-disk_buf_size">disk_buf_size (int64, required)</h3><p>This is a required option. The maximum size of the disk-buffer in bytes. The minimum value is 1048576 bytes.</p><h3 id="diskbuffer-mem_buf_length">mem_buf_length (*int64, optional)</h3><p>Use this option if the option reliable() is set to no. This option contains the number of messages stored in overflow queue.</p><h3 id="diskbuffer-mem_buf_size">mem_buf_size (*int64, optional)</h3><p>Use this option if the option reliable() is set to yes. This option contains the size of the messages in bytes that is used in the memory part of the disk buffer.</p><h3 id="diskbuffer-q_out_size">q_out_size (*int64, optional)</h3><p>The number of messages stored in the output buffer of the destination.</p><h3 id="diskbuffer-reliable">reliable (bool, required)</h3><p>If set to yes, syslog-ng OSE cannot lose logs in case of reload/restart, unreachable destination or syslog-ng OSE crash. This solution provides a slower, but reliable disk-buffer option.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-217fe992275c17196145bd8aca20419a">4.8.6.3 - Elasticsearch</h1><h2 id="overview">Overview</h2><p>Based on the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-elasticsearch-http/">ElasticSearch destination of AxoSyslog core</a>.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">elasticsearch</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">elasticsearch</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://elastic-search-endpoint:9200/_bulk&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">index</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;indexname&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">user</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;username&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">password</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">elastic</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">password</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h3 id="elasticsearchoutput-">(HTTPOutput, required)</h3><h3 id="elasticsearchoutput-custom_id">custom_id (string, optional)</h3><p>The document ID. If no ID is specified, a document ID is automatically generated.</p><h3 id="elasticsearchoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="elasticsearchoutput-index">index (string, optional)</h3><p>Name of the data stream, index, or index alias to perform the action on.</p><h3 id="elasticsearchoutput-logstash_prefix">logstash_prefix (string, optional)</h3><p>Set the prefix for logs in logstash format. If set, then the Index field will be ignored.</p><h3 id="elasticsearchoutput-logstash_prefix_separator">logstash_prefix_separator (string, optional)</h3><p>Set the separator between LogstashPrefix and LogStashDateformat. Default: &ldquo;-&rdquo;</p><h3 id="elasticsearchoutput-logstash_suffix">logstash_suffix (string, optional)</h3><p>Set the suffix for logs in logstash format.</p><p>Default: <code>${YEAR}.${MONTH}.${DAY}</code>### type (*string, optional) {#elasticsearchoutput-type}</p><p>The document type associated with the operation. Elasticsearch indices now support a single document type: <code>_doc</code></p><h3 id="elasticsearchoutput-template">template (string, optional)</h3><p>The template to format the record itself inside the payload body</p><h3 id="elasticsearchoutput-type">type (*string, optional)</h3><p>The document type associated with the operation. Elasticsearch indices now support a single document type: <code>_doc</code></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-20150d5282a0092eb6c0366d786537b3">4.8.6.4 - Elasticsearch datastream</h1><h2 id="overview">Overview</h2><p>Based on the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-elasticsearch-datastream/">ElasticSearch datastream destination of AxoSyslog</a>.</p><p>Available in Logging operator version 4.9 and later.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">elasticsearch-datastream</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">elasticsearch-datastream</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://elastic-endpoint:9200/my-data-stream/_bulk&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">user</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;username&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">password</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">elastic</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">password</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="elasticsearchdatastreamoutput">ElasticsearchDatastreamOutput</h2><h3 id="elasticsearchdatastreamoutput-">(HTTPOutput, required)</h3><h3 id="elasticsearchdatastreamoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="elasticsearchdatastreamoutput-record">record (string, optional)</h3><p>Arguments to the <code>$format-json()</code> template function. Default: <code>"--scope rfc5424 --exclude DATE --key ISODATE @timestamp=${ISODATE}"</code></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-def8416dfd78030f291e4e2fee600a97">4.8.6.5 - File</h1><p>The <code>file</code> output stores log records in a plain text file.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/mnt/archive/logs/${YEAR}/${MONTH}/${DAY}/app.log</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">create_dirs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span></span></span></code></pre></div><p>For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-file/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><p>For available macros like <code>${YEAR}/${MONTH}/${DAY}</code> see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/customizing-message-format/reference-macros/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="configuration">Configuration</h2><h2 id="fileoutput">FileOutput</h2><h3 id="fileoutput-create_dirs">create_dirs (bool, optional)</h3><p>Enable creating non-existing directories.</p><p>Default: false</p><h3 id="fileoutput-dir_group">dir_group (string, optional)</h3><p>The group of the directories created by syslog-ng. To preserve the original properties of an existing directory, use the option without specifying an attribute: <code>dir-group()</code>.</p><p>Default: Use the global settings</p><h3 id="fileoutput-dir_owner">dir_owner (string, optional)</h3><p>The owner of the directories created by syslog-ng. To preserve the original properties of an existing directory, use the option without specifying an attribute: <code>dir-owner()</code>.</p><p>Default: Use the global settings</p><h3 id="fileoutput-dir_perm">dir_perm (int, optional)</h3><p>The permission mask of directories created by syslog-ng. Log directories are only created if a file after macro expansion refers to a non-existing directory, and directory creation is enabled (see also the <code>create-dirs()</code> option). For octal numbers prefix the number with 0, for example, use <code>0755</code> for <code>rwxr-xr-x</code>.</p><p>Default: Use the global settings</p><h3 id="fileoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="fileoutput-path">path (string, required)</h3><p>Path where the file is stored.</p><h3 id="fileoutput-persist_name">persist_name (string, optional)</h3><h3 id="fileoutput-template">template (string, optional)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-f64978e87cfa5c2c0a8c6ad06c690873">4.8.6.6 - HTTP</h1><p>Sends messages over HTTP. For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-http-nonjava/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="example">Example</h2><p>A simple example sending logs over HTTP to a fluentbit HTTP endpoint:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">http</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#URL of the ingest endpoint</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">http://fluentbit-endpoint:8080/tag</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">method</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">POST</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">headers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#4e9a06">&#34;Content-type: application/json&#34;</span></span></span></code></pre></div><p>A more complex example to demonstrate sending logs to OpenObserve
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">openobserve</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">http</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic">#URL of the ingest endpoint</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://openobserve-endpoint/api/default/log-generator/_json</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">user</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;username&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">password</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">openobserve</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">password</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">method</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">POST</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Parameters for sending logs in batches</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">batch-lines</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">5000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">batch-bytes</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">4096</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">batch-timeout</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">300</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">headers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#4e9a06">&#34;Connection: keep-alive&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#8f5902;font-style:italic"># Disable TLS peer verification for demo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tls</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">peer_verify</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;no&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">body-prefix</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;[&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">body-suffix</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;]&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">delimiter</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;,&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">body</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${MESSAGE}&#34;</span></span></span></code></pre></div></p><p>For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-http-nonjava/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="configuration">Configuration</h2><h3 id="httpoutput-">(Batch, required)</h3><p>Batching parameters</p><h3 id="httpoutput-body">body (string, optional)</h3><p>The body of the HTTP request, for example, <code>body("${ISODATE} ${MESSAGE}")</code>. You can use strings, macros, and template functions in the body. If not set, it will contain the message received from the source by default.</p><h3 id="httpoutput-body-prefix">body-prefix (string, optional)</h3><p>The string syslog-ng OSE puts at the beginning of the body of the HTTP request, before the log message.</p><h3 id="httpoutput-body-suffix">body-suffix (string, optional)</h3><p>The string syslog-ng OSE puts to the end of the body of the HTTP request, after the log message.</p><h3 id="httpoutput-delimiter">delimiter (string, optional)</h3><p>By default, syslog-ng OSE separates the log messages of the batch with a newline character.</p><h3 id="httpoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="httpoutput-headers">headers ([]string, optional)</h3><p>Custom HTTP headers to include in the request, for example, <code>headers("HEADER1: header1", "HEADER2: header2")</code>.</p><p>Default: empty</p><h3 id="httpoutput-log-fifo-size">log-fifo-size (int, optional)</h3><p>The number of messages that the output queue can store.</p><h3 id="httpoutput-method">method (string, optional)</h3><p>Specifies the HTTP method to use when sending the message to the server. <code>POST | PUT</code></p><h3 id="httpoutput-password">password (secret.Secret, optional)</h3><p>The password that syslog-ng OSE uses to authenticate on the server where it sends the messages.</p><h3 id="httpoutput-persist_name">persist_name (string, optional)</h3><p>If you receive the following error message during syslog-ng startup, set the <code>persist-name()</code> option of the duplicate drivers: <code>Error checking the uniqueness of the persist names, please override it with persist-name option. Shutting down.</code> See the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-http-nonjava/reference-destination-http-nonjava/#persist-name">documentation of the AxoSyslog syslog-ng distribution</a> for more information.</p><h3 id="httpoutput-response-action">response-action (filter.RawArrowMap, optional)</h3><p>Specifies what syslog-ng does with the log message, based on the response code received from the HTTP server. See the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-http-nonjava/reference-destination-http-nonjava/#response-action">documentation of the AxoSyslog syslog-ng distribution</a> for more information.</p><h3 id="httpoutput-retries">retries (int, optional)</h3><p>The number of times syslog-ng OSE attempts to send a message to this destination. If syslog-ng OSE could not send a message, it will try again until the number of attempts reaches <code>retries</code>, then drops the message.</p><h3 id="httpoutput-time_reopen">time_reopen (int, optional)</h3><p>The time to wait in seconds before a dead connection is reestablished.</p><p>Default: 60</p><h3 id="httpoutput-timeout">timeout (int, optional)</h3><p>Sets the maximum number of messages sent to the destination per second. Use this output-rate-limiting functionality only when using disk-buffer as well to avoid the risk of losing messages. Specifying 0 or a lower value sets the output limit to unlimited.</p><h3 id="httpoutput-tls">tls (*TLS, optional)</h3><p>This option sets various options related to TLS encryption, for example, key/certificate files and trusted CA locations. TLS can be used only with tcp-based transport protocols. For details, see <a href="../tls/">TLS for syslog-ng outputs</a> and the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="httpoutput-url">url (string, optional)</h3><p>Specifies the hostname or IP address and optionally the port number of the web service that can receive log data via HTTP. Use a colon (:) after the address to specify the port number of the server. For example: <code>http://127.0.0.1:8000</code></p><h3 id="httpoutput-user">user (string, optional)</h3><p>The username that syslog-ng OSE uses to authenticate on the server where it sends the messages.</p><h3 id="httpoutput-user-agent">user-agent (string, optional)</h3><p>The value of the USER-AGENT header in the messages sent to the server.</p><h3 id="httpoutput-workers">workers (int, optional)</h3><p>Specifies the number of worker threads (at least 1) that syslog-ng OSE uses to send messages to the server. Increasing the number of worker threads can drastically improve the performance of the destination.</p><h2 id="batch">Batch</h2><h3 id="batch-batch-bytes">batch-bytes (int, optional)</h3><p>Description: Sets the maximum size of payload in a batch. If the size of the messages reaches this value, syslog-ng OSE sends the batch to the destination even if the number of messages is less than the value of the <code>batch-lines()</code> option. Note that if the <code>batch-timeout()</code> option is enabled and the queue becomes empty, syslog-ng OSE flushes the messages only if <code>batch-timeout()</code> expires, or the batch reaches the limit set in <code>batch-bytes()</code>.</p><h3 id="batch-batch-lines">batch-lines (int, optional)</h3><p>Description: Specifies how many lines are flushed to a destination in one batch. The syslog-ng OSE application waits for this number of lines to accumulate and sends them off in a single batch. Increasing this number increases throughput as more messages are sent in a single batch, but also increases message latency. For example, if you set <code>batch-lines()</code> to 100, syslog-ng OSE waits for 100 messages.</p><h3 id="batch-batch-timeout">batch-timeout (int, optional)</h3><p>Description: Specifies the time syslog-ng OSE waits for lines to accumulate in the output buffer. The syslog-ng OSE application sends batches to the destinations evenly. The timer starts when the first message arrives to the buffer, so if only few messages arrive, syslog-ng OSE sends messages to the destination at most once every <code>batch-timeout()</code> milliseconds.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-db09f336e539e97c3a4b6ae4786aded5">4.8.6.7 - Loggly output</h1><h2 id="overview">Overview</h2><p>The <code>loggly()</code> destination sends log messages to the <a href="https://www.loggly.com/">Loggly</a> Logging-as-a-Service provider.
You can send log messages over TCP, or encrypted with <a href="/docs/configuration/plugins/syslog-ng-outputs/tls/">TLS for syslog-ng outputs</a>.</p><p>For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-loggly/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="prerequisites">Prerequisites</h2><p>You need a Loggly account and your user token to use this output.</p><h2 id="configuration">Configuration</h2><h3 id="loggly-">(SyslogOutput, required)</h3><p>syslog output configuration</p><h3 id="loggly-host">host (string, optional)</h3><p>Address of the destination host.</p><h3 id="loggly-tag">tag (string, optional)</h3><p>Event tag. For details, see the <a href="https://documentation.solarwinds.com/en/success_center/loggly/content/admin/tags.htm">Loggy documentation</a></p><h3 id="loggly-token">token (*secret.Secret, required)</h3><p>Your Customer Token that you received from Loggly. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-loggly/">documentation of the AxoSyslog syslog-ng distribution</a></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-18b36b379ed9690f5568e3f8d7088d0f">4.8.6.8 - LogScale</h1><p>Based on the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/crowdstrike-falcon/">LogScale destination of AxoSyslog core</a>. Sends log records over HTTP to Falcon&rsquo;s LogScale.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test-logscale</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">logscale</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">token</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">token</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logscale-token</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">timezone</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;UTC&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">batch_lines</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">disk_buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">disk_buf_size</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">512000000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">dir</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/buffers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">reliable</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span></span></span></code></pre></div><h2 id="logscaleoutput">LogScaleOutput</h2><h3 id="logscaleoutput-attributes">attributes (string, optional)</h3><p>A JSON object representing key-value pairs for the Event. These key-value pairs adds structure to Events, making it easier to search. Attributes can be nested JSON objects, however, we recommend limiting the amount of nesting.</p><p>Default: <code>"--scope rfc5424 --exclude MESSAGE --exclude DATE --leave-initial-dot"</code></p><h3 id="logscaleoutput-batch_bytes">batch_bytes (int, optional)</h3><h3 id="logscaleoutput-batch_lines">batch_lines (int, optional)</h3><h3 id="logscaleoutput-batch_timeout">batch_timeout (int, optional)</h3><h3 id="logscaleoutput-body">body (string, optional)</h3><h3 id="logscaleoutput-content_type">content_type (string, optional)</h3><p>This field specifies the content type of the log records being sent to Falcon&rsquo;s LogScale.</p><p>Default: <code>"application/json"</code></p><h3 id="logscaleoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="logscaleoutput-extra_headers">extra_headers (string, optional)</h3><p>This field represents additional headers that can be included in the HTTP request when sending log records to Falcon&rsquo;s LogScale.</p><p>Default: empty</p><h3 id="logscaleoutput-persist_name">persist_name (string, optional)</h3><h3 id="logscaleoutput-rawstring">rawstring (string, optional)</h3><p>The raw string representing the Event. The default display for an Event in LogScale is the rawstring. If you do not provide the rawstring field, then the response defaults to a JSON representation of the attributes field.</p><p>Default: empty</p><h3 id="logscaleoutput-timezone">timezone (string, optional)</h3><p>The timezone is only required if you specify the timestamp in milliseconds. The timezone specifies the local timezone for the event. Note that you must still specify the timestamp in UTC time.</p><h3 id="logscaleoutput-token">token (*secret.Secret, optional)</h3><p>An <a href="https://library.humio.com/data-analysis/ingesting-data-tokens.html">Ingest Token</a> is a unique string that identifies a repository and allows you to send data to that repository.</p><p>Default: empty</p><h3 id="logscaleoutput-url">url (*secret.Secret, optional)</h3><p>Ingester URL is the URL of the Humio cluster you want to send data to.</p><p>Default: <code>https://cloud.humio.com</code></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-eefbe22dbc8ede1633843ddca2372922">4.8.6.9 - Loki</h1><p>Sends messages to Grafana Loki over gRPC, based on the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-loki/">Loki destination of AxoSyslog Core</a>.</p><p>Available in Logging operator version 4.4 and later.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">loki-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">loki</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;loki.loki:8000&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">batch-lines</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">2000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">batch-timeout</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">10</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">workers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">log-fifo-size</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">&#34;app&#34;: </span><span style="color:#4e9a06">&#34;$PROGRAM&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">&#34;host&#34;: </span><span style="color:#4e9a06">&#34;$HOST&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">timestamp</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;msg&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">template</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;$ISODATE $HOST $MSGHDR$MSG&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">auth</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">insecure</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}</span></span></code></pre></div><p>For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-loki/">documentation of the AxoSyslog syslog-ng distribution</a>. For available macros like <code>$PROGRAM</code> and <code>$HOST</code> see <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/customizing-message-format/reference-macros/">https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/customizing-message-format/reference-macros/</a></p><h2 id="configuration">Configuration</h2><h3 id="lokioutput-auth">auth (*Auth, optional)</h3><p>Authentication configuration, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-loki/#auth">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="lokioutput-batch-lines">batch-lines (int, optional)</h3><p>Description: Specifies how many lines are flushed to a destination in one batch. The syslog-ng OSE application waits for this number of lines to accumulate and sends them off in a single batch. Increasing this number increases throughput as more messages are sent in a single batch, but also increases message latency. For example, if you set batch-lines() to 100, syslog-ng OSE waits for 100 messages.</p><h3 id="lokioutput-batch-timeout">batch-timeout (int, optional)</h3><p>Description: Specifies the time syslog-ng OSE waits for lines to accumulate in the output buffer. The syslog-ng OSE application sends batches to the destinations evenly. The timer starts when the first message arrives to the buffer, so if only few messages arrive, syslog-ng OSE sends messages to the destination at most once every batch-timeout() milliseconds.</p><h3 id="lokioutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="lokioutput-labels">labels (filter.ArrowMap, optional)</h3><p>Using the Labels map, Kubernetes label to Loki label mapping can be configured. Example: <code>{"app" : "$PROGRAM"}</code></p><h3 id="lokioutput-log-fifo-size">log-fifo-size (int, optional)</h3><p>The number of messages that the output queue can store.</p><h3 id="lokioutput-persist_name">persist_name (string, optional)</h3><p>If you receive the following error message during AxoSyslog startup, set the persist-name() option of the duplicate drivers: <code>Error checking the uniqueness of the persist names, please override it with persist-name option. Shutting down.</code> See <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-http-nonjava/reference-destination-http-nonjava/#persist-name">syslog-ng docs</a> for more information.</p><h3 id="lokioutput-retries">retries (int, optional)</h3><p>The number of times syslog-ng OSE attempts to send a message to this destination. If syslog-ng OSE could not send a message, it will try again until the number of attempts reaches retries, then drops the message.</p><h3 id="lokioutput-template">template (string, optional)</h3><p>Template for customizing the log message format.</p><h3 id="lokioutput-time_reopen">time_reopen (int, optional)</h3><p>The time to wait in seconds before a dead connection is reestablished.</p><p>Default: 60</p><h3 id="lokioutput-timestamp">timestamp (string, optional)</h3><p>The timestamp that will be applied to the outgoing messages (possible values: current|received|msg default: current). Loki does not accept events, in which the timestamp is not monotonically increasing.</p><h3 id="lokioutput-url">url (string, optional)</h3><p>Specifies the hostname or IP address and optionally the port number of the service that can receive log data via gRPC. Use a colon (:) after the address to specify the port number of the server. For example: <code>grpc://127.0.0.1:8000</code></p><h3 id="lokioutput-workers">workers (int, optional)</h3><p>Specifies the number of worker threads (at least 1) that syslog-ng OSE uses to send messages to the server. Increasing the number of worker threads can drastically improve the performance of the destination.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-50ca131a90db80476f6b3ee7bf91ede9">4.8.6.10 - MongoDB</h1><p>Based on the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-mongodb/">MongoDB destination of the AxoSyslog syslog-ng distribution</a>.</p><p>Available in Logging operator version 4.4 and later.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">mongodb</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">mongodb</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">collection</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">syslog</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">uri</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;mongodb://mongodb-endpoint/syslog?wtimeoutMS=60000&amp;socketTimeoutMS=60000&amp;connectTimeoutMS=60000&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">value_pairs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">scope(&#34;selected-macros&#34; &#34;nv-pairs&#34;)</span></span></span></code></pre></div><p>For more information, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-mongodb/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="configuration">Configuration</h2><h3 id="mongodb-">(Batch, required)</h3><p>Batching parameters</p><h3 id="mongodb-">(Bulk, required)</h3><p>Bulk operation related options</p><h3 id="mongodb-collection">collection (string, required)</h3><p>The name of the MongoDB collection where the log messages are stored (collections are similar to SQL tables). Note that the name of the collection must not start with a dollar sign ($), and that it may contain dot (.) characters.</p><h3 id="mongodb-dir">dir (string, optional)</h3><p>Defines the folder where the disk-buffer files are stored.</p><h3 id="mongodb-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="mongodb-log-fifo-size">log-fifo-size (int, optional)</h3><p>The number of messages that the output queue can store.</p><h3 id="mongodb-persist_name">persist_name (string, optional)</h3><p>If you receive the following error message during syslog-ng startup, set the <code>persist-name()</code> option of the duplicate drivers: <code>Error checking the uniqueness of the persist names, please override it with persist-name option. Shutting down.</code> See the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-http-nonjava/reference-destination-http-nonjava/#persist-name">documentation of the AxoSyslog syslog-ng distribution</a> for more information.</p><h3 id="mongodb-retries">retries (int, optional)</h3><p>The number of times syslog-ng OSE attempts to send a message to this destination. If syslog-ng OSE could not send a message, it will try again until the number of attempts reaches retries, then drops the message.</p><h3 id="mongodb-time_reopen">time_reopen (int, optional)</h3><p>The time to wait in seconds before a dead connection is reestablished.</p><p>Default: 60</p><h3 id="mongodb-uri">uri (*secret.Secret, optional)</h3><p>Connection string used for authentication. See the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-mongodb/reference-destination-mongodb/#mongodb-option-uri">documentation of the AxoSyslog syslog-ng distribution</a></p><p>Default: <code>mongodb://127.0.0.1:27017/syslog?wtimeoutMS=60000&socketTimeoutMS=60000&connectTimeoutMS=60000</code></p><h3 id="mongodb-value_pairs">value_pairs (ValuePairs, optional)</h3><p>Creates structured name-value pairs from the data and metadata of the log message.</p><p>Default: <code>"scope("selected-macros" "nv-pairs")"</code></p><h3 id="mongodb-write_concern">write_concern (RawString, optional)</h3><p>Description: Sets the write concern mode of the MongoDB operations, for both bulk and single mode. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-mongodb/reference-destination-mongodb/#mongodb-option-write-concern">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="bulk">Bulk</h2><p>Bulk operation related options. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-mongodb/reference-destination-mongodb/#mongodb-option-bulk">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="bulk-bulk">bulk (*bool, optional)</h3><p>Enables bulk insert mode. If disabled, each messages is inserted individually.</p><p>Default: yes</p><h3 id="bulk-bulk_bypass_validation">bulk_bypass_validation (*bool, optional)</h3><p>If set to yes, it disables MongoDB bulk operations validation mode.</p><p>Default: no</p><h3 id="bulk-bulk_unordered">bulk_unordered (*bool, optional)</h3><p>Description: Enables unordered bulk operations mode.</p><p>Default: no</p><h2 id="valuepairs">ValuePairs</h2><p>TODO move this to a common module once it is used in more places</p><h3 id="valuepairs-exclude">exclude (RawString, optional)</h3><h3 id="valuepairs-key">key (RawString, optional)</h3><h3 id="valuepairs-pair">pair (RawString, optional)</h3><h3 id="valuepairs-scope">scope (RawString, optional)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-31ea9edde3a649f6c3772919f9e7a156">4.8.6.11 - MQTT</h1><h2 id="overview">Overview</h2><p>Sends messages from a local network to an MQTT broker. For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-mqtt-intro/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">mqtt</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">mqtt</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">address</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tcp://mosquitto:1883</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">topic</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test/demo</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="mqtt">MQTT</h2><h3 id="mqtt-address">address (string, optional)</h3><p>Address of the destination host</p><h3 id="mqtt-fallback-topic">fallback-topic (string, optional)</h3><p>fallback-topic is used when syslog-ng cannot post a message to the originally defined topic (which can include invalid characters coming from templates).</p><h3 id="mqtt-qos">qos (int, optional)</h3><p>qos stands for quality of service and can take three values in the MQTT world. Its default value is 0, where there is no guarantee that the message is ever delivered.</p><h3 id="mqtt-template">template (string, optional)</h3><p>Template where you can configure the message template sent to the MQTT broker. By default, the template is: <code>$ISODATE $HOST $MSGHDR$MSG</code></p><h3 id="mqtt-topic">topic (string, optional)</h3><p>Topic defines in which topic syslog-ng stores the log message. You can also use templates here, and use, for example, the $HOST macro in the topic name hierarchy.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-f45875ac7b5bd367d7324b30c22e5503">4.8.6.12 - Openobserve</h1><h2 id="overview">Overview</h2><p>Send messages to <a href="https://openobserve.ai/docs/api/ingestion/logs/json/">OpenObserve</a> using its <a href="https://openobserve.ai/docs/api/ingestion/logs/json/">Logs Ingestion - JSON API</a>. This API accepts multiple records in batch in JSON format.</p><p>Available in Logging operator version 4.5 and later.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">openobserve</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">openobserve</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://some-openobserve-endpoint&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">5080</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">organization</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">stream</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">user</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;username&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">password</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">openobserve</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">password</span></span></span></code></pre></div><p>For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/openobserve/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="configuration">Configuration</h2><h2 id="openobserveoutput">OpenobserveOutput</h2><h3 id="openobserveoutput-">(HTTPOutput, required)</h3><h3 id="openobserveoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="openobserveoutput-organization">organization (string, optional)</h3><p>Name of the organization in OpenObserve.</p><h3 id="openobserveoutput-port">port (int, optional)</h3><p>The port number of the OpenObserve server. Specify it here instead of appending it to the URL.</p><p>Default: 5080</p><h3 id="openobserveoutput-record">record (string, optional)</h3><p>Arguments to the <code>$format-json()</code> template function. Default: <code>"--scope rfc5424 --exclude DATE --key ISODATE @timestamp=${ISODATE}"</code></p><h3 id="openobserveoutput-stream">stream (string, optional)</h3><p>Name of the stream in OpenObserve.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-6d7223a166a300bc7803f652ecf314ae">4.8.6.13 - OpenTelemetry output</h1><h2 id="overview">Overview</h2><p>Sends messages over OpenTelemetry GRPC. For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/opentelemetry/">documentation of AxoSyslog</a>.</p><p>Available in Logging operator version 4.9 and later.</p><h2 id="example">Example</h2><p>A simple example sending logs over OpenTelemetry GRPC to a remote OpenTelemetry endpoint:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">otlp</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">opentelemetry</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">otel-server:4379</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="opentelemetryoutput">OpenTelemetryOutput</h2><h3 id="opentelemetryoutput-">(Batch, required)</h3><p>Batching parameters</p><h3 id="opentelemetryoutput-auth">auth (*Auth, optional)</h3><p>Authentication configuration, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-syslog-ng-otlp/#auth">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="opentelemetryoutput-channel_args">channel_args (filter.ArrowMap, optional)</h3><p>Add GRPC Channel arguments <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/opentelemetry/#channel-args">https://axoflow.com/docs/axosyslog-core/chapter-destinations/opentelemetry/#channel-args</a></p><h3 id="opentelemetryoutput-compression">compression (*bool, optional)</h3><p>Enable or disable compression.</p><p>Default: false</p><h3 id="opentelemetryoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="opentelemetryoutput-url">url (string, required)</h3><p>Specifies the hostname or IP address and optionally the port number of the web service that can receive log data via HTTP. Use a colon (:) after the address to specify the port number of the server. For example: <code>http://127.0.0.1:8000</code></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-d44d1d1ef5ea3fb8124c088fcb9e125f">4.8.6.14 - Redis</h1><p>Based on the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-redis/">Redis destination of AxoSyslog core</a>.</p><p>Available in Logging operator version 4.4 and later.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">redis</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">redis</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">127.0.0.1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">6379</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">retries</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">throttle</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">time-reopen</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">60</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">workers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"> </span></span></span></code></pre></div><p>For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-redis/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="configuration">Configuration</h2><h3 id="redisoutput-">(Batch, required)</h3><p>Batching parameters</p><h3 id="redisoutput-auth">auth (*secret.Secret, optional)</h3><p>The password used for authentication on a password-protected Redis server.</p><h3 id="redisoutput-command">command (StringList, optional)</h3><p>Internal rendered form of the CommandAndArguments field</p><h3 id="redisoutput-command_and_arguments">command_and_arguments ([]string, optional)</h3><p>The Redis command to execute, for example, LPUSH, INCR, or HINCRBY. Using the HINCRBY command with an increment value of 1 allows you to create various statistics. For example, the <code>command("HINCRBY" "${HOST}/programs" "${PROGRAM}" "1")</code> command counts the number of log messages on each host for each program.</p><p>Default: ""</p><h3 id="redisoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="redisoutput-host">host (string, optional)</h3><p>The hostname or IP address of the Redis server.</p><p>Default: 127.0.0.1</p><h3 id="redisoutput-log-fifo-size">log-fifo-size (int, optional)</h3><p>The number of messages that the output queue can store.</p><h3 id="redisoutput-persist_name">persist_name (string, optional)</h3><p>Persistname</p><h3 id="redisoutput-port">port (int, optional)</h3><p>The port number of the Redis server.</p><p>Default: 6379</p><h3 id="redisoutput-retries">retries (int, optional)</h3><p>If syslog-ng OSE cannot send a message, it will try again until the number of attempts reaches <code>retries()</code>.</p><p>Default: 3</p><h3 id="redisoutput-throttle">throttle (int, optional)</h3><p>Sets the maximum number of messages sent to the destination per second. Use this output-rate-limiting functionality only when using disk-buffer as well to avoid the risk of losing messages. Specifying 0 or a lower value sets the output limit to unlimited.</p><p>Default: 0</p><h3 id="redisoutput-time-reopen">time-reopen (int, optional)</h3><p>The time to wait in seconds before a dead connection is reestablished.</p><p>Default: 60</p><h3 id="redisoutput-workers">workers (int, optional)</h3><p>Specifies the number of worker threads (at least 1) that syslog-ng OSE uses to send messages to the server. Increasing the number of worker threads can drastically improve the performance of the destination.</p><p>Default: 1</p><h2 id="stringlist">StringList</h2><h3 id="stringlist-string-list">string-list ([]string, optional)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-a30c0b2e8f92178a45957a767cd80264">4.8.6.15 - S3</h1><p>Sends messages from a local network to a S3 (compatible) server. For more information, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-s3/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><p>Available in Logging operator version 4.4 and later.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">s3</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://some-s3-compatible-endpoint:8088&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">bucket</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;s3bucket-name&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">access_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">access-key</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">secret_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">s3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">secret-key</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">object_key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;path/to/my-logs/${HOST}&#34;</span></span></span></code></pre></div><p>For available macros like <code>$PROGRAM</code> and <code>$HOST</code>, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/customizing-message-format/reference-macros/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="s3output">S3Output</h2><h3 id="s3output-access_key">access_key (*secret.Secret, optional)</h3><p>The access_key for the S3 server.</p><h3 id="s3output-bucket">bucket (string, optional)</h3><p>The bucket name of the S3 server.</p><h3 id="s3output-canned_acl">canned_acl (string, optional)</h3><p>Set the canned_acl option.</p><h3 id="s3output-chunk_size">chunk_size (int, optional)</h3><p>Set the chunk size.</p><p>Default: 5MiB</p><h3 id="s3output-compresslevel">compresslevel (int, optional)</h3><p>Set the compression level (1-9).</p><p>Default: 9</p><h3 id="s3output-compression">compression (*bool, optional)</h3><p>Enable or disable compression.</p><p>Default: false</p><h3 id="s3output-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="s3output-flush_grace_period">flush_grace_period (int, optional)</h3><p>Set the number of seconds for flush period.</p><p>Default: 60</p><h3 id="s3output-log-fifo-size">log-fifo-size (int, optional)</h3><p>The number of messages that the output queue can store.</p><h3 id="s3output-max_object_size">max_object_size (int, optional)</h3><p>Set the maximum object size size.</p><p>Default: 5120GiB</p><h3 id="s3output-max_pending_uploads">max_pending_uploads (int, optional)</h3><p>Set the maximum number of pending uploads.</p><p>Default: 32</p><h3 id="s3output-object_key">object_key (string, optional)</h3><p>The object_key for the S3 server.</p><h3 id="s3output-object_key_timestamp">object_key_timestamp (string, optional)</h3><p>Set object_key_timestamp</p><h3 id="s3output-persist_name">persist_name (string, optional)</h3><p>Persistname</p><h3 id="s3output-region">region (string, optional)</h3><p>Set the region option.</p><h3 id="s3output-retries">retries (int, optional)</h3><p>The number of times syslog-ng OSE attempts to send a message to this destination. If syslog-ng OSE could not send a message, it will try again until the number of attempts reaches retries, then drops the message.</p><h3 id="s3output-secret_key">secret_key (*secret.Secret, optional)</h3><p>The secret_key for the S3 server.</p><h3 id="s3output-storage_class">storage_class (string, optional)</h3><p>Set the storage_class option.</p><h3 id="s3output-template">template (string, optional)</h3><p>Template</p><h3 id="s3output-throttle">throttle (int, optional)</h3><p>Sets the maximum number of messages sent to the destination per second. Use this output-rate-limiting functionality only when using disk-buffer as well to avoid the risk of losing messages. Specifying 0 or a lower value sets the output limit to unlimited.</p><p>Default: 0</p><h3 id="s3output-upload_threads">upload_threads (int, optional)</h3><p>Set the number of upload threads.</p><p>Default: 8</p><h3 id="s3output-url">url (string, optional)</h3><p>The hostname or IP address of the S3 server.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-ebf6ce972f8f52a488cb4fd3bc510dcb">4.8.6.16 - SplunkHEC</h1><p>Based on the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/syslog-ng-with-splunk/">Splunk destination of AxoSyslog core</a>.</p><p>Available in Logging operator version 4.4 and later.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">splunkhec</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">splunk_hec_event</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">url</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://splunk-endpoint&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">token</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">splunk-hec</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">token</span></span></span></code></pre></div><h2 id="configuration">Configuration</h2><h2 id="splunkhecoutput">SplunkHECOutput</h2><h3 id="splunkhecoutput-">(HTTPOutput, required)</h3><h3 id="splunkhecoutput-content_type">content_type (string, optional)</h3><p>Additional HTTP request content-type option.</p><h3 id="splunkhecoutput-default_index">default_index (string, optional)</h3><p>Fallback option for index field. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/syslog-ng-with-splunk/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="splunkhecoutput-default_source">default_source (string, optional)</h3><p>Fallback option for source field.</p><h3 id="splunkhecoutput-default_sourcetype">default_sourcetype (string, optional)</h3><p>Fallback option for sourcetype field.</p><h3 id="splunkhecoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="splunkhecoutput-event">event (string, optional)</h3><p>event() accepts a template, which declares the content of the log message sent to Splunk. Default value: <code>${MSG}</code></p><h3 id="splunkhecoutput-extra_headers">extra_headers ([]string, optional)</h3><p>Additional HTTP request headers.</p><h3 id="splunkhecoutput-extra_queries">extra_queries ([]string, optional)</h3><p>Additional HTTP request query options.</p><h3 id="splunkhecoutput-fields">fields (string, optional)</h3><p>Additional indexing metadata for Splunk.</p><h3 id="splunkhecoutput-host">host (string, optional)</h3><p>Sets the host field.</p><h3 id="splunkhecoutput-index">index (string, optional)</h3><p>Splunk index where the messages will be stored.</p><h3 id="splunkhecoutput-source">source (string, optional)</h3><p>Sets the source field.</p><h3 id="splunkhecoutput-sourcetype">sourcetype (string, optional)</h3><p>Sets the sourcetype field.</p><h3 id="splunkhecoutput-time">time (string, optional)</h3><p>Sets the time field.</p><h3 id="splunkhecoutput-token">token (secret.Secret, optional)</h3><p>The token that syslog-ng OSE uses to authenticate on the event collector.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-764b7c70899b4d51e51a8ba401f96cd2">4.8.6.17 - Sumo Logic HTTP</h1><p>The <code>sumologic-http</code> output sends log records over HTTP to Sumo Logic. For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-sumologic-intro/destination-sumologic-options/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="prerequisites">Prerequisites</h2><p>You need a Sumo Logic account to use this output. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-sumologic-intro/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="example">Example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test-sumo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">sumologic-http</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">batch-lines</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">disk_buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">disk_buf_size</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">512000000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">dir</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/buffers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">reliable</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">body</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;$(format-json
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">                --subkeys json.
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">                --exclude json.kubernetes.annotations.*
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">                json.kubernetes.annotations=literal($(format-flat-json --subkeys json.kubernetes.annotations.))
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">                --exclude json.kubernetes.labels.*
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">                json.kubernetes.labels=literal($(format-flat-json --subkeys json.kubernetes.labels.)))&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">collector</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">valueFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">token</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">sumo-collector</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">deployment</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">us2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">headers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">&#39;X-Sumo-Name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">source-name&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">&#39;X-Sumo-Category</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">source-category&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tls</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">use-system-cert-store</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span></span></span></code></pre></div><p>For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-sumologic-intro/destination-sumologic-http/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="configuration">Configuration</h2><h2 id="sumologichttpoutput">SumologicHTTPOutput</h2><h3 id="sumologichttpoutput-batch-bytes">batch-bytes (int, optional)</h3><h3 id="sumologichttpoutput-batch-lines">batch-lines (int, optional)</h3><h3 id="sumologichttpoutput-batch-timeout">batch-timeout (int, optional)</h3><h3 id="sumologichttpoutput-body">body (string, optional)</h3><h3 id="sumologichttpoutput-collector">collector (*secret.Secret, optional)</h3><p>The Cloud Syslog Cloud Token that you received from the Sumo Logic service while configuring your cloud syslog source.</p><p>Default: empty</p><h3 id="sumologichttpoutput-deployment">deployment (string, optional)</h3><p>This option specifies your <a href="https://help.sumologic.com/APIs/General-API-Information/Sumo-Logic-Endpoints-by-Deployment-and-Firewall-Security">Sumo Logic deployment</a>.</p><p>Default: empty</p><h3 id="sumologichttpoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="sumologichttpoutput-headers">headers ([]string, optional)</h3><p>Custom HTTP headers to include in the request, for example, <code>headers("HEADER1: header1", "HEADER2: header2")</code>.</p><p>Default: empty</p><h3 id="sumologichttpoutput-persist_name">persist_name (string, optional)</h3><h3 id="sumologichttpoutput-time_reopen">time_reopen (int, optional)</h3><p>The time to wait in seconds before a dead connection is reestablished.</p><p>Default: 60</p><h3 id="sumologichttpoutput-tls">tls (*TLS, optional)</h3><p>This option sets various options related to TLS encryption, for example, key/certificate files and trusted CA locations. TLS can be used only with tcp-based transport protocols. For details, see <a href="../tls/">TLS for syslog-ng outputs</a> and the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><p>Default: -</p><h3 id="sumologichttpoutput-url">url (*secret.Secret, optional)</h3></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-1721ec291a25f8230ddeedf2a20018f9">4.8.6.18 - Sumo Logic Syslog</h1><p>The <code>sumologic-syslog</code> output sends log records over HTTP to Sumo Logic. For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-sumologic-intro/destination-sumologic-options/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="prerequisites">Prerequisites</h2><p>You need a Sumo Logic account to use this output. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/destination-sumologic-intro/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="configuration">Configuration</h2><h2 id="sumologicsyslogoutput">SumologicSyslogOutput</h2><h3 id="sumologicsyslogoutput-deployment">deployment (string, optional)</h3><p>This option specifies your <a href="https://help.sumologic.com/APIs/General-API-Information/Sumo-Logic-Endpoints-by-Deployment-and-Firewall-Security">Sumo Logic deployment</a>.</p><p>Default: empty</p><h3 id="sumologicsyslogoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>This option enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><p>Default: false</p><h3 id="sumologicsyslogoutput-persist_name">persist_name (string, optional)</h3><h3 id="sumologicsyslogoutput-port">port (int, optional)</h3><p>This option sets the port number of the Sumo Logic server to connect to.</p><p>Default: 6514</p><h3 id="sumologicsyslogoutput-tag">tag (string, optional)</h3><p>This option specifies the list of tags to add as the tags fields of Sumo Logic messages. If not specified, syslog-ng OSE automatically adds the tags already assigned to the message. If you set the tag() option, only the tags you specify will be added to the messages.</p><p>Default: tag</p><h3 id="sumologicsyslogoutput-token">token (int, optional)</h3><p>The Cloud Syslog Cloud Token that you received from the Sumo Logic service while configuring your cloud syslog source. <a href="https://help.sumologic.com/03Send-Data/Sources/02Sources-for-Hosted-Collectors/Cloud-Syslog-Source#configure-a-cloud%C2%A0syslog%C2%A0source">https://help.sumologic.com/03Send-Data/Sources/02Sources-for-Hosted-Collectors/Cloud-Syslog-Source#configure-a-cloud%C2%A0syslog%C2%A0source</a></p><h3 id="sumologicsyslogoutput-tls">tls (*TLS, optional)</h3><p>This option sets various options related to TLS encryption, for example, key/certificate files and trusted CA locations. TLS can be used only with tcp-based transport protocols. For details, see <a href="../tls/">TLS for syslog-ng outputs</a> and the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions/">documentation of the AxoSyslog syslog-ng distribution</a>.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-17c2f3cac6d1fd9cb831fa66c2daf727">4.8.6.19 - Syslog (RFC5424) output</h1><p>The <code>syslog</code> output sends log records over a socket using the Syslog protocol (RFC 5424). Based on the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/">syslog destination of AxoSyslog core</a>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslog</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">10.12.34.56</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">transport</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tls</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">ca_file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">mountFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls-secret</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ca.crt</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">cert_file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">mountFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls-secret</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls.crt</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">key_file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">mountFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls-secret</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls.key</span></span></span></code></pre></div><p>The following example also configures disk-based buffering for the output. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslog</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">host</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">10.20.9.89</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">port</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">601</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">disk_buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">disk_buf_size</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">512000000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">dir</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/buffer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">reliable</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">template</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;$(format-json
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">                --subkeys json.
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">                --exclude json.kubernetes.labels.*
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06">                json.kubernetes.labels=literal($(format-flat-json --subkeys json.kubernetes.labels.)))\n&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tls</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">ca_file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">mountFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ca.crt</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">syslog-tls-cert</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">cert_file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">mountFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls.crt</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">syslog-tls-cert</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">key_file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">mountFrom</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">secretKeyRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls.key</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">syslog-tls-cert</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">transport</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">tls</span></span></span></code></pre></div><p>For details on the available options of the output, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h2 id="configuration">Configuration</h2><h3 id="syslogoutput-close_on_input">close_on_input (*bool, optional)</h3><p>By default, syslog-ng OSE closes destination sockets if it receives any input from the socket (for example, a reply). If this option is set to no, syslog-ng OSE just ignores the input, but does not close the socket. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/reference-destination-syslog-chapter/#close-on-input">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="syslogoutput-disk_buffer">disk_buffer (*DiskBuffer, optional)</h3><p>Enables putting outgoing messages into the disk buffer of the destination to avoid message loss in case of a system failure on the destination side. For details, see the <a href="../disk_buffer/">Syslog-ng DiskBuffer options</a>.</p><h3 id="syslogoutput-flags">flags ([]string, optional)</h3><p>Flags influence the behavior of the destination driver. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/reference-destination-syslog-chapter/#flags">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="syslogoutput-flush_lines">flush_lines (int, optional)</h3><p>Specifies how many lines are flushed to a destination at a time. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/reference-destination-syslog-chapter/#flush-lines">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="syslogoutput-host">host (string, optional)</h3><p>Address of the destination host</p><h3 id="syslogoutput-persist_name">persist_name (string, optional)</h3><p>Unique name for the syslog-ng driver. If you receive the following error message during syslog-ng startup, set the <code>persist-name()</code> option of the duplicate drivers: <code>Error checking the uniqueness of the persist names, please override it with persist-name option. Shutting down.</code> See the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-http-nonjava/reference-destination-http-nonjava/#persist-name">documentation of the AxoSyslog syslog-ng distribution</a> for more information.</p><h3 id="syslogoutput-port">port (int, optional)</h3><p>The port number to connect to. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/reference-destination-syslog-chapter/#port-or-destport">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="syslogoutput-so_keepalive">so_keepalive (*bool, optional)</h3><p>Enables keep-alive messages, keeping the socket open. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/reference-destination-syslog-chapter/#so-keepalive">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="syslogoutput-suppress">suppress (int, optional)</h3><p>Specifies the number of seconds syslog-ng waits for identical messages. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/reference-destination-syslog-chapter/#suppress">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="syslogoutput-template">template (string, optional)</h3><p>Specifies a template defining the logformat to be used in the destination. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/reference-destination-syslog-chapter/#template">documentation of the AxoSyslog syslog-ng distribution</a>.</p><p>Default: 0</p><h3 id="syslogoutput-template_escape">template_escape (*bool, optional)</h3><p>Turns on escaping for the &lsquo;, &ldquo;, and backspace characters in templated output files. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/reference-destination-syslog-chapter/#template-escape">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="syslogoutput-tls">tls (*TLS, optional)</h3><p>Sets various options related to TLS encryption, for example, key/certificate files and trusted CA locations. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/reference-destination-syslog-chapter/#tls">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="syslogoutput-transport">transport (string, optional)</h3><p>Specifies the protocol used to send messages to the destination server. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/reference-destination-syslog-chapter/#transport">documentation of the AxoSyslog syslog-ng distribution</a>.</p><h3 id="syslogoutput-ts_format">ts_format (string, optional)</h3><p>Override the global timestamp format (set in the global ts-format() parameter) for the specific destination. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-destinations/configuring-destinations-syslog/reference-destination-syslog-chapter/#ts-format">documentation of the AxoSyslog syslog-ng distribution</a>.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-56a41f3fbc6007034e66766bff690bfa">4.8.6.20 - TLS config for syslog-ng outputs</h1><p>For details on how TLS configuration works in syslog-ng, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/">AxoSyslog Core documentation</a>.</p><h2 id="configuration">Configuration</h2><h3 id="tls-ca_dir">ca_dir (*secret.Secret, optional)</h3><p>The name of a directory that contains a set of trusted CA certificates in PEM format. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions/#ca-dir">AxoSyslog Core documentation</a>.</p><h3 id="tls-ca_file">ca_file (*secret.Secret, optional)</h3><p>The name of a file that contains a set of trusted CA certificates in PEM format. (Optional) For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions/#ca-file">AxoSyslog Core documentation</a>.</p><h3 id="tls-cert_file">cert_file (*secret.Secret, optional)</h3><p>Name of a file, that contains an X.509 certificate (or a certificate chain) in PEM format, suitable as a TLS certificate, matching the private key set in the key-file() option. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions/#cert-file">AxoSyslog Core documentation</a>.</p><h3 id="tls-cipher-suite">cipher-suite (string, optional)</h3><p>Description: Specifies the cipher, hash, and key-exchange algorithms used for the encryption, for example, ECDHE-ECDSA-AES256-SHA384. The list of available algorithms depends on the version of OpenSSL used to compile syslog-ng.</p><h3 id="tls-key_file">key_file (*secret.Secret, optional)</h3><p>The name of a file that contains an unencrypted private key in PEM format, suitable as a TLS key. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions/#key-file">AxoSyslog Core documentation</a>.</p><h3 id="tls-peer_verify">peer_verify (*bool, optional)</h3><p>Verification method of the peer. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions/#tls-options-peer-verify">AxoSyslog Core documentation</a>.</p><h3 id="tls-ssl_version">ssl_version (string, optional)</h3><p>Configure required TLS version. Accepted values: [sslv3, tlsv1, tlsv1_0, tlsv1_1, tlsv1_2, tlsv1_3]</p><h3 id="tls-use-system-cert-store">use-system-cert-store (*bool, optional)</h3><p>Use the certificate store of the system for verifying HTTPS certificates. For details, see the <a href="https://curl.se/docs/sslcerts.html">AxoSyslog Core documentation</a>.</p><h2 id="grpctls">GrpcTLS</h2><h3 id="grpctls-ca_file">ca_file (*secret.Secret, optional)</h3><p>The name of a file that contains a set of trusted CA certificates in PEM format. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions/#ca-file">AxoSyslog Core documentation</a>.</p><h3 id="grpctls-cert_file">cert_file (*secret.Secret, optional)</h3><p>Name of a file that contains an X.509 certificate (or a certificate chain) in PEM format, suitable as a TLS certificate, matching the private key set in the key-file() option. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions/#cert-file">AxoSyslog Core documentation</a>.</p><h3 id="grpctls-key_file">key_file (*secret.Secret, optional)</h3><p>The name of a file that contains an unencrypted private key in PEM format, suitable as a TLS key. For details, see the <a href="https://axoflow.com/docs/axosyslog-core/chapter-encrypted-transport-tls/tlsoptions/#key-file">AxoSyslog Core documentation</a>.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-7eee50e5d896d8c0f7761ed471a95d89">5 - Examples</h1><h2 id="flow-examples">Flow examples</h2><p>The following examples show some simple flows. For more examples that use filters, see <a href="/5.1/docs/examples/filters-in-flows/">Filter examples in Flows</a>.</p><h3 id="flow-with-a-single-output">Flow with a single output</h3><p>This Flow sends every message with the <code>app: nginx</code> label to the output called <code>forward-output-sample</code>.</p><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_flow_single_output.yaml' data-download-link data-download-link-label="Download this file" $opts></pre><h3 id="flow-with-multiple-outputs">Flow with multiple outputs</h3><p>This Flow sends every message with the <code>app: nginx</code> label to the <code>gcs-output-sample</code> and <code>s3-output-example</code> outputs.</p><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_flow_multiple_output.yaml' data-download-link data-download-link-label="Download this file" $opts></pre><h2 id="logging-examples">Logging examples</h2><p>Simple <a href="/5.1/docs/logging-infrastructure/logging/">Logging</a> definition with default values.</p><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_logging_simple.yaml' data-download-link data-download-link-label="Download this file" $opts></pre><h3 id="logging-with-tls">Logging with TLS</h3><p>Simple <a href="/5.1/docs/logging-infrastructure/logging/">Logging</a> definition with <a href="/5.1/docs/logging-infrastructure/tls/">TLS encryption enabled</a>.</p><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_logging_tls.yaml' data-download-link data-download-link-label="Download this file" $opts></pre><h2 id="output-examples">Output examples</h2><h3 id="simple-file-output">Simple file output</h3><p>Defines a <a href="/5.1/docs/configuration/plugins/outputs/file/">file output</a> with timestamped log files.</p><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_output_file.yaml' data-download-link data-download-link-label="Download this file" $opts></pre><h3 id="drop-messages-into-devnull-output">Drop messages into dev/null output</h3><p>Creates a dev/null output that can be the destination of messages you want to drop explicitly.</p><div class="warning-block">
<p><strong>CAUTION:</strong></p>Messages sent to this output are irrevocably lost forever.
</div><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_output_null.yaml' data-download-link data-download-link-label="Download this file" $opts></pre><h3 id="s3-output">S3 output</h3><p>Defines an <a href="/5.1/docs/configuration/plugins/outputs/s3/">Amazon S3 output</a> to store your logs in a bucket.</p><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_output_s3.yaml' data-download-link data-download-link-label="Download this file" $opts></pre><h3 id="gcs-output">GCS output</h3><p>Defines a <a href="/5.1/docs/configuration/plugins/outputs/gcs/">Google Cloud Storage output</a> to store your logs.</p><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_output_s3.yaml' data-download-link data-download-link-label="Download this file" $opts></pre></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-05eacbf7a0c1b481b78d7fadf3072b45">5.1 - Filter examples in Flows</h1><p>YAML files for simple logging flows with filter examples.</p><h2 id="geoip-filter">GeoIP filter</h2><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_flow_geoip.yaml' data-download-link data-download-link-label="Download this file" $opts></pre><h2 id="parser-and-tag-normalizer">Parser and tag normalizer</h2><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_flow_with_filters.yaml' data-download-link data-download-link-label="Download this file" $opts></pre><h2 id="dedot-filter">Dedot filter</h2><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_flow_with_dedot.yaml' data-download-link data-download-link-label="Download this file" $opts></pre><h2 id="multiple-format">Multiple format</h2><pre data-src='https://kube-logging.dev/5.1/docs/examples/logging_flow_with_multi_format.yaml' data-download-link data-download-link-label="Download this file" $opts></pre></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-a32e96d02144ee3cb1936db017f63e08">5.2 - Parsing custom date formats</h1><p>By default, the syslog-ng aggregator uses the time when a message has been received on its input source as the timestamp. If you want to use the timestamp written in the message metadata, you can use a <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/date-parser/date-parser-options/">date-parser</a>.</p><p>Available in Logging operator version 4.5 and later.</p><p>To use the timestamps written by the container runtime (<em>cri</em> or <em>docker</em>) and parsed by Fluent Bit, define the <code>sourceDateParser</code> in the <em>syslog-ng</em> spec.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogNG</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">sourceDateParser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>You can also define your own parser format and template. The following example shows the default values.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogNG</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">sourceDateParser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;%FT%T.%f%z&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">template</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;${json.time}&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-40c8034365add30f05453065286935a7">5.3 - Store Nginx Access Logs in Amazon CloudWatch with Logging Operator</h1><p align="center"><img src="../../img/nlw.png" alt="Logos" width="340"></p><p>This guide describes how to collect application and container logs in Kubernetes using the Logging operator, and how to send them to CloudWatch.</p><p>The following figure gives you an overview about how the system works. The Logging operator collects the logs from the application, selects which logs to forward to the output, and sends the selected log messages to the output. For more details about the Logging operator, see the <a href="/5.1/docs/">Logging operator overview</a>.</p><p align="center"><img src="../../img/nginx-cloudwatch.png" alt="Architecture" width="900"></p><h2 id="deploy-the-logging-operator-and-a-demo-application">Deploy the Logging operator and a demo Application</h2><p>Install the Logging operator and a demo application using <a href="#helm">Helm</a>.</p><h3 id="helm">Deploy the Logging operator with Helm</h3><p>To install the Logging operator using Helm, complete the following steps.</p><blockquote>
<p>Note: You need Helm v3.8 or later to be able to install the chart from an OCI registry.</p></blockquote><ol>
<li>
<p>Install the Logging operator into the <em>logging</em> namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging logging-operator oci://ghcr.io/kube-logging/helm-charts/logging-operator
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;logging-operator&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>Pulled: ghcr.io/kube-logging/helm-charts/logging-operator:4.3.0
</span></span><span style="display:flex"><span>Digest: sha256:c2ece861f66a3a2cb9788e7ca39a267898bb5629dc98429daa8f88d7acf76840
</span></span><span style="display:flex"><span>NAME: logging-operator
</span></span><span style="display:flex"><span>LAST DEPLOYED: Wed Aug  <span style="color:#0000cf;font-weight:700">9</span> 11:02:12 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: logging
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>TEST SUITE: None
</span></span></code></pre></div><blockquote>
<p>Note:</p><ul>
<li>
<p>Helm has a known issue in version 3.13.0 that requires users to log in to the registry, even though the repo is public.</p><p>Upgrade to 3.13.1 or higher to avoid having to log in, see: <a href="https://github.com/kube-logging/logging-operator/issues/1522">https://github.com/kube-logging/logging-operator/issues/1522</a></p></li><li>
<p>If you&rsquo;re installing the Helm chart from Terraform, reference the repository as <code>repository = "oci://ghcr.io/kube-logging/helm-charts/"</code> (without the <code>logging-operator</code> suffix). Otherwise, you&rsquo;ll get a <a href="https://github.com/hashicorp/terraform-provider-helm/issues/1291">403 Forbidden error</a>.</p></li></ul></blockquote></li><li>
<p>Create AWS <code>secret</code></p><blockquote>
<p>If you have your <code>$AWS_ACCESS_KEY_ID</code> and <code>$AWS_SECRET_ACCESS_KEY</code> set you can use the following snippet.</p></blockquote><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>    kubectl -n logging create secret generic logging-cloudwatch --from-literal <span style="color:#4e9a06">&#34;awsAccessKeyId=</span><span style="color:#000">$AWS_ACCESS_KEY_ID</span><span style="color:#4e9a06">&#34;</span> --from-literal <span style="color:#4e9a06">&#34;awsSecretAccessKey=</span><span style="color:#000">$AWS_SECRET_ACCESS_KEY</span><span style="color:#4e9a06">&#34;</span>
</span></span></code></pre></div><p>Or set up the secret manually.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>    kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>    apiVersion: v1
</span></span><span style="display:flex"><span>    kind: Secret
</span></span><span style="display:flex"><span>    metadata:
</span></span><span style="display:flex"><span>      name: logging-cloudwatch
</span></span><span style="display:flex"><span>    type: Opaque
</span></span><span style="display:flex"><span>    data:
</span></span><span style="display:flex"><span>      awsAccessKeyId: &lt;base64encoded&gt;
</span></span><span style="display:flex"><span>      awsSecretAccessKey: &lt;base64encoded&gt;
</span></span><span style="display:flex"><span>    EOF
</span></span></code></pre></div></li><li>
<p>Create the <code>logging</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Logging
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: default-logging-simple
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  fluentd: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  fluentbit: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  controlNamespace: logging
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: You can use the <code>ClusterOutput</code> and <code>ClusterFlow</code> resources only in the <code>controlNamespace</code>.</p></blockquote></li><li>
<p>Create an CloudWatch <code>output</code> definition.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Output
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span> name: cloudwatch-output
</span></span><span style="display:flex"><span> namespace: logging
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span> cloudwatch:
</span></span><span style="display:flex"><span>   aws_key_id:
</span></span><span style="display:flex"><span>     valueFrom:
</span></span><span style="display:flex"><span>       secretKeyRef:
</span></span><span style="display:flex"><span>         name: logging-cloudwatch
</span></span><span style="display:flex"><span>         key: awsAccessKeyId
</span></span><span style="display:flex"><span>   aws_sec_key:
</span></span><span style="display:flex"><span>     valueFrom:
</span></span><span style="display:flex"><span>       secretKeyRef:
</span></span><span style="display:flex"><span>         name: logging-cloudwatch
</span></span><span style="display:flex"><span>         key: awsSecretAccessKey
</span></span><span style="display:flex"><span>   log_group_name: operator-log-group
</span></span><span style="display:flex"><span>   log_stream_name: operator-log-stream
</span></span><span style="display:flex"><span>   region: us-east-1
</span></span><span style="display:flex"><span>   auto_create_stream: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>   buffer:
</span></span><span style="display:flex"><span>     timekey: 30s
</span></span><span style="display:flex"><span>     timekey_wait: 30s
</span></span><span style="display:flex"><span>     timekey_use_utc: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: In production environment, use a longer <code>timekey</code> interval to avoid generating too many objects.</p></blockquote></li><li>
<p>Create a <code>flow</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Flow
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: cloudwatch-flow
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  filters:
</span></span><span style="display:flex"><span>    - tag_normaliser: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>    - parser:
</span></span><span style="display:flex"><span>        remove_key_name_field: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>        reserve_data: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>        parse:
</span></span><span style="display:flex"><span>          type: nginx
</span></span><span style="display:flex"><span>  match:
</span></span><span style="display:flex"><span>    - <span style="color:#204a87;font-weight:700">select</span>:
</span></span><span style="display:flex"><span>        labels:
</span></span><span style="display:flex"><span>          app.kubernetes.io/name: log-generator
</span></span><span style="display:flex"><span>  localOutputRefs:
</span></span><span style="display:flex"><span>    - cloudwatch-output
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div></li><li>
<p>Install log-generator to produce logs with the label <code>app.kubernetes.io/name: log-generator</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging log-generator oci://ghcr.io/kube-logging/helm-charts/log-generator
</span></span></code></pre></div></li><li>
<p><a href="#validate">Validate your deployment</a>.</p></li></ol><h2 id="validate">Validate the deployment</h2><p align="center"><img src="../../img/cw.png" alt="Cloudwatch dashboard"></p><blockquote>
<p>If you don&rsquo;t get the expected result you can find help in the <a href="/5.1/docs/operation/troubleshooting/">troubleshooting section</a>.</p></blockquote></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-8ccd39da9b80871a1d5d3a16b317985a">5.4 - Transport all logs into Amazon S3 with Logging operator</h1><p align="center"><img src="../../img/s3_logo.png" alt="Logos" width="340"></p><p>This guide describes how to collect all the container logs in Kubernetes using the Logging operator, and how to send them to Amazon S3.</p><p>The following figure gives you an overview about how the system works. The Logging operator collects the logs from the application, selects which logs to forward to the output, and sends the selected log messages to the output. For more details about the Logging operator, see the <a href="/5.1/docs/">Logging operator overview</a>.</p><p align="center"><img src="../../img/s3_flow.png" alt="Architecture" width="900"></p><h2 id="deploy-the-logging-operator">Deploy the Logging operator</h2><p>Install the Logging operator.</p><h3 id="helm">Deploy the Logging operator with Helm</h3><p>To install the Logging operator using Helm, complete the following steps.</p><blockquote>
<p>Note: You need Helm v3.8 or later to be able to install the chart from an OCI registry.</p></blockquote><ol>
<li>
<p>Install the Logging operator into the <em>logging</em> namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging logging-operator oci://ghcr.io/kube-logging/helm-charts/logging-operator
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;logging-operator&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>Pulled: ghcr.io/kube-logging/helm-charts/logging-operator:4.3.0
</span></span><span style="display:flex"><span>Digest: sha256:c2ece861f66a3a2cb9788e7ca39a267898bb5629dc98429daa8f88d7acf76840
</span></span><span style="display:flex"><span>NAME: logging-operator
</span></span><span style="display:flex"><span>LAST DEPLOYED: Wed Aug  <span style="color:#0000cf;font-weight:700">9</span> 11:02:12 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: logging
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>TEST SUITE: None
</span></span></code></pre></div><blockquote>
<p>Note:</p><ul>
<li>
<p>Helm has a known issue in version 3.13.0 that requires users to log in to the registry, even though the repo is public.</p><p>Upgrade to 3.13.1 or higher to avoid having to log in, see: <a href="https://github.com/kube-logging/logging-operator/issues/1522">https://github.com/kube-logging/logging-operator/issues/1522</a></p></li><li>
<p>If you&rsquo;re installing the Helm chart from Terraform, reference the repository as <code>repository = "oci://ghcr.io/kube-logging/helm-charts/"</code> (without the <code>logging-operator</code> suffix). Otherwise, you&rsquo;ll get a <a href="https://github.com/hashicorp/terraform-provider-helm/issues/1291">403 Forbidden error</a>.</p></li></ul></blockquote></li><li>
<p><a href="#validate">Validate your deployment</a>.</p></li></ol><h2 id="configure-the-logging-operator">Configure the Logging operator</h2><ol>
<li>
<p>Create AWS <code>secret</code></p><blockquote>
<p>If you have your <code>$AWS_ACCESS_KEY_ID</code> and <code>$AWS_SECRET_ACCESS_KEY</code> set you can use the following snippet.</p></blockquote><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging create secret generic logging-s3 --from-literal <span style="color:#4e9a06">&#34;awsAccessKeyId=</span><span style="color:#000">$AWS_ACCESS_KEY_ID</span><span style="color:#4e9a06">&#34;</span> --from-literal <span style="color:#4e9a06">&#34;awsSecretAccessKey=</span><span style="color:#000">$AWS_SECRET_ACCESS_KEY</span><span style="color:#4e9a06">&#34;</span>
</span></span></code></pre></div><p>Or set up the secret manually.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>    kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>    apiVersion: v1
</span></span><span style="display:flex"><span>    kind: Secret
</span></span><span style="display:flex"><span>    metadata:
</span></span><span style="display:flex"><span>      name: logging-s3
</span></span><span style="display:flex"><span>    type: Opaque
</span></span><span style="display:flex"><span>    data:
</span></span><span style="display:flex"><span>      awsAccessKeyId: &lt;base64encoded&gt;
</span></span><span style="display:flex"><span>      awsSecretAccessKey: &lt;base64encoded&gt;
</span></span><span style="display:flex"><span>    EOF
</span></span></code></pre></div></li><li>
<p>Create the <code>logging</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Logging
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: default-logging-simple
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  fluentd: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  fluentbit: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  controlNamespace: logging
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: You can use the <code>ClusterOutput</code> and <code>ClusterFlow</code> resources only in the <code>controlNamespace</code>.</p></blockquote></li><li>
<p>Create an S3 <code>output</code> definition.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Output
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span> name: s3-output
</span></span><span style="display:flex"><span> namespace: logging
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span> s3:
</span></span><span style="display:flex"><span>   aws_key_id:
</span></span><span style="display:flex"><span>     valueFrom:
</span></span><span style="display:flex"><span>       secretKeyRef:
</span></span><span style="display:flex"><span>         name: logging-s3
</span></span><span style="display:flex"><span>         key: awsAccessKeyId
</span></span><span style="display:flex"><span>   aws_sec_key:
</span></span><span style="display:flex"><span>     valueFrom:
</span></span><span style="display:flex"><span>       secretKeyRef:
</span></span><span style="display:flex"><span>         name: logging-s3
</span></span><span style="display:flex"><span>         key: awsSecretAccessKey
</span></span><span style="display:flex"><span>   s3_bucket: logging-amazon-s3
</span></span><span style="display:flex"><span>   s3_region: eu-central-1
</span></span><span style="display:flex"><span>   path: logs/<span style="color:#4e9a06">${</span><span style="color:#000">tag</span><span style="color:#4e9a06">}</span>/%Y/%m/%d/
</span></span><span style="display:flex"><span>   buffer:
</span></span><span style="display:flex"><span>     timekey: 10m
</span></span><span style="display:flex"><span>     timekey_wait: 30s
</span></span><span style="display:flex"><span>     timekey_use_utc: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: In production environment, use a longer <code>timekey</code> interval to avoid generating too many objects.</p></blockquote></li><li>
<p>Create a <code>flow</code> resource. (Mind the label selector in the <code>match</code> that selects a set of pods that we will install in the next step)</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Flow
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: s3-flow
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  filters:
</span></span><span style="display:flex"><span>    - tag_normaliser: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  match:
</span></span><span style="display:flex"><span>    - <span style="color:#204a87;font-weight:700">select</span>:
</span></span><span style="display:flex"><span>        labels:
</span></span><span style="display:flex"><span>          app.kubernetes.io/name: log-generator
</span></span><span style="display:flex"><span>  localOutputRefs:
</span></span><span style="display:flex"><span>    - s3-output
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div></li><li>
<p>Install log-generator to produce logs with the label <code>app.kubernetes.io/name: log-generator</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging log-generator oci://ghcr.io/kube-logging/helm-charts/log-generator
</span></span></code></pre></div></li><li>
<p><a href="#validate">Validate your deployment</a>.</p></li></ol><h2 id="validate">Validate the deployment</h2><p>Check fluentd logs (errors with AWS credentials should be visible here):</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl logs -f -n logging default-logging-simple-fluentd-0 -c fluentd
</span></span></code></pre></div><blockquote>
<p>Fluentd logs were written to the container filesystem up until Logging operator version 4.3, which has been changed to stdout with 4.4.
See <a href="/5.1/docs/logging-infrastructure/fluentd/#fluentoutlogrotate">FluentOutLogrotate</a> why this was changed and how you can re-enable it if needed.</p></blockquote><p>Check the output. The logs will be available in the bucket on a <code>path</code> like:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>/logs/default.default-logging-simple-fluentbit-lsdp5.fluent-bit/2019/09/11/201909111432_0.gz
</span></span></code></pre></div><blockquote>
<p>If you don&rsquo;t get the expected result you can find help in the <a href="/5.1/docs/operation/troubleshooting/">troubleshooting section</a>.</p></blockquote></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-4db6cfeb56675824920db186601c2746">5.5 - Store NGINX access logs in Elasticsearch with Logging operator</h1><p align="center"><img src="../../img/nle.png" alt="Logos" width="340"></p><p>This guide describes how to collect application and container logs in Kubernetes using the Logging operator, and how to send them to Elasticsearch.</p><p>The following figure gives you an overview about how the system works. The Logging operator collects the logs from the application, selects which logs to forward to the output, and sends the selected log messages to the output. For more details about the Logging operator, see the <a href="/5.1/docs/">Logging operator overview</a>.</p><p align="center"><img src="../../img/nginx-elastic.png" alt="Architecture" width="900"></p><h2 id="deploy-elasticsearch">Deploy Elasticsearch</h2><p>First, deploy Elasticsearch in your Kubernetes cluster. The following procedure is based on the <a href="https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-quickstart.html">Elastic Cloud on Kubernetes quickstart</a>, but there are some minor configuration changes, and we install everything into the <em>logging</em> namespace.</p><ol>
<li>
<p>Install the Elasticsearch operator.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl apply -f https://download.elastic.co/downloads/eck/1.3.0/all-in-one.yaml</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Create the <code>logging</code> Namespace.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl create ns logging
</span></span></code></pre></div></li><li>
<p>Install the Elasticsearch cluster into the <em>logging</em> namespace.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">cat &lt;&lt;EOF | kubectl apply -n logging -f -</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">elasticsearch.k8s.elastic.co/v1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Elasticsearch</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">quickstart</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">version</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">7.10.0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">nodeSets</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">count</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">config</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">node.master</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">node.data</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">node.ingest</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">node.store.allow_mmap</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Install Kibana into the <em>logging</em> namespace.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">cat &lt;&lt;EOF | kubectl apply -n logging -f -</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">kibana.k8s.elastic.co/v1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Kibana</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">quickstart</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">version</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">7.10.0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">count</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">elasticsearchRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">quickstart</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li></ol><h2 id="deploy-the-logging-operator-and-a-demo-application">Deploy the Logging operator and a demo Application</h2><p>Install the Logging operator and a demo application to provide sample log messages.</p><h3 id="helm">Deploy the Logging operator with Helm</h3><p>To install the Logging operator using Helm, complete the following steps.</p><blockquote>
<p>Note: You need Helm v3.8 or later to be able to install the chart from an OCI registry.</p></blockquote><ol>
<li>
<p>Install the Logging operator into the <em>logging</em> namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging logging-operator oci://ghcr.io/kube-logging/helm-charts/logging-operator
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;logging-operator&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>Pulled: ghcr.io/kube-logging/helm-charts/logging-operator:4.3.0
</span></span><span style="display:flex"><span>Digest: sha256:c2ece861f66a3a2cb9788e7ca39a267898bb5629dc98429daa8f88d7acf76840
</span></span><span style="display:flex"><span>NAME: logging-operator
</span></span><span style="display:flex"><span>LAST DEPLOYED: Wed Aug  <span style="color:#0000cf;font-weight:700">9</span> 11:02:12 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: logging
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>TEST SUITE: None
</span></span></code></pre></div><blockquote>
<p>Note:</p><ul>
<li>
<p>Helm has a known issue in version 3.13.0 that requires users to log in to the registry, even though the repo is public.</p><p>Upgrade to 3.13.1 or higher to avoid having to log in, see: <a href="https://github.com/kube-logging/logging-operator/issues/1522">https://github.com/kube-logging/logging-operator/issues/1522</a></p></li><li>
<p>If you&rsquo;re installing the Helm chart from Terraform, reference the repository as <code>repository = "oci://ghcr.io/kube-logging/helm-charts/"</code> (without the <code>logging-operator</code> suffix). Otherwise, you&rsquo;ll get a <a href="https://github.com/hashicorp/terraform-provider-helm/issues/1291">403 Forbidden error</a>.</p></li></ul></blockquote></li><li>
<p><a href="#validate">Validate your deployment</a>.</p></li></ol><h2 id="configure-the-logging-operator">Configure the Logging operator</h2><ol>
<li>
<p>Create the <code>logging</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Logging
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: default-logging-simple
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  fluentd: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  fluentbit: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  controlNamespace: logging
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: You can use the <code>ClusterOutput</code> and <code>ClusterFlow</code> resources only in the <code>controlNamespace</code>.</p></blockquote></li><li>
<p>Create an Elasticsearch <code>output</code> definition.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Output
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: es-output
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  elasticsearch:
</span></span><span style="display:flex"><span>    host: quickstart-es-http.logging.svc.cluster.local
</span></span><span style="display:flex"><span>    port: <span style="color:#0000cf;font-weight:700">9200</span>
</span></span><span style="display:flex"><span>    scheme: https
</span></span><span style="display:flex"><span>    ssl_verify: <span style="color:#204a87">false</span>
</span></span><span style="display:flex"><span>    ssl_version: TLSv1_2
</span></span><span style="display:flex"><span>    user: elastic
</span></span><span style="display:flex"><span>    password:
</span></span><span style="display:flex"><span>      valueFrom:
</span></span><span style="display:flex"><span>        secretKeyRef:
</span></span><span style="display:flex"><span>          name: quickstart-es-elastic-user
</span></span><span style="display:flex"><span>          key: elastic
</span></span><span style="display:flex"><span>    buffer:
</span></span><span style="display:flex"><span>      timekey: 1m
</span></span><span style="display:flex"><span>      timekey_wait: 30s
</span></span><span style="display:flex"><span>      timekey_use_utc: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: In production environment, use a longer <code>timekey</code> interval to avoid generating too many objects.</p></blockquote></li><li>
<p>Create a <code>flow</code> resource. (Mind the label selector in the <code>match</code> that selects a set of pods that we will install in the next step)</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Flow
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: es-flow
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  filters:
</span></span><span style="display:flex"><span>    - tag_normaliser: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>    - parser:
</span></span><span style="display:flex"><span>        remove_key_name_field: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>        reserve_data: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>        parse:
</span></span><span style="display:flex"><span>          type: nginx
</span></span><span style="display:flex"><span>  match:
</span></span><span style="display:flex"><span>     - <span style="color:#204a87;font-weight:700">select</span>:
</span></span><span style="display:flex"><span>         labels:
</span></span><span style="display:flex"><span>           app.kubernetes.io/name: log-generator
</span></span><span style="display:flex"><span>  localOutputRefs:
</span></span><span style="display:flex"><span>    - es-output
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div></li><li>
<p>Install the demo application.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging log-generator oci://ghcr.io/kube-logging/helm-charts/log-generator
</span></span></code></pre></div></li><li>
<p><a href="#validate">Validate your deployment</a>.</p></li></ol><h2 id="validate">Validate the deployment</h2><p>To validate that the deployment was successful, complete the following steps.</p><ol>
<li>
<p>Check fluentd logs:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl logs -f -n logging default-logging-simple-fluentd-0 -c fluentd
</span></span></code></pre></div><blockquote>
<p>Fluentd logs were written to the container filesystem up until Logging operator version 4.3, which has been changed to stdout with 4.4.
See <a href="/5.1/docs/logging-infrastructure/fluentd/#fluentoutlogrotate">FluentOutLogrotate</a> why this was changed and how you can re-enable it if needed.</p></blockquote></li><li>
<p>Use the following command to retrieve the password of the <code>elastic</code> user:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging get secret quickstart-es-elastic-user -o<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.data.elastic}&#39;</span> <span style="color:#000;font-weight:700">|</span> base64 --decode<span style="color:#000;font-weight:700">;</span> <span style="color:#204a87">echo</span>
</span></span></code></pre></div></li><li>
<p>Enable port forwarding to the Kibana Dashboard Service.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging port-forward svc/quickstart-kb-http <span style="color:#0000cf;font-weight:700">5601</span>
</span></span></code></pre></div></li><li>
<p>Open the Kibana dashboard in your browser at <a href="https://localhost:5601">https://localhost:5601</a> and login as <strong>elastic</strong> using the retrieved password.</p></li><li>
<p>By default, the Logging operator sends the incoming log messages into an index called <em>fluentd</em>. Create an Index Pattern that includes this index (for example, <em>fluentd*</em>), then select <strong>Menu > Kibana > Discover</strong>. You should see the dashboard and some sample log messages from the demo application.</p></li></ol><p align="center"><img src="../../img/es_kibana.png" alt="Kibana dashboard"></p><blockquote>
<p>If you don&rsquo;t get the expected result you can find help in the <a href="/5.1/docs/operation/troubleshooting/">troubleshooting section</a>.</p></blockquote></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-151681c15ceae7e696e0c20fe51220fa">5.6 - Splunk operator with Logging operator</h1><p align="center"><img src="../../img/splunk.png" alt="Logos" width="340"></p><p>This guide describes how to collect application and container logs in Kubernetes using the Logging operator, and how to send them to Splunk.</p><p>Logging operator collects the logs from the application, selects which logs to forward to the output, and sends the selected log messages to the output (in this case, to Splunk). For more details about the Logging operator, see the <a href="/5.1/docs/">Logging operator overview</a>.</p><h2 id="deploy-splunk">Deploy Splunk</h2><p>First, deploy Splunk Standalone in your Kubernetes cluster. The following procedure is based on the <a href="https://www.splunk.com/en_us/blog/it/an-insider-s-guide-to-splunk-on-containers-and-kubernetes.html">Splunk on Kubernetes quickstart</a>.</p><ol>
<li>
<p>Create the <code>logging</code> Namespace.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl create ns logging
</span></span></code></pre></div></li><li>
<p>Install the Splunk operator.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl apply -n logging -f https://github.com/splunk/splunk-operator/releases/download/2.4.0/splunk-operator-cluster.yaml</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Install the Splunk cluster</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl apply -n logging -f - &lt;&lt;&#34;EOF&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">enterprise.splunk.com/v4</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Standalone</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">single</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">finalizers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">enterprise.splunk.com/delete-pvc</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li></ol><h2 id="deploy-the-logging-operator-and-a-demo-application">Deploy the Logging operator and a demo Application</h2><p>Install the Logging operator and a demo application to provide sample log messages.</p><h3 id="helm">Deploy the Logging operator with Helm</h3><p>To install the Logging operator using Helm, see <a href="/5.1/docs/install/#helm">Deploy the Logging operator with Helm</a>.</p><ol>
<li>
<p>Create the <code>logging</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Logging
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: default-logging-simple
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  fluentd: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  fluentbit: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  controlNamespace: logging
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: You can use the <code>ClusterOutput</code> and <code>ClusterFlow</code> resources only in the <code>controlNamespace</code>.</p></blockquote></li><li>
<p>Get a Splunk HEC Token.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#000">HEC_TOKEN</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#204a87;font-weight:700">$(</span>kubectl get secret -n logging  splunk-logging-secret -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.data.hec_token}&#39;</span> <span style="color:#000;font-weight:700">|</span> base64 --decode<span style="color:#204a87;font-weight:700">)</span>
</span></span></code></pre></div></li><li>
<p>Create a Splunk output secret from the token.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl  create secret generic splunk-token -n logging --from-literal <span style="color:#4e9a06">&#34;SplunkHecToken=</span><span style="color:#4e9a06">${</span><span style="color:#000">HEC_TOKEN</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span></code></pre></div></li><li>
<p>Define a Splunk <code>output</code>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Output
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span> name: splunk-output
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span> splunkHec:
</span></span><span style="display:flex"><span>    hec_host: splunk-single-standalone-headless
</span></span><span style="display:flex"><span>    insecure_ssl: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>    hec_port: <span style="color:#0000cf;font-weight:700">8088</span>
</span></span><span style="display:flex"><span>    hec_token:
</span></span><span style="display:flex"><span>        valueFrom:
</span></span><span style="display:flex"><span>           secretKeyRef:
</span></span><span style="display:flex"><span>              name:  splunk-token
</span></span><span style="display:flex"><span>              key: SplunkHecToken
</span></span><span style="display:flex"><span>    index: main
</span></span><span style="display:flex"><span>    format:
</span></span><span style="display:flex"><span>      type: json
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div></li><li>
<p>Create a <code>flow</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Flow
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: splunk-flow
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  filters:
</span></span><span style="display:flex"><span>    - tag_normaliser: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>    - parser:
</span></span><span style="display:flex"><span>        remove_key_name_field: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>        reserve_data: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>        parse:
</span></span><span style="display:flex"><span>          type: nginx
</span></span><span style="display:flex"><span>  match:
</span></span><span style="display:flex"><span>    - <span style="color:#204a87;font-weight:700">select</span>:
</span></span><span style="display:flex"><span>        labels:
</span></span><span style="display:flex"><span>          app.kubernetes.io/name: log-generator
</span></span><span style="display:flex"><span>  localOutputRefs:
</span></span><span style="display:flex"><span>    - splunk-output
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div></li><li>
<p>Install log-generator to produce logs with the label <code>app.kubernetes.io/name: log-generator</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging log-generator oci://ghcr.io/kube-logging/helm-charts/log-generator
</span></span></code></pre></div></li><li>
<p><a href="#validate">Validate your deployment</a>.</p></li></ol><h2 id="validate">Validate the deployment</h2><p>To validate that the deployment was successful, complete the following steps.</p><ol>
<li>
<p>Use the following command to retrieve the password of the <code>admin</code> user:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging get secret splunk-single-standalone-secrets -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.data.password}&#39;</span> <span style="color:#000;font-weight:700">|</span> base64 --decode
</span></span></code></pre></div></li><li>
<p>Enable port forwarding to the Splunk Dashboard Service.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging port-forward svc/splunk-single-standalone-headless <span style="color:#0000cf;font-weight:700">8000</span>
</span></span></code></pre></div></li><li>
<p>Open the Splunk dashboard in your browser: <a href="http://localhost:8000">http://localhost:8000</a>. You should see the dashboard and some sample log messages from the demo application.</p></li></ol><p align="center"><img src="../../img/splunk_dash.png" alt="Splunk dashboard" width="660"></p><blockquote>
<p>If you don&rsquo;t get the expected result you can find help in the <a href="/5.1/docs/operation/troubleshooting/">troubleshooting section</a>.</p></blockquote></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-256fcfd7514994ffef95721e2aab59da">5.7 - Sumo Logic with Logging operator and Fluentd</h1><p>This guide walks you through a simple Sumo Logic setup using the Logging Operator.
Sumo Logic has Prometheus and logging capabilities as well. Now we only focus on the logging part.</p><h2 id="configuration">Configuration</h2><p>There are 3 crucial plugins needed for a proper Sumo Logic setup.</p><ol>
<li>Kubernetes metadata enhancer</li><li>Sumo Logic filter</li><li>Sumo Logic output</li></ol><p>Let&rsquo;s setup the logging first.</p><h3 id="globalfilters">GlobalFilters</h3><p>The first thing we need to ensure is that the <code>EnhanceK8s</code> filter is present in the <code>globalFilters</code> section of the Logging spec.
This adds additional data to the log lines (like deployment and service names).</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Logging
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: sumologic
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  controlNamespace: logging
</span></span><span style="display:flex"><span>  enableRecreateWorkloadOnImmutableFieldChange: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>  globalFilters:
</span></span><span style="display:flex"><span>  - enhanceK8s: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  fluentbit:
</span></span><span style="display:flex"><span>    bufferStorage:
</span></span><span style="display:flex"><span>      storage.backlog.mem_limit: 256KB
</span></span><span style="display:flex"><span>    inputTail:
</span></span><span style="display:flex"><span>      Mem_Buf_Limit: 256KB
</span></span><span style="display:flex"><span>      storage.type: filesystem
</span></span><span style="display:flex"><span>    metrics:
</span></span><span style="display:flex"><span>      serviceMonitor: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>      serviceMonitorConfig: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  fluentd:
</span></span><span style="display:flex"><span>    disablePvc: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>    metrics:
</span></span><span style="display:flex"><span>      serviceMonitor: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>      serviceMonitorConfig: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><h3 id="clusterflow">ClusterFlow</h3><p>Now we can create a ClusterFlow. Add the Sumo Logic filter to the <code>filters</code> section of the ClusterFlow spec.
It will use the Kubernetes metadata and moves them to a special field called <code>_sumo_metadata</code>.
All those moved fields will be sent as HTTP Header to the Sumo Logic endpoint.</p><blockquote>
<p>Note: As we are using Fluent Bit to enrich Kubernetes metadata, we need to specify the field names where this data is stored.</p></blockquote><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: ClusterFlow
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: sumologic
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  filters:
</span></span><span style="display:flex"><span>    - sumologic:
</span></span><span style="display:flex"><span>        source_name: kubernetes
</span></span><span style="display:flex"><span>        log_format: fields
</span></span><span style="display:flex"><span>        tracing_namespace: namespace_name
</span></span><span style="display:flex"><span>        tracing_pod: pod_name
</span></span><span style="display:flex"><span>  match:
</span></span><span style="display:flex"><span>  - <span style="color:#204a87;font-weight:700">select</span>: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  globalOutputRefs:
</span></span><span style="display:flex"><span>    - sumo
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><h3 id="clusteroutput">ClusterOutput</h3><p>Create a Sumo Logic output secret from the URL.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl create secret generic logging-sumo -n logging --from-literal <span style="color:#4e9a06">&#34;sumoURL=https://endpoint1.collection.eu.sumologic.com/......&#34;</span>
</span></span></code></pre></div><p>Finally create the Sumo Logic output.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: ClusterOutput
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: sumo
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  sumologic:
</span></span><span style="display:flex"><span>    buffer:
</span></span><span style="display:flex"><span>      flush_interval: 10s
</span></span><span style="display:flex"><span>      flush_mode: interval
</span></span><span style="display:flex"><span>    endpoint:
</span></span><span style="display:flex"><span>      valueFrom:
</span></span><span style="display:flex"><span>        secretKeyRef:
</span></span><span style="display:flex"><span>          name:  logging-sumo
</span></span><span style="display:flex"><span>          key: sumoURL
</span></span><span style="display:flex"><span>    source_name: kubernetes
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-9e8c31099cc068e1c927a9cdd5531187">5.8 - Sumo Logic with Logging operator and syslog-ng</h1><p>This guide helps you install and configure the Logging operator and syslog-ng to forward logs to your Sumo Logic account.</p><h2 id="prerequisites">Prerequisites</h2><p>We assume that you already have:</p><ul>
<li>
<p>A Sumo Logic account.</p></li><li>
<p>A <a href="https://help.sumologic.com/03Send-Data/Sources/02Sources-for-Hosted-Collectors/HTTP-Source">HTTP Hosted Collector</a> configured in the Sumo Logic service.</p><p>To configure a Hosted Collector, complete the steps in the <a href="https://help.sumologic.com/03Send-Data/Hosted-Collectors/Configure-a-Hosted-Collector">Configure a Hosted Collector</a> section on the official Sumo Logic website.</p></li><li>
<p>The unique HTTP collector code you receive while configuring your Host Collector for HTTP requests.</p></li></ul><hr>
<h2 id="deploy-the-logging-operator-and-a-demo-application">Deploy the Logging operator and a demo Application</h2><p>Install the Logging operator and a demo application to provide sample log messages.</p><h3 id="helm">Deploy the Logging operator with Helm</h3><p>To install the Logging operator using Helm, complete the following steps.</p><blockquote>
<p>Note: You need Helm v3.8 or later to be able to install the chart from an OCI registry.</p></blockquote><ol>
<li>
<p>Install the Logging operator into the <em>logging</em> namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging logging-operator oci://ghcr.io/kube-logging/helm-charts/logging-operator
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;logging-operator&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>Pulled: ghcr.io/kube-logging/helm-charts/logging-operator:4.3.0
</span></span><span style="display:flex"><span>Digest: sha256:c2ece861f66a3a2cb9788e7ca39a267898bb5629dc98429daa8f88d7acf76840
</span></span><span style="display:flex"><span>NAME: logging-operator
</span></span><span style="display:flex"><span>LAST DEPLOYED: Wed Aug  <span style="color:#0000cf;font-weight:700">9</span> 11:02:12 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: logging
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>TEST SUITE: None
</span></span></code></pre></div><blockquote>
<p>Note:</p><ul>
<li>
<p>Helm has a known issue in version 3.13.0 that requires users to log in to the registry, even though the repo is public.</p><p>Upgrade to 3.13.1 or higher to avoid having to log in, see: <a href="https://github.com/kube-logging/logging-operator/issues/1522">https://github.com/kube-logging/logging-operator/issues/1522</a></p></li><li>
<p>If you&rsquo;re installing the Helm chart from Terraform, reference the repository as <code>repository = "oci://ghcr.io/kube-logging/helm-charts/"</code> (without the <code>logging-operator</code> suffix). Otherwise, you&rsquo;ll get a <a href="https://github.com/hashicorp/terraform-provider-helm/issues/1291">403 Forbidden error</a>.</p></li></ul></blockquote></li></ol><h2 id="configure-the-logging-operator">Configure the Logging operator</h2><ol>
<li>
<p>Create the <code>logging</code> resource with a persistent syslog-ng installation.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Logging
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: demo
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  controlNamespace: logging
</span></span><span style="display:flex"><span>  fluentbit: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  syslogNG:
</span></span><span style="display:flex"><span>    statefulSet:
</span></span><span style="display:flex"><span>      spec:
</span></span><span style="display:flex"><span>        template:
</span></span><span style="display:flex"><span>          spec:
</span></span><span style="display:flex"><span>            containers:
</span></span><span style="display:flex"><span>            - name: syslog-ng
</span></span><span style="display:flex"><span>              volumeMounts:
</span></span><span style="display:flex"><span>              - mountPath: /buffers
</span></span><span style="display:flex"><span>                name: buffer
</span></span><span style="display:flex"><span>        volumeClaimTemplates:
</span></span><span style="display:flex"><span>        - metadata:
</span></span><span style="display:flex"><span>            name: buffer
</span></span><span style="display:flex"><span>          spec:
</span></span><span style="display:flex"><span>            accessModes:
</span></span><span style="display:flex"><span>            - ReadWriteOnce
</span></span><span style="display:flex"><span>            resources:
</span></span><span style="display:flex"><span>              requests:
</span></span><span style="display:flex"><span>                storage: 10Gi
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: You can use the <code>ClusterOutput</code> and <code>ClusterFlow</code> resources only in the <code>controlNamespace</code>.</p></blockquote></li><li>
<p>Create a Sumo Logic output secret from the URL of your Sumo Logic collection.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl create secret generic sumo-collector -n logging --from-literal <span style="color:#4e9a06">&#34;token=XYZ&#34;</span>
</span></span></code></pre></div></li><li>
<p>Create a <code>SyslogNGOutput</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: SyslogNGOutput
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: sumologic-syslog-ng-output
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  sumologic-http: 
</span></span><span style="display:flex"><span>    collector:
</span></span><span style="display:flex"><span>      valueFrom:
</span></span><span style="display:flex"><span>        secretKeyRef:
</span></span><span style="display:flex"><span>          key: token
</span></span><span style="display:flex"><span>          name: sumo-collector
</span></span><span style="display:flex"><span>    deployment: us2
</span></span><span style="display:flex"><span>    batch-lines: <span style="color:#0000cf;font-weight:700">1000</span>
</span></span><span style="display:flex"><span>    disk_buffer:
</span></span><span style="display:flex"><span>      disk_buf_size: <span style="color:#0000cf;font-weight:700">512000000</span>
</span></span><span style="display:flex"><span>      dir: /buffers
</span></span><span style="display:flex"><span>      reliable: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>    body: <span style="color:#4e9a06">&#34;</span><span style="color:#204a87;font-weight:700">$(</span>format-json --subkeys json. --exclude json.kubernetes.annotations.* json.kubernetes.annotations<span style="color:#ce5c00;font-weight:700">=</span>literal<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#204a87;font-weight:700">$(</span>format-flat-json --subkeys json.kubernetes.annotations.<span style="color:#204a87;font-weight:700">))</span><span style="color:#4e9a06"> --exclude json.kubernetes.labels.* json.kubernetes.labels=literal(</span><span style="color:#204a87;font-weight:700">$(</span>format-flat-json --subkeys json.kubernetes.labels.<span style="color:#204a87;font-weight:700">)</span><span style="color:#4e9a06">))&#34;</span>
</span></span><span style="display:flex"><span>    headers:
</span></span><span style="display:flex"><span>      - <span style="color:#4e9a06">&#39;X-Sumo-Name: source-name&#39;</span>
</span></span><span style="display:flex"><span>      - <span style="color:#4e9a06">&#39;X-Sumo-Category: source-category&#39;</span>
</span></span><span style="display:flex"><span>    tls:
</span></span><span style="display:flex"><span>      use-system-cert-store: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div></li><li>
<p>Create a <code>SyslogNGFlow</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: SyslogNGFlow
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: log-generator
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  match:
</span></span><span style="display:flex"><span>    and:
</span></span><span style="display:flex"><span>    - regexp:
</span></span><span style="display:flex"><span>        value: json.kubernetes.labels.app.kubernetes.io/instance
</span></span><span style="display:flex"><span>        pattern: log-generator
</span></span><span style="display:flex"><span>        type: string
</span></span><span style="display:flex"><span>    - regexp:
</span></span><span style="display:flex"><span>        value:  json.kubernetes.labels.app.kubernetes.io/name
</span></span><span style="display:flex"><span>        pattern: log-generator
</span></span><span style="display:flex"><span>        type: string
</span></span><span style="display:flex"><span>  filters:
</span></span><span style="display:flex"><span>  -  parser:
</span></span><span style="display:flex"><span>      regexp: 
</span></span><span style="display:flex"><span>        patterns:
</span></span><span style="display:flex"><span>        - <span style="color:#4e9a06">&#39;^(?&lt;remote&gt;[^ ]*) (?&lt;host&gt;[^ ]*) (?&lt;user&gt;[^ ]*) \[(?&lt;time&gt;[^\]]*)\] &#34;(?&lt;method&gt;\S+)(?: +(?&lt;path&gt;[^\&#34;]*?)(?: +\S*)?)?&#34; (?&lt;code&gt;[^ ]*) (?&lt;size&gt;[^ ]*)(?: &#34;(?&lt;referer&gt;[^\&#34;]*)&#34; &#34;(?&lt;agent&gt;[^\&#34;]*)&#34;(?:\s+(?&lt;http_x_forwarded_for&gt;[^ ]+))?)?$&#39;</span>
</span></span><span style="display:flex"><span>        template: <span style="color:#4e9a06">${</span><span style="color:#000">json</span><span style="color:#000;font-weight:700">.message</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex"><span>        prefix: json.
</span></span><span style="display:flex"><span>  - rewrite:
</span></span><span style="display:flex"><span>    -  set:
</span></span><span style="display:flex"><span>        field: json.cluster
</span></span><span style="display:flex"><span>        value: xxxxx
</span></span><span style="display:flex"><span>    -  unset:
</span></span><span style="display:flex"><span>        field: json.message
</span></span><span style="display:flex"><span>    -  set:
</span></span><span style="display:flex"><span>        field: json.source
</span></span><span style="display:flex"><span>        value: /var/log/log-generator
</span></span><span style="display:flex"><span>        condition:
</span></span><span style="display:flex"><span>          regexp:
</span></span><span style="display:flex"><span>            value:  json.kubernetes.container_name
</span></span><span style="display:flex"><span>            pattern: log-generator
</span></span><span style="display:flex"><span>            type: string
</span></span><span style="display:flex"><span>  localOutputRefs:
</span></span><span style="display:flex"><span>    - sumologic-syslog-ng-output
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div></li><li>
<p>Install log-generator to produce logs with the label <code>app.kubernetes.io/name: log-generator</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging log-generator oci://ghcr.io/kube-logging/helm-charts/log-generator
</span></span></code></pre></div></li></ol><blockquote>
<p>If you don&rsquo;t get the expected result you can find help in the <a href="/5.1/docs/operation/troubleshooting/">troubleshooting section</a>.</p></blockquote></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-abd97e700fb7a973b1dcfb4cb9aae1b4">5.9 - Transport Nginx Access Logs into Kafka with Logging operator</h1><p align="center"><img src="../../img/kafka_logo.png" alt="Logos" width="340"></p><p>This guide describes how to collect application and container logs in Kubernetes using the Logging operator, and how to send them to Kafka.</p><p>The following figure gives you an overview about how the system works. The Logging operator collects the logs from the application, selects which logs to forward to the output, and sends the selected log messages to the output. For more details about the Logging operator, see the <a href="/5.1/docs/">Logging operator overview</a>.</p><p align="center"><img src="../../img/nignx-kafka.png" alt="Architecture" width="900"></p><h2 id="deploy-kafka">Deploy Kafka</h2><p>This demo uses <a href="https://github.com/banzaicloud/koperator/">Koperator</a> to create an Apache Kafka cluster in Kubernetes. For details on installing it, see the <a href="https://banzaicloud.com/docs/supertubes/kafka-operator/install-kafka-operator/">Koperator installation guide</a>.</p><h2 id="deploy-the-logging-operator-and-a-demo-application">Deploy the Logging operator and a demo Application</h2><p>Install the Logging operator and a demo application to provide sample log messages.</p><h3 id="helm">Deploy the Logging operator with Helm</h3><p>To install the Logging operator using Helm, complete the following steps.</p><blockquote>
<p>Note: You need Helm v3.8 or later to be able to install the chart from an OCI registry.</p></blockquote><ol>
<li>
<p>Install the Logging operator into the <em>logging</em> namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging logging-operator oci://ghcr.io/kube-logging/helm-charts/logging-operator
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;logging-operator&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>Pulled: ghcr.io/kube-logging/helm-charts/logging-operator:4.3.0
</span></span><span style="display:flex"><span>Digest: sha256:c2ece861f66a3a2cb9788e7ca39a267898bb5629dc98429daa8f88d7acf76840
</span></span><span style="display:flex"><span>NAME: logging-operator
</span></span><span style="display:flex"><span>LAST DEPLOYED: Wed Aug  <span style="color:#0000cf;font-weight:700">9</span> 11:02:12 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: logging
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>TEST SUITE: None
</span></span></code></pre></div><blockquote>
<p>Note:</p><ul>
<li>
<p>Helm has a known issue in version 3.13.0 that requires users to log in to the registry, even though the repo is public.</p><p>Upgrade to 3.13.1 or higher to avoid having to log in, see: <a href="https://github.com/kube-logging/logging-operator/issues/1522">https://github.com/kube-logging/logging-operator/issues/1522</a></p></li><li>
<p>If you&rsquo;re installing the Helm chart from Terraform, reference the repository as <code>repository = "oci://ghcr.io/kube-logging/helm-charts/"</code> (without the <code>logging-operator</code> suffix). Otherwise, you&rsquo;ll get a <a href="https://github.com/hashicorp/terraform-provider-helm/issues/1291">403 Forbidden error</a>.</p></li></ul></blockquote></li><li>
<p><a href="#validate">Validate your deployment</a>.</p></li><li>
<p>Create the <code>logging</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl -n logging apply -f - &lt;&lt;&#34;EOF&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><blockquote>
<p>Note: You can use the <code>ClusterOutput</code> and <code>ClusterFlow</code> resources only in the <code>controlNamespace</code>.</p></blockquote></li><li>
<p>Create a Kafka <code>output</code> definition.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl -n logging apply -f - &lt;&lt;&#34;EOF&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">kafka-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">kafka</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:700">brokers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">kafka-headless.kafka.svc.cluster.local:29092</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:700">default_topic</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">topic</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:700">format</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">json</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">   </span><span style="color:#204a87;font-weight:700">buffer</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#204a87;font-weight:700">tags</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">topic</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#204a87;font-weight:700">timekey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#204a87;font-weight:700">timekey_wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">30s</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">     </span><span style="color:#204a87;font-weight:700">timekey_use_utc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><blockquote>
<p>Note: In production environment, use a longer <code>timekey</code> interval to avoid generating too many objects.</p></blockquote></li><li>
<p>Create a <code>flow</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl -n logging apply -f - &lt;&lt;&#34;EOF&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">kafka-flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">tag_normaliser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">parser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">remove_key_name_field</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">reserve_data</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">parse</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">app.kubernetes.io/name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log-generator</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">kafka-output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Install log-generator to produce logs with the label <code>app.kubernetes.io/name: log-generator</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging log-generator oci://ghcr.io/kube-logging/helm-charts/log-generator
</span></span></code></pre></div></li><li>
<p><a href="#validate">Validate your deployment</a>.</p></li></ol><h2 id="validate">Validate the deployment</h2><p>Run the following command to consume some log messages from Kafka:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n kafka run kafka-consumer -it --image<span style="color:#ce5c00;font-weight:700">=</span>banzaicloud/kafka:2.13-2.4.0 --rm<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#204a87">true</span> --restart<span style="color:#ce5c00;font-weight:700">=</span>Never -- /opt/kafka/bin/kafka-console-consumer.sh --bootstrap-server kafka-headless:29092 --topic topic --from-beginning
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;stream&#34;</span>:<span style="color:#4e9a06">&#34;stdout&#34;</span>,<span style="color:#4e9a06">&#34;logtag&#34;</span>:<span style="color:#4e9a06">&#34;F&#34;</span>,<span style="color:#4e9a06">&#34;kubernetes&#34;</span>:<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;pod_name&#34;</span>:<span style="color:#4e9a06">&#34;logging-demo-log-generator-5f9f9cdb9f-z76wr&#34;</span>,<span style="color:#4e9a06">&#34;namespace_name&#34;</span>:<span style="color:#4e9a06">&#34;logging&#34;</span>,<span style="color:#4e9a06">&#34;pod_id&#34;</span>:<span style="color:#4e9a06">&#34;a7174256-31bf-4ace-897b-77899873d9ad&#34;</span>,<span style="color:#4e9a06">&#34;labels&#34;</span>:<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;app.kubernetes.io/instance&#34;</span>:<span style="color:#4e9a06">&#34;logging-demo&#34;</span>,<span style="color:#4e9a06">&#34;app.kubernetes.io/name&#34;</span>:<span style="color:#4e9a06">&#34;log-generator&#34;</span>,<span style="color:#4e9a06">&#34;pod-template-hash&#34;</span>:<span style="color:#4e9a06">&#34;5f9f9cdb9f&#34;</span><span style="color:#ce5c00;font-weight:700">}</span>,<span style="color:#4e9a06">&#34;host&#34;</span>:<span style="color:#4e9a06">&#34;ip-192-168-3-189.eu-west-2.compute.internal&#34;</span>,<span style="color:#4e9a06">&#34;container_name&#34;</span>:<span style="color:#4e9a06">&#34;log-generator&#34;</span>,<span style="color:#4e9a06">&#34;docker_id&#34;</span>:<span style="color:#4e9a06">&#34;7349e6bb2926b8c93cb054a60f171a3f2dd1f6751c07dd389da7f28daf4d70c5&#34;</span>,<span style="color:#4e9a06">&#34;container_hash&#34;</span>:<span style="color:#4e9a06">&#34;ghcr.io/banzaicloud/log-generator@sha256:814a69be8ab8a67aa6b009d83f6fa6c4776beefbe629a869ff16690fde8ac362&#34;</span>,<span style="color:#4e9a06">&#34;container_image&#34;</span>:<span style="color:#4e9a06">&#34;ghcr.io/banzaicloud/log-generator:0.3.3&#34;</span><span style="color:#ce5c00;font-weight:700">}</span>,<span style="color:#4e9a06">&#34;remote&#34;</span>:<span style="color:#4e9a06">&#34;79.104.42.168&#34;</span>,<span style="color:#4e9a06">&#34;host&#34;</span>:<span style="color:#4e9a06">&#34;-&#34;</span>,<span style="color:#4e9a06">&#34;user&#34;</span>:<span style="color:#4e9a06">&#34;-&#34;</span>,<span style="color:#4e9a06">&#34;method&#34;</span>:<span style="color:#4e9a06">&#34;PUT&#34;</span>,<span style="color:#4e9a06">&#34;path&#34;</span>:<span style="color:#4e9a06">&#34;/products&#34;</span>,<span style="color:#4e9a06">&#34;code&#34;</span>:<span style="color:#4e9a06">&#34;302&#34;</span>,<span style="color:#4e9a06">&#34;size&#34;</span>:<span style="color:#4e9a06">&#34;18136&#34;</span>,<span style="color:#4e9a06">&#34;referer&#34;</span>:<span style="color:#4e9a06">&#34;-&#34;</span>,<span style="color:#4e9a06">&#34;agent&#34;</span>:<span style="color:#4e9a06">&#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.166 Safari/537.36 OPR/20.0.1396.73172&#34;</span>,<span style="color:#4e9a06">&#34;http_x_forwarded_for&#34;</span>:<span style="color:#4e9a06">&#34;-&#34;</span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;stream&#34;</span>:<span style="color:#4e9a06">&#34;stdout&#34;</span>,<span style="color:#4e9a06">&#34;logtag&#34;</span>:<span style="color:#4e9a06">&#34;F&#34;</span>,<span style="color:#4e9a06">&#34;kubernetes&#34;</span>:<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;pod_name&#34;</span>:<span style="color:#4e9a06">&#34;logging-demo-log-generator-5f9f9cdb9f-mpp98&#34;</span>,<span style="color:#4e9a06">&#34;namespace_name&#34;</span>:<span style="color:#4e9a06">&#34;logging&#34;</span>,<span style="color:#4e9a06">&#34;pod_id&#34;</span>:<span style="color:#4e9a06">&#34;e2822c26-961c-4be8-99a2-b17517494ca1&#34;</span>,<span style="color:#4e9a06">&#34;labels&#34;</span>:<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;app.kubernetes.io/instance&#34;</span>:<span style="color:#4e9a06">&#34;logging-demo&#34;</span>,<span style="color:#4e9a06">&#34;app.kubernetes.io/name&#34;</span>:<span style="color:#4e9a06">&#34;log-generator&#34;</span>,<span style="color:#4e9a06">&#34;pod-template-hash&#34;</span>:<span style="color:#4e9a06">&#34;5f9f9cdb9f&#34;</span><span style="color:#ce5c00;font-weight:700">}</span>,<span style="color:#4e9a06">&#34;host&#34;</span>:<span style="color:#4e9a06">&#34;ip-192-168-2-102.eu-west-2.compute.internal&#34;</span>,<span style="color:#4e9a06">&#34;container_name&#34;</span>:<span style="color:#4e9a06">&#34;log-generator&#34;</span>,<span style="color:#4e9a06">&#34;docker_id&#34;</span>:<span style="color:#4e9a06">&#34;26ffbec769e52e468216fe43a331f4ce5374075f9b2717d9b9ae0a7f0747b3e2&#34;</span>,<span style="color:#4e9a06">&#34;container_hash&#34;</span>:<span style="color:#4e9a06">&#34;ghcr.io/banzaicloud/log-generator@sha256:814a69be8ab8a67aa6b009d83f6fa6c4776beefbe629a869ff16690fde8ac362&#34;</span>,<span style="color:#4e9a06">&#34;container_image&#34;</span>:<span style="color:#4e9a06">&#34;ghcr.io/banzaicloud/log-generator:0.3.3&#34;</span><span style="color:#ce5c00;font-weight:700">}</span>,<span style="color:#4e9a06">&#34;remote&#34;</span>:<span style="color:#4e9a06">&#34;26.220.126.5&#34;</span>,<span style="color:#4e9a06">&#34;host&#34;</span>:<span style="color:#4e9a06">&#34;-&#34;</span>,<span style="color:#4e9a06">&#34;user&#34;</span>:<span style="color:#4e9a06">&#34;-&#34;</span>,<span style="color:#4e9a06">&#34;method&#34;</span>:<span style="color:#4e9a06">&#34;POST&#34;</span>,<span style="color:#4e9a06">&#34;path&#34;</span>:<span style="color:#4e9a06">&#34;/&#34;</span>,<span style="color:#4e9a06">&#34;code&#34;</span>:<span style="color:#4e9a06">&#34;200&#34;</span>,<span style="color:#4e9a06">&#34;size&#34;</span>:<span style="color:#4e9a06">&#34;14370&#34;</span>,<span style="color:#4e9a06">&#34;referer&#34;</span>:<span style="color:#4e9a06">&#34;-&#34;</span>,<span style="color:#4e9a06">&#34;agent&#34;</span>:<span style="color:#4e9a06">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:52.0) Gecko/20100101 Firefox/52.0&#34;</span>,<span style="color:#4e9a06">&#34;http_x_forwarded_for&#34;</span>:<span style="color:#4e9a06">&#34;-&#34;</span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span></code></pre></div><blockquote>
<p>If you don&rsquo;t get the expected result you can find help in the <a href="/5.1/docs/operation/troubleshooting/">troubleshooting section</a>.</p></blockquote></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-01af43cb645f47605cedaae3bc91678b">5.10 - Store Nginx Access Logs in Grafana Loki with Logging operator</h1><p align="center"><img src="../../img/nll.png" width="340"></p><p>This guide describes how to collect application and container logs in Kubernetes using the Logging operator, and how to send them to Grafana Loki.</p><p>The following figure gives you an overview about how the system works. The Logging operator collects the logs from the application, selects which logs to forward to the output, and sends the selected log messages to the output. For more details about the Logging operator, see the <a href="/5.1/docs/">Logging operator overview</a>.</p><p align="center"><img src="../../img/nginx-loki.png" width="900"></p><h2 id="deploy-loki-and-grafana">Deploy Loki and Grafana</h2><ol>
<li>
<p>Add the chart repositories of Loki and Grafana using the following commands:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm repo add grafana https://grafana.github.io/helm-charts
</span></span><span style="display:flex"><span>helm repo update
</span></span></code></pre></div></li><li>
<p>Install Loki into the <em>logging</em> namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --create-namespace --namespace logging loki grafana/loki
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;loki&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>NAME: loki
</span></span><span style="display:flex"><span>LAST DEPLOYED: Wed Aug  <span style="color:#0000cf;font-weight:700">9</span> 10:58:32 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: logging
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>NOTES:
</span></span><span style="display:flex"><span>***********************************************************************
</span></span><span style="display:flex"><span>Welcome to Grafana Loki
</span></span><span style="display:flex"><span>Chart version: 5.10.0
</span></span><span style="display:flex"><span>Loki version: 2.8.3
</span></span><span style="display:flex"><span>***********************************************************************
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Installed components:
</span></span><span style="display:flex"><span>* grafana-agent-operator
</span></span><span style="display:flex"><span>* gateway
</span></span><span style="display:flex"><span>* <span style="color:#204a87">read</span>
</span></span><span style="display:flex"><span>* write
</span></span><span style="display:flex"><span>* backend
</span></span></code></pre></div><blockquote>
<p>For details, see the <a href="https://grafana.com/docs/loki/next/setup/install/helm/">Grafana Loki Documentation</a></p></blockquote></li><li>
<p>Install Grafana into the <em>logging</em> namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span> helm upgrade --install --create-namespace --namespace logging grafana grafana/grafana <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span> --set <span style="color:#4e9a06">&#34;datasources.datasources\\.yaml.apiVersion=1&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span> --set <span style="color:#4e9a06">&#34;datasources.datasources\\.yaml.datasources[0].name=Loki&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span> --set <span style="color:#4e9a06">&#34;datasources.datasources\\.yaml.datasources[0].type=loki&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span> --set <span style="color:#4e9a06">&#34;datasources.datasources\\.yaml.datasources[0].url=http://loki:3100&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span> --set <span style="color:#4e9a06">&#34;datasources.datasources\\.yaml.datasources[0].access=proxy&#34;</span>
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;grafana&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>NAME: grafana
</span></span><span style="display:flex"><span>LAST DEPLOYED: Wed Aug  <span style="color:#0000cf;font-weight:700">9</span> 11:00:47 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: logging
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>NOTES:
</span></span><span style="display:flex"><span>1. Get your <span style="color:#4e9a06">&#39;admin&#39;</span> user password by running:
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>  kubectl get secret --namespace logging grafana -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;{.data.admin-password}&#34;</span> <span style="color:#000;font-weight:700">|</span> base64 --decode <span style="color:#000;font-weight:700">;</span> <span style="color:#204a87">echo</span>
</span></span><span style="display:flex"><span>...
</span></span></code></pre></div></li></ol><h2 id="deploy-the-logging-operator-and-a-demo-application">Deploy the Logging operator and a demo application</h2><p>Install the Logging operator and a demo application to provide sample log messages.</p><h3 id="helm">Deploy the Logging operator with Helm</h3><p>To install the Logging operator using Helm, complete the following steps.</p><blockquote>
<p>Note: You need Helm v3.8 or later to be able to install the chart from an OCI registry.</p></blockquote><ol>
<li>
<p>Install the Logging operator into the <em>logging</em> namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging logging-operator oci://ghcr.io/kube-logging/helm-charts/logging-operator
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;logging-operator&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>Pulled: ghcr.io/kube-logging/helm-charts/logging-operator:4.3.0
</span></span><span style="display:flex"><span>Digest: sha256:c2ece861f66a3a2cb9788e7ca39a267898bb5629dc98429daa8f88d7acf76840
</span></span><span style="display:flex"><span>NAME: logging-operator
</span></span><span style="display:flex"><span>LAST DEPLOYED: Wed Aug  <span style="color:#0000cf;font-weight:700">9</span> 11:02:12 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: logging
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>TEST SUITE: None
</span></span></code></pre></div><blockquote>
<p>Note:</p><ul>
<li>
<p>Helm has a known issue in version 3.13.0 that requires users to log in to the registry, even though the repo is public.</p><p>Upgrade to 3.13.1 or higher to avoid having to log in, see: <a href="https://github.com/kube-logging/logging-operator/issues/1522">https://github.com/kube-logging/logging-operator/issues/1522</a></p></li><li>
<p>If you&rsquo;re installing the Helm chart from Terraform, reference the repository as <code>repository = "oci://ghcr.io/kube-logging/helm-charts/"</code> (without the <code>logging-operator</code> suffix). Otherwise, you&rsquo;ll get a <a href="https://github.com/hashicorp/terraform-provider-helm/issues/1291">403 Forbidden error</a>.</p></li></ul></blockquote></li><li>
<p>Create the <code>logging</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Logging
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: default-logging-simple
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  fluentd: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  fluentbit: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>  controlNamespace: logging
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: You can use the <code>ClusterOutput</code> and <code>ClusterFlow</code> resources only in the <code>controlNamespace</code>.</p></blockquote></li><li>
<p>Create a Loki <code>output</code> definition.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Output
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span> name: loki-output
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span> loki:
</span></span><span style="display:flex"><span>   url: http://loki:3100
</span></span><span style="display:flex"><span>   configure_kubernetes_labels: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>   buffer:
</span></span><span style="display:flex"><span>     timekey: 1m
</span></span><span style="display:flex"><span>     timekey_wait: 30s
</span></span><span style="display:flex"><span>     timekey_use_utc: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: In production environment, use a longer <code>timekey</code> interval to avoid generating too many objects.</p></blockquote></li><li>
<p>Create a <code>flow</code> resource.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Flow
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: loki-flow
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  filters:
</span></span><span style="display:flex"><span>    - tag_normaliser: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>    - parser:
</span></span><span style="display:flex"><span>        remove_key_name_field: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>        reserve_data: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>        parse:
</span></span><span style="display:flex"><span>          type: nginx
</span></span><span style="display:flex"><span>  match:
</span></span><span style="display:flex"><span>    - <span style="color:#204a87;font-weight:700">select</span>:
</span></span><span style="display:flex"><span>        labels:
</span></span><span style="display:flex"><span>          app.kubernetes.io/name: log-generator
</span></span><span style="display:flex"><span>  localOutputRefs:
</span></span><span style="display:flex"><span>    - loki-output
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div></li><li>
<p>Install log-generator to produce logs with the label <code>app.kubernetes.io/name: log-generator</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging log-generator oci://ghcr.io/kube-logging/helm-charts/log-generator
</span></span></code></pre></div></li><li>
<p><a href="#validate">Validate your deployment</a>.</p></li></ol><h2 id="validate">Validate the deployment</h2><h3 id="grafana-dashboard">Grafana Dashboard</h3><ol>
<li>
<p>Use the following command to retrieve the password of the Grafana <code>admin</code> user:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl get secret --namespace logging grafana -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;{.data.admin-password}&#34;</span> <span style="color:#000;font-weight:700">|</span> base64 --decode <span style="color:#000;font-weight:700">;</span> <span style="color:#204a87">echo</span>
</span></span></code></pre></div></li><li>
<p>Enable port forwarding to the Grafana Service.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging port-forward svc/grafana 3000:80
</span></span></code></pre></div></li><li>
<p>Open the Grafana Dashboard: <a href="http://localhost:3000">http://localhost:3000</a></p></li><li>
<p>Use the <code>admin</code> username and the password retrieved in Step 1 to log in.</p></li><li>
<p>Select <strong>Menu > Explore</strong>, select <strong>Data source > Loki</strong>, then select <strong>Log labels > namespace > logging</strong>. A list of logs should appear.</p><p><img src="../../img/loki1.png" alt="Sample log messages in Loki"></p></li></ol><blockquote>
<p>If you don&rsquo;t get the expected result you can find help in the <a href="/5.1/docs/operation/troubleshooting/">troubleshooting section</a>.</p></blockquote></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-aeee3c18c3b933f861743e7b21d3529d">5.11 - Nodegroup-based multitenancy</h1><p>Nodegroup-based multitenancy allows you to have multiple tenants (for example, different developer teams or customer environments) on the same cluster who can configure their own logging resources within their assigned namespaces residing on different node groups.
These resources are isolated from the resources of the other tenants so the configuration issues and performance characteristics of one tenant doesn&rsquo;t affect the others.</p><h2 id="sample-setup">Sample setup</h2><p>The following procedure creates two tenants (A and B) and their respective namespaces on a two-node cluster.</p><ol>
<li>
<p>If you don&rsquo;t already have a cluster, create one with your provider. For a quick test, you can use a local cluster, for example, using minikube:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>minikube start --nodes<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#0000cf;font-weight:700">2</span>
</span></span></code></pre></div></li><li>
<p>Set labels on the nodes that correspond to your tenants, for example, <code>tenant-a</code> and <code>tenant-b</code>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl label node minikube <span style="color:#000">tenant</span><span style="color:#ce5c00;font-weight:700">=</span>tenant-a
</span></span><span style="display:flex"><span>kubectl label node minikube-m02 <span style="color:#000">tenant</span><span style="color:#ce5c00;font-weight:700">=</span>tenant-b
</span></span></code></pre></div></li><li>
<p>Install the logging operator</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm install logging-operator oci://ghcr.io/kube-logging/helm-charts/logging-operator
</span></span></code></pre></div></li><li>
<p>Apply the sample resources from the <a href="https://github.com/kube-logging/logging-operator/tree/master/config/samples/mulitenant-hard/logging">project repository</a>. These create namespaces, flows, and sample outputs for the two tenants.</p></li><li>
<p>(Optional) Install a sample log generator application to the respective namespaces of your tenants. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --namespace a --create-namespace --set <span style="color:#4e9a06">&#34;nodeSelector.tenant=tenant-a&#34;</span> log-generator oci://ghcr.io/kube-logging/helm-charts/log-generator
</span></span><span style="display:flex"><span>helm upgrade --install --namespace b --create-namespace --set <span style="color:#4e9a06">&#34;nodeSelector.tenant=tenant-b&#34;</span> log-generator oci://ghcr.io/kube-logging/helm-charts/log-generator
</span></span></code></pre></div></li><li>
<p>Check that your pods are up and running by running <code>kubectl get pods -A</code></p><p>If you have followed the examples, the output should look like:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>NAMESPACE     NAME                               READY   STATUS    RESTARTS      AGE
</span></span><span style="display:flex"><span>a-control     a-fluentbit-4tqzg                  1/1     Running   <span style="color:#0000cf;font-weight:700">0</span>             9m29s
</span></span><span style="display:flex"><span>a-control     a-fluentd-0                        2/2     Running   <span style="color:#0000cf;font-weight:700">0</span>             4m48s
</span></span><span style="display:flex"><span>a             log-generator-6cfb45c684-q6fl6     1/1     Running   <span style="color:#0000cf;font-weight:700">0</span>             3m25s
</span></span><span style="display:flex"><span>b-control     b-fluentbit-qmf58                  1/1     Running   <span style="color:#0000cf;font-weight:700">0</span>             9m20s
</span></span><span style="display:flex"><span>b-control     b-fluentd-0                        2/2     Running   <span style="color:#0000cf;font-weight:700">0</span>             9m16s
</span></span><span style="display:flex"><span>b             log-generator-7b95b6fdc5-cshh7     1/1     Running   <span style="color:#0000cf;font-weight:700">0</span>             8m49s
</span></span><span style="display:flex"><span>default       logging-operator-bbd66bb7d-qvsmg   1/1     Running   <span style="color:#0000cf;font-weight:700">0</span>             35m
</span></span><span style="display:flex"><span>infra         test-receiver-7c45f9cd77-whvlv     1/1     Running   <span style="color:#0000cf;font-weight:700">0</span>             53m
</span></span></code></pre></div></li><li>
<p>Check logs coming from both tenants <code>kubectl logs -f -n infra svc/test-receiver</code></p><p>Expected output should show logs from both tenants</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>0<span style="color:#ce5c00;font-weight:700">]</span> tenant_a: <span style="color:#ce5c00;font-weight:700">[[</span>1695999280.157810965, <span style="color:#ce5c00;font-weight:700">{}]</span>, <span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;15.238.250.48 - - [29/Sep/2023:14:54:38 +0000] &#34;</span>PUT /pro...
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">[</span>0<span style="color:#ce5c00;font-weight:700">]</span> tenant_b: <span style="color:#ce5c00;font-weight:700">[[</span>1695999280.160868923, <span style="color:#ce5c00;font-weight:700">{}]</span>, <span style="color:#ce5c00;font-weight:700">{</span><span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#ce5c00;font-weight:700">=</span>&gt;<span style="color:#4e9a06">&#34;252.201.89.36 - - [29/Sep/2023:14:54:33 +0000] &#34;</span>POST /bl...
</span></span></code></pre></div></li></ol></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-3c57b775dac77ff05294c6fa7e03a10b">5.12 - Custom source and output metrics</h1><p>When using syslog-ng as the log aggregator, you can create custom log metrics for sources and outputs, based on the <a href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/metrics-probe/">metrics-probe() parser</a>.</p><p>Available in Logging operator version 4.5 and later.</p><h2 id="source-metrics">Source metrics</h2><p>Custom source metrics are added to the messages after the JSON parsing is completed. The following example adds the key called <code>custom_input</code>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogNG</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">metrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">sourceMetrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">custom_input</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">test</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">my-label-value</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>This corresponds to the following syslog-ng configuration:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#204a87">source</span> <span style="color:#4e9a06">&#34;main_input&#34;</span> <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>    channel <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>        <span style="color:#204a87">source</span> <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>            network<span style="color:#ce5c00;font-weight:700">(</span>flags<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;no-parse&#34;</span><span style="color:#ce5c00;font-weight:700">)</span> port<span style="color:#ce5c00;font-weight:700">(</span>601<span style="color:#ce5c00;font-weight:700">)</span> transport<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;tcp&#34;</span><span style="color:#ce5c00;font-weight:700">)</span> max-connections<span style="color:#ce5c00;font-weight:700">(</span>100<span style="color:#ce5c00;font-weight:700">)</span> log-iw-size<span style="color:#ce5c00;font-weight:700">(</span>10000<span style="color:#ce5c00;font-weight:700">))</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>        <span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>        parser <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>            json-parser<span style="color:#ce5c00;font-weight:700">(</span>prefix<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;json.&#34;</span><span style="color:#ce5c00;font-weight:700">))</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>            metrics-probe<span style="color:#ce5c00;font-weight:700">(</span>key<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;custom_input&#34;</span><span style="color:#ce5c00;font-weight:700">)</span> labels<span style="color:#ce5c00;font-weight:700">(</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;logging&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;logging&#34;</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;test&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;my-label-value&#34;</span>
</span></span><span style="display:flex"><span>            <span style="color:#ce5c00;font-weight:700">))</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>        <span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>    <span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span></code></pre></div><p>And results in the following metrics:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>curl logging-syslog-ng-0:9577/metrics  <span style="color:#000;font-weight:700">|</span> grep custom_
</span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"># TYPE syslogng_custom_input gauge</span>
</span></span><span style="display:flex"><span>syslogng_custom_input<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#000">logging</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;logging&#34;</span><span style="color:#ce5c00;font-weight:700">}</span> <span style="color:#0000cf;font-weight:700">154</span>
</span></span></code></pre></div><h2 id="output-metrics">Output metrics</h2><p>Output metrics are added before the log reaches the destination, and is decorated with the output metadata like: <code>name</code>, <code>namespace</code>, and <code>scope</code>. <code>scope</code> stores whether the output is a local or global one. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">SyslogNGFlow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">all1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">outputMetrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">custom_output</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">flow</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">all1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">http</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">globalOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">http2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>This corresponds to the following syslog-ng configuration:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>filter <span style="color:#4e9a06">&#34;flow_default_all1_ns_filter&#34;</span> <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>    match<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;default&#34;</span> value<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;json.kubernetes.namespace_name&#34;</span><span style="color:#ce5c00;font-weight:700">)</span> type<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#ce5c00;font-weight:700">))</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>log <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>    source<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;main_input&#34;</span><span style="color:#ce5c00;font-weight:700">)</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>    filter<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;flow_default_all1_ns_filter&#34;</span><span style="color:#ce5c00;font-weight:700">)</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>    log <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>        parser <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>            metrics-probe<span style="color:#ce5c00;font-weight:700">(</span>key<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;custom_output&#34;</span><span style="color:#ce5c00;font-weight:700">)</span> labels<span style="color:#ce5c00;font-weight:700">(</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;flow&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;all1&#34;</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;logging&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;logging&#34;</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;output_name&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;http2&#34;</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;output_namespace&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;default&#34;</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;output_scope&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;global&#34;</span>
</span></span><span style="display:flex"><span>            <span style="color:#ce5c00;font-weight:700">))</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>        <span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>        destination<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;clusteroutput_default_http2&#34;</span><span style="color:#ce5c00;font-weight:700">)</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>    <span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>    log <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>        parser <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>            metrics-probe<span style="color:#ce5c00;font-weight:700">(</span>key<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;custom_output&#34;</span><span style="color:#ce5c00;font-weight:700">)</span> labels<span style="color:#ce5c00;font-weight:700">(</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;flow&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;all1&#34;</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;logging&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;logging&#34;</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;output_name&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;http&#34;</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;output_namespace&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;default&#34;</span>
</span></span><span style="display:flex"><span>                <span style="color:#4e9a06">&#34;output_scope&#34;</span> <span style="color:#ce5c00;font-weight:700">=</span>&gt; <span style="color:#4e9a06">&#34;local&#34;</span>
</span></span><span style="display:flex"><span>            <span style="color:#ce5c00;font-weight:700">))</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>        <span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>        destination<span style="color:#ce5c00;font-weight:700">(</span><span style="color:#4e9a06">&#34;output_default_http&#34;</span><span style="color:#ce5c00;font-weight:700">)</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span>    <span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span><span style="color:#000;font-weight:700">;</span>
</span></span></code></pre></div><p>And results in the following metrics:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>curl logging-syslog-ng-0:9577/metrics  <span style="color:#000;font-weight:700">|</span> grep custom_
</span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"># TYPE syslogng_custom_output gauge</span>
</span></span><span style="display:flex"><span>syslogng_custom_output<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#000">flow</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;all1&#34;</span>,logging<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;logging&#34;</span>,output_name<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;http2&#34;</span>,output_namespace<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;default&#34;</span>,output_scope<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;global&#34;</span><span style="color:#ce5c00;font-weight:700">}</span> <span style="color:#0000cf;font-weight:700">42</span>
</span></span><span style="display:flex"><span>syslogng_custom_output<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#000">flow</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;all1&#34;</span>,logging<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;logging&#34;</span>,output_name<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;http&#34;</span>,output_namespace<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;default&#34;</span>,output_scope<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;local&#34;</span><span style="color:#ce5c00;font-weight:700">}</span> <span style="color:#0000cf;font-weight:700">42</span>
</span></span><span style="display:flex"><span>syslogng_custom_output<span style="color:#ce5c00;font-weight:700">{</span><span style="color:#000">flow</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;all2&#34;</span>,logging<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;logging&#34;</span>,output_name<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;http2&#34;</span>,output_namespace<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;default&#34;</span>,output_scope<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;global&#34;</span><span style="color:#ce5c00;font-weight:700">}</span> <span style="color:#0000cf;font-weight:700">154</span>
</span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-66b2f94db85b38033f1e648756b3c604">6 - Logging infrastructure setup</h1><p>The following sections describe how to change the configuration of your logging infrastructure, that is, how to configure your log collectors and forwarders.</p><blockquote>
<p>Note: Log routing is covered in <a href="/5.1/docs/logging-infrastructure/">Logging infrastructure setup</a>.</p></blockquote></div><div class="td-content">
<h1 id="pg-c0708ac9ee8c8fbda19457c73798a929">6.1 - The Logging custom resource</h1><p>The <code>logging</code> resource defines the logging infrastructure for your cluster that collects and transports your log messages, and also contains configurations for the Fluent Bit log collector and the Fluentd and syslog-ng log forwarders. It also establishes the <code>controlNamespace</code>, the administrative namespace of the Logging operator. The Fluentd and syslog-ng statefulsets and the Fluent Bit daemonset are deployed in this namespace, and global resources like <code>ClusterOutput</code> and <code>ClusterFlow</code> are evaluated only in this namespace by default - they are ignored in any other namespace unless <code>allowClusterResourcesFromAllNamespaces</code> is set to true.</p><p>You can customize the configuration of Fluentd, syslog-ng, and Fluent Bit in the logging resource. The logging resource also declares <code>watchNamespaces</code>, that specifies the namespaces where <code>Flow</code>/<code>SyslogNGFlow</code> and <code>Output</code>/<code>SyslogNGOutput</code> resources will be applied into Fluentd&rsquo;s/syslog-ng&rsquo;s configuration.</p><blockquote>
<p>Note: By default, the Logging operator Helm chart doesn&rsquo;t install the <code>logging</code> resource. If you want to install it with Helm, set the <code>logging.enabled</code> value to true.</p><p>For details on customizing the installation, see the <a href="https://github.com/kube-logging/logging-operator/tree/master/charts/logging-operator">Helm chart values</a>.</p></blockquote><p>You can customize the following sections of the logging resource:</p><ul>
<li>Generic parameters of the logging resource. For the list of available parameters, see <a href="/5.1/docs/configuration/crds/v1beta1/logging_types/">LoggingSpec</a>.</li><li>The <code>fluentd</code> statefulset that Logging operator deploys. For a list of parameters, see <a href="/5.1/docs/configuration/crds/v1beta1/fluentd_types/">FluentdSpec</a>. For examples on customizing the Fluentd configuration, see <a href="/5.1/docs/logging-infrastructure/fluentd/">Configure Fluentd</a>.</li><li>The <code>syslogNG</code> statefulset that Logging operator deploys. For a list of parameters, see <a href="/5.1/docs/configuration/crds/v1beta1/syslogng_types/">SyslogNGSpec</a>. For examples on customizing the Fluentd configuration, see <a href="/5.1/docs/logging-infrastructure/syslog-ng/">Configure syslog-ng</a>.</li><li>The <code>fluentbit</code> field is deprecated. Fluent Bit should now be configured separately, see <a href="/5.1/docs/logging-infrastructure/fluentbit/">Fluent Bit log collector</a>.</li></ul><p>The following example snippets use the <strong>logging</strong> namespace. To create this namespace if it does not already exist, run:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl create ns logging
</span></span></code></pre></div><h2 id="examples-logging">A simple <code>logging</code> example</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="filter-namespaces">Filter namespaces</h2><p>In the following example, the <strong>watchNamespaces</strong> option is set, so logs are collected only from the <em>prod</em> and <em>test</em> namespaces.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-namespaced</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">watchNamespaces</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:700">[</span><span style="color:#4e9a06">&#34;prod&#34;</span><span style="color:#000;font-weight:700">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;test&#34;</span><span style="color:#000;font-weight:700">]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Starting with Logging operator version 4.3, you can use the <code>watchNamespaceSelector</code> selector to select the watched namespaces based on their label, or an expression, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">watchNamespaceSelector</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">matchLabels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">&lt;label-name&gt;</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;label-value&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">watchNamespaceSelector</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">matchExpressions</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&lt;label-name&gt;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">operator</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">NotIn</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">values</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span>- <span style="color:#4e9a06">&#34;&lt;label-value&gt;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>If both <code>watchNamespaces</code> and <code>watchNamespaceSelector</code> are set, the union of them will take effect.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-73731e87b595ac2d32428566811fc127">6.2 - Configure Fluentd</h1><p>This page shows some examples on configuring Fluentd.</p><h2 id="ways-to-configure-fluentd">Ways to configure Fluentd</h2><p>There are two ways to configure the Fluentd statefulset:</p><ol>
<li>
<p>Using the <strong>spec.fluentd</strong> section of <a href="/5.1/docs/logging-infrastructure/logging/">The Logging custom resource</a>.</p></li><li>
<p>Using the standalone FluentdConfig CRD. This method is only available in Logging operator version 4.5 and newer, and the specification of the CRD is compatible with the <strong>spec.fluentd</strong> configuration method. That way you can use a multi-tenant model, where tenant owners are responsible for operating their own aggregator, while the Logging resource is in control of the central operations team.</p><p>The standalone FluentdConfig is a namespaced resource that allows the configuration of the Fluentd aggregator in the control namespace, separately from the Logging resource. This allows you to use a multi-tenant model, where tenant owners are responsible for operating their own aggregator, while the Logging resource is in control of the central operations team. For more information about the multi-tenancy model where the collector is capable of routing logs based on namespaces to individual aggregators and where aggregators are fully isolated, see this blog post about <a href="https://axoflow.com/multi-tenancy-using-logging-operator/">Multi-tenancy using Logging operator</a>.</p></li></ol><p>For the detailed list of available parameters, see <a href="/5.1/docs/configuration/crds/v1beta1/fluentd_types/">FluentdSpec</a>.</p><h3 id="migrating">Migrating from <strong>spec.fluentd</strong> to FluentdConfig</h3><p>The standalone FluentdConfig CRD is only available in Logging operator version 4.5 and newer. Its specification and logic is identical with the <strong>spec.fluentd</strong> configuration method. Using the FluentdConfig CRD allows you to remove the <strong>spec.fluentd</strong> section from the Logging CRD, which has the following benefits.</p><ul>
<li>RBAC control over the FluentdConfig CRD, so you can have separate roles that can manage the Logging resource and the FluentdConfig resource (that is, the Fluentd deployment).</li><li>It reduces the size of the Logging resource, which can grow big enough to reach the annotation size limit in certain scenarios (e.g. when using <code>kubectl apply</code>).</li><li>You can use a multi-tenant model, where tenant owners are responsible for operating their own aggregator, while the Logging resource is in control of the central operations team.</li></ul><p>To migrate your <strong>spec.fluentd</strong> configuration from the Logging resource to a separate FluentdConfig CRD, complete the following steps.</p><ol>
<li>
<p>Open your Logging resource and find the <strong>spec.fluentd</strong> section. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-logging-resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">scaling</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">replicas</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Create a new FluentdConfig CRD. For the value of <strong>metadata.name</strong>, use the name of the Logging resource, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentdConfig</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Use the name of the logging resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-logging-resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Use the control namespace of the logging resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Copy the the <strong>spec.fluentd</strong> section from the Logging resource into the <strong>spec</strong> section of the FluentdConfig CRD, then fix the indentation. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentdConfig</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Use the name of the logging resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-logging-resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Use the control namespace of the logging resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">scaling</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">replicas</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Delete the <strong>spec.fluentd</strong> section from the Logging resource, then apply the Logging and the FluentdConfig CRDs.</p></li></ol><h2 id="using-the-standalone-fluentdconfig-resource">Using the standalone FluentdConfig resource</h2><p>The standalone FluentdConfig is a namespaced resource that allows the configuration of the Fluentd aggregator in the control namespace, separately from the Logging resource. This allows you to use a multi-tenant model, where tenant owners are responsible for operating their own aggregator, while the Logging resource is in control of the central operations team. For more information about the multi-tenancy model where the collector is capable of routing logs based on namespaces to individual aggregators and where aggregators are fully isolated, see this blog post about <a href="https://axoflow.com/multi-tenancy-using-logging-operator/">Multi-tenancy using Logging operator</a>.</p><p>A <code>Logging</code> resource can have only one <code>FluentdConfig</code> at a time. The controller registers the active <code>FluentdConfig</code> resource into the <code>Logging</code> resource&rsquo;s status under <code>fluentdConfigName</code>, and also registers the <code>Logging</code> resource name under <code>logging</code> in the <code>FluentdConfig</code> resource&rsquo;s status, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get logging example -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.status}&#39;</span> <span style="color:#000;font-weight:700">|</span> jq .
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;configCheckResults&#34;</span>: <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;ac2d4553&#34;</span>: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>  <span style="color:#ce5c00;font-weight:700">}</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;fluentdConfigName&#34;</span>: <span style="color:#4e9a06">&#34;example&#34;</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get fluentdconfig example -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.status}&#39;</span> <span style="color:#000;font-weight:700">|</span> jq .
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;active&#34;</span>: true,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;logging&#34;</span>: <span style="color:#4e9a06">&#34;example&#34;</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span></code></pre></div><p>If there is a conflict, the controller adds a problem to both resources so that both the operations team and the tenant users can notice the problem. For example, if a <code>FluentdConfig</code> is already registered to a <code>Logging</code> resource and you create another <code>FluentdConfig</code> resource in the same namespace, then the first <code>FluentdConfig</code> is left intact, while the second one should have the following status:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get fluentdconfig example2 -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.status}&#39;</span> <span style="color:#000;font-weight:700">|</span> jq .
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;active&#34;</span>: false,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;problems&#34;</span>: <span style="color:#ce5c00;font-weight:700">[</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;logging already has a detached fluentd configuration, remove excess configuration objects&#34;</span>
</span></span><span style="display:flex"><span>  <span style="color:#ce5c00;font-weight:700">]</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;problemsCount&#34;</span>: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span></code></pre></div><p>The <code>Logging</code> resource will also show the issue:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get logging example -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.status}&#39;</span> <span style="color:#000;font-weight:700">|</span> jq .
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;configCheckResults&#34;</span>: <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;ac2d4553&#34;</span>: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>  <span style="color:#ce5c00;font-weight:700">}</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;fluentdConfigName&#34;</span>: <span style="color:#4e9a06">&#34;example&#34;</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;problems&#34;</span>: <span style="color:#ce5c00;font-weight:700">[</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;multiple fluentd configurations found, couldn&#39;t associate it with logging&#34;</span>
</span></span><span style="display:flex"><span>  <span style="color:#ce5c00;font-weight:700">]</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;problemsCount&#34;</span>: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span></code></pre></div><h2 id="custom-pvc-volume-for-fluentd-buffers">Custom pvc volume for Fluentd buffers</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">bufferStorageVolume</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">pvc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">accessModes</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#000">ReadWriteOnce</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">resources</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">requests</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#204a87;font-weight:700">storage</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">40Gi</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">storageClassName</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fast</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">volumeMode</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Filesystem</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="custom-fluentd-hostpath-volume-for-buffers">Custom Fluentd hostPath volume for buffers</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">disablePvc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">bufferStorageVolume</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">hostPath</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># leave it empty to automatically generate: /opt/logging-operator/default-logging-simple/default-logging-simple-fluentd-buffer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="fluentoutlogrotate">FluentOutLogrotate</h2><p>The following snippet redirects Fluentd&rsquo;s stdout to a file and configures rotation settings.</p><p>This mechanism was used prior to version 4.4 to avoid Fluent-bit rereading Fluentd&rsquo;s logs and causing an exponentially growing amount of redundant logs.</p><p>Example configuration used by the operator in version 4.3 and earlier (keep 10 files, 10M each):</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">fluentOutLogrotate</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">enabled</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/fluentd/log/out</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">age</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">10</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">size</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">10485760</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Fluentd logs are now excluded using the <code>fluentbit.io/exclude: "true"</code> annotation.</p><h2 id="scaling">Scaling</h2><p>You can scale the Fluentd deployment manually by changing the number of replicas in the <strong>fluentd</strong> section of the <a href="/5.1/docs/logging-infrastructure/logging/">The Logging custom resource</a>. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">scaling</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">replicas</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For automatic scaling, see <a href="#autoscaling">Autoscaling with HPA</a>.</p><h3 id="graceful-draining">Graceful draining</h3><p>While you can scale down the Fluentd deployment by decreasing the number of replicas in the <strong>fluentd</strong> section of the <a href="/5.1/docs/logging-infrastructure/logging/">The Logging custom resource</a>, it won&rsquo;t automatically be graceful, as the controller will stop the extra replica pods without waiting for any remaining buffers to be flushed.
You can enable graceful draining in the <strong>scaling</strong> subsection:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">scaling</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">drain</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">enabled</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>When graceful draining is enabled, the operator starts drainer jobs for any undrained volumes.
The drainer job flushes any remaining buffers before terminating, and the operator marks the associated volume (the PVC, actually) as <em>drained</em> until it gets used again.
The drainer job has a template very similar to that of the Fluentd deployment with the addition of a sidecar container that oversees the buffers and signals Fluentd to terminate when all buffers are gone.
Pods created by the job are labeled as not to receive any further logs, thus buffers will clear out eventually.</p><p>If you want, you can specify a custom drainer job sidecar image in the <strong>drain</strong> subsection:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">scaling</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">drain</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">enabled</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">image</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ghcr.io/banzaicloud/fluentd-drain-watch</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">latest</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>In addition to the drainer job, the operator also creates a placeholder pod with the same name as the terminated pod of the Fluentd deployment to keep the deployment from recreating that pod which would result in concurrent access of the volume.
The placeholder pod just runs a pause container, and goes away as soon as the job has finished successfully or the deployment is scaled back up and explicitly flushing the buffers is no longer necessary because the newly created replica will take care of processing them.</p><p>You can mark volumes that should be ignored by the drain logic by adding the label <code>logging.banzaicloud.io/drain: no</code> to the PVC.</p><h3 id="autoscaling">Autoscaling with HPA</h3><p>To configure autoscaling of the Fluentd deployment using Horizontal Pod Autoscaler (HPA), complete the following steps.</p><ol>
<li>
<p><a href="https://kubernetes.io/docs/tasks/extend-kubernetes/configure-aggregation-layer/">Configure the aggregation layer</a>. Many providers already have this configured, including <code>kind</code>.</p></li><li>
<p>Install Prometheus and the <a href="https://github.com/kubernetes-sigs/prometheus-adapter">Prometheus Adapter</a> if you don&rsquo;t already have them installed on the cluster. Adjust the default Prometheus address values as needed for your environment (set <code>prometheus.url</code>, <code>prometheus.port</code>, and <code>prometheus.path</code> to the appropriate values).</p></li><li>
<p>(Optional) Install <a href="https://github.com/kubernetes-sigs/metrics-server"><code>metrics-server</code></a> to access basic metrics. If the readiness of the <code>metrics-server</code> pod fails with HTTP 500, try adding the <code>--kubelet-insecure-tls</code> flag to the container.</p></li><li>
<p>If you want to use a custom metric for autoscaling Fluentd and the necessary metric is not available in Prometheus, define a Prometheus recording rule:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">groups</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">my-logging-hpa.rules</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">rules</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">expr</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">(node_filesystem_size_bytes{container=&#34;buffer-metrics-sidecar&#34;,mountpoint=&#34;/buffers&#34;}-node_filesystem_free_bytes{container=&#34;buffer-metrics-sidecar&#34;,mountpoint=&#34;/buffers&#34;})/node_filesystem_size_bytes{container=&#34;buffer-metrics-sidecar&#34;,mountpoint=&#34;/buffers&#34;}</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">record</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">buffer_space_usage_ratio</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Alternatively, you can define the derived metric as a configuration rule in the Prometheus Adapter&rsquo;s config map.</p></li><li>
<p>If it&rsquo;s not already installed, install the logging-operator and configure a logging resource with at least one flow. Make sure that the logging resource has buffer volume metrics monitoring enabled under <code>spec.fluentd</code>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">#spec:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic">#  fluentd:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">bufferVolumeMetrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">serviceMonitor</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Verify that the custom metric is available by running:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="display:flex"><span>kubectl get --raw <span style="color:#4e9a06">&#39;/apis/custom.metrics.k8s.io/v1beta1/namespaces/default/pods/*/buffer_space_usage_ratio&#39;</span>
</span></span></code></pre></div></li><li>
<p>The logging-operator enforces the replica count of the stateful set based on the logging resource&rsquo;s replica count, even if it&rsquo;s not set explicitly. To allow for HPA to control the replica count of the stateful set, this coupling has to be severed.
<strong>Currently, the only way to do that is by deleting the logging-operator deployment.</strong></p></li><li>
<p>Create a HPA resource. The following example tries to keep the average buffer volume usage of Fluentd instances at 80%.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">autoscaling/v2beta2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">HorizontalPodAutoscaler</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">scaleTargetRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">apps/v1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">StatefulSet</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">minReplicas</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">maxReplicas</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">10</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">metrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Pods</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">pods</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">metric</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">buffer_space_usage_ratio</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">target</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">AverageValue</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">averageValue</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">800m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li></ol><h2 id="probe">Probe</h2><p>A <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#container-probes">Probe</a> is a diagnostic performed periodically by the kubelet on a Container. To perform a diagnostic, the kubelet calls a Handler implemented by the Container. You can configure a probe for Fluentd in the <strong>livenessProbe</strong> section of the <a href="/5.1/docs/logging-infrastructure/logging/">The Logging custom resource</a>. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">livenessProbe</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">periodSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">60</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">initialDelaySeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">600</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">exec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">command</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;/bin/sh&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;-c&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000;font-weight:700">&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">          LIVENESS_THRESHOLD_SECONDS=${LIVENESS_THRESHOLD_SECONDS:-300};
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">          if [ ! -e /buffers ];
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">          then
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">            exit 1;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">          fi;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">          touch -d &#34;${LIVENESS_THRESHOLD_SECONDS} seconds ago&#34; /tmp/marker-liveness;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">          if [ -z &#34;$(find /buffers -type d -newer /tmp/marker-liveness -print -quit)&#34; ];
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">          then
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">            exit 1;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">          fi;</span><span style="color:#f8f8f8;text-decoration:underline">          
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>You can use the following parameters:</p><table>
<thead>
<tr>
<th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>initialDelaySeconds</td><td>int</td><td>600</td><td>Number of seconds after the container has started before liveness probes are initiated.</td></tr><tr>
<td>timeoutSeconds</td><td>int</td><td>0</td><td>Number of seconds after which the probe times out.</td></tr><tr>
<td>periodSeconds</td><td>int</td><td>60</td><td>How often (in seconds) to perform the probe.</td></tr><tr>
<td>successThreshold</td><td>int</td><td>0</td><td>Minimum consecutive successes for the probe to be considered successful after having failed.</td></tr><tr>
<td>failureThreshold</td><td>int</td><td>0</td><td>Minimum consecutive failures for the probe to be considered failed after having succeeded.</td></tr><tr>
<td>exec</td><td>array</td><td>{}</td><td>Exec specifies the action to take. <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#execaction-v1-core">More info</a></td></tr><tr>
<td>httpGet</td><td>array</td><td>{}</td><td>HTTPGet specifies the http request to perform. <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#httpgetaction-v1-core">More info</a></td></tr><tr>
<td>tcpSocket</td><td>array</td><td>{}</td><td>TCPSocket specifies an action involving a TCP port. <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#tcpsocketaction-v1-core">More info</a></td></tr></tbody></table><blockquote>
<p>Note: To configure readiness probes, see <a href="/5.1/docs/operation/readiness-probe/">Readiness probe</a>.</p></blockquote><h2 id="custom-fluentd-image">Custom Fluentd image</h2><p>You can deploy custom images by overriding the default images using the following parameters in the fluentd or fluentbit sections of the logging resource.</p><table>
<thead>
<tr>
<th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>repository</td><td>string</td><td>""</td><td>Image repository</td></tr><tr>
<td>tag</td><td>string</td><td>""</td><td>Image tag</td></tr><tr>
<td>pullPolicy</td><td>string</td><td>""</td><td>Always, IfNotPresent, Never</td></tr></tbody></table><p>The following example deploys a custom fluentd image:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">image</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">banzaicloud/fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v1.10.4-alpine-1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">pullPolicy</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">IfNotPresent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">configReloaderImage</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">jimmidyson/configmap-reload</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v0.4.0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">pullPolicy</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">IfNotPresent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">scaling</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">drain</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">image</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ghcr.io/banzaicloud/fluentd-drain-watch</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v0.0.1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">pullPolicy</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">IfNotPresent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">bufferVolumeImage</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">quay.io/prometheus/node-exporter</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v1.1.2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">pullPolicy</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">IfNotPresent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="kubernetesstorage">KubernetesStorage</h2><p>Define Kubernetes storage.</p><table>
<thead>
<tr>
<th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>hostPath</td><td><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#hostpathvolumesource-v1-core">HostPathVolumeSource</a></td><td>-</td><td>Represents a host path mapped into a pod. If path is empty, it will automatically be set to <code>/opt/logging-operator/&lt;name of the logging CR>/&lt;name of the volume></code> </td></tr><tr>
<td>emptyDir</td><td><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#emptydirvolumesource-v1-core">EmptyDirVolumeSource</a></td><td>-</td><td>Represents an empty directory for a pod. </td></tr><tr>
<td>pvc</td><td><a href="#persistent-volume-claim">PersistentVolumeClaim</a></td><td>-</td><td>A PersistentVolumeClaim (PVC) is a request for storage by a user. </td></tr></tbody></table><h2 id="persistent-volume-claim">Persistent Volume Claim</h2><table>
<thead>
<tr>
<th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>spec</td><td><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#persistentvolumeclaimspec-v1-core">PersistentVolumeClaimSpec</a></td><td>-</td><td>Spec defines the desired characteristics of a volume requested by a pod author. </td></tr><tr>
<td>source</td><td><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#persistentvolumeclaimvolumesource-v1-core">PersistentVolumeClaimVolumeSource</a></td><td>-</td><td>PersistentVolumeClaimVolumeSource references the user&rsquo;s PVC in the same namespace.  </td></tr></tbody></table><p>The Persistent Volume Claim should be created with the given <code>spec</code> and with the <code>name</code> defined in the <code>source</code>&rsquo;s <code>claimName</code>.</p><h2 id="cpu-and-memory-requirements">CPU and memory requirements</h2><p>To adjust the CPU and memory limits and requests of the pods managed by Logging operator, see <a href="/5.1/docs/operation/requirements/">CPU and memory requirements</a>.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-e0c4f740879ef5ce79b6d0d086ef5e14">6.3 - Configure syslog-ng</h1><p>syslog-ng is supported only in Logging operator 4.0 or newer.</p><p>This page shows some examples on configuring syslog-ng.</p><h2 id="ways-to-configure-syslog-ng">Ways to configure syslog-ng</h2><p>There are two ways to configure the syslog-ng statefulset:</p><ol>
<li>
<p>Using the <strong>spec.syslogNG</strong> section of <a href="/5.1/docs/logging-infrastructure/logging/">The Logging custom resource</a>.</p></li><li>
<p>Using the standalone syslogNGConfig CRD. This method is only available in Logging operator version 4.5 and newer, and the specification of the CRD is compatible with the <strong>spec.syslogNG</strong> configuration method. That way you can use a multi-tenant model, where tenant owners are responsible for operating their own aggregator, while the Logging resource is in control of the central operations team.</p><p>The standalone syslogNGConfig is a namespaced resource that allows the configuration of the syslog-ng aggregator in the control namespace, separately from the Logging resource. This allows you to use a multi-tenant model, where tenant owners are responsible for operating their own aggregator, while the Logging resource is in control of the central operations team. For more information about the multi-tenancy model where the collector is capable of routing logs based on namespaces to individual aggregators and where aggregators are fully isolated, see this blog post about <a href="https://axoflow.com/multi-tenancy-using-logging-operator/">Multi-tenancy using Logging operator</a>.</p></li></ol><p>For the detailed list of available parameters, see <a href="/5.1/docs/configuration/crds/v1beta1/syslogng_types/">SyslogNGSpec</a>.</p><h3 id="migrating">Migrating from <strong>spec.syslogNG</strong> to syslogNGConfig</h3><p>The standalone syslogNGConfig CRD is only available in Logging operator version 4.5 and newer. Its specification and logic is identical with the <strong>spec.syslogNG</strong> configuration method. Using the syslogNGConfig CRD allows you to remove the <strong>spec.syslogNG</strong> section from the Logging CRD, which has the following benefits.</p><ul>
<li>RBAC control over the syslogNGConfig CRD, so you can have separate roles that can manage the Logging resource and the syslogNGConfig resource (that is, the syslog-ng deployment).</li><li>It reduces the size of the Logging resource, which can grow big enough to reach the annotation size limit in certain scenarios (e.g. when using <code>kubectl apply</code>).</li><li>You can use a multi-tenant model, where tenant owners are responsible for operating their own aggregator, while the Logging resource is in control of the central operations team.</li></ul><p>To migrate your <strong>spec.syslogNG</strong> configuration from the Logging resource to a separate syslogNGConfig CRD, complete the following steps.</p><ol>
<li>
<p>Open your Logging resource and find the <strong>spec.syslogNG</strong> section. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-logging-resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogNG</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">statefulSet</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">replicas</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Create a new syslogNGConfig CRD. For the value of <strong>metadata.name</strong>, use the name of the Logging resource, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">syslogNGConfig</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Use the name of the logging resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-logging-resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Use the control namespace of the logging resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Copy the the <strong>spec.syslogNG</strong> section from the Logging resource into the <strong>spec</strong> section of the syslogNGConfig CRD, then fix the indentation. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">syslogNGConfig</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Use the name of the logging resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-logging-resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Use the control namespace of the logging resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">statefulSet</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">replicas</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Delete the <strong>spec.syslogNG</strong> section from the Logging resource, then apply the Logging and the syslogNGConfig CRDs.</p></li></ol><h2 id="using-the-standalone-syslogngconfig-resource">Using the standalone syslogNGConfig resource</h2><p>The standalone syslogNGConfig is a namespaced resource that allows the configuration of the syslog-ng aggregator in the control namespace, separately from the Logging resource. This allows you to use a multi-tenant model, where tenant owners are responsible for operating their own aggregator, while the Logging resource is in control of the central operations team. For more information about the multi-tenancy model where the collector is capable of routing logs based on namespaces to individual aggregators and where aggregators are fully isolated, see this blog post about <a href="https://axoflow.com/multi-tenancy-using-logging-operator/">Multi-tenancy using Logging operator</a>.</p><p>A <code>Logging</code> resource can have only one <code>syslogNGConfig</code> at a time. The controller registers the active <code>syslogNGConfig</code> resource into the <code>Logging</code> resource&rsquo;s status under <code>syslogNGConfigName</code>, and also registers the <code>Logging</code> resource name under <code>logging</code> in the <code>syslogNGConfig</code> resource&rsquo;s status, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get logging example -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.status}&#39;</span> <span style="color:#000;font-weight:700">|</span> jq .
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;configCheckResults&#34;</span>: <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;ac2d4553&#34;</span>: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>  <span style="color:#ce5c00;font-weight:700">}</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;syslogNGConfigName&#34;</span>: <span style="color:#4e9a06">&#34;example&#34;</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get syslogngconfig example -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.status}&#39;</span> <span style="color:#000;font-weight:700">|</span> jq .
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;active&#34;</span>: true,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;logging&#34;</span>: <span style="color:#4e9a06">&#34;example&#34;</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span></code></pre></div><p>If there is a conflict, the controller adds a problem to both resources so that both the operations team and the tenant users can notice the problem. For example, if a <code>syslogNGConfig</code> is already registered to a <code>Logging</code> resource and you create another <code>syslogNGConfig</code> resource in the same namespace, then the first <code>syslogNGConfig</code> is left intact, while the second one should have the following status:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get syslogngconfig example2 -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.status}&#39;</span> <span style="color:#000;font-weight:700">|</span> jq .
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;active&#34;</span>: false,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;problems&#34;</span>: <span style="color:#ce5c00;font-weight:700">[</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;logging already has a detached syslog-ng configuration, remove excess configuration objects&#34;</span>
</span></span><span style="display:flex"><span>  <span style="color:#ce5c00;font-weight:700">]</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;problemsCount&#34;</span>: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span></code></pre></div><p>The <code>Logging</code> resource will also show the issue:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get logging example -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.status}&#39;</span> <span style="color:#000;font-weight:700">|</span> jq .
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;configCheckResults&#34;</span>: <span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;ac2d4553&#34;</span>: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>  <span style="color:#ce5c00;font-weight:700">}</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;syslogNGConfigName&#34;</span>: <span style="color:#4e9a06">&#34;example&#34;</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;problems&#34;</span>: <span style="color:#ce5c00;font-weight:700">[</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;multiple syslog-ng configurations found, couldn&#39;t associate it with logging&#34;</span>
</span></span><span style="display:flex"><span>  <span style="color:#ce5c00;font-weight:700">]</span>,
</span></span><span style="display:flex"><span>  <span style="color:#4e9a06">&#34;problemsCount&#34;</span>: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span></code></pre></div><h2 id="volume-mount-for-buffering">Volume mount for buffering</h2><p>The following example sets a volume mount that syslog-ng can use for buffering messages on the disk (if <a href="/5.1/docs/configuration/plugins/syslog-ng-outputs/disk_buffer/">Disk buffer</a> is configured in the output).</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogNG</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">statefulSet</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">template</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">containers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">syslog-ng</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#204a87;font-weight:700">volumeMounts</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">              </span>- <span style="color:#204a87;font-weight:700">mountPath</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/buffers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">buffer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">volumeClaimTemplates</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">buffer</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">accessModes</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span>- <span style="color:#000">ReadWriteOnce</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">resources</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">              </span><span style="color:#204a87;font-weight:700">requests</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">                </span><span style="color:#204a87;font-weight:700">storage</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10Gi</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="cpu-and-memory-requirements">CPU and memory requirements</h2><p>To adjust the CPU and memory limits and requests of the pods managed by Logging operator, see <a href="/5.1/docs/operation/requirements/">CPU and memory requirements</a>.</p><h2 id="probe">Probe</h2><p>A <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#container-probes">Probe</a> is a diagnostic performed periodically by the kubelet on a Container. To perform a diagnostic, the kubelet calls a Handler implemented by the Container. You can configure a probe for syslog-ng in the <strong>livenessProbe</strong> section of the <a href="/5.1/docs/logging-infrastructure/logging/">The Logging custom resource</a>. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogNG</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">livenessProbe</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">periodSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">60</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">initialDelaySeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">600</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">exec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">command</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;/usr/sbin/syslog-ng-ctl&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;--control=/tmp/syslog-ng/syslog-ng.ctl&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;query&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;get&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#4e9a06">&#34;global.sdata_updates.processed&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>You can use the following parameters:</p><table>
<thead>
<tr>
<th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>initialDelaySeconds</td><td>int</td><td>30</td><td>Number of seconds after the container has started before liveness probes are initiated.</td></tr><tr>
<td>timeoutSeconds</td><td>int</td><td>0</td><td>Number of seconds after which the probe times out.</td></tr><tr>
<td>periodSeconds</td><td>int</td><td>10</td><td>How often (in seconds) to perform the probe.</td></tr><tr>
<td>successThreshold</td><td>int</td><td>0</td><td>Minimum consecutive successes for the probe to be considered successful after having failed.</td></tr><tr>
<td>failureThreshold</td><td>int</td><td>3</td><td>Minimum consecutive failures for the probe to be considered failed after having succeeded.</td></tr><tr>
<td>exec</td><td>array</td><td>{}</td><td>Exec specifies the action to take. <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#execaction-v1-core">More info</a></td></tr></tbody></table><blockquote>
<p>Note: To configure readiness probes, see <a href="/5.1/docs/operation/readiness-probe/">Readiness probe</a>.</p></blockquote></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-e55dcde4fa90369f23e1167b78e14986">6.4 - Fluent Bit log collector</h1><p align="center"><img src="../../img/fluentbit.png" alt="Logos" width="340"></p><p>Fluent Bit is an open source and multi-platform Log Processor and Forwarder which allows you to collect data/logs from different sources, unify and send them to multiple destinations.</p><p>Logging operator uses Fluent Bit as a log collector agent: Logging operator deploys Fluent Bit to your Kubernetes nodes where it collects and enriches the local logs and transfers them to a log forwarder instance.</p><h2 id="ways-to-configure-fluent-bit">Ways to configure Fluent Bit</h2><p>There are three ways to configure the Fluent Bit daemonset:</p><ol>
<li>Using the <strong>spec.fluentbit</strong> section of <a href="/5.1/docs/logging-infrastructure/logging/">The Logging custom resource</a>. This method is deprecated and will be removed in the next major release.</li><li>Using the standalone FluentbitAgent CRD. This method is only available in Logging operator version 4.2 and newer, and the specification of the CRD is compatible with the <strong>spec.fluentbit</strong> configuration method.</li><li>Using the <strong>spec.nodeagents</strong> section of <a href="/5.1/docs/logging-infrastructure/logging/">The Logging custom resource</a>. This method is deprecated and will be removed from the Logging operator. (Note that this configuration isn&rsquo;t compatible with the FluentbitAgent CRD.)</li></ol><p>For the detailed list of available parameters, see <a href="/5.1/docs/configuration/crds/v1beta1/fluentbit_types/">FluentbitSpec</a>.</p><h3 id="migrating">Migrating from <strong>spec.fluentbit</strong> to FluentbitAgent</h3><p>The standalone FluentbitAgent CRD is only available in Logging operator version 4.2 and newer. Its specification and logic is identical with the <strong>spec.fluentbit</strong> configuration method. Using the FluentbitAgent CRD allows you to remove the <strong>spec.fluentbit</strong> section from the Logging CRD, which has the following benefits.</p><ul>
<li>RBAC control over the FluentbitAgent CRD, so you can have separate roles that can manage the Logging resource and the FluentbitAgent resource (that is, the Fluent Bit deployment).</li><li>It reduces the size of the Logging resource, which can grow big enough to reach the annotation size limit in certain scenarios (e.g. when using <code>kubectl apply</code>).</li><li>It allows you to use multiple different Fluent Bit configurations within the same cluster. For details, see <a href="/5.1/docs/logging-infrastructure/fluentbit-multiple/">Multiple Fluent Bit agents in the cluster</a>.</li></ul><p>To migrate your <strong>spec.fluentbit</strong> configuration from the Logging resource to a separate FluentbitAgent CRD, complete the following steps.</p><ol>
<li>
<p>Open your Logging resource and find the <strong>spec.fluentbit</strong> section. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-logging-resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">inputTail</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">storage.type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">filesystem</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">positiondb</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">hostPath</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">bufferStorageVolume</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">hostPath</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">            </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Create a new FluentbitAgent CRD. For the value of <strong>metadata.name</strong>, use the name of the Logging resource, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Use the name of the logging resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-logging-resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Copy the the <strong>spec.fluentbit</strong> section from the Logging resource into the <strong>spec</strong> section of the FluentbitAgent CRD, then fix the indentation.</p></li><li>
<p>Specify the paths for the positiondb and the bufferStorageVolume. If you used the default settings in the <strong>spec.fluentbit</strong> configuration, set empty strings as paths, like in the following example. This is needed to retain the existing buffers of the deployment, otherwise data loss may occur.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Use the name of the logging resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-logging-resource</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">inputTail</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">storage.type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">filesystem</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">positiondb</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">hostPath</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">bufferStorageVolume</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">hostPath</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Delete the <strong>spec.fluentbit</strong> section from the Logging resource, then apply the Logging and the FluentbitAgent CRDs.</p></li></ol><h2 id="examples">Examples</h2><p>The following sections show you some examples on configuring Fluent Bit. For the detailed list of available parameters, see <a href="/5.1/docs/configuration/crds/v1beta1/fluentbit_types/">FluentbitSpec</a>.</p><blockquote>
<p>Note: These examples use the traditional method that configures the Fluent Bit deployment using <strong>spec.fluentbit</strong> section of <a href="/5.1/docs/logging-infrastructure/logging/">The Logging custom resource</a>.</p></blockquote><h2 id="containerd-log-fields">Containerd log fields</h2><p>The following example defines a custom Fluent Bit parser that places the parsed containerd log messages into the <code>log</code> field instead of the <code>message</code> field to be backwards compatible with docker container runtimes.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">containerd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">inputTail</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">Parser</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">cri-log-key</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Parser that populates `log` instead of `message` to enable the Kubernetes filter&#39;s Merge_Log feature to work</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Mind the indentation, otherwise Fluent Bit will parse the whole message into the `log` key</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">customParsers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:700">|</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                  [PARSER]
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                      Name cri-log-key
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                      Format regex
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                      Regex ^(?&lt;time&gt;[^ ]+) (?&lt;stream&gt;stdout|stderr) (?&lt;logtag&gt;[^ ]*) (?&lt;log&gt;.*)$
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                      Time_Key    time
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">                      Time_Format %Y-%m-%dT%H:%M:%S.%L%z</span><span style="color:#f8f8f8;text-decoration:underline">                  
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Required key remap if one wants to rely on the existing auto-detected log key in the fluentd parser and concat filter otherwise should be omitted</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filterModify</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">rules</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:700">Rename</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">key</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">log</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">value</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">message</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="filters">Filters</h2><h3 id="kubernetes-filterkubernetes">Kubernetes (filterKubernetes)</h3><p>Fluent Bit Kubernetes Filter allows you to enrich your log files with Kubernetes metadata. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filterKubernetes</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">Kube_URL</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;https://kubernetes.default.svc:443&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For the detailed list of available parameters for this plugin, see <a href="/5.1/docs/configuration/crds/v1beta1/fluentbit_types/#filterkubernetes">FilterKubernetes</a>.
<a href="https://docs.fluentbit.io/manual/pipeline/filters/kubernetes">More info</a></p><h2 id="tail-input">Tail input</h2><p>The tail input plugin allows to monitor one or several text files. It has a similar behavior like <em>tail -f</em> shell command. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">inputTail</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">storage.type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">filesystem</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">Refresh_Interval</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;60&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">Rotate_Wait</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;5&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For the detailed list of available parameters for this plugin, see <a href="/5.1/docs/configuration/crds/v1beta1/fluentbit_types/#inputtail">InputTail</a>.
<a href="https://github.com/fluent/fluent-bit-docs/blob/1.3/input/tail.md">More Info</a>.</p><h2 id="buffering">Buffering</h2><p>Buffering in Fluent Bit places the processed data into a temporal location until is sent to Fluentd. By default, the Logging operator sets <code>storage.path</code> to <code>/buffers</code> and leaves fluent-bit defaults for the other options.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">inputTail</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">storage.type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">filesystem</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">bufferStorage</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">storage.path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/buffers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For the detailed list of available parameters for this plugin, see <a href="/5.1/docs/configuration/crds/v1beta1/fluentbit_types/#bufferstorage">BufferStorage</a>.
<a href="https://docs.fluentbit.io/manual/v/1.3/configuration/buffering">More Info</a>.</p><h3 id="hostpath-volumes-for-buffers-and-positions">HostPath volumes for buffers and positions</h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">inputTail</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">storage.type</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">filesystem</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">bufferStorageVolume</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">hostPath</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># leave it empty to automatically generate</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">positiondb</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">hostPath</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># leave it empty to automatically generate</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="custom-fluent-bit-image">Custom Fluent Bit image</h2><p>You can deploy custom images by overriding the default images using the following parameters.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">image</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluent/fluent-bit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">2.1.8</span>-<span style="color:#000">debug</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">pullPolicy</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">IfNotPresent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="volume-mount">Volume Mount</h2><p>Defines a pod volume mount. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">extraVolumeMounts</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">destination</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data/docker/containers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">readOnly</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">source</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/data/docker/containers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For the detailed list of available parameters for this plugin, see <a href="/5.1/docs/configuration/crds/v1beta1/fluentbit_types/#volumemount">VolumeMount</a>.</p><h2 id="custom-fluent-bit-annotations">Custom Fluent Bit annotations</h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">annotations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">my-annotations/enable</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="kubernetesstorage">KubernetesStorage</h2><p>Define Kubernetes storage.</p><table>
<thead>
<tr>
<th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>hostPath</td><td><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#hostpathvolumesource-v1-core">HostPathVolumeSource</a></td><td>-</td><td>Represents a host path mapped into a pod. If path is empty, it will automatically be set to <code>/opt/logging-operator/&lt;name of the logging CR>/&lt;name of the volume></code> </td></tr><tr>
<td>emptyDir</td><td><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#emptydirvolumesource-v1-core">EmptyDirVolumeSource</a></td><td>-</td><td>Represents an empty directory for a pod. </td></tr></tbody></table><h2 id="cpu-and-memory-requirements">CPU and memory requirements</h2><p>To adjust the CPU and memory limits and requests of the pods managed by Logging operator, see <a href="/5.1/docs/operation/requirements/">CPU and memory requirements</a>.</p><h2 id="probe">Probe</h2><p>A <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#container-probes">Probe</a> is a diagnostic performed periodically by the kubelet on a Container. To perform a diagnostic, the kubelet calls a Handler implemented by the Container. You can configure a probe for Fluent Bit in the <strong>livenessProbe</strong> section of the <a href="/5.1/docs/logging-infrastructure/logging/">The Logging custom resource</a>. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">livenessProbe</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">periodSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">60</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">initialDelaySeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">600</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">exec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">command</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#4e9a06">&#34;/bin/sh&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#4e9a06">&#34;-c&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#000;font-weight:700">&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">        LIVENESS_THRESHOLD_SECONDS=${LIVENESS_THRESHOLD_SECONDS:-300};
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">        if [ ! -e /buffers ]; then
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">          exit 1;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">        fi;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">        touch -d &#34;${LIVENESS_THRESHOLD_SECONDS} seconds ago&#34; /tmp/marker-liveness;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">        if [ -z &#34;$(find /buffers -type d -newer /tmp/marker-liveness -print -quit)&#34; ]; then
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">          exit 1;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">        fi;</span><span style="color:#f8f8f8;text-decoration:underline">        
</span></span></span></code></pre></div><p>You can use the following parameters:</p><table>
<thead>
<tr>
<th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>initialDelaySeconds</td><td>int</td><td>10</td><td>Number of seconds after the container has started before liveness probes are initiated.</td></tr><tr>
<td>timeoutSeconds</td><td>int</td><td>0</td><td>Number of seconds after which the probe times out.</td></tr><tr>
<td>periodSeconds</td><td>int</td><td>10</td><td>How often (in seconds) to perform the probe.</td></tr><tr>
<td>successThreshold</td><td>int</td><td>0</td><td>Minimum consecutive successes for the probe to be considered successful after having failed.</td></tr><tr>
<td>failureThreshold</td><td>int</td><td>3</td><td>Minimum consecutive failures for the probe to be considered failed after having succeeded.</td></tr><tr>
<td>exec</td><td>array</td><td>{}</td><td>Exec specifies the action to take. <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#execaction-v1-core">More info</a></td></tr><tr>
<td>httpGet</td><td>array</td><td>{}</td><td>HTTPGet specifies the http request to perform. <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#httpgetaction-v1-core">More info</a></td></tr><tr>
<td>tcpSocket</td><td>array</td><td>{}</td><td>TCPSocket specifies an action involving a TCP port. <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#tcpsocketaction-v1-core">More info</a></td></tr></tbody></table><blockquote>
<p>Note: To configure readiness probes, see <a href="/5.1/docs/operation/readiness-probe/">Readiness probe</a>.</p></blockquote></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-d8f4a300f3d0e2b8000fec50bc64befb">6.5 - Multiple Fluent Bit agents in the cluster</h1><p>There can be at least two different use cases where one might need multiple sets of node agents running with different configuration while still forwarding logs to the same aggregator.</p><p>One specific example is when there is a need for a configuration change in a rolling upgrade manner. As new nodes come up, they need to run with a new configuration, while old nodes use the previous configuration.</p><p>The other use case is when there are different node groups in a cluster for multitenancy reasons for example. You might need different Fluent Bit configurations on the separate node groups in that case.</p><p>Starting with Logging operator version 4.2, you can do that by using the FluentbitAgent CRD. This allows you to implement hard multitenancy on the node group level.</p><p>For details on using the FluentbitAgent CRD, see <a href="/5.1/docs/logging-infrastructure/fluentbit/">Fluent Bit log collector</a>.</p><p>To configure multiple FluentbitAgent CRDs for a cluster, complete the following steps.</p><blockquote>
<p>Note: The examples refer to a scenario where you have two node groups that have the Kubernetes label <code>nodeGroup=A</code> and <code>nodeGroup=B</code>. These labels are fictional and are used only as examples. Node labels are not available in the log metadata, to have similar labels, you have to apply the node labels directly to the pods. How to do that is beyond the scope of this guide (for example, you can use a policy engine, like <a href="https://kyverno.io/">Kyverno</a>).</p></blockquote><ol>
<li>
<p>If you are updating an existing deployment, make sure that it already uses a Logging configuration based on FluentbitAgent CRD. If not, first <a href="/5.1/docs/logging-infrastructure/fluentbit/#migrating">migrate your configuration to use a FluentbitAgent CRD</a>.</p></li><li>
<p>Edit your existing FluentbitAgent CRD, and set the <strong>spec.nodeSelector</strong> field so it applies only to the node group you want to apply this Fluent Bit configuration on, for example, nodes that have the label <code>nodeGroup=A</code>. For details, see <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector">nodeSelector in the Kubernetes documentation</a>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#8f5902;font-style:italic"># Use the same name as the logging resource does</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">multi</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">nodeSelector</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">nodeGroup</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;A&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><blockquote>
<p>Note: If your Logging resource has its <strong>spec.loggingRef</strong> parameter set, set the same value in the <strong>spec.loggingRef</strong> parameter of the FluentbitAgent resource.</p></blockquote><p>Set other <a href="/5.1/docs/configuration/crds/v1beta1/fluentbit_types/">FluentbitAgent parameters</a> as needed for your environment.</p></li><li>
<p>Create a new FluentbitAgent CRD, and set the <strong>spec.nodeSelector</strong> field so it applies only to the node group you want to apply this Fluent Bit configuration on, for example, nodes that have the label <code>nodeGroup=B</code>. For details, see <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector">nodeSelector in the Kubernetes documentation</a>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentbitAgent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">multi-B</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">nodeSelector</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">nodeGroup</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;B&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><blockquote>
<p>Note: If your Logging resource has its <strong>spec.loggingRef</strong> parameter set, set the same value in the <strong>spec.loggingRef</strong> parameter of the FluentbitAgent resource.</p></blockquote><p>Set other <a href="/5.1/docs/configuration/crds/v1beta1/fluentbit_types/">FluentbitAgent parameters</a> as needed for your environment.</p></li><li>
<p>Create the Flow resources to route the log messages to the outputs. For example, you can select and exclude logs based on their node group labels.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;flow-for-nodegroup-A&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">nodeGroup</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;A&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#4e9a06">&#34;output-for-nodegroup-A&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;flow-for-nodegroup-B&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">match</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">select</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#204a87;font-weight:700">nodeGroup</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;B&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#4e9a06">&#34;output-for-nodegroup-B&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><blockquote>
<p>Note: If your Logging resource has its <strong>spec.loggingRef</strong> parameter set, set the same value in the <strong>spec.loggingRef</strong> parameter of the Flow resource.</p></blockquote><p>Set other <a href="/5.1/docs/configuration/crds/v1beta1/flow_types/">Flow parameters</a> as needed for your environment.</p></li><li>
<p>Create the outputs (called <code>"output-for-nodegroup-A"</code> and <code>"output-for-nodegroup-B"</code>) for the Flows.</p></li></ol></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-34e5e120deddba15a35b3c3d1135cbb2">6.6 - TLS encryption</h1><p>To use TLS encryption in your logging infrastructure, you have to configure encryption:</p><ul>
<li>for the log collection part of your logging pipeline (between Fluent Bit and Fluentd or Fluent bit and syslog-ng), and</li><li>for the output plugin (between Fluentd or syslog-ng and the output backend).</li></ul><p>For configuring the output, see the documentation of the output plugin you want to use at <a href="/5.1/docs/configuration/plugins/outputs/">Fluentd outputs</a>.</p><p>For Fluentd and Fluent Bit, you can configure encryption in the <code>logging</code> resource using the following parameters:</p><table>
<thead>
<tr>
<th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>enabled</td><td>bool</td><td>&ldquo;Yes&rdquo;</td><td>Enable TLS encryption</td></tr><tr>
<td>secretName</td><td>string</td><td>""</td><td>Kubernetes secret that contains: <strong>tls.crt, tls.key, ca.crt</strong></td></tr><tr>
<td>sharedKey</td><td>string</td><td>""</td><td>Shared secret for fluentd authentication</td></tr></tbody></table><p>For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-tls</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tls</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">enabled</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">secretName</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluentd-tls</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">sharedKey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-secret</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">tls</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">enabled</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">secretName</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluentbit-tls</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">sharedKey</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-secret</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For other parameters of the logging resource, see <a href="/5.1/docs/configuration/crds/v1beta1/logging_types/">LoggingSpec</a>.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-ad05d57db5d08bb5a16b343b608e91fa">6.7 - Security</h1><h2 id="security-variables">Security Variables</h2><table>
<thead>
<tr>
<th>Variable Name</th><th>Type</th><th>Required</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>roleBasedAccessControlCreate</td><td>bool</td><td>No</td><td>True</td><td>create RBAC resources</td></tr><tr>
<td>serviceAccount</td><td>string</td><td>No</td><td>-</td><td>Set ServiceAccount</td></tr><tr>
<td>securityContext</td><td><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#securitycontext-v1-core">SecurityContext</a></td><td>No</td><td>{}</td><td>SecurityContext holds security configuration that will be applied to a container.</td></tr><tr>
<td>podSecurityContext</td><td><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#podsecuritycontext-v1-core">PodSecurityContext</a></td><td>No</td><td>{}</td><td>PodSecurityContext holds pod-level security attributes and common container settings. Some</td></tr></tbody></table><h2 id="using-rbachttpskubernetesiodocsreferenceaccess-authn-authzrbac-authorization">Using <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">RBAC</a> Authorization</h2><blockquote>
<p>By default, RBAC is enabled.</p></blockquote><h3 id="deploy-with-kubernetes-manifests">Deploy with Kubernetes Manifests</h3><h4 id="create-logging-resource-with-rbac">Create <code>logging</code> resource with RBAC</h4><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl -n logging apply -f - &lt;&lt;&#34;EOF&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">security</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">roleBasedAccessControlCreate</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">security</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">roleBasedAccessControlCreate</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="example-manifest-generated-by-the-operator">Example Manifest Generated by the operator</h3><h4 id="fluentd-role--rolebinding-output">Fluentd Role & RoleBinding Output</h4><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span>- <span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">rbac.authorization.k8s.io/v1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Role</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-demo-nginx-logging-demo-logging-fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">ownerReferences</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">controller</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">rules</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">apiGroups</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">resources</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">configmaps</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">secrets</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">verbs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#4e9a06">&#39;*&#39;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span>--<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">rbac.authorization.k8s.io/v1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">RoleBinding</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">annotations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-demo-nginx-logging-demo-logging-fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">ownerReferences</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">controller</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">roleRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">apiGroup</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">rbac.authorization.k8s.io</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Role</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-demo-nginx-logging-demo-logging-fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">subjects</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ServiceAccount</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-demo-nginx-logging-demo-logging-fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h4 id="fluentbit-clusterrole--clusterrolebinding-output">Fluentbit ClusterRole & ClusterRoleBinding Output</h4><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ClusterRole</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">annotations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-demo-nginx-logging-demo-logging-fluentbit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">ownerReferences</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">controller</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">rules</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:700">apiGroups</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">resources</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">pods</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">namespaces</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">verbs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">get</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">list</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#000">watch</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">---</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ClusterRoleBinding</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">annotations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-nginx-demo-nginx-logging-demo-logging-fluentbit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">ownerReferences</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">controller</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">roleRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">apiGroup</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">rbac.authorization.k8s.io</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ClusterRole</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx-demo-nginx-logging-demo-logging-fluentbit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">subjects</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ServiceAccount</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx-demo-nginx-logging-demo-logging-fluentbit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="service-account-sahttpskubernetesiodocsreferenceaccess-authn-authzservice-accounts-admin">Service Account (<a href="https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/">SA</a>)</h2><h3 id="service-account-deploy-kubernetes-manifests">Deploy with Kubernetes Manifests</h3><h4 id="create-logging-resource-with-service-account">Create <code>logging</code> resource with Service Account</h4><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl -n logging apply -f - &lt;&lt;&#34;EOF&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">security</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">serviceAccount</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluentdUser1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">security</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">serviceAccount</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluentbitUser1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="security-contexthttpskubernetesiodocstasksconfigure-pod-containersecurity-context"><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Security Context</a></h2><ul>
<li><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#securitycontext-v1-core">Security Context Parameters</a></li><li><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#podsecuritycontext-v1-core">POD Security Context Parameters</a></li></ul><h3 id="deploy-with-kubernetes-manifests-1">Deploy with Kubernetes Manifests</h3><h4 id="create-logging-resource-with-psp">Create <code>logging</code> resource with PSP</h4><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000">kubectl -n logging apply -f - &lt;&lt;&#34;EOF&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">security</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">securityContext</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">allowPrivilegeEscalation</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">readOnlyRootFilesystem</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">podSecurityContext</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">fsGroup</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">101</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">security</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">securityContext</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">allowPrivilegeEscalation</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">readOnlyRootFilesystem</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">podSecurityContext</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">fsGroup</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">101</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">EOF</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="example-manifest-generated-by-the-operator-1">Example Manifest Generated by the operator</h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Pod</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx-demo-nginx-logging-demo-logging-fluentd-0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">containers</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">image</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ghcr.io/kube-logging/fluentd:v1.15</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">imagePullPolicy</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">IfNotPresent</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">securityContext</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">allowPrivilegeEscalation</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">readOnlyRootFilesystem</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">false</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">schedulerName</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-scheduler</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">securityContext</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">fsGroup</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">101</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">serviceAccount</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx-demo-nginx-logging-demo-logging-fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-2468a881210107c399941aefc2a95a23">7 - Operation</h1></div><div class="td-content">
<h1 id="pg-85dfc8f2bc8d8124c30cdb1fdddb3b6c">7.1 - Logging operator troubleshooting</h1><p align="center"><img src="/docs/img/troubleshooting.svg" alt="Logo" width="260"></p><p align="center">
<p>The following tips and commands can help you to troubleshoot your Logging operator installation.</p><h2 id="first-things-to-do">First things to do</h2><ol>
<li>
<p>Check that the necessary CRDs are installed. Issue the following command: <code>kubectl get crd</code>
The output should include the following CRDs:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>clusterflows.logging.banzaicloud.io     2019-12-05T15:11:48Z
</span></span><span style="display:flex"><span>clusteroutputs.logging.banzaicloud.io   2019-12-05T15:11:48Z
</span></span><span style="display:flex"><span>flows.logging.banzaicloud.io            2019-12-05T15:11:48Z
</span></span><span style="display:flex"><span>loggings.logging.banzaicloud.io         2019-12-05T15:11:48Z
</span></span><span style="display:flex"><span>outputs.logging.banzaicloud.io          2019-12-05T15:11:48Z
</span></span></code></pre></div></li><li>
<p>Verify that the Logging operator pod is running. Issue the following command: <code>kubectl get pods |grep logging-operator</code>
The output should include the a running pod, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>NAME                                          READY   STATUS      RESTARTS   AGE
</span></span><span style="display:flex"><span>logging-demo-log-generator-6448d45cd9-z7zk8   1/1     Running     <span style="color:#0000cf;font-weight:700">0</span>          24m
</span></span></code></pre></div></li><li>
<p>Check the status of your resources. Beginning with Logging Operator 3.8, all custom resources have a <code>Status</code> and a <code>Problems</code> field. In a healthy system, the Problems field of the resources is empty, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl get clusteroutput -A
</span></span></code></pre></div><p>Sample output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>NAMESPACE   NAME      ACTIVE   PROBLEMS
</span></span><span style="display:flex"><span>default     nullout   <span style="color:#204a87">true</span>
</span></span></code></pre></div><p>The <code>ACTIVE</code> column indicates that the <code>ClusterOutput</code> has successfully passed the <code>configcheck</code> and presented it in the current fluentd configuration. When no errors are reported the <code>PROBLEMS</code> column is empty.</p><p>Take a look at another example, in which we have an incorrect <code>ClusterFlow</code>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl get clusterflow -o wide
</span></span></code></pre></div><p>Sample output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>NAME      ACTIVE   PROBLEMS
</span></span><span style="display:flex"><span>all-log   <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>nullout   <span style="color:#204a87">false</span>    <span style="color:#0000cf;font-weight:700">1</span>
</span></span></code></pre></div><p>You can see that the <strong>nullout</strong> <code>Clusterflow</code> is inactive and there is <em>1</em> problem with the configuration. To display the problem, check the <code>status</code> field of the object, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl get clusterflow nullout -o<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;{.status}&#39;</span> <span style="color:#000;font-weight:700">|</span> jq
</span></span></code></pre></div><p>Sample output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">{</span>
</span></span><span style="display:flex"><span><span style="color:#4e9a06">&#34;active&#34;</span>: false,
</span></span><span style="display:flex"><span><span style="color:#4e9a06">&#34;problems&#34;</span>: <span style="color:#ce5c00;font-weight:700">[</span>
</span></span><span style="display:flex"><span>    <span style="color:#4e9a06">&#34;dangling global output reference: nullout2&#34;</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">]</span>,
</span></span><span style="display:flex"><span><span style="color:#4e9a06">&#34;problemsCount&#34;</span>: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">}</span>
</span></span></code></pre></div></li></ol><p>After that, check the following sections for further tips.</p><h2 id="getting-support">Getting Support</h2><p>If you encounter any problems that the documentation does not address, <a href="https://github.com/kube-logging/logging-operator/issues">file an issue</a> or talk to us on <a href="https://discord.gg/9ACY4RDsYN">Discord</a> or on the <a href="/5.1/docs/community/">CNCF Slack</a>.</p><p>Before asking for help, prepare the following information to make troubleshooting faster:</p><ul>
<li>Logging operator version</li><li>kubernetes version</li><li>helm/chart version (if you installed the Logging operator with helm)</li><li>Logging operator logs</li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#check-fluentd-configuration">fluentd configuration</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#get-fluentd-logs">fluentd logs</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentbit/#check-the-fluent-bit-configuration">fluentbit configuration</a></li><li>fluentbit logs</li></ul><p>Do not forget to remove any sensitive information (for example, passwords and private keys) before sharing.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-741171b799e509ff0eabf397d862c757">7.1.1 - Troubleshooting Fluent Bit</h1><p align="center"><img src="/docs/img/fluentbit.png" alt="Fluent Bit logo" height="100"></p><p>The following sections help you troubleshoot the Fluent Bit component of the Logging operator.</p><h2 id="check-the-fluent-bit-daemonset">Check the Fluent Bit daemonset</h2><p>Verify that the Fluent Bit daemonset is available. Issue the following command: <code>kubectl get daemonsets</code>
The output should include a Fluent Bit daemonset, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>NAME                     DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE
</span></span><span style="display:flex"><span>logging-demo-fluentbit   <span style="color:#0000cf;font-weight:700">1</span>         <span style="color:#0000cf;font-weight:700">1</span>         <span style="color:#0000cf;font-weight:700">1</span>       <span style="color:#0000cf;font-weight:700">1</span>            <span style="color:#0000cf;font-weight:700">1</span>           &lt;none&gt;          110s
</span></span></code></pre></div><h2 id="check-the-fluent-bit-configuration">Check the Fluent Bit configuration</h2><p>You can display the current configuration of the Fluent Bit daemonset using the following command:
<code>kubectl get secret logging-demo-fluentbit -o jsonpath="{.data['fluent-bit\.conf']}" | base64 --decode</code></p><p>The output looks like the following:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#000;font-weight:700">[</span><span style="color:#000">SERVICE]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Flush        1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Daemon       Off</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Log_Level    info</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Parsers_File parsers.conf</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">storage.path  /buffers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000;font-weight:700">[</span><span style="color:#000">INPUT]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Name         tail</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">DB  /tail-db/tail-containers-state.db</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Mem_Buf_Limit  5MB</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Parser  docker</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Path  /var/log/containers/*.log</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Refresh_Interval  5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Skip_Long_Lines  On</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Tag  kubernetes.*</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000;font-weight:700">[</span><span style="color:#000">FILTER]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Name        kubernetes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Kube_CA_File  /var/run/secrets/kubernetes.io/serviceaccount/ca.crt</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Kube_Tag_Prefix  kubernetes.var.log.containers</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Kube_Token_File  /var/run/secrets/kubernetes.io/serviceaccount/token</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Kube_URL  https://kubernetes.default.svc:443</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Match  kubernetes.*</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Merge_Log  On</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#000;font-weight:700">[</span><span style="color:#000">OUTPUT]</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Name          forward</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Match         *</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Host          logging-demo-fluentd.logging.svc</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Port          24240</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">tls           On</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">tls.verify    Off</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">tls.ca_file   /fluent-bit/tls/ca.crt</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">tls.crt_file  /fluent-bit/tls/tls.crt</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">tls.key_file  /fluent-bit/tls/tls.key</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Shared_Key    Kamk2_SukuWenk</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#000">Retry_Limit   False</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="debug-version-of-the-fluentbit-container">Debug version of the fluentbit container</h2><p>All Fluent Bit image tags have a debug version marked with the <code>-debug</code> suffix. You can install this debug version using the following command:
<code>kubectl edit loggings.logging.banzaicloud.io logging-demo</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">image</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">pullPolicy</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Always</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">repository</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluent/fluent-bit</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">tag</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1.3.2</span>-<span style="color:#000">debug</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>After deploying the debug version, you can kubectl exec into the pod using <code>sh</code> and look around. For example: <code>kubectl exec -it logging-demo-fluentbit-778zg sh</code></p><h2 id="check-the-queued-log-messages">Check the queued log messages</h2><p>You can check the buffer directory if Fluent Bit is configured to buffer queued log messages to disk instead of in memory. (You can configure it through the InputTail fluentbit config, by setting the <code>storage.type</code> field to <code>filesystem</code>.)</p><p><code>kubectl exec -it logging-demo-fluentbit-9dpzg ls /buffers</code></p><h2 id="getting-support">Getting Support</h2><p>If you encounter any problems that the documentation does not address, <a href="https://github.com/kube-logging/logging-operator/issues">file an issue</a> or talk to us on <a href="https://discord.gg/9ACY4RDsYN">Discord</a> or on the <a href="/5.1/docs/community/">CNCF Slack</a>.</p><p>Before asking for help, prepare the following information to make troubleshooting faster:</p><ul>
<li>Logging operator version</li><li>kubernetes version</li><li>helm/chart version (if you installed the Logging operator with helm)</li><li>Logging operator logs</li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#check-fluentd-configuration">fluentd configuration</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#get-fluentd-logs">fluentd logs</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentbit/#check-the-fluent-bit-configuration">fluentbit configuration</a></li><li>fluentbit logs</li></ul><p>Do not forget to remove any sensitive information (for example, passwords and private keys) before sharing.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-08d978e8b4bd5dff112fd9e079aaba48">7.1.2 - Troubleshooting Fluentd</h1><p align="center"><img src="/docs/img/fluentd.png" alt="Fluentd logo" height="100"></p><p>The following sections help you troubleshoot the Fluentd statefulset component of the Logging operator.</p><h2 id="check-fluentd-pod-status-statefulset">Check Fluentd pod status (statefulset)</h2><p>Verify that the Fluentd statefulset is available using the following command: <code>kubectl get statefulsets</code></p><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>NAME                   READY   AGE
</span></span><span style="display:flex"><span>logging-demo-fluentd   1/1     1m
</span></span></code></pre></div><h2 id="configcheck">ConfigCheck</h2><p>The Logging operator has a builtin mechanism that validates the generated fluentd configuration before applying it to fluentd. You should be able to see the configcheck pod and its log output. The result of the check is written into the <code>status</code> field of the corresponding <code>Logging</code> resource.</p><p>In case the operator is stuck in an error state caused by a failed configcheck, restore the previous configuration by modifying or removing the invalid resources to the point where the configcheck pod is finally able to complete successfully.</p><h2 id="check-fluentd-configuration">Check Fluentd configuration</h2><p>Use the following command to display the configuration of Fluentd:
<code>kubectl get secret logging-demo-fluentd-app -o jsonpath="{.data['fluentd\.conf']}" | base64 --decode</code></p><p>The output should be similar to the following:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;source&gt;</span>
</span></span><span style="display:flex"><span>  @type forward
</span></span><span style="display:flex"><span>  @id main_forward
</span></span><span style="display:flex"><span>  bind 0.0.0.0
</span></span><span style="display:flex"><span>  port 24240
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;transport</span> <span style="color:#a40000">tls</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>    ca_path /fluentd/tls/ca.crt
</span></span><span style="display:flex"><span>    cert_path /fluentd/tls/tls.crt
</span></span><span style="display:flex"><span>    client_cert_auth true
</span></span><span style="display:flex"><span>    private_key_path /fluentd/tls/tls.key
</span></span><span style="display:flex"><span>    version TLSv1_2
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/transport&gt;</span>
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;security&gt;</span>
</span></span><span style="display:flex"><span>    self_hostname fluentd
</span></span><span style="display:flex"><span>    shared_key Kamk2_SukuWenk
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/security&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/source&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;match</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>  @type label_router
</span></span><span style="display:flex"><span>  @id main_label_router
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;route&gt;</span>
</span></span><span style="display:flex"><span>    @label @427b3e18f3a3bc3f37643c54e9fc960b
</span></span><span style="display:flex"><span>    labels app.kubernetes.io/instance:logging-demo,app.kubernetes.io/name:log-generator
</span></span><span style="display:flex"><span>    namespace logging
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/route&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/match&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;label</span> <span style="color:#a40000">@427b3e18f3a3bc3f37643c54e9fc960b</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;match</span> <span style="color:#a40000">kubernetes.**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>    @type tag_normaliser
</span></span><span style="display:flex"><span>    @id logging-demo-flow_0_tag_normaliser
</span></span><span style="display:flex"><span>    format ${namespace_name}.${pod_name}.${container_name}
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/match&gt;</span>
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;filter</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>    @type parser
</span></span><span style="display:flex"><span>    @id logging-demo-flow_1_parser
</span></span><span style="display:flex"><span>    key_name log
</span></span><span style="display:flex"><span>    remove_key_name_field true
</span></span><span style="display:flex"><span>    reserve_data true
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;parse&gt;</span>
</span></span><span style="display:flex"><span>      @type nginx
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;/parse&gt;</span>
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/filter&gt;</span>
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;match</span> <span style="color:#a40000">**</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>    @type s3
</span></span><span style="display:flex"><span>    @id logging_logging-demo-flow_logging-demo-output-minio_s3
</span></span><span style="display:flex"><span>    aws_key_id WVKblQelkDTSKTn4aaef
</span></span><span style="display:flex"><span>    aws_sec_key LAmjIah4MTKTM3XGrDxuD2dTLLmysVHvZrtxpzK6
</span></span><span style="display:flex"><span>    force_path_style true
</span></span><span style="display:flex"><span>    path logs/${tag}/%Y/%m/%d/
</span></span><span style="display:flex"><span>    s3_bucket demo
</span></span><span style="display:flex"><span>    s3_endpoint http://logging-demo-minio.logging.svc.cluster.local:9000
</span></span><span style="display:flex"><span>    s3_region test_region
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;buffer</span> <span style="color:#a40000">tag,time</span><span style="color:#204a87;font-weight:700">&gt;</span>
</span></span><span style="display:flex"><span>      @type file
</span></span><span style="display:flex"><span>      path /buffers/logging_logging-demo-flow_logging-demo-output-minio_s3.*.buffer
</span></span><span style="display:flex"><span>      retry_forever true
</span></span><span style="display:flex"><span>      timekey 10s
</span></span><span style="display:flex"><span>      timekey_use_utc true
</span></span><span style="display:flex"><span>      timekey_wait 0s
</span></span><span style="display:flex"><span>    <span style="color:#204a87;font-weight:700">&lt;/buffer&gt;</span>
</span></span><span style="display:flex"><span>  <span style="color:#204a87;font-weight:700">&lt;/match&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#204a87;font-weight:700">&lt;/label&gt;</span>
</span></span></code></pre></div><h2 id="set-fluentd-log-level">Set Fluentd log Level</h2><p>Use the following command to change the log level of Fluentd.
<code>kubectl edit loggings.logging.banzaicloud.io logging-demo</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">logLevel</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">debug</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="get-fluentd-logs">Get Fluentd logs</h2><p>The following command displays the logs of the Fluentd container.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl logs -f logging-demo-fluentd-0 -c fluentd
</span></span></code></pre></div><blockquote>
<p>Fluentd logs were written to the container filesystem up until Logging operator version 4.3, which has been changed to stdout with 4.4.
See <a href="/5.1/docs/logging-infrastructure/fluentd/#fluentoutlogrotate">FluentOutLogrotate</a> why this was changed and how you can re-enable it if needed.</p></blockquote><blockquote>
<p>Tip: If the logs include the <code>error="can't create buffer file ...</code> error message, Fluentd can’t create the buffer file at the specified location. This can mean for example that the disk is full, the filesystem is read-only, or some other permission error. Check the buffer-related settings of your <a href="/5.1/docs/configuration/crds/v1beta1/fluentd_types/">Fluentd configuration</a>.</p></blockquote><h2 id="set-stdout-as-an-output">Set stdout as an output</h2><p>You can use an stdout filter at any point in the flow to dump the log messages to the stdout of the Fluentd container. For example:
<code>kubectl edit loggings.logging.banzaicloud.io logging-demo</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Flow</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">exchange</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">filters</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">stdout</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">localOutputRefs</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#000">exchange</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">selectors</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">application</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">exchange</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="check-the-buffer-path-in-the-fluentd-container">Check the buffer path in the fluentd container</h2><p><code>kubectl exec -it logging-demo-fluentd-0 ls /buffers</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>Defaulting container name to fluentd.
</span></span><span style="display:flex"><span>Use <span style="color:#4e9a06">&#39;kubectl describe pod/logging-demo-fluentd-0 -n logging&#39;</span> to see all of the containers in this pod.
</span></span><span style="display:flex"><span>logging_logging-demo-flow_logging-demo-output-minio_s3.b598f7eb0b2b34076b6da13a996ff2671.buffer
</span></span><span style="display:flex"><span>logging_logging-demo-flow_logging-demo-output-minio_s3.b598f7eb0b2b34076b6da13a996ff2671.buffer.meta
</span></span></code></pre></div><h2 id="getting-support">Getting Support</h2><p>If you encounter any problems that the documentation does not address, <a href="https://github.com/kube-logging/logging-operator/issues">file an issue</a> or talk to us on <a href="https://discord.gg/9ACY4RDsYN">Discord</a> or on the <a href="/5.1/docs/community/">CNCF Slack</a>.</p><p>Before asking for help, prepare the following information to make troubleshooting faster:</p><ul>
<li>Logging operator version</li><li>kubernetes version</li><li>helm/chart version (if you installed the Logging operator with helm)</li><li>Logging operator logs</li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#check-fluentd-configuration">fluentd configuration</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#get-fluentd-logs">fluentd logs</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentbit/#check-the-fluent-bit-configuration">fluentbit configuration</a></li><li>fluentbit logs</li></ul><p>Do not forget to remove any sensitive information (for example, passwords and private keys) before sharing.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-3f9ff6b76f6626e8e1fb3f91c1ad7b0f">7.1.3 - Troubleshooting syslog-ng</h1><p>The following sections help you troubleshoot the syslog-ng statefulset component of the Logging operator.</p><h2 id="check-syslog-ng-pod-status-statefulset">Check syslog-ng pod status (statefulset)</h2><p>Verify that the syslog-ng statefulset is available using the following command: <code>kubectl get statefulsets</code></p><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>NAME                   READY   AGE
</span></span><span style="display:flex"><span>logging-demo-syslog-ng   1/1     1m
</span></span></code></pre></div><h2 id="configcheck">ConfigCheck</h2><p>The Logging operator has a builtin mechanism that validates the generated syslog-ng configuration before applying it to syslog-ng. You should be able to see the configcheck pod and its log output. The result of the check is written into the <code>status</code> field of the corresponding <code>Logging</code> resource.</p><p>In case the operator is stuck in an error state caused by a failed configcheck, restore the previous configuration by modifying or removing the invalid resources to the point where the configcheck pod is finally able to complete successfully.</p><h2 id="check-syslog-ng-configuration">Check syslog-ng configuration</h2><p>Use the following command to display the configuration of syslog-ng:
<code>kubectl get secret logging-demo-syslogng-app -o jsonpath="{.data['syslog-ng\.conf']}" | base64 --decode</code></p><h2 id="getting-support">Getting Support</h2><p>If you encounter any problems that the documentation does not address, <a href="https://github.com/kube-logging/logging-operator/issues">file an issue</a> or talk to us on <a href="https://discord.gg/9ACY4RDsYN">Discord</a> or on the <a href="/5.1/docs/community/">CNCF Slack</a>.</p><p>Before asking for help, prepare the following information to make troubleshooting faster:</p><ul>
<li>Logging operator version</li><li>kubernetes version</li><li>helm/chart version (if you installed the Logging operator with helm)</li><li>Logging operator logs</li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#check-fluentd-configuration">fluentd configuration</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#get-fluentd-logs">fluentd logs</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentbit/#check-the-fluent-bit-configuration">fluentbit configuration</a></li><li>fluentbit logs</li></ul><p>Do not forget to remove any sensitive information (for example, passwords and private keys) before sharing.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-ff4769d67e22b03ee37bf3b31cd60c80">7.1.4 - Running on KinD</h1><p>Persistent Volumes do not respect the <code>fsGroup</code> value on Kind so disable using a PVC for fluentd:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example-on-kind</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">disablePvc</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="getting-support">Getting Support</h2><p>If you encounter any problems that the documentation does not address, <a href="https://github.com/kube-logging/logging-operator/issues">file an issue</a> or talk to us on <a href="https://discord.gg/9ACY4RDsYN">Discord</a> or on the <a href="/5.1/docs/community/">CNCF Slack</a>.</p><p>Before asking for help, prepare the following information to make troubleshooting faster:</p><ul>
<li>Logging operator version</li><li>kubernetes version</li><li>helm/chart version (if you installed the Logging operator with helm)</li><li>Logging operator logs</li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#check-fluentd-configuration">fluentd configuration</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentd/#get-fluentd-logs">fluentd logs</a></li><li><a href="/5.1/docs/operation/troubleshooting/fluentbit/#check-the-fluent-bit-configuration">fluentbit configuration</a></li><li>fluentbit logs</li></ul><p>Do not forget to remove any sensitive information (for example, passwords and private keys) before sharing.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-f43e816fa3bb01ec74b11406f7aa77ce">7.2 - Monitor your logging pipeline with Prometheus Operator</h1><p align="center"><img src="../../img/lo-pro.png" alt="Logos" width="340"></p><p align="center"><img src="../../img/monitor.png" alt="Architecture" width="900"></p><p>You can configure the Logging operator to expose metrics endpoints for Fluentd, Fluent Bit, and syslog-ng using ServiceMonitor resources. That way, a Prometheus operator running in the same cluster can automatically fetch your logging metrics.</p><h2 id="metrics-variables">Metrics Variables</h2><p>You can configure the following metrics-related options in the <strong>spec.fluentd.metrics</strong>, <strong>spec.syslogNG.metrics</strong>, and <strong>spec.fluentbit.metrics</strong> sections of your Logging resource.</p><table>
<thead>
<tr>
<th>Variable Name</th><th>Type</th><th>Required</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr>
<td>interval</td><td>string</td><td>No</td><td>&ldquo;15s&rdquo;</td><td>Scrape Interval</td></tr><tr>
<td>timeout</td><td>string</td><td>No</td><td>&ldquo;5s&rdquo;</td><td>Scrape Timeout</td></tr><tr>
<td>port</td><td>int</td><td>No</td><td>-</td><td>Metrics Port.</td></tr><tr>
<td>path</td><td>int</td><td>No</td><td>-</td><td>Metrics Path.</td></tr><tr>
<td>serviceMonitor</td><td>bool</td><td>No</td><td>false</td><td>Enable to create ServiceMonitor for Prometheus operator</td></tr><tr>
<td>prometheusAnnotations</td><td>bool</td><td>No</td><td>false</td><td>Add prometheus labels to fluent pods.</td></tr></tbody></table><p>For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">metrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">serviceMonitor</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">metrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">serviceMonitor</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogNG</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">metrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">serviceMonitor</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>For more details on installing the Prometheus operator and configuring and accessing metrics, see the following procedures.</p><h2 id="install-prometheus-operator-with-helm">Install Prometheus Operator with Helm</h2><ol>
<li>
<p>Create <code>logging</code> namespace</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl create namespace logging
</span></span></code></pre></div></li><li>
<p>Install Prometheus Operator</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span> helm upgrade --install --wait --create-namespace --namespace logging monitor prometheus-community/kube-prometheus-stack <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --set <span style="color:#4e9a06">&#34;grafana.dashboardProviders.dashboardproviders\\.yaml.apiVersion=1&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --set <span style="color:#4e9a06">&#34;grafana.dashboardProviders.dashboardproviders\\.yaml.providers[0].orgId=1&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --set <span style="color:#4e9a06">&#34;grafana.dashboardProviders.dashboardproviders\\.yaml.providers[0].type=file&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --set <span style="color:#4e9a06">&#34;grafana.dashboardProviders.dashboardproviders\\.yaml.providers[0].disableDeletion=false&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --set <span style="color:#4e9a06">&#34;grafana.dashboardProviders.dashboardproviders\\.yaml.providers[0].options.path=/var/lib/grafana/dashboards/default&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --set <span style="color:#4e9a06">&#34;grafana.dashboards.default.logging.gnetId=7752&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --set <span style="color:#4e9a06">&#34;grafana.dashboards.default.logging.revision=5&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --set <span style="color:#4e9a06">&#34;grafana.dashboards.default.logging.datasource=Prometheus&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex"><span><span style="color:#4e9a06"></span>    --set <span style="color:#4e9a06">&#34;prometheus.prometheusSpec.serviceMonitorSelectorNilUsesHelmValues=False&#34;</span>
</span></span></code></pre></div><blockquote>
<p><a href="https://github.com/coreos/prometheus-operator">Prometheus Operator Documentation</a>
The prometheus-operator install may take a few more minutes. <em><strong>Please be patient.</strong></em>
The logging-operator metrics function depends on the prometheus-operator&rsquo;s resources.
If those do not exist in the cluster it may cause the logging-operator&rsquo;s malfunction.</p></blockquote></li></ol><h2 id="install-logging-operator-with-helm">Install Logging Operator with Helm</h2><ol>
<li>
<p>Install the Logging operator into the <em>logging</em> namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging logging-operator oci://ghcr.io/kube-logging/helm-charts/logging-operator
</span></span></code></pre></div><p>Expected output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>Release <span style="color:#4e9a06">&#34;logging-operator&#34;</span> does not exist. Installing it now.
</span></span><span style="display:flex"><span>Pulled: ghcr.io/kube-logging/helm-charts/logging-operator:4.3.0
</span></span><span style="display:flex"><span>Digest: sha256:c2ece861f66a3a2cb9788e7ca39a267898bb5629dc98429daa8f88d7acf76840
</span></span><span style="display:flex"><span>NAME: logging-operator
</span></span><span style="display:flex"><span>LAST DEPLOYED: Wed Aug  <span style="color:#0000cf;font-weight:700">9</span> 11:02:12 <span style="color:#0000cf;font-weight:700">2023</span>
</span></span><span style="display:flex"><span>NAMESPACE: logging
</span></span><span style="display:flex"><span>STATUS: deployed
</span></span><span style="display:flex"><span>REVISION: <span style="color:#0000cf;font-weight:700">1</span>
</span></span><span style="display:flex"><span>TEST SUITE: None
</span></span></code></pre></div><blockquote>
<p>Note:</p><ul>
<li>
<p>Helm has a known issue in version 3.13.0 that requires users to log in to the registry, even though the repo is public.</p><p>Upgrade to 3.13.1 or higher to avoid having to log in, see: <a href="https://github.com/kube-logging/logging-operator/issues/1522">https://github.com/kube-logging/logging-operator/issues/1522</a></p></li><li>
<p>If you&rsquo;re installing the Helm chart from Terraform, reference the repository as <code>repository = "oci://ghcr.io/kube-logging/helm-charts/"</code> (without the <code>logging-operator</code> suffix). Otherwise, you&rsquo;ll get a <a href="https://github.com/hashicorp/terraform-provider-helm/issues/1291">403 Forbidden error</a>.</p></li></ul></blockquote></li></ol><h2 id="install-minio">Install Minio</h2><ol>
<li>
<p>Create Minio Credential Secret</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging create secret generic logging-s3 --from-literal<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#000">accesskey</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;AKIAIOSFODNN7EXAMPLE&#39;</span> --from-literal<span style="color:#ce5c00;font-weight:700">=</span><span style="color:#000">secretkey</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#39;wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY&#39;</span>
</span></span></code></pre></div></li><li>
<p>Deploy Minio</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: apps/v1
</span></span><span style="display:flex"><span>kind: Deployment
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: minio-deployment
</span></span><span style="display:flex"><span>  namespace: logging
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  selector:
</span></span><span style="display:flex"><span>    matchLabels:
</span></span><span style="display:flex"><span>      app: minio
</span></span><span style="display:flex"><span>  strategy:
</span></span><span style="display:flex"><span>    type: Recreate
</span></span><span style="display:flex"><span>  template:
</span></span><span style="display:flex"><span>    metadata:
</span></span><span style="display:flex"><span>      labels:
</span></span><span style="display:flex"><span>        app: minio
</span></span><span style="display:flex"><span>    spec:
</span></span><span style="display:flex"><span>      containers:
</span></span><span style="display:flex"><span>      - name: minio
</span></span><span style="display:flex"><span>        image: minio/minio
</span></span><span style="display:flex"><span>        args:
</span></span><span style="display:flex"><span>        - server
</span></span><span style="display:flex"><span>        - /data
</span></span><span style="display:flex"><span>        - <span style="color:#4e9a06">&#34;--console-address=:9001&#34;</span>
</span></span><span style="display:flex"><span>        readinessProbe:
</span></span><span style="display:flex"><span>          httpGet:
</span></span><span style="display:flex"><span>            path: /minio/health/ready
</span></span><span style="display:flex"><span>            port: <span style="color:#0000cf;font-weight:700">9000</span>
</span></span><span style="display:flex"><span>          initialDelaySeconds: <span style="color:#0000cf;font-weight:700">10</span>
</span></span><span style="display:flex"><span>          periodSeconds: <span style="color:#0000cf;font-weight:700">5</span>
</span></span><span style="display:flex"><span>        env:
</span></span><span style="display:flex"><span>        - name: MINIO_REGION
</span></span><span style="display:flex"><span>          value: <span style="color:#4e9a06">&#39;test_region&#39;</span>
</span></span><span style="display:flex"><span>        - name: MINIO_ROOT_USER
</span></span><span style="display:flex"><span>          valueFrom:
</span></span><span style="display:flex"><span>            secretKeyRef:
</span></span><span style="display:flex"><span>              name: logging-s3
</span></span><span style="display:flex"><span>              key: accesskey
</span></span><span style="display:flex"><span>        - name: MINIO_ROOT_PASSWORD
</span></span><span style="display:flex"><span>          valueFrom:
</span></span><span style="display:flex"><span>            secretKeyRef:
</span></span><span style="display:flex"><span>              name: logging-s3
</span></span><span style="display:flex"><span>              key: secretkey
</span></span><span style="display:flex"><span>        - name: MINIO_BROWSER_LOGIN_ANIMATION
</span></span><span style="display:flex"><span>          value: <span style="color:#4e9a06">&#34;off&#34;</span>
</span></span><span style="display:flex"><span>        ports:
</span></span><span style="display:flex"><span>        - containerPort: <span style="color:#0000cf;font-weight:700">9000</span>
</span></span><span style="display:flex"><span>        - containerPort: <span style="color:#0000cf;font-weight:700">9001</span>
</span></span><span style="display:flex"><span>      volumes:
</span></span><span style="display:flex"><span>        - name: logging-s3
</span></span><span style="display:flex"><span>          secret:
</span></span><span style="display:flex"><span>            secretName: logging-s3
</span></span><span style="display:flex"><span>---
</span></span><span style="display:flex"><span>kind: Service
</span></span><span style="display:flex"><span>apiVersion: v1
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: nginx-demo-minio
</span></span><span style="display:flex"><span>  namespace: logging
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  selector:
</span></span><span style="display:flex"><span>    app: minio
</span></span><span style="display:flex"><span>  ports:
</span></span><span style="display:flex"><span>  - name: http
</span></span><span style="display:flex"><span>    protocol: TCP
</span></span><span style="display:flex"><span>    port: <span style="color:#0000cf;font-weight:700">9000</span>
</span></span><span style="display:flex"><span>    targetPort: <span style="color:#0000cf;font-weight:700">9000</span>
</span></span><span style="display:flex"><span>  - name: console
</span></span><span style="display:flex"><span>    protocol: TCP
</span></span><span style="display:flex"><span>    port: <span style="color:#0000cf;font-weight:700">9001</span>
</span></span><span style="display:flex"><span>    targetPort: <span style="color:#0000cf;font-weight:700">9001</span>
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div></li><li>
<p>Create <code>logging</code> resource</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Logging
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: default-logging-simple
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  fluentd:
</span></span><span style="display:flex"><span>    metrics:
</span></span><span style="display:flex"><span>      serviceMonitor: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>  fluentbit:
</span></span><span style="display:flex"><span>    metrics:
</span></span><span style="display:flex"><span>      serviceMonitor: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>  controlNamespace: logging
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: <code>ClusterOutput</code> and <code>ClusterFlow</code> resource will only be accepted in the <code>controlNamespace</code></p></blockquote></li><li>
<p>Create Minio output definition</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Output
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: demo-output
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  s3:
</span></span><span style="display:flex"><span>    aws_key_id:
</span></span><span style="display:flex"><span>      valueFrom:
</span></span><span style="display:flex"><span>        secretKeyRef:
</span></span><span style="display:flex"><span>          key: accesskey
</span></span><span style="display:flex"><span>          name: logging-s3
</span></span><span style="display:flex"><span>    aws_sec_key:
</span></span><span style="display:flex"><span>      valueFrom:
</span></span><span style="display:flex"><span>        secretKeyRef:
</span></span><span style="display:flex"><span>          key: secretkey
</span></span><span style="display:flex"><span>          name: logging-s3
</span></span><span style="display:flex"><span>    buffer:
</span></span><span style="display:flex"><span>      timekey: 10s
</span></span><span style="display:flex"><span>      timekey_use_utc: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>      timekey_wait: 0s
</span></span><span style="display:flex"><span>    force_path_style: <span style="color:#4e9a06">&#34;true&#34;</span>
</span></span><span style="display:flex"><span>    path: logs/<span style="color:#4e9a06">${</span><span style="color:#000">tag</span><span style="color:#4e9a06">}</span>/%Y/%m/%d/
</span></span><span style="display:flex"><span>    s3_bucket: demo
</span></span><span style="display:flex"><span>    s3_endpoint: http://nginx-demo-minio.logging.svc.cluster.local:9000
</span></span><span style="display:flex"><span>    s3_region: test_region
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div><blockquote>
<p>Note: For production set-up we recommend using longer <code>timekey</code> interval to avoid generating too many object.</p></blockquote></li><li>
<p>Create <code>flow</code> resource</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging apply -f - &lt;&lt;<span style="color:#4e9a06">&#34;EOF&#34;</span>
</span></span><span style="display:flex"><span>apiVersion: logging.banzaicloud.io/v1beta1
</span></span><span style="display:flex"><span>kind: Flow
</span></span><span style="display:flex"><span>metadata:
</span></span><span style="display:flex"><span>  name: demo-flow
</span></span><span style="display:flex"><span>spec:
</span></span><span style="display:flex"><span>  filters:
</span></span><span style="display:flex"><span>    - tag_normaliser: <span style="color:#ce5c00;font-weight:700">{}</span>
</span></span><span style="display:flex"><span>    - parser:
</span></span><span style="display:flex"><span>        remove_key_name_field: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>        reserve_data: <span style="color:#204a87">true</span>
</span></span><span style="display:flex"><span>        parse:
</span></span><span style="display:flex"><span>          type: nginx
</span></span><span style="display:flex"><span>  match:
</span></span><span style="display:flex"><span>    - <span style="color:#204a87;font-weight:700">select</span>:
</span></span><span style="display:flex"><span>        labels:
</span></span><span style="display:flex"><span>          app.kubernetes.io/instance: log-generator
</span></span><span style="display:flex"><span>          app.kubernetes.io/name: log-generator
</span></span><span style="display:flex"><span>  localOutputRefs:
</span></span><span style="display:flex"><span>    - demo-output
</span></span><span style="display:flex"><span>EOF
</span></span></code></pre></div></li><li>
<p>Install log-generator to produce logs with the label <code>app.kubernetes.io/name: log-generator</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>helm upgrade --install --wait --create-namespace --namespace logging log-generator oci://ghcr.io/kube-logging/helm-charts/log-generator
</span></span></code></pre></div></li></ol><h2 id="validation">Validation</h2><h3 id="minio">Minio</h3><ol>
<li>
<p>Get Minio login credentials</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging get secrets logging-s3 -o json <span style="color:#000;font-weight:700">|</span> jq <span style="color:#4e9a06">&#39;.data | map_values(@base64d)&#39;</span>
</span></span></code></pre></div></li><li>
<p>Forward Service</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging port-forward svc/nginx-demo-minio 9001:9001
</span></span></code></pre></div></li><li>
<p>Open the <a href="http://localhost:9001">Minio Dashboard: http://localhost:9001</a></p><p align="center"><img src="../../img/servicemonitor_minio.png" alt="Minio dashboard"></p></li></ol><h3 id="prometheus">Prometheus</h3><ol>
<li>
<p>Forward Service</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging port-forward svc/monitor-kube-prometheus-st-prometheus <span style="color:#0000cf;font-weight:700">9090</span>
</span></span></code></pre></div></li><li>
<p>Open the <a href="http://localhost:9090">Prometheus Dashboard: http://localhost:9090</a></p><p align="center"><img src="../../img/servicemonitor_prometheus.png" alt="Prometheus dashboard"></p></li></ol><h3 id="grafana">Grafana</h3><ol>
<li>
<p>Get Grafana login credentials</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl get secret --namespace logging monitor-grafana -o <span style="color:#000">jsonpath</span><span style="color:#ce5c00;font-weight:700">=</span><span style="color:#4e9a06">&#34;{.data.admin-password}&#34;</span> <span style="color:#000;font-weight:700">|</span> base64 --decode <span style="color:#000;font-weight:700">;</span> <span style="color:#204a87">echo</span>
</span></span></code></pre></div><blockquote>
<p>Default username: <code>admin</code></p></blockquote></li><li>
<p>Forward Service</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl -n logging port-forward svc/monitor-grafana 3000:80
</span></span></code></pre></div></li><li>
<p>Open <a href="http://localhost:3000">Grafana Dashboard: http://localhost:3000</a></p><p align="center"><img src="../../img/servicemonitor_grafana.png" alt="Grafana dashboard"></p></li></ol></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-362f849752620b4cf0d070e2fc884699">7.3 - Alerting</h1><p>This section describes how to set alerts for your logging infrastructure. Alternatively, you can enable the default alerting rules that are provided by the Logging operator.</p><blockquote>
<p>Note: Alerting based on the contents of the collected log messages is not covered here.</p></blockquote><h2 id="prerequisites">Prerequisites</h2><p>Using alerting rules requires the following:</p><ul>
<li>Logging operator 3.14.0 or newer installed on the cluster.</li><li>Prometheus operator installed on the cluster. For details, see <a href="/5.1/docs/operation/logging-operator-monitoring/">Monitor your logging pipeline with Prometheus Operator</a>.</li><li>
<p>syslog-ng is supported only in Logging operator 4.0 or newer.</p></li></ul><h2 id="enable-default-alerts">Enable the default alerting rules</h2><p>Logging operator comes with a number of default alerting rules that help you monitor your logging environment and ensure that it&rsquo;s working properly. To enable the default rules, complete the following steps.</p><ol>
<li>
<p>Verify that your cluster meets the <a href="#prerequisites">Prerequisites</a>.</p></li><li>
<p>Enable the alerting rules in your <strong>logging</strong> CR. You can enable alerting separately for Fluentd, syslog-ng, and Fluent Bit. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging-simple</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">metrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">prometheusRules</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">metrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">prometheusRules</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogNG</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">metrics</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">prometheusRules</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>If needed you can <a href="#custom-alerting-rules">add custom alerting rules</a>.</p></li></ol><h2 id="overview-of-default-alerting-rules">Overview of default alerting rules</h2><p>The default alerting rules trigger alerts when:</p><p>For the <strong>Fluent Bit</strong> log collector:</p><ul>
<li>The number of Fluent Bit errors or retries is high</li></ul><p>For the <strong>Fluentd</strong> and <strong>syslog-ng</strong> log forwarders:</p><ul>
<li>Prometheus cannot access the log forwarder node</li><li>The buffers of the log forwarder are filling up quickly</li><li>Traffic to the log forwarder is increasing at a high rate</li><li>The number of errors or retries is high on the log forwarder</li><li>The buffers are over 90% full</li></ul><p>Currently, you cannot modify the default alerting rules, because they are generated from the source files. For the detailed list of alerts, see the source code:</p><ul>
<li>For <a href="https://github.com/kube-logging/logging-operator/blob/master/pkg/resources/fluentd/prometheusrules.go">Fluentd</a></li><li>For <a href="https://github.com/kube-logging/logging-operator/blob/master/pkg/resources/syslogng/prometheusrules.go">syslog-ng</a></li><li>For <a href="https://github.com/kube-logging/logging-operator/blob/master/pkg/resources/fluentbit/prometheusrules.go">Fluent Bit</a></li></ul><p>To enable these alerts on your cluster, see <a href="#enable-default-alerts">Enable the default alerting rules</a>.</p><h2 id="custom-alerting-rules">Add custom alerting rules</h2><p>Although you cannot modify the default alerting rules, you can add your own custom rules to the cluster by creating and applying <a href="https://github.com/prometheus-operator/prometheus-operator/blob/master/Documentation/user-guides/alerting.md">AlertmanagerConfig resources to the Prometheus Operator</a>.</p><p>For example, the Logging operator creates the following alerting rule to detect if a Fluentd node is down:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">monitoring.coreos.com/v1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">PrometheusRule</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-demo-fluentd-metrics</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">groups</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">rules</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:700">alert</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">FluentdNodeDown</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">annotations</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">description</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Prometheus could not scrape {{ &#34;{{ $labels.job }}&#34; }} for more</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#000">than 30 minutes</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">summary</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluentd cannot be scraped</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">expr</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">up{job=&#34;logging-demo-fluentd-metrics&#34;, namespace=&#34;logging&#34;} == 0</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">for</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">10m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">labels</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">service</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">fluentd</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">severity</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">critical</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>On the Prometheus web interface, this rule looks like:</p><p><img src="alerting-rule-in-prometheus.png" alt="Fluentd alerting rule on the Prometheus web interface"></p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-e1b978ea58e795d55d2b6d7ad7aabb23">7.4 - Readiness probe</h1><p>This section describes how to configure readiness probes for your Fluentd and syslog-ng pods. If you don&rsquo;t configure custom readiness probes, Logging operator uses the default probes.</p><h2 id="prerequisites">Prerequisites</h2><ul>
<li>Configuring readiness probes requires Logging operator 3.14.0 or newer installed on the cluster.</li><li>
<p>syslog-ng is supported only in Logging operator 4.0 or newer.</p></li></ul><h2 id="overview-of-default-readiness-probes">Overview of default readiness probes</h2><p>By default, Logging operator performs the following readiness checks:</p><ul>
<li>Number of buffer files is too high (higher than 5000)</li><li>Fluentd buffers are over 90% full</li><li>syslog-ng buffers are over 90% full</li></ul><p>The parameters of the readiness probes and pod failure is set by using the usual <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#configure-probes">Kubernetes probe configuration parameters</a>. Instead of the Kubernetes defaults, the Logging operator uses the following values for these parameters:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">InitialDelaySeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">TimeoutSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">PeriodSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">30</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">SuccessThreshold</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">FailureThreshold</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>Currently, you cannot modify the default readiness probes, because they are generated from the source files. For the detailed list of readiness probes, see the <a href="#default-readiness-probes">Default readiness probes</a>. However, you can customize their values in the Logging custom resource, separately for the Fluentd and syslog-ng log forwarder. For example:</p><h3 id="fluentd-readiness-probe-settings">Fluentd readiness probe settings</h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-demo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">readinessDefaultCheck</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">bufferFileNumber</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">bufferFileNumberMax</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">5000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">bufferFreeSpace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">bufferFreeSpaceThreshold</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">90</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">failureThreshold</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">initialDelaySeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">periodSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">30</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">successThreshold</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timeoutSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h3 id="syslogng-readiness-probe-settings">SyslogNG readiness probe settings</h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging-demo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogNG</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">readinessDefaultCheck</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">bufferFileNumber</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">bufferFileNumberMax</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">5000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">bufferFreeSpace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">bufferFreeSpaceThreshold</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">90</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">failureThreshold</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">initialDelaySeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">periodSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">30</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">successThreshold</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timeoutSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="default-readiness-probes">Default readiness probes</h2><p>The Logging operator applies the following readiness probe by default:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">readinessProbe</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">exec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">command</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">/bin/sh</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- -<span style="color:#000">c</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">FREESPACE_THRESHOLD=90</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">FREESPACE_CURRENT=$(df -h $BUFFER_PATH  | grep / | awk &#39;{ print $5}&#39; | sed</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">          </span><span style="color:#4e9a06">&#39;s/%//g&#39;</span><span style="color:#000">)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">if [ &#34;$FREESPACE_CURRENT&#34; -gt &#34;$FREESPACE_THRESHOLD&#34; ] ; then exit 1; fi</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">MAX_FILE_NUMBER=5000</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">FILE_NUMBER_CURRENT=$(find $BUFFER_PATH -type f -name *.buffer | wc -l)</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#000">if [ &#34;$FILE_NUMBER_CURRENT&#34; -gt &#34;$MAX_FILE_NUMBER&#34; ] ; then exit 1; fi</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">failureThreshold</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">initialDelaySeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">5</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">periodSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">30</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">successThreshold</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">timeoutSeconds</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">3</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><h2 id="custom-readiness-probes">Add custom readiness probes</h2><p>You can add your own custom readiness probes to the <strong>spec.ReadinessProbe</strong> section of the <strong>logging</strong> custom resource. For details on the format of readiness probes, see the <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#define-readiness-probes">official Kubernetes documentation</a>.</p><div class="warning-block">
<p><strong>CAUTION:</strong></p>If you set any custom readiness probes, they completely override the default probes.
</div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-791b523329c1485057fb827f9ed4b80b">7.5 - Collect Fluentd errors</h1><p>This section describes how to collect Fluentd error messages (messages that are sent to the <a href="https://docs.fluentd.org/configuration/config-file#error-label">@ERROR label</a> from another plugin in Fluentd).</p><blockquote>
<p>Note: It depends on the specific plugin implementation what messages are sent to the @ERROR label. For example, a parsing plugin that fails to parse a line could send that line to the @ERROR label.</p></blockquote><h2 id="prerequisites">Prerequisites</h2><p>Configuring readiness probes requires Logging operator 3.14.0 or newer installed on the cluster.</p><h2 id="configure-error-output">Configure error output</h2><p>To collect the error messages of Fluentd, complete the following steps.</p><ol>
<li>
<p>Create a ClusterOutput that receives logs from every logging flow where error happens. For example, create a file output. For details on creating outputs, see <a href="/5.1/docs/configuration/output/">Output and ClusterOutput</a>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ClusterOutput</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">error-file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">file</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/tmp/error.log</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>Set the <code>errorOutputRef</code> in the Logging resource to your preferred ClusterOutput.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">example</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">controlNamespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">enableRecreateWorkloadOnImmutableFieldChange</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:700">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">errorOutputRef</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">error-file</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">bufferStorage</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">bufferStorageVolume</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">hostPath</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">path</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">filterKubernetes</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span>{}<span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#8f5902;font-style:italic"># rest of the resource is omitted</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div><p>You cannot apply filters for this specific error flow.</p></li><li>
<p>Apply the ClusterOutput and Logging to your cluster.</p></li></ol></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-5ac19d15e22096d860ccfc7422b529f9">7.6 - Optimization</h1><h2 id="watch-specific-resources">Watch specific resources</h2><p>The Logging operator watches resources in all namespaces, which is required because it manages cluster-scoped objects, and also objects in multiple namespaces.</p><p>However, in a large-scale infrastructure, where the number of resources is large, it makes sense to limit the scope of resources monitored by the Logging operator to save considerable amount of memory and container restarts.</p><p>Starting with Logging operator version 3.12.0, this is now available by passing the following command-line arguments to the operator.</p><ul>
<li><code>watch-namespace</code>: Watch only objects in this namespace. Note that even if the <code>watch-namespace</code> option is set, the operator must watch certain objects (like <code>Flows</code> and <code>Outputs</code>) in every namespace.</li><li><code>watch-logging-name</code>: Logging resource name to optionally filter the list of watched objects based on which logging they belong to by checking the <code>app.kubernetes.io/managed-by</code> label.</li></ul></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-af5ba8326f5b4c35d5dc6de4337c19b0">7.7 - Scaling</h1><blockquote>
<p>Note: When multiple instances send logs to the same output, the output can receive chunks of messages out of order. Some outputs tolerate this (for example, Elasticsearch), some do not, some require fine tuning (for example, Loki).</p></blockquote><h2 id="scaling-fluentd">Scaling Fluentd</h2><p>In a large-scale infrastructure the logging components can get high load as well. The typical sign of this is when <code>fluentd</code> cannot handle its <a href="../../configuration/plugins/outputs/buffer/">buffer</a> directory size growth for more than the configured or calculated (timekey + timekey_wait) flush interval. In this case, you can <a href="/5.1/docs/logging-infrastructure/fluentd/#scaling">scale the fluentd statefulset</a>.</p><p>The Logging Operator supports scaling a <strong>Fluentd aggregator</strong> statefulset up and down. Scaling statefulset pods down is challenging, because we need to take care of the underlying volumes with buffered data that hasn&rsquo;t been sent, but the Logging Operator supports that use case as well.</p><p>The details for that and how to configure an HPA is described in the following documents:</p><ul>
<li><a href="https://github.com/kube-logging/logging-operator/blob/master/docs/volume-drainer.md">https://github.com/kube-logging/logging-operator/blob/master/docs/volume-drainer.md</a></li><li><a href="https://github.com/kube-logging/logging-operator/blob/master/docs/scaling.md">https://github.com/kube-logging/logging-operator/blob/master/docs/scaling.md</a></li></ul><h2 id="scaling-syslogng">Scaling SyslogNG</h2><p>SyslogNG can be scaled up as well, but persistent disk buffers are not processed automatically when scaling the statefulset down. That is currently a manual process.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-2ea22a017fd9fef2575c36200cd7f9b8">7.8 - CPU and memory requirements</h1><p>The resource requirements and limits of your Logging operator deployment must match the size of your cluster and the logging workloads. By default, the Logging operator uses the following configuration.</p><ul>
<li>
<p>For <strong>Fluent Bit</strong>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span>- <span style="color:#204a87;font-weight:700">Limits</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">cpu</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">200m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">memory</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">100M</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:700">Requests</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">cpu</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">100m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">memory</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">50M</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li><li>
<p>For <strong>Fluentd</strong> and <strong>syslog-ng</strong>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span>- <span style="color:#204a87;font-weight:700">Limits</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">cpu</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1000m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">memory</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">400M</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:700">Requests</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">cpu</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">500m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span>- <span style="color:#204a87;font-weight:700">memory</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">100M</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></li></ul><p>You can adjust these values in the Logging custom resource, for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">apiVersion</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging.banzaicloud.io/v1beta1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">kind</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">metadata</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">name</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default-logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">namespace</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">logging</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:700">spec</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentd</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">resources</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">requests</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">cpu</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">memory</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1Gi</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">limits</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">cpu</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">2</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">memory</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">2Gi</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">fluentbit</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">resources</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">requests</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">cpu</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">500m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">memory</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">500M</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">limits</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">cpu</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">memory</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1Gi</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:700">syslogNG</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:700">resources</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">requests</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">cpu</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">500m</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">memory</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">500M</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:700">limits</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">cpu</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:700">1</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span><span style="display:flex"><span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:700">memory</span><span style="color:#000;font-weight:700">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">1Gi</span><span style="color:#f8f8f8;text-decoration:underline">
</span></span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-58416e0a7f68f24b8e7d9b1834b3036f">8 - Images used by Logging operator</h1><p>Logging operator uses the following image versions.</p><h2 id="logging-operator-version-51">Logging operator version 5.1</h2><table>
<thead>
<tr>
<th>Image repository</th><th>GitHub repository</th><th>Version</th></tr></thead><tbody>
<tr>
<td>ghcr.io/kube-logging/node-exporter</td><td><a href="https://github.com/kube-logging/node-exporter-image">https://github.com/kube-logging/node-exporter-image</a></td><td>v0.9.0</td></tr><tr>
<td>ghcr.io/kube-logging/config-reloader</td><td><a href="https://github.com/kube-logging/config-reloader">https://github.com/kube-logging/config-reloader</a></td><td>v0.0.7</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd-drain-watch</td><td><a href="https://github.com/kube-logging/fluentd-drain-watch">https://github.com/kube-logging/fluentd-drain-watch</a></td><td>v0.2.4</td></tr><tr>
<td>k8s.gcr.io/pause</td><td></td><td>3.9</td></tr><tr>
<td>docker.io/busybox</td><td><a href="https://github.com/docker-library/busybox">https://github.com/docker-library/busybox</a></td><td>latest</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog</td><td><a href="https://github.com/axoflow/axosyslog/">https://github.com/axoflow/axosyslog/</a></td><td>4.9.0</td></tr><tr>
<td>docker.io/fluent/fluent-bit</td><td><a href="https://github.com/fluent/fluent-bit">https://github.com/fluent/fluent-bit</a></td><td>3.2.5</td></tr><tr>
<td>ghcr.io/kube-logging/logging-operator/fluentd</td><td>ghcr.io/kube-logging/logging-operator/fluentd</td><td>5.1.1-full</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog-metrics-exporter</td><td><a href="https://github.com/axoflow/axosyslog-metrics-exporter">https://github.com/axoflow/axosyslog-metrics-exporter</a></td><td>0.0.9</td></tr><tr>
<td>ghcr.io/kube-logging/syslogng-reload</td><td><a href="https://github.com/kube-logging/syslogng-reload-image">https://github.com/kube-logging/syslogng-reload-image</a></td><td>v1.6.0</td></tr><tr>
<td>ghcr.io/kube-logging/eventrouter</td><td><a href="https://github.com/kube-logging/eventrouter">https://github.com/kube-logging/eventrouter</a></td><td>0.4.0</td></tr></tbody></table><h2 id="logging-operator-version-50">Logging operator version 5.0</h2><table>
<thead>
<tr>
<th>Image repository</th><th>GitHub repository</th><th>Version</th></tr></thead><tbody>
<tr>
<td>ghcr.io/kube-logging/node-exporter</td><td><a href="https://github.com/kube-logging/node-exporter-image">https://github.com/kube-logging/node-exporter-image</a></td><td>v0.8.0</td></tr><tr>
<td>ghcr.io/kube-logging/config-reloader</td><td><a href="https://github.com/kube-logging/config-reloader">https://github.com/kube-logging/config-reloader</a></td><td>v0.0.6</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd-drain-watch</td><td><a href="https://github.com/kube-logging/fluentd-drain-watch">https://github.com/kube-logging/fluentd-drain-watch</a></td><td>v0.2.3</td></tr><tr>
<td>k8s.gcr.io/pause</td><td></td><td>3.2</td></tr><tr>
<td>docker.io/busybox</td><td><a href="https://github.com/docker-library/busybox">https://github.com/docker-library/busybox</a></td><td>latest</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog</td><td><a href="https://github.com/axoflow/axosyslog/">https://github.com/axoflow/axosyslog/</a></td><td>4.9.0</td></tr><tr>
<td>docker.io/fluent/fluent-bit</td><td><a href="https://github.com/fluent/fluent-bit">https://github.com/fluent/fluent-bit</a></td><td>3.1.8</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd <br> (Moving tag with security updates. If you need a non-moving tag, use <code>ghcr.io/kube-logging/fluentd:v1.17-5.0-full-build.173</code> in your <code>Logging</code> or <code>FluentdConfig</code> resources.)</td><td><a href="https://github.com/kube-logging/fluentd-images">https://github.com/kube-logging/fluentd-images</a></td><td>v1.17-5.0-full</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog-metrics-exporter</td><td><a href="https://github.com/axoflow/axosyslog-metrics-exporter">https://github.com/axoflow/axosyslog-metrics-exporter</a></td><td>0.0.7</td></tr><tr>
<td>ghcr.io/kube-logging/syslogng-reload</td><td><a href="https://github.com/kube-logging/syslogng-reload-image">https://github.com/kube-logging/syslogng-reload-image</a></td><td>v1.5.0</td></tr><tr>
<td>ghcr.io/kube-logging/eventrouter</td><td><a href="https://github.com/kube-logging/eventrouter">https://github.com/kube-logging/eventrouter</a></td><td>0.4.0</td></tr></tbody></table><h2 id="logging-operator-version-411">Logging operator version 4.11</h2><table>
<thead>
<tr>
<th>Image repository</th><th>GitHub repository</th><th>Version</th></tr></thead><tbody>
<tr>
<td>ghcr.io/kube-logging/node-exporter</td><td><a href="https://github.com/kube-logging/node-exporter-image">https://github.com/kube-logging/node-exporter-image</a></td><td>v0.8.0</td></tr><tr>
<td>ghcr.io/kube-logging/config-reloader</td><td><a href="https://github.com/kube-logging/config-reloader">https://github.com/kube-logging/config-reloader</a></td><td>v0.0.6</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd-drain-watch</td><td><a href="https://github.com/kube-logging/fluentd-drain-watch">https://github.com/kube-logging/fluentd-drain-watch</a></td><td>v0.2.3</td></tr><tr>
<td>k8s.gcr.io/pause</td><td></td><td>3.2</td></tr><tr>
<td>docker.io/busybox</td><td><a href="https://github.com/docker-library/busybox">https://github.com/docker-library/busybox</a></td><td>latest</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog</td><td><a href="https://github.com/axoflow/axosyslog/">https://github.com/axoflow/axosyslog/</a></td><td>4.9.0</td></tr><tr>
<td>docker.io/fluent/fluent-bit</td><td><a href="https://github.com/fluent/fluent-bit">https://github.com/fluent/fluent-bit</a></td><td>3.1.8</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd</td><td><a href="https://github.com/kube-logging/fluentd-images">https://github.com/kube-logging/fluentd-images</a></td><td>v1.16-4.11-full</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog-metrics-exporter</td><td><a href="https://github.com/axoflow/axosyslog-metrics-exporter">https://github.com/axoflow/axosyslog-metrics-exporter</a></td><td>0.0.7</td></tr><tr>
<td>ghcr.io/kube-logging/syslogng-reload</td><td><a href="https://github.com/kube-logging/syslogng-reload-image">https://github.com/kube-logging/syslogng-reload-image</a></td><td>v1.5.0</td></tr><tr>
<td>ghcr.io/kube-logging/eventrouter</td><td><a href="https://github.com/kube-logging/eventrouter">https://github.com/kube-logging/eventrouter</a></td><td>0.4.0</td></tr></tbody></table><h2 id="logging-operator-version-410">Logging operator version 4.10</h2><table>
<thead>
<tr>
<th>Image repository</th><th>GitHub repository</th><th>Version</th></tr></thead><tbody>
<tr>
<td>ghcr.io/kube-logging/node-exporter</td><td><a href="https://github.com/kube-logging/node-exporter-image">https://github.com/kube-logging/node-exporter-image</a></td><td>v0.8.0</td></tr><tr>
<td>ghcr.io/kube-logging/config-reloader</td><td><a href="https://github.com/kube-logging/config-reloader">https://github.com/kube-logging/config-reloader</a></td><td>v0.0.6</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd-drain-watch</td><td><a href="https://github.com/kube-logging/fluentd-drain-watch">https://github.com/kube-logging/fluentd-drain-watch</a></td><td>v0.2.3</td></tr><tr>
<td>k8s.gcr.io/pause</td><td></td><td>3.2</td></tr><tr>
<td>docker.io/busybox</td><td><a href="https://github.com/docker-library/busybox">https://github.com/docker-library/busybox</a></td><td>latest</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog</td><td><a href="https://github.com/axoflow/axosyslog/">https://github.com/axoflow/axosyslog/</a></td><td>4.8.1-1</td></tr><tr>
<td>docker.io/fluent/fluent-bit</td><td><a href="https://github.com/fluent/fluent-bit">https://github.com/fluent/fluent-bit</a></td><td>3.1.8</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd</td><td><a href="https://github.com/kube-logging/fluentd-images">https://github.com/kube-logging/fluentd-images</a></td><td>v1.16-4.10-full</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog-metrics-exporter</td><td><a href="https://github.com/axoflow/axosyslog-metrics-exporter">https://github.com/axoflow/axosyslog-metrics-exporter</a></td><td>0.0.7</td></tr><tr>
<td>ghcr.io/kube-logging/syslogng-reload</td><td><a href="https://github.com/kube-logging/syslogng-reload-image">https://github.com/kube-logging/syslogng-reload-image</a></td><td>v1.5.0</td></tr><tr>
<td>ghcr.io/kube-logging/eventrouter</td><td><a href="https://github.com/kube-logging/eventrouter">https://github.com/kube-logging/eventrouter</a></td><td>0.4.0</td></tr></tbody></table><h2 id="logging-operator-version-49">Logging operator version 4.9</h2><table>
<thead>
<tr>
<th>Image repository</th><th>GitHub repository</th><th>Version</th></tr></thead><tbody>
<tr>
<td>ghcr.io/kube-logging/node-exporter</td><td><a href="https://github.com/kube-logging/node-exporter-image">https://github.com/kube-logging/node-exporter-image</a></td><td>v0.7.1</td></tr><tr>
<td>ghcr.io/kube-logging/config-reloader</td><td><a href="https://github.com/kube-logging/config-reloader">https://github.com/kube-logging/config-reloader</a></td><td>v0.0.5</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd-drain-watch</td><td><a href="https://github.com/kube-logging/fluentd-drain-watch">https://github.com/kube-logging/fluentd-drain-watch</a></td><td>v0.2.1</td></tr><tr>
<td>k8s.gcr.io/pause</td><td></td><td>3.2</td></tr><tr>
<td>docker.io/busybox</td><td><a href="https://github.com/docker-library/busybox">https://github.com/docker-library/busybox</a></td><td>latest</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog</td><td><a href="https://github.com/axoflow/axosyslog/">https://github.com/axoflow/axosyslog/</a></td><td>4.8.0</td></tr><tr>
<td>docker.io/fluent/fluent-bit</td><td><a href="https://github.com/fluent/fluent-bit">https://github.com/fluent/fluent-bit</a></td><td>3.0.4</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd</td><td><a href="https://github.com/kube-logging/fluentd-images">https://github.com/kube-logging/fluentd-images</a></td><td>v1.16-4.9-full</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog-metrics-exporter</td><td><a href="https://github.com/axoflow/axosyslog-metrics-exporter">https://github.com/axoflow/axosyslog-metrics-exporter</a></td><td>0.0.2</td></tr><tr>
<td>ghcr.io/kube-logging/syslogng-reload</td><td><a href="https://github.com/kube-logging/syslogng-reload-image">https://github.com/kube-logging/syslogng-reload-image</a></td><td>v1.4.0</td></tr><tr>
<td>ghcr.io/kube-logging/eventrouter</td><td><a href="https://github.com/kube-logging/eventrouter">https://github.com/kube-logging/eventrouter</a></td><td>0.4.0</td></tr></tbody></table><h2 id="logging-operator-version-48">Logging operator version 4.8</h2><table>
<thead>
<tr>
<th>Image repository</th><th>GitHub repository</th><th>Version</th></tr></thead><tbody>
<tr>
<td>ghcr.io/kube-logging/node-exporter</td><td><a href="https://github.com/kube-logging/node-exporter-image">https://github.com/kube-logging/node-exporter-image</a></td><td>v0.7.1</td></tr><tr>
<td>ghcr.io/kube-logging/config-reloader</td><td><a href="https://github.com/kube-logging/config-reloader">https://github.com/kube-logging/config-reloader</a></td><td>v0.0.5</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd-drain-watch</td><td><a href="https://github.com/kube-logging/fluentd-drain-watch">https://github.com/kube-logging/fluentd-drain-watch</a></td><td>v0.2.1</td></tr><tr>
<td>k8s.gcr.io/pause</td><td></td><td>3.2</td></tr><tr>
<td>docker.io/busybox</td><td><a href="https://github.com/docker-library/busybox">https://github.com/docker-library/busybox</a></td><td>latest</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog</td><td><a href="https://github.com/axoflow/axosyslog/">https://github.com/axoflow/axosyslog/</a></td><td>4.7.1</td></tr><tr>
<td>docker.io/fluent/fluent-bit</td><td><a href="https://github.com/fluent/fluent-bit">https://github.com/fluent/fluent-bit</a></td><td>3.0.4</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd</td><td><a href="https://github.com/kube-logging/fluentd-images">https://github.com/kube-logging/fluentd-images</a></td><td>v1.16-4.8-full</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog-metrics-exporter</td><td><a href="https://github.com/axoflow/axosyslog-metrics-exporter">https://github.com/axoflow/axosyslog-metrics-exporter</a></td><td>0.0.2</td></tr><tr>
<td>ghcr.io/kube-logging/syslogng-reload</td><td><a href="https://github.com/kube-logging/syslogng-reload-image">https://github.com/kube-logging/syslogng-reload-image</a></td><td>v1.3.1</td></tr><tr>
<td>ghcr.io/kube-logging/eventrouter</td><td><a href="https://github.com/kube-logging/eventrouter">https://github.com/kube-logging/eventrouter</a></td><td>0.4.0</td></tr></tbody></table><h2 id="logging-operator-version-47">Logging operator version 4.7</h2><table>
<thead>
<tr>
<th>Image repository</th><th>GitHub repository</th><th>Version</th></tr></thead><tbody>
<tr>
<td>ghcr.io/kube-logging/node-exporter</td><td><a href="https://github.com/kube-logging/node-exporter-image">https://github.com/kube-logging/node-exporter-image</a></td><td>v0.7.1</td></tr><tr>
<td>ghcr.io/kube-logging/config-reloader</td><td><a href="https://github.com/kube-logging/config-reloader">https://github.com/kube-logging/config-reloader</a></td><td>v0.0.5</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd-drain-watch</td><td><a href="https://github.com/kube-logging/fluentd-drain-watch">https://github.com/kube-logging/fluentd-drain-watch</a></td><td>v0.2.1</td></tr><tr>
<td>k8s.gcr.io/pause</td><td></td><td>3.2</td></tr><tr>
<td>docker.io/busybox</td><td><a href="https://github.com/docker-library/busybox">https://github.com/docker-library/busybox</a></td><td>latest</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog</td><td><a href="https://github.com/axoflow/axosyslog-docker/">https://github.com/axoflow/axosyslog-docker/</a></td><td>4.7.1</td></tr><tr>
<td>docker.io/fluent/fluent-bit</td><td><a href="https://github.com/fluent/fluent-bit">https://github.com/fluent/fluent-bit</a></td><td>3.0.4</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd</td><td><a href="https://github.com/kube-logging/fluentd-images">https://github.com/kube-logging/fluentd-images</a></td><td>v1.16-full</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog-metrics-exporter</td><td><a href="https://github.com/axoflow/axosyslog-metrics-exporter">https://github.com/axoflow/axosyslog-metrics-exporter</a></td><td>0.0.2</td></tr><tr>
<td>ghcr.io/kube-logging/syslogng-reload</td><td><a href="https://github.com/kube-logging/syslogng-reload-image">https://github.com/kube-logging/syslogng-reload-image</a></td><td>v1.3.1</td></tr><tr>
<td>ghcr.io/kube-logging/eventrouter</td><td><a href="https://github.com/kube-logging/eventrouter">https://github.com/kube-logging/eventrouter</a></td><td>0.4.0</td></tr></tbody></table><h2 id="logging-operator-version-46">Logging operator version 4.6</h2><table>
<thead>
<tr>
<th>Image repository</th><th>GitHub repository</th><th>Version</th></tr></thead><tbody>
<tr>
<td>ghcr.io/kube-logging/node-exporter</td><td><a href="https://github.com/kube-logging/node-exporter-image">https://github.com/kube-logging/node-exporter-image</a></td><td>v0.7.1</td></tr><tr>
<td>ghcr.io/kube-logging/config-reloader</td><td><a href="https://github.com/kube-logging/config-reloader">https://github.com/kube-logging/config-reloader</a></td><td>v0.0.5</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd-drain-watch</td><td><a href="https://github.com/kube-logging/fluentd-drain-watch">https://github.com/kube-logging/fluentd-drain-watch</a></td><td>v0.2.1</td></tr><tr>
<td>k8s.gcr.io/pause</td><td></td><td>3.2</td></tr><tr>
<td>docker.io/busybox</td><td><a href="https://github.com/docker-library/busybox">https://github.com/docker-library/busybox</a></td><td>latest</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog</td><td><a href="https://github.com/axoflow/axosyslog-docker/">https://github.com/axoflow/axosyslog-docker/</a></td><td>4.5.0</td></tr><tr>
<td>docker.io/fluent/fluent-bit</td><td><a href="https://github.com/fluent/fluent-bit">https://github.com/fluent/fluent-bit</a></td><td>2.1.8</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd</td><td><a href="https://github.com/kube-logging/fluentd-images">https://github.com/kube-logging/fluentd-images</a></td><td>v1.16-full</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog-metrics-exporter</td><td><a href="https://github.com/axoflow/axosyslog-metrics-exporter">https://github.com/axoflow/axosyslog-metrics-exporter</a></td><td>0.0.2</td></tr><tr>
<td>ghcr.io/kube-logging/syslogng-reload</td><td><a href="https://github.com/kube-logging/syslogng-reload-image">https://github.com/kube-logging/syslogng-reload-image</a></td><td>v1.3.1</td></tr><tr>
<td>ghcr.io/kube-logging/eventrouter</td><td><a href="https://github.com/kube-logging/eventrouter">https://github.com/kube-logging/eventrouter</a></td><td>0.4.0</td></tr></tbody></table><h2 id="logging-operator-version-45">Logging operator version 4.5</h2><table>
<thead>
<tr>
<th>Image repository</th><th>GitHub repository</th><th>Version</th></tr></thead><tbody>
<tr>
<td>ghcr.io/kube-logging/node-exporter</td><td><a href="https://github.com/kube-logging/node-exporter-image">https://github.com/kube-logging/node-exporter-image</a></td><td>v0.7.1</td></tr><tr>
<td>ghcr.io/kube-logging/config-reloader</td><td><a href="https://github.com/kube-logging/config-reloader">https://github.com/kube-logging/config-reloader</a></td><td>v0.0.5</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd-drain-watch</td><td><a href="https://github.com/kube-logging/fluentd-drain-watch">https://github.com/kube-logging/fluentd-drain-watch</a></td><td>v0.2.1</td></tr><tr>
<td>k8s.gcr.io/pause</td><td></td><td>3.2</td></tr><tr>
<td>docker.io/busybox</td><td><a href="https://github.com/docker-library/busybox">https://github.com/docker-library/busybox</a></td><td>latest</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog</td><td><a href="https://github.com/axoflow/axosyslog-docker/">https://github.com/axoflow/axosyslog-docker/</a></td><td>4.5.0</td></tr><tr>
<td>docker.io/fluent/fluent-bit</td><td><a href="https://github.com/fluent/fluent-bit">https://github.com/fluent/fluent-bit</a></td><td>2.1.8</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd</td><td><a href="https://github.com/kube-logging/fluentd-images">https://github.com/kube-logging/fluentd-images</a></td><td>v1.16-full</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog-metrics-exporter</td><td><a href="https://github.com/axoflow/axosyslog-metrics-exporter">https://github.com/axoflow/axosyslog-metrics-exporter</a></td><td>0.0.2</td></tr><tr>
<td>ghcr.io/kube-logging/syslogng-reload</td><td><a href="https://github.com/kube-logging/syslogng-reload-image">https://github.com/kube-logging/syslogng-reload-image</a></td><td>v1.3.1</td></tr><tr>
<td>ghcr.io/kube-logging/eventrouter</td><td><a href="https://github.com/kube-logging/eventrouter">https://github.com/kube-logging/eventrouter</a></td><td>0.4.0</td></tr></tbody></table><h2 id="logging-operator-version-44">Logging operator version 4.4</h2><table>
<thead>
<tr>
<th>Image repository</th><th>GitHub repository</th><th>Version</th></tr></thead><tbody>
<tr>
<td>ghcr.io/kube-logging/node-exporter</td><td><a href="https://github.com/kube-logging/node-exporter-image">https://github.com/kube-logging/node-exporter-image</a></td><td>v0.7.1</td></tr><tr>
<td>ghcr.io/kube-logging/config-reloader</td><td><a href="https://github.com/kube-logging/config-reloader">https://github.com/kube-logging/config-reloader</a></td><td>v0.0.5</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd-drain-watch</td><td><a href="https://github.com/kube-logging/fluentd-drain-watch">https://github.com/kube-logging/fluentd-drain-watch</a></td><td>v0.2.1</td></tr><tr>
<td>k8s.gcr.io/pause</td><td></td><td>3.2</td></tr><tr>
<td>docker.io/busybox</td><td><a href="https://github.com/docker-library/busybox">https://github.com/docker-library/busybox</a></td><td>latest</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog</td><td><a href="https://github.com/axoflow/axosyslog-docker/">https://github.com/axoflow/axosyslog-docker/</a></td><td>4.4.0</td></tr><tr>
<td>docker.io/fluent/fluent-bit</td><td><a href="https://github.com/fluent/fluent-bit-docker-image">https://github.com/fluent/fluent-bit-docker-image</a></td><td>2.1.8</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd</td><td><a href="https://github.com/kube-logging/fluentd-images">https://github.com/kube-logging/fluentd-images</a></td><td>v1.15-ruby3</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog-metrics-exporter</td><td><a href="https://github.com/axoflow/axosyslog-metrics-exporter">https://github.com/axoflow/axosyslog-metrics-exporter</a></td><td>0.0.2</td></tr><tr>
<td>ghcr.io/kube-logging/syslogng-reload</td><td><a href="https://github.com/kube-logging/syslogng-reload-image">https://github.com/kube-logging/syslogng-reload-image</a></td><td>v1.3.1</td></tr><tr>
<td>ghcr.io/kube-logging/eventrouter</td><td><a href="https://github.com/kube-logging/eventrouter">https://github.com/kube-logging/eventrouter</a></td><td>v0.4.0</td></tr></tbody></table><h3 id="the-following-images-are-now-replaced">The following images are now replaced</h3><table>
<thead>
<tr>
<th>Image used in 4.3</th><th>New image in 4.4</th><th></th></tr></thead><tbody>
<tr>
<td>banzaicloud/eventrouter</td><td>ghcr.io/kube-logging/eventrouter</td><td></td></tr><tr>
<td>ghcr.io/kube-logging/syslog-ng-exporter</td><td>ghcr.io/axoflow/axosyslog-metrics-exporter</td><td></td></tr></tbody></table><h2 id="logging-operator-version-43">Logging operator version 4.3</h2><table>
<thead>
<tr>
<th>Image repository</th><th>GitHub repository</th><th>Version</th></tr></thead><tbody>
<tr>
<td>ghcr.io/kube-logging/node-exporter</td><td><a href="https://github.com/kube-logging/node-exporter-image">https://github.com/kube-logging/node-exporter-image</a></td><td>v0.6.1</td></tr><tr>
<td>ghcr.io/kube-logging/config-reloader</td><td><a href="https://github.com/kube-logging/config-reloader">https://github.com/kube-logging/config-reloader</a></td><td>v0.0.5</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd-drain-watch</td><td><a href="https://github.com/kube-logging/fluentd-drain-watch">https://github.com/kube-logging/fluentd-drain-watch</a></td><td>v0.2.0</td></tr><tr>
<td>k8s.gcr.io/pause</td><td></td><td>3.2</td></tr><tr>
<td>docker.io/busybox</td><td><a href="https://github.com/docker-library/busybox">https://github.com/docker-library/busybox</a></td><td>latest</td></tr><tr>
<td>ghcr.io/axoflow/axosyslog</td><td><a href="https://github.com/axoflow/axosyslog-docker/">https://github.com/axoflow/axosyslog-docker/</a></td><td>4.3.0</td></tr><tr>
<td>docker.io/fluent/fluent-bit</td><td><a href="https://github.com/fluent/fluent-bit-docker-image">https://github.com/fluent/fluent-bit-docker-image</a></td><td>2.1.4</td></tr><tr>
<td>ghcr.io/kube-logging/fluentd</td><td><a href="https://github.com/kube-logging/fluentd-images">https://github.com/kube-logging/fluentd-images</a></td><td>v1.15-ruby3</td></tr><tr>
<td>ghcr.io/kube-logging/syslog-ng-exporter</td><td><a href="https://github.com/kube-logging/syslog_ng_exporter">https://github.com/kube-logging/syslog_ng_exporter</a></td><td>v0.0.16</td></tr><tr>
<td>ghcr.io/kube-logging/syslogng-reload</td><td><a href="https://github.com/kube-logging/syslogng-reload-image">https://github.com/kube-logging/syslogng-reload-image</a></td><td>v1.3.1</td></tr><tr>
<td>banzaicloud/eventrouter</td><td><a href="https://github.com/kube-logging/event-router">https://github.com/kube-logging/event-router</a></td><td>v0.1.0</td></tr></tbody></table></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-b9683b78eca24c9572e4995734221f3f">9 - For developers</h1><p>This documentation helps to set-up a developer environment and writing plugins for the Logging operator.</p><h2 id="setting-up-kind">Setting up Kind</h2><ol>
<li>
<p>Install Kind on your computer</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>go get sigs.k8s.io/kind@v0.5.1
</span></span></code></pre></div></li><li>
<p>Create cluster</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kind create cluster --name logging
</span></span></code></pre></div></li><li>
<p>Install prerequisites (this is a Kubebuilder makefile that will generate and install crds)</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>make install
</span></span></code></pre></div></li><li>
<p>Run the Operator</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>go run main.go
</span></span></code></pre></div></li></ol><h2 id="writing-a-plugin">Writing a plugin</h2><p>To add a <code>plugin</code> to the logging operator you need to define the plugin struct.</p><blockquote>
<p>Note: Place your plugin in the corresponding directory <code>pkg/sdk/logging/model/filter</code> or <code>pkg/sdk/logging/model/output</code></p></blockquote><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">type</span> <span style="color:#000">MyExampleOutput</span> <span style="color:#204a87;font-weight:700">struct</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>	<span style="color:#8f5902;font-style:italic">// Path that is required for the plugin
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">Path</span> <span style="color:#204a87;font-weight:700">string</span> <span style="color:#4e9a06">`json:&#34;path,omitempty&#34;`</span>
</span></span><span style="display:flex"><span><span style="color:#000;font-weight:700">}</span>
</span></span></code></pre></div><p>The plugin uses the <strong>JSON</strong> tags to parse and validate configuration. Without tags the configuration is not valid. The <code>fluent</code> parameter name must match with the JSON tag. Don&rsquo;t forget to use <code>omitempty</code> for non required parameters.</p><h3 id="implement-todirective">Implement <code>ToDirective</code></h3><p>To render the configuration you have to implement the <code>ToDirective</code> function.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">func</span> <span style="color:#000;font-weight:700">(</span><span style="color:#000">c</span> <span style="color:#ce5c00;font-weight:700">*</span><span style="color:#000">S3OutputConfig</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000">ToDirective</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">secretLoader</span> <span style="color:#000">secret</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">SecretLoader</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000;font-weight:700">(</span><span style="color:#000">types</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">Directive</span><span style="color:#000;font-weight:700">,</span> <span style="color:#204a87;font-weight:700">error</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>	<span style="color:#ce5c00;font-weight:700">...</span>
</span></span><span style="display:flex"><span><span style="color:#000;font-weight:700">}</span>
</span></span></code></pre></div><p>For simple Plugins you can use the <code>NewFlatDirective</code> function.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">func</span> <span style="color:#000;font-weight:700">(</span><span style="color:#000">c</span> <span style="color:#ce5c00;font-weight:700">*</span><span style="color:#000">ExampleOutput</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000">ToDirective</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">secretLoader</span> <span style="color:#000">secret</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">SecretLoader</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000;font-weight:700">(</span><span style="color:#000">types</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">Directive</span><span style="color:#000;font-weight:700">,</span> <span style="color:#204a87;font-weight:700">error</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">return</span> <span style="color:#000">types</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">NewFlatDirective</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">types</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">PluginMeta</span><span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>		<span style="color:#000">Type</span><span style="color:#000;font-weight:700">:</span>      <span style="color:#4e9a06">&#34;example&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>		<span style="color:#000">Directive</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;output&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>		<span style="color:#000">Tags</span><span style="color:#000;font-weight:700">:</span> <span style="color:#4e9a06">&#34;**&#34;</span><span style="color:#000;font-weight:700">,</span>
</span></span><span style="display:flex"><span>	<span style="color:#000;font-weight:700">},</span> <span style="color:#000">c</span><span style="color:#000;font-weight:700">,</span> <span style="color:#000">secretLoader</span><span style="color:#000;font-weight:700">)</span>
</span></span><span style="display:flex"><span><span style="color:#000;font-weight:700">}</span>
</span></span></code></pre></div><p>For more example please check the available plugins.</p><h3 id="reuse-existing-plugin-sections">Reuse existing Plugin sections</h3><p>You can embed existing configuration for your plugins. For example modern <code>Output</code> plugins have <code>Buffer</code> section.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// +docLink:&#34;Buffer,./buffer.md&#34;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Buffer</span> <span style="color:#ce5c00;font-weight:700">*</span><span style="color:#000">Buffer</span> <span style="color:#4e9a06">`json:&#34;buffer,omitempty&#34;`</span>
</span></span></code></pre></div><p>If you are using embedded sections you must call its <code>ToDirective</code> method manually and append it as a <code>SubDirective</code></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#204a87;font-weight:700">if</span> <span style="color:#000">c</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">Buffer</span> <span style="color:#ce5c00;font-weight:700">!=</span> <span style="color:#204a87;font-weight:700">nil</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>	<span style="color:#204a87;font-weight:700">if</span> <span style="color:#000">buffer</span><span style="color:#000;font-weight:700">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:700">:=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">Buffer</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">ToDirective</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">secretLoader</span><span style="color:#000;font-weight:700">);</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:700">!=</span> <span style="color:#204a87;font-weight:700">nil</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>		<span style="color:#204a87;font-weight:700">return</span> <span style="color:#204a87;font-weight:700">nil</span><span style="color:#000;font-weight:700">,</span> <span style="color:#000">err</span>
</span></span><span style="display:flex"><span>	<span style="color:#000;font-weight:700">}</span> <span style="color:#204a87;font-weight:700">else</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span>		<span style="color:#000">s3</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">SubDirectives</span> <span style="color:#000;font-weight:700">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:700">(</span><span style="color:#000">s3</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">SubDirectives</span><span style="color:#000;font-weight:700">,</span> <span style="color:#000">buffer</span><span style="color:#000;font-weight:700">)</span>
</span></span><span style="display:flex"><span>	<span style="color:#000;font-weight:700">}</span>
</span></span><span style="display:flex"><span><span style="color:#000;font-weight:700">}</span>
</span></span></code></pre></div><h3 id="special-plugin-tags">Special plugin tags</h3><p>To document the plugins logging-operator uses the Go <code>tags</code> (like JSON tags). Logging operator uses <code>plugin</code> named tags for special instructions.</p><h4 id="special-tag-default">Special tag <code>default</code></h4><p>The default tag helps to give <code>default</code> values for parameters. These parameters are explicitly set in the generated fluentd configuration.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#000">RetryForever</span> <span style="color:#204a87;font-weight:700">bool</span> <span style="color:#4e9a06">`json:&#34;retry_forever&#34; plugin:&#34;default:true&#34;`</span>
</span></span></code></pre></div><h4 id="special-tag-required">Special tag <code>required</code></h4><p>The required tag ensures that the attribute <strong>cannot</strong> be empty</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#000">RetryForever</span> <span style="color:#204a87;font-weight:700">bool</span> <span style="color:#4e9a06">`json:&#34;retry_forever&#34; plugin:&#34;required&#34;`</span>
</span></span></code></pre></div><h3 id="add-plugin-to-the-logging-operator-api">Add plugin to the Logging operator API</h3><p>Enable your plugin for users when using the <code>output/flow</code> CRDs by adding it to the proper Logging operator API type.</p><ul>
<li>Output Plugin - <a href="https://github.com/kube-logging/logging-operator/blob/64495126b215bc852a702b47aab73df8d0515bd7/pkg/sdk/logging/api/v1beta1/output_types.go#L32">OutputSpec</a></li><li>Filter Plugin - <a href="https://github.com/kube-logging/logging-operator/blob/64495126b215bc852a702b47aab73df8d0515bd7/pkg/sdk/logging/api/v1beta1/flow_types.go#L64">Filter</a></li></ul><h2 id="generate-documentation-for-plugin">Generate documentation for Plugin</h2><p>The operator parse the <code>docstrings</code> for the documentation.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">...</span>
</span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// AWS access key id
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">AwsAccessKey</span> <span style="color:#ce5c00;font-weight:700">*</span><span style="color:#000">secret</span><span style="color:#000;font-weight:700">.</span><span style="color:#000">Secret</span> <span style="color:#4e9a06">`json:&#34;aws_key_id,omitempty&#34;`</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">...</span>
</span></span></code></pre></div><p>Will generate the following Markdown</p><table>
<thead>
<tr>
<th>Variable Name</th><th>Default</th><th>Applied function</th></tr></thead><tbody>
<tr>
<td>AwsAccessKey</td><td></td><td>AWS access key id</td></tr></tbody></table><p>You can <em>hint</em> default values in docstring via <code>(default: value)</code>. This is useful if you don&rsquo;t want to set default explicitly with <code>tag</code>. However during rendering defaults in <code>tags</code> have priority over docstring.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">...</span>
</span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// The format of S3 object keys (default: %{path}%{time_slice}_%{index}.%{file_extension})
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">S3ObjectKeyFormat</span> <span style="color:#204a87;font-weight:700">string</span> <span style="color:#4e9a06">`json:&#34;s3_object_key_format,omitempty&#34;`</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">...</span>
</span></span></code></pre></div><h3 id="special-docstrings">Special docstrings</h3><ul>
<li><code>+docName:"Title for the plugin section"</code></li><li><code>+docLink:"Buffer,./buffer.md"</code></li></ul><p>You can declare document <strong>title</strong> and <strong>description</strong> above the <code>type _doc* interface{}</code> variable declaration.</p><p>Example Document headings:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// +docName:&#34;Amazon S3 plugin for Fluentd&#34;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// **s3** output plugin buffers event logs in local file and upload it to S3 periodically. This plugin splits files exactly by using the time of event logs (not the time when the logs are received). For example, a log &#39;2011-01-02 message B&#39; is reached, and then another log &#39;2011-01-03 message B&#39; is reached in this order, the former one is stored in &#34;20110102.gz&#34; file, and latter one in &#34;20110103.gz&#34; file.
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:700">type</span> <span style="color:#000">_docS3</span> <span style="color:#204a87;font-weight:700">interface</span><span style="color:#000;font-weight:700">{}</span>
</span></span></code></pre></div><p>Example Plugin headings:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// +kubebuilder:object:generate=true
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// +docName:&#34;Shared Credentials&#34;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:700">type</span> <span style="color:#000">S3SharedCredentials</span> <span style="color:#204a87;font-weight:700">struct</span> <span style="color:#000;font-weight:700">{</span>
</span></span><span style="display:flex"><span><span style="color:#ce5c00;font-weight:700">...</span>
</span></span></code></pre></div><p>Example linking embedded sections</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#8f5902;font-style:italic">// +docLink:&#34;Buffer,./buffer.md&#34;
</span></span></span><span style="display:flex"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Buffer</span> <span style="color:#ce5c00;font-weight:700">*</span><span style="color:#000">Buffer</span> <span style="color:#4e9a06">`json:&#34;buffer,omitempty&#34;`</span>
</span></span></code></pre></div><h3 id="generate-resources-for-your-plugin">Generate resources for your Plugin</h3><p>Run the following command to generate updated docs and CRDs for your new plugin.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>make generate
</span></span></code></pre></div></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-04fd5dde5261fd5d26d6bac28e83d40e">10 - Commercial support for the Logging operator</h1><p>If you encounter problems while using the Logging operator the documentation does not address, <a href="https://github.com/kube-logging/logging-operator/issues">open an issue</a> or talk to us on <a href="https://discord.gg/9ACY4RDsYN">Discord</a> or on the <a href="/5.1/docs/community/">CNCF Slack</a>.</p><p>The following companies provide commercial support for the Logging operator:</p><ul>
<li><a href="https://axoflow.com/">Axoflow</a></li></ul><p>If your company offers support for Logging operator and would like to be listed on this page, open a <a href="https://github.com/kube-logging/kube-logging.github.io/issues/new?title=Commercial%20support%20for%20Logging%20operator">documentation issue</a>.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-956da29f025cba37fca9fe6b80ab5d48">11 - Frequently asked questions</h1><h2 id="how-can-i-run-the-unreleased-master-version">How can I run the unreleased master version?</h2><ol>
<li>
<p>Clone the logging-operator repo.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>git clone git@github.com:kube-logging/logging-operator.git
</span></span></code></pre></div></li><li>
<p>Navigate to the <code>logging-operator</code> folder.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#204a87">cd</span> logging-operator
</span></span></code></pre></div></li><li>
<p>Install with helm</p><ul>
<li>
<p>Helm v3</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span> helm upgrade --install --wait --create-namespace --namespace logging logging ./charts/logging-operator --set image.tag<span style="color:#ce5c00;font-weight:700">=</span>master
</span></span></code></pre></div></li></ul></li></ol><h2 id="how-can-i-support-the-project">How can I support the project?</h2><ul>
<li>Give a star to <a href="https://github.com/kube-logging/logging-operator">this repository</a></li><li>Add your company to the <a href="https://github.com/kube-logging/logging-operator/blob/master/ADOPTERS.md">adopters</a> list</li></ul></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-0c44f8157757ae9807433efcf75c4e52">12 - License</h1><p>Copyright (c) 2017-2019 <a href="https://banzaicloud.com">Banzai Cloud, Inc.</a>
Copyright (c) 2020-2023 <a href="https://cisco.com">Cisco Systems, Inc.</a>
Copyright (c) 2023- <a href="https://github.com/kube-logging/">kube-logging authors</a></p><p>Licensed under the Apache License, Version 2.0 (the &ldquo;License&rdquo;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p><p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p><p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &ldquo;AS IS&rdquo; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p></div><div class="td-content" style="page-break-before:always">
<h1 id="pg-51fa3b5335cd006e7cfd90883860deec">13 - Community</h1><p>If you have questions about Logging operator or its components, get in touch with us on Slack!</p><p>First, <a href="https://communityinviter.com/apps/cloud-native/cncf">register on the CNCF Slack</a>, then <a href="https://cloud-native.slack.com/archives/C06DW57NWSJ">visit the #logging-operator Slack channel</a>.</p><p>Alternatively, you can also find us on <a href="https://discord.gg/9ACY4RDsYN">Discord</a>.</p><p>If you&rsquo;d like to contribute, see our <a href="https://github.com/kube-logging/logging-operator/blob/master/CONTRIBUTING.md">contribution guidelines</a> for details.</p></div></main></div></div><footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class="row">
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
<a class="text-white" target="_blank" rel="noopener" href="https://github.com/kube-logging/logging-operator" aria-label="GitHub">
<i class="fab fa-github"></i>
</a>
</li><li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
<a class="text-white" target="_blank" rel="noopener" href="/docs/community/" aria-label="Slack">
<i class="fab fa-slack"></i>
</a>
</li><li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Discord" aria-label="Discord">
<a class="text-white" target="_blank" rel="noopener" href="https://discord.gg/9ACY4RDsYN" aria-label="Discord">
<i class="fab fa-discord"></i>
</a>
</li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class="text-white"><a class="text-white" href="https://www.linuxfoundation.org/trademark-usage/">Trademark Usage</a> | </small>
<small class="text-white">&copy; 2023-2025 kube-logging authors | All Rights Reserved</small>
</div></div></div></footer></div><script src="/5.1/js/main.min.93ea63f0578d626414d66b8633bc9a15385bf21359be725f5a534ffcc01d3c9e.js" integrity="sha256-k+pj8FeNYmQU1muGM7yaFThb8hNZvnJfWlNP/MAdPJ4=" crossorigin="anonymous"></script>
<script src='/5.1/js/prism.js'></script>
<script src='/5.1/js/tabpane-persist.js'></script>
<script src="/js/tocbot.min.js"></script>
<script type="text/javascript">tocbot.init({tocSelector:".td-toc",contentSelector:".td-content",headingSelector:"h2, h3, h4",ignoreHiddenElements:!0})</script>
<script>(function(){var e=document.querySelector("#td-section-nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</body></html>